define("_generated/Less/MsPortalImpl/Widgets/Widgets.HoverCard.css",["module"],(function(e){"use strict";return{css:'@keyframes cardOpen{0%{opacity:0;transform:scale(.7)}100%{opacity:1;transform:scale(1)}}.fxs-hover-card-balloon{background-color:transparent;list-style-type:none;padding:0;margin:0}.fxs-hover-card-balloon .azc-balloon-pointer2{display:none}.fxs-hover-card-balloon.azc-balloon-hidden .fxs-hover-card{animation:none;display:none}.fxs-hover-card-balloon>.azc-balloon-content{padding:0;background-color:transparent;box-shadow:0 8px 16px 0 rgba(0,0,0,.28);animation-name:stretch;animation-duration:.2s;animation-timing-function:ease-out;animation-delay:0;animation-direction:alternate;animation-fill-mode:none;animation-play-state:running}@keyframes stretch{0%{transform:scale(.1);box-shadow:none}100%{transform:scale(1);box-shadow:0 8px 16px 0 rgba(0,0,0,.28)}}.fxs-hover-card-balloon.fxs-portal-bg-txt-br{background-color:transparent}.fxs-hover-card-balloon.azc-balloon-hidden .fxs-hover-card{animation:none;display:none}.fxs-hover-card-balloon>.azc-balloon-content{margin:0;background-color:transparent;box-shadow:0 8px 16px 0 rgba(0,0,0,.28);animation-name:stretch;animation-duration:.2s;animation-timing-function:ease-out;animation-delay:0;animation-fill-mode:none;animation-direction:alternate;animation-play-state:running}@keyframes stretch{0%{transform:scale(.1);box-shadow:none}100%{transform:scale(1);box-shadow:0 8px 16px 0 rgba(0,0,0,.28)}}.fxs-hover-card-container{font-family:az_ea_font,"Segoe UI",az_font,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;font-weight:400;border:1px solid #f3f2f1;font-size:13px;line-height:18px;color:inherit;width:320px;max-height:512px;overflow:hidden;cursor:default}.fxs-hover-card-header{display:flex;padding:0 0 10px}.fxs-hover-card-header .fxs-hover-card-h3 .fxs-hover-card-icon{float:left}.fxs-hover-card-favoriteicon{margin:0 0 auto auto;float:right;cursor:pointer}.fxs-hover-card-favoriteicon svg{height:14px;width:14px;opacity:.6;fill:#0078d4}.fxs-hover-card-favoriteicon:hover svg{opacity:1}.fxs-mode-dark .fxs-hover-card-favoriteicon svg{fill:#f2f2f2}.fxs-hover-card-icon{height:50px;width:50px;flex:0 0 auto;float:right;text-align:center;border:1px solid transparent;margin:0 20px 0 0;box-sizing:border-box}.fxs-hover-card-border{opacity:0;height:0;margin:0 20px;border-top:1px solid #f3f2f1}.fxs-hover-card{animation:cardExpand .467s ease 1500ms;animation-fill-mode:forwards;transition:opacity 1500ms cubic-bezier(.5,0,0,1) 3s;visibility:hidden;opacity:0;height:0;max-height:0;width:100%;overflow:hidden}@keyframes cardExpand{0%{opacity:0;height:0;max-height:0}99%{visibility:visible;opacity:1;height:100%;max-height:356px}100%{visibility:visible;opacity:1;height:100%;max-height:100%}}.fxs-hover-card-initial{padding:20px 20px 0 20px}.fxs-hover-card-additional{overflow-y:auto;max-height:376px;margin-top:-1px}.fxs-hover-card-padleftright{padding:0 20px}.fxs-hover-card-commands{position:relative;padding:0;display:flex;margin-bottom:10px}.fxs-hover-card-training-icon{padding:0 5px 0 0;min-width:24px;min-height:24px;height:24px;width:24px}.fxs-hover-card-training-item{display:flex;align-items:center;padding:5px 20px}.fxs-hover-card-padless-header{padding:10px 0 0 0;margin:0 20px;border-top:1px solid #f3f2f1}.fxs-hover-card-training-link{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-bottom:-3px}.fxs-hover-card-training-sub{line-height:17px;margin-top:-2px;display:flex}.fxs-hover-card-list{list-style-type:none;padding-left:0}.fxs-hover-card-title{font-weight:600;font-size:18px;line-height:20px;overflow:hidden;-webkit-line-clamp:2;-webkit-box-orient:vertical;max-height:41px;display:-webkit-box}.fxs-hover-card-heading{font-weight:600;font-size:14px;line-height:20px;margin:4px 0}.fxs-hover-card-padbottom{padding-bottom:10px}.fxs-hover-card-section{padding:10px 0;margin:0 20px;border-top:1px solid #f3f2f1}.fxs-hover-card-description{display:block;display:-webkit-box;line-height:18px;max-height:90px;overflow:hidden;text-overflow:ellipsis;-webkit-line-clamp:5;-webkit-box-orient:vertical;max-width:263px}.fxs-hover-card-expanded-description{max-height:100%;overflow-y:auto;-webkit-line-clamp:initial;-webkit-box-orient:vertical}.fxs-hover-card-seemore-link{display:flex}.fxs-hover-card-see-more-less{padding-right:5px}.fxs-hover-card-expand-icon{cursor:pointer;background-color:transparent;border:0;margin:0;padding:0;height:10px;width:10px}.fxs-hover-card-icon-vertical-transform{transform:scale(-1,-1);padding-bottom:8px}.fxs-hover-card-resource-property{padding:5px 0}.fxs-hover-card-property-name{color:#605e5c}.fxs-theme-dark .fxs-hover-card-property-name{color:#9fa1a3}.fxs-hover-card-property-value{display:flex}.fxs-hover-card-no-border{border:0}.fxs-hover-card-preview-tag{color:#8a2da5;border:1px #d6adeb;fill:solid;border-radius:2px;background-color:#f9f3fc;padding:2px 6px;width:42px}.fxs-hover-card-disabled-tag{border:1px #a19f9d;fill:solid;border-radius:2px;background-color:#f3f2f1;color:#a19f9d;padding:2px 6px;margin-right:5px;width:46px}',moduleId:e.id}})),
define("MsPortalImpl/Widgets/Widgets.HoverCard",["require","exports","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","Viva.Controls/Controls/Viva.Balloon","MsPortalImpl/UI/UI.PopupPositioningMethods","MsPortalImpl/UI/Hubs/UI.FavoritesManager","MsPortalImpl/Base/Base.KeyboardHelper","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.HoverCard.css","Weave"],(function(e,t,o,a,i,r,n,s,d,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBalloonElement=t.attach=t.Widget=t.ViewModel=t.logTelemetry=void 0,(0,d.injectCss)(l);function p(e,t){return!(!e||!t)&&(t===e||$.contains(e,t))}function h(e,t,o){MsPortalFx.Base.Diagnostics.Telemetry.trace({source:"HoverCard",name:t,action:e,actionModifier:"mark",data:o})}t.logTelemetry=h;class g extends o.ViewModel{constructor(){super(...arguments),this.positionHint=1,this.favoriteOnDismiss=!1}}t.ViewModel=g;class x extends o.Widget{constructor(e,t,o){super(e,t),this._diContainer=o,t.onFavoritesChange&&(0,c.subscribeAndRun)(this.ltm,[this._diContainer.get(n.FavoritesManager).favorites],(e=>{t.onFavoritesChange(e)})),t.widget=this,this.element.addClass("fxs-home-hover-card"),this._initializeBalloonWidget()}_initializeBalloonWidget(){const e=this.element,t=new i.ViewModel({ltm:this.ltm}),o={htmlTemplate:this.options.template,viewModel:this.options};t.visible(!0),t.closeOtherBalloons=!0,t.renderMode(0),t.positionHint=this.options.positionHint,t.box((()=>(0,r.getBox)(this.options.dockingElement))),t.content(o);const n=new i.Widget(e,t,{isTrusted:!0},new i.WidgetUIState),d=new MsPortalFx.Base.Debouncer(((t,o)=>(t||[]).concat(o.filter((t=>p(e[0],t.currentTarget)||p(this.options.dockingElement[0],t.currentTarget))))),(e=>{if(!e.length)return Q(null);const t=MsPortalFx.last(e);return["focusout","mouseleave","mouseout"].includes(t.type)&&!p(n.element[0],document.activeElement)&&(this.ltm.isDisposed()||this.dispose()),Q(null)}),500,!0);this.ltm.registerForDispose([n,()=>{this.options.dockingElement[0].addEventListener("click",(e=>{p(this.element[0],e.currentTarget)&&(this.dispose(),e.stopPropagation())}),!0)},n.element.setEvents(["animationend",".fxs-hover-card",e=>{const t=$(window).height()+$(document).scrollTop(),o=n.element[0],a=(0,r.getBox)(o),i=a.top+a.height+30-t;if(a.height>150){const t=(0,r.getBox)($(e.currentTarget).find(".fxs-hover-card-padless-header")[0]);n.element.find(".fxs-hover-card-border").css({width:t.width}).animate({opacity:1})}i>0&&$(o).animate({top:a.top-i+"px"}),h("FullyRevealed",o.getAttribute("data-assetid")||o.getAttribute("data-name"),{hoverCardLocation:o.getAttribute("data-source")})}],["click",t=>{if(p(e[0],t.target)){($(t.target).parents("a")[0]||"a"===t.target.tagName.toLowerCase())&&this.dispose(),t.stopPropagation()}}],["mouseleave",e=>{d.execute([e]),e.stopPropagation()}],["focusout",e=>{d.execute([e]),e.stopPropagation()}],["mouseenter",e=>{d.execute([e]),e.stopPropagation()}],["focusin",e=>{d.execute([e]),e.stopPropagation()}],["keydown",e=>{27!==e.keyCode&&112!==e.keyCode||(this.dispose(),e.stopPropagation(),e.preventDefault()),32===e.keyCode&&4===(0,s.getModifierKeys)(e)&&(this.options.setFavorite&&this.options.setFavorite(),e.stopPropagation(),e.preventDefault())}],["focusin",".fxs-hover-card-favoriteicon",e=>{const t="true"===$(e.currentTarget).attr("aria-pressed");$(e.currentTarget).attr("aria-pressed",!t),e&&!p(n.element[0],e.relatedTarget)&&(this.options.dockingElement.blur(),$(e.relatedTarget).focus())}]),this.options.dockingElement.setEvents(["mouseleave",e=>{d.execute([e])}],["focusout",e=>{d.execute([e]),e.stopPropagation()}],["mouseenter",e=>{d.execute([e]),e.stopPropagation()}],["focusin",e=>{d.execute([e]),e.stopPropagation()}]),$(document).setEvents(["keydown",e=>{27===e.keyCode&&(this.dispose(),e.stopPropagation(),e.preventDefault()),32===e.keyCode&&4===(0,s.getModifierKeys)(e)&&(this.options.setFavorite(),e.stopPropagation(),e.preventDefault())}])]),new a.KeyboardNavigation(this.ltm,{element:this.element,tabTriggers:2})}dispose(){p(this.options.dockingElement[0],document.activeElement)&&(this.options.dockingElement.findFirstTabbable().focus(),this.options.dockingElement.trigger("programmatic"),this.element.find(".fxs-hover-card-container").animate({height:0},501)),this.element.removeAttr("tabindex"),setTimeout((()=>{super.dispose(),this.options.favoriteOnDismiss&&this.options.updateFavorite&&this.options.updateFavorite(),this.options.dockingElement.removeAttr("title"),this._cleanElement(),f(void 0)}),501)}}t.Widget=x;const f=ko.observable();t.attach=function(e,t,o,a,i){if(i.get(FxImpl.Features).isEnabled("showhovercard")){let i=!1;const r=new MsPortalFx.Base.Debouncer(((e,o)=>(e||[]).concat(o.filter((e=>p(t[0],e.currentTarget))))),(e=>{const t=MsPortalFx.last(e);if(!e.length||"programmatic"===t.type)return Q(null);const o=f();let i=o&&o.options.dockingElement[0];return i&&o.ltm.isDisposed()&&(i=null),"open"!==t.type&&!$(t.currentTarget).is(":hover")&&!p(t.currentTarget,document.activeElement)||p(i,t.currentTarget)||f(a(t)),Q(null)}),500,!0),n=t=>{const o=f(),a=document.activeElement;if(o&&p(o.options.dockingElement[0],t))return o.options.focusContent.fxAwaitAndRun(e).then((()=>{o.element.find('[role="button"]').focus(),f.fxOnce(e,(e=>{$(a).focus()}))}));f(null),f.fxAwait(e).then((t=>{const o=document.activeElement;t&&t.options.focusContent.fxAwaitAndRun(e).then((()=>{t.element.find('[role="button"]').focus(),f.fxOnce(e,(e=>{$(o).focus()}))}))})),r.execute([$.Event("open",{currentTarget:t,target:t})]),r.flush()};return e.registerForDispose(t.setEvents(["click",o,e=>{r.flush().then((()=>{if($(e.target).parents("a")[0]||"a"===e.target.tagName.toLowerCase()){const e=f();e&&e.dispose(),i=!0}}))}],["mouseenter",o,e=>{$(e.currentTarget).find("[title]").each(((e,t)=>{$(t).attr("data-title",$(t).attr("title")),$(t).removeAttr("title")})),e.stopPropagation()}],["programmatic",o,e=>{r.execute([e])}],["mouseleave",o,e=>{i=!1,$(e.currentTarget).find("[data-title]").each(((e,t)=>{$(t).attr("title",$(t).attr("data-title")),$(t).removeAttr("data-title")})),e.stopPropagation()}],["mousemove",o,e=>{i||($(e.currentTarget).attr("aria-describedby","hoverCardDescriptionId"),r.execute([e]),e.stopPropagation())}],["keydown",o,e=>{$(e.currentTarget).attr("aria-describedby","hoverCardDescriptionId"),112===e.keyCode&&(n(e.currentTarget),e.stopImmediatePropagation(),e.preventDefault())}])),n}return MsPortalFx.identity},t.getBalloonElement=function(e,t,o){let a=$.querySelectorAll(`.fxs-hover-card-balloon[data-name='${e}']`);return(null==a?void 0:a.length)||(a=$(FxImpl.createElement("div",{style:"display: none",class:"fxs-hover-card-balloon"})),a.attr("data-name",e),a.attr("data-source",t),o&&a.attr("data-assetid",o),function(){const e="fxs-hover-cards-main-container";let t=$.querySelectorAll(`.${e}`);return(null==t?void 0:t.length)||(t=$(FxImpl.createElement("div",{class:e})),$.querySelectorAll("body").append(t)),t}().append(a)),a}}));
define("MsPortalImpl/Weave/SandboxDomAgents/Button",["require","exports","MsPortalImpl/Base/Base.Selectable2","MsPortalImpl/UI/UI.LinkHandler","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Widgets/Widgets.Common"],(function(e,t,o,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.attachDomAgent=void 0;MsPortalFx.Base.Diagnostics;t.attachDomAgent=function(t,l,c,d){const p=$(t).parent(),g=i+s++,u=(0,o.getFxClickSelectable)(c,l,p,i,g);let m,k=(e,t,o)=>!0,b="";ko.reactor(l,(()=>{m&&m.dispose(),m=l.createChildLifetime();const t=ko.unwrap(d.onClick);if(b=t&&t.telemetryName||"",!ko.unwrap(d.aggregatedDisabled)&&t){const o=p.find(".fxs-button");ko.ignoreDependencies((()=>{let i;if("function"==typeof t){const o=t;i=t=>{t.stopPropagation(),Q.isPromiseAlike(o)&&(0,r.logToExtension)(e,p,2,FxImpl.createError("SimpleButton binding argument is not a callback function. The click handler is "+o)),u.invokeClick(void 0,o,t)}}else i=t;(0,a.isLink)(t)?o.attr("role","link"):o.attr("role","button");const s=(0,n.getUriAndHandler)(m,c,i,!0);s.errorMessage.subscribeAndRun(m,(t=>{t&&(0,r.logToExtension)(e,p,1,FxImpl.createError(`SimpleButton failure: ${MsPortalFx.getLogFriendlyMessage(t)}`))})),s.uri.subscribeAndRun(l,(e=>{d.selfDisabled(!e)})),k=s.handler}))}}));const f=t=>{if(t.stopPropagation(),t.preventDefault(),!ko.unwrap(d.aggregatedDisabled))try{k(t,u,b)}catch(t){(0,r.logToExtension)(e,p,2,FxImpl.createError("Button control failed to execute click handler",{innerErrors:t,data:{databind:$(p).attr("data-bind")}}))}};l.registerForDispose(p.setEvents(["click",f],["keydown",e=>{13!==e.keyCode&&32!==e.keyCode||(f(e),32===e.keyCode&&(e.preventDefault(),e.stopPropagation()))}]))};const i="simplebutton";let s=0}));
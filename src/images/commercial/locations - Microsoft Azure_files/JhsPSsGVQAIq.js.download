define("MsPortalImpl/Base/Base.Selectable2.SupplyBladeReference",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Base.Pipeline","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.Selectable2.Common"],(function(e,r,a,s,t,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.SupplyBladeReferenceHandler=void 0;MsPortalFx.Base.Diagnostics;var l=MsPortalFx.Errors;let o=class{constructor(e){this._resources=e}async fetchRequest(r,a){const s=this._resources.selectable;try{const r=await this._resources.extensionVm.fetchRequest(a.operationId);a.bladeRequest=r;const n=r.bladeReference;if(MsPortalFx.isNullOrUndefined(n))throw new l.Error("No blade reference is supplied.");s.referenceOverride&&(s.referenceOverride.bladeName===n.bladeName&&s.referenceOverride.extensionName===n.extensionName||(0,t.logToExtension)(e,d(this._resources.extensionVm),2,`The blade reference '${s.referenceOverride.extensionName}/${s.referenceOverride.bladeName}' provided to the menu blade does not match the blade reference '${n.extensionName}/${n.bladeName}' returned from supplyBladeReference.`),a.bladeRequest.bladeReference=s.referenceOverride,s.referenceOverride=null),a.bladeRequest.bladeReference.parameters=ko.toJS(a.bladeRequest.bladeReference.parameters)}catch(a){const n=l.Error.isBaseOf(a)?a:void 0;if(s.isDisposed()||n&&0===n.errorLevel);else{const r=`supplyBladeReference failed.\r\n ${MsPortalFx.getLogFriendlyMessage(a)}`;(0,t.logToExtension)(e,d(this._resources.extensionVm,n),2,r)}r.indicateTaskComplete()}}};function d(e,r){const a=FxImpl.Po.getMetadataId(e);return r&&r.extension||a&&a.split("-")[0]}__decorate([__metadata("fx:diagnostics",[e,"SupplyBladeReferenceHandler.prototype"]),s.Step(1),__metadata("design:type",Function),__metadata("design:paramtypes",[s.Task,n.OpenBladeTaskArgs]),__metadata("design:returntype",Promise)],o.prototype,"fetchRequest",null),o=__decorate([__metadata("fx:diagnostics",[e,"SupplyBladeReferenceHandler"]),a.Class("pipeline"),__metadata("design:paramtypes",[n.OpenBladeResources])],o),r.SupplyBladeReferenceHandler=o}));
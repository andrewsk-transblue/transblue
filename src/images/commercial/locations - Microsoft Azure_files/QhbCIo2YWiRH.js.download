define("MsPortalImpl/Controls/Controls.Essentials.Component",["require","exports","Weave/DirectMode","Weave","MsPortalImpl/Resources/ImplScriptResources","_generated/MsPortalImpl/Svg/Library/Loading/EllipsisSquare.svg","MsPortalImpl/Base/Base.KnockoutExtensions.Copy","FxInternal/Weave/Util","MsPortalImpl/Weave/Util","FxInternal/Weave","MsPortalImpl/Weave/LazyControls","MsPortalImpl/Weave/Components"],(function(e,t,s,a,i,n,o,l,r,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EssentialsInner=t.widgetInvisibleClass=t.widgetEditTagClass=t.fxPrimaryTextClass=t.portalTextClass=t.widgetItemLabelSplitterClass=t.widgetViewAllButtonClass=t.widgetItemValueIconClass=t.widgetItemValueClass=t.widgetItemValueContainerHasIconClass=t.widgetItemValueContainerClass=t.widgetItemValueWrapperClass=t.widgetLabelClass=t.widgetItemItemValueContainerRightClass=t.widgetItemItemValueContainerLeftClass=t.widgetItemItemValueContainerClass=t.widgetLabelContainerRightClass=t.widgetLabelContainerLeftClass=t.widgetLabelContainerClass=t.widgetItemEmptyClass=t.widgetItemLoadingClass=t.widgetItemClass=t.widgetColumnContainerClass=t.widgetColumnClass=t.widgetCollapseButtonClass=t.widgetExpandButtonClass=t.widgetAccordionButtonClass=void 0,t.widgetAccordionButtonClass="fxc-essentials-accordion-toggle",t.widgetExpandButtonClass="fxc-essentials-expand-button",t.widgetCollapseButtonClass="fxc-essentials-collapse-button",t.widgetColumnClass="fxc-essentials-column",t.widgetColumnContainerClass="fxc-essentials-column-container",t.widgetItemClass="fxc-essentials-item",t.widgetItemLoadingClass="fxc-essentials-item-loading",t.widgetItemEmptyClass="fxc-essentials-item-empty",t.widgetLabelContainerClass="fxc-essentials-label-container",t.widgetLabelContainerLeftClass="fxc-essentials-label-container-left",t.widgetLabelContainerRightClass="fxc-essentials-label-container-right",t.widgetItemItemValueContainerClass="fxc-essentials-item-value-container",t.widgetItemItemValueContainerLeftClass="fxc-essentials-item-value-container-left",t.widgetItemItemValueContainerRightClass="fxc-essentials-item-value-container-right",t.widgetLabelClass="fxc-essentials-label",t.widgetItemValueWrapperClass="fxc-essentials-value-wrapper",t.widgetItemValueContainerClass="fxc-essentials-value-container",t.widgetItemValueContainerHasIconClass="fxc-essentials-value-container-has-icon",t.widgetItemValueClass="fxc-essentials-value",t.widgetItemValueIconClass="fxc-essentials-value-icon",t.widgetViewAllButtonClass="fxc-essentials-viewall-button",t.widgetItemLabelSplitterClass="fxc-essentials-item-label-splitter",t.portalTextClass="fxs-portal-text",t.fxPrimaryTextClass="msportalfx-text-primary",t.widgetEditTagClass="fxc-essentials-edittag",t.widgetInvisibleClass="fxs-display-none";const p=i.Controls.Essentials;let m=0;const h=()=>"_essentials_"+m++;function g(e,i,n,o,r){const d=h(),u=h(),p=i.lines;return s(a.If,{condition:(0,c.toComputation)(i.visible,l.trueComputation),concealmentBehavior:"remove",trueFn:()=>s("div",{className:t.widgetItemClass,"aria-labelledby":d,"data-side":e},s("div",{className:[t.widgetLabelContainerClass,"left"===e?t.widgetLabelContainerLeftClass:t.widgetLabelContainerRightClass]},s("label",{className:[t.widgetLabelClass,"fxs-portal-subtext"],id:d,title:i.label},i.label),i.movableLabelExists?s("span",{role:"presentation",className:"fxc-essentials-move"},"(",s("button",{role:"link",className:[t.fxPrimaryTextClass,"fxc-essentials-move-button",{"fxc-disabled":n.disabled}],fxclick:i.movableOnClick,id:u,"aria-labelledby":[d,u].join(" "),"aria-disabled":n.disabled,tabindex:n.tabIndex},i.movableLabel),")"):null),s("div",{className:[t.widgetItemLabelSplitterClass,{[t.widgetInvisibleClass]:r}]},":"),s("div",{className:t.widgetItemValueWrapperClass},p?p.map((t=>x(o,t,n,e,d,i.label))):x(o,i,n,e,d,i.label)))})}function x(e,i,l,r,d,u){const p=(0,c.toComputation)(i.icon),m=(0,a.composeComputation)([p],(e=>e&&e.image)),g=(0,a.composeComputation)([p],(e=>e&&e.position)),x=(0,c.toComputation)(i.loading),C=(0,c.toComputation)(i.valueExists);return s("div",{className:[t.widgetItemItemValueContainerClass,"left"===r?t.widgetItemItemValueContainerLeftClass:t.widgetItemItemValueContainerRightClass,{[t.widgetItemValueContainerHasIconClass]:m}]},s(a.If,{condition:(0,c.toComputation)(i.loading),concealmentBehavior:"remove",trueFn:()=>s("div",{className:[t.widgetItemLoadingClass,t.portalTextClass],image:n})}),s(a.If,{condition:(0,a.composeComputation)([x,C],((e,t)=>!e&&!t)),concealmentBehavior:"remove",trueFn:()=>s("div",{className:[t.widgetItemEmptyClass,t.widgetItemValueClass,t.portalTextClass],"aria-label":'"---"',"aria-describedby":e.descId},"---")}),s("div",{className:[t.widgetItemValueContainerClass,{[t.widgetInvisibleClass]:(0,a.composeComputation)([x,C],((e,t)=>e||!t))}]},f(g,m,0),function(e,i,n,l,r){const d=h(),u=(t,s)=>{const i=s.createChildLifetime();(0,a.subscribeAndRun)(i,[(0,c.toComputation)(e.loading),(0,c.toComputation)(e.valueExists)],((a,n)=>{if(!a&&n){const a=e.value;(0,o.initializeCopyBinding)(t.parentElement,a,{hideTextbox:!0,ariaLabel:ko.computed(s,a,(e=>r+" "+e))},s),i.dispose()}}))},p=(0,c.toComputation)(e.value);switch(e.type){case 4:case 5:return s("a",{className:[b,{"fxc-disabled":n.disabled}],fxclick:e.onClick,id:d,"aria-labelledby":d,"aria-disabled":n.disabled,tabindex:n.tabIndex,"aria-describedby":l,title:p,afterMount:u},p);case 3:return s("button",{className:[b,{"fxc-disabled":n.disabled},{"fxs-essentials-item-disabled-button":n.disabled}],fxclick:e.onClick,id:d,"aria-labelledby":d,"aria-disabled":n.disabled,tabindex:n.tabIndex,"aria-describedby":l,title:p,afterMount:u},p);case 2:return s("a",{className:[b,{"fxc-disabled":n.disabled}],href:"#",fxclick:e.onClick,id:d,"aria-labelledby":d,"aria-disabled":n.disabled,tabindex:n.tabIndex,"aria-describedby":l,title:p,afterMount:u},p);case 1:return s("div",{className:[t.widgetItemValueClass,t.portalTextClass,{"fxc-disabled":n.disabled}],"aria-label":p,"aria-describedby":l,title:p,afterMount:u},p);default:return null}}(i,0,l,d,u),f(g,m,1)))}t.EssentialsInner=i=>{const{vm:o,state:m}=i,x=(0,c.toComputation)(o.expanded),b=x.compose(l.negation),f=m.spreadOutLayout.compose(l.negation);return s(a.GetContext,{fn:i=>{const C=(0,r.aggregateContext)(i,o,m),{disabled:v,tabIndex:I}=C;return s(a.SetContext,{disabled:v,tabIndex:I},s("div",{className:"fxc-essentials-container fxs-portal-border"},s("div",{className:["fxc-essentials-accordion","fxs-portal-hover"]},s("button",{title:p.Label.collapse,"aria-label":p.essentials,"aria-controls":m.controlId,className:[t.widgetExpandButtonClass,"fxs-portal-hover",t.widgetAccordionButtonClass],"aria-disabled":v,disabled:v,tabindex:I,"aria-expanded":x},s("div",{className:["fxc-essentials-expand-icon","fxs-portal-svg",{"fxt-essentials-expand-svg":x,"fxt-essentials-collapse-svg":b}]},s(u.ShellHtml,{content:m.collapseIcon.data,skipSanitization:!0,require:e})),s("div",{className:["fxs-portal-text","fxc-essentials-accordion-text"]},p.essentials)),s("div",{className:"fxc-essentials-cost-and-json"},MsPortalFx.isFeatureEnabled("essentialscostview")?s("a",{href:"#",className:["fxs-portal-border","fxc-essentials-costview-text"]},p.costInformation):null,MsPortalFx.isFeatureEnabled("essentialsjsonview")?s("a",{href:"#",className:["fxc-essentials-jsonview-text"]},p.resourceInformation):null)),s("div",{id:m.controlId,className:[t.widgetColumnContainerClass,{[t.widgetInvisibleClass]:b}],"aria-label":p.listProps},s("div",{id:m.descId,"aria-hidden":"true",className:"fxs-hide-accessible-label"},window.navigator.platform.indexOf("Mac")>=0?p.Copy.mac:p.Copy.win),s("div",{"aria-live":"polite","aria-atomic":"true",className:"fxs-hide-accessible-label"},m.copyTextAriaLive),s("div",{className:t.widgetColumnClass,"data-side":"left"},s(a.ForEach,{collection:m.leftItems,fn:({item:e})=>g("left",e,C,m,f)})),s("div",{className:t.widgetColumnClass,"data-side":"right"},s(a.ForEach,{collection:m.rightItems,fn:({item:e})=>g("right",e,C,m,f)}))),s(a.If,{condition:m.showTags,concealmentBehavior:"remove",trueFn:()=>s("div",{className:["fxc-essentials-tags-container",{[t.widgetInvisibleClass]:b}]},function(e,i,o,r){const u=e.options,m=u.hiddenChangeLink&&~u.hiddenChangeLink.indexOf(6),g=h(),x=h();return s("div",{className:t.widgetItemClass,tabindex:"-1"},s("div",{className:[t.widgetLabelContainerClass,t.widgetLabelContainerLeftClass]},s("label",{className:[t.widgetLabelClass,"fxs-portal-subtext"],id:g},p.tags),m?null:s("span",{role:"presentation",className:"fxc-essentials-move"},"(",s("button",{role:"link",className:[t.fxPrimaryTextClass,t.widgetEditTagClass,{"fxc-disabled":o.disabled}],id:x,"aria-labelledby":[g,x].join(" "),"aria-disabled":o.disabled,tabindex:o.tabIndex},p.editTags),")")),s("div",{className:[t.widgetItemLabelSplitterClass,{[t.widgetInvisibleClass]:r}]},":"),s("div",{className:[t.widgetItemLoadingClass,t.portalTextClass,{[t.widgetInvisibleClass]:(0,c.toComputation)(i.fetchingResourceData).compose(l.negation)}],image:n}),s(a.If,{condition:i.noTags,concealmentBehavior:"remove",trueFn:()=>s("button",{className:[t.fxPrimaryTextClass,"fxc-essentials-notags-button",t.widgetEditTagClass,{[t.widgetInvisibleClass]:(0,c.toComputation)(i.fetchingResourceData),"fxc-disabled":o.disabled}],"aria-disabled":o.disabled,tabindex:o.tabIndex},p.noTagsLabel),falseFn:()=>s(d.LazyPillCollection,{className:["fxc-essentials-tags-list",{[t.widgetInvisibleClass]:(0,c.toComputation)(i.fetchingResourceData)}],vm:i.tagsPillList})}))}(o,m,C,f))}),s("div",{className:["fxc-essentials-viewall-button-container",{[t.widgetInvisibleClass]:(0,a.composeComputation)([x,m.showViewAllButton],((e,t)=>!e||!t))}]},s("button",{className:["msportalfx-text-primary",t.widgetViewAllButtonClass,{"fxc-disabled":v}],role:"button","aria-controls":m.controlId,"aria-disabled":v,"aria-expanded":m.viewAll,tabindex:I},m.viewAllSwitchText))))}})};const b=[t.fxPrimaryTextClass,t.widgetItemValueClass,t.portalTextClass];function f(e,i,n){const o=0===n||3===n,l=`${t.widgetItemValueIconClass} ${t.widgetItemValueIconClass}-${o?"left":"right"}`;return s(a.If,{condition:(0,a.composeComputation)([e,i],((e,t)=>t&&e===n)),concealmentBehavior:"remove",trueFn:()=>s("span",{className:l,image:i})})}})),
define("_generated/Less/MsPortalImpl/Controls/Controls.Essentials.css",["module"],(function(e){"use strict";return{css:'.fxc-essentials{flex:0 0 auto}.fxc-essentials .fxc-disabled{pointer-events:none;cursor:default}.fxc-essentials .msportalfx-text-primary{padding:0;border:0;cursor:pointer}.fxc-essentials-cost-and-json{display:flex;flex-direction:row}.fxs-highcontrast-light button:focus .msportalfx-svg-c05{fill:white}.fxs-highcontrast-dark button:focus .msportalfx-svg-c05{fill:black}.fxc-essentials-jsonview-text,.fxc-essentials-costview-text{margin-left:auto;white-space:nowrap;padding-left:10px;cursor:pointer}.fxc-essentials-jsonview-text{padding-right:10px}.fxc-essentials-costview-text::after{content:"";height:16px;width:1px;padding-left:10px;border-right-style:solid;border-right-width:1px;border-right-color:inherit}.fxc-essentials-container{position:relative}.fxc-essentials-container::after{content:"";display:block;margin-left:20px;margin-right:20px;border-bottom-style:solid;border-bottom-width:1px;border-bottom-color:inherit}.fxc-essentials-border{padding-top:22px;border-bottom-width:1px;border-bottom-style:solid;margin:0 20px}.fxc-essentials-accordion{height:28px;line-height:28px;box-sizing:border-box;margin:0 20px;display:flex;flex-direction:row}.fxc-essentials-accordion-text{float:left;margin-left:5px;margin-right:auto}.fxc-essentials-expand-icon{display:grid;width:8px;height:8px;padding:5px}.fxt-essentials-expand-svg{transform:rotate(-90deg)}.fxt-essentials-collapse-svg{transform:rotate(90deg)}.fxc-essentials-expand-button{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;width:100%;height:100%;background:transparent;border:0;padding:0;margin:0;display:flex;align-items:center;font-size:13px;font-weight:600}.fxc-essentials-collapse-button{cursor:pointer;width:calc(100% - 40px);height:28px;border:0;padding:0;margin:0 20px;display:block;position:absolute;bottom:1px;left:0;right:0}.fxc-essentials-column-container{padding-top:4px;width:100%}.fxc-essentials-column-container::after{content:" ";clear:both;display:block}.fxc-essentials-column{box-sizing:border-box;float:left;width:50%}.fxc-essentials-column[data-side="left"] .fxc-essentials-item,.fxc-essentials-column[data-side="right"] .fxc-essentials-item{clear:both}.fxc-essentials-item{box-sizing:border-box;padding:4px 10px;margin:0 10px}.fxc-essentials-item .msportalfx-text-primary{text-decoration:underline}.fxc-essentials-item .fxc-copyablelabel-textbox .azc-input{font-size:13px;height:18px;line-height:18px}.fxc-essentials-item .fxs-copyfield-wrapper{height:100%}.fxc-essentials-item-loading{display:inline-block;width:18px;height:18px}.fxc-essentials-label-container .msportalfx-text-primary{display:inline;font-size:inherit;overflow:hidden;text-overflow:ellipsis}.fxc-essentials-label{font-size:13px;line-height:18px;text-overflow:ellipsis;overflow:hidden}.fxc-essentials-move{display:inline-block;margin-left:4px;font-size:13px;line-height:18px}.fxc-essentials-move-button{line-height:18px}.fxc-essentials-item-value-container{height:18px;padding-top:4px}.fxc-essentials-item-value-container:first-child{padding-top:0}.fxc-essentials-value-container{position:relative;height:18px;padding-right:25px;display:inline-flex;max-width:100%;box-sizing:border-box}.fxc-essentials-value-container.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield{width:24px}.fxc-essentials-value{white-space:nowrap;overflow:hidden;font-size:13px;height:18px;line-height:18px;display:inline-block;text-overflow:ellipsis;text-align:left;max-width:100%}.fxc-essentials-value-icon{display:inline-block;width:18px;height:18px}.fxc-essentials-value-icon-left{margin-right:4px}.fxc-essentials-value-icon-right{margin-left:4px}.fxc-essentials-notags-button{height:18px;white-space:nowrap}.fxc-essentials-tags-container{padding-top:5px}.fxc-essentials-tags-list{margin-top:2px;margin-left:-5px;width:auto;flex:1 0 auto}.fxc-essentials-viewall-button-container{clear:both;float:none;height:20px;padding:10px 10px 0 10px;margin:0 10px}.fxc-essentials-viewall-button{font-size:13px}.fxc-essentials-viewall-button:hover{text-decoration:underline}.fxc-essentials-spread-out .fxc-essentials-item{display:flex;padding:5px 15px}.fxc-essentials-spread-out .fxc-essentials-label-container{flex:0 0 auto;white-space:nowrap;text-overflow:ellipsis;display:inline-flex;overflow:hidden}.fxc-essentials-spread-out .fxc-essentials-item-label-splitter{flex:0 0 15px;text-align:center}.fxc-essentials-spread-out .fxc-essentials-value-wrapper{flex:1 0 auto;max-width:100%}.fxc-essentials-spread-out .fxc-essentials-viewall-button-container{padding:10px 15px 0}.fxc-essentials-spread-out .fxc-essentials-tags-list{margin-top:0}.fxc-essentials-spread-out .fxc-essentials-tags-container .fxc-essentials-label-container,.fxc-essentials-spread-out .fxc-essentials-tags-container .fxc-essentials-item-label-splitter,.fxc-essentials-spread-out .fxc-essentials-tags-container .fxc-essentials-notags-button{margin-top:5px}.fxc-essentials-spread-out .fxc-essentials-tags-container .fxc-essentials-item{padding-top:0}',moduleId:e.id}})),
define("_generated/MsPortalImpl/Svg/Library/Controls/Chevron.svg",["require","exports"],(function(e,t){"use strict";return{type:1,data:"<svg viewBox='0 0 11 17' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M2.414 17 1 15.586l7.071-7.071L1 1.443 2.414.029l8.485 8.486z' class='msportalfx-svg-c05'/></g></svg>"}})),
define("MsPortalImpl/Controls/Controls.Essentials",["require","exports","Fx/Controls/Pill","Fx/Controls/PillCollection","Fx/ResourceManagement","MsPortalImpl.Controls/Controls/Base/ViewModelBase","MsPortalImpl.Controls/Controls/ResourceFilterHelper","FxInternal/Controls/Essentials","Viva.Controls/Util/Viva.Resize","MsPortalImpl/Base/Base.FeatureDetection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.ArmIdHelpers","_generated/MsPortalImpl/Svg/Library/Controls/Chevron.svg","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/Services/Services.ProjectedDirectories","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl.Controls/Controls/Base/Base","MsPortalImpl/Controls/Controls.Essentials.Component","Weave/Core/Computation","FxInternal/Css","_generated/Less/MsPortalImpl/Controls/Controls.Essentials.css","MsPortalImpl/Base/Base.Selectable2","FxInternal/Weave","Weave","Fx","Fx/Composition/Selectable","MsPortalImpl/Base/Base.KnockoutExtensions.Copy"],(function(e,t,s,a,i,n,o,l,r,c,d,u,p,m,h,g,x,b,f,C,v,I,w,y,k,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.WidgetUIState=t.InnerTsxComponent=void 0,(0,C.injectCss)(v);var _=MsPortalFx.Base,E=_.Diagnostics.Telemetry.Context;const P=window,D=1007,B=155,T=105,N="fxc-essentials",M="fxc-essentials-spread-out",R=d.Controls.Essentials,F=d.ResourceFilter.Directory.unknownText,O=new _.Diagnostics.Log("MsPortalImpl/Controls/Controls.Essentials");const A=(0,k.memoizePromise)((e=>(0,o.getLocations)().then((t=>{const s=(e.location||"").toLowerCase();return(MsPortalFx.find(t,(e=>e.name.toLowerCase()===s))||{}).displayName||e.location}))));t.InnerTsxComponent=b.EssentialsInner;class S extends x.WidgetUIState{constructor(e){super(),this.collapseIcon=_.Images.CustomImageWithOptions(p,{}),this.viewAll=(0,y.makeWritableComputation)(!1),this.viewAllSwitchText=this.viewAll.compose((e=>e?R.seeLess:R.seeMore)),this.showTags=(0,y.makeWritableComputation)(!1),this.copyTextAriaLive=(0,y.makeWritableComputation)(""),this.showViewAllButton=(0,y.makeWritableComputation)(!1),this.leftItems=(0,y.makeWritableComputation)(),this.rightItems=(0,y.makeWritableComputation)(),this.noTags=(0,y.makeWritableComputation)(!0),this.fetchingResourceData=ko.observable(!1),this.spreadOutLayout=(0,y.makeWritableComputation)(!1),this.controlId=(0,k.getUniqueId)(),this.descId=`${this.controlId}-desc`;const t=e.vm.options;if(t.resourceId){this.tagsPillList=a.create(this._ltm,{multipleRows:!1,theme:2,ariaLabel:R.tags,items:[]});const e=t.hiddenBuiltInTypes&&t.hiddenBuiltInTypes.indexOf(6)>=0;this.showTags(t.includeTags&&!e)}}}function V(e,t,s,a){_.Diagnostics.Telemetry.trace({source:"Essentials",action:e,name:t,data:s,actionModifier:a})}t.WidgetUIState=S;class W extends n.Widget{constructor(e,t,s,a){super(e,t,s,a),this._staticItems={left:[],right:[]},this._events=[],this._lastKnownContainerWidth=0,this._armData={resourceGroup:{value:ko.observable(null),movableOnClick:ko.observable(MsPortalFx.noop),onClick:{resourceId:ko.observable(null),onLinkOpened:()=>{V("EssentialsClick","ResourceGroup",{bladeInstance:this._bladeInstanceId(),resourceId:this.vm.options.resourceId||""})}}},status:{value:ko.observable(null)},location:{value:ko.observable(null),movableOnClick:ko.observable(MsPortalFx.noop)},subscriptionName:{value:ko.observable(null),movableOnClick:ko.observable(MsPortalFx.noop),onClick:{resourceId:ko.observable(null),onLinkOpened:()=>{V("EssentialsClick","Subscription",{bladeInstance:this._bladeInstanceId(),resourceId:this.vm.options.resourceId||""})}}},subscriptionId:{value:ko.observable(null)},directoryName:{value:ko.observable(null)},directoryId:{value:ko.observable(null)}},this._showTenantInfo=ko.observable(!1),this._bladeInstanceId=ko.observable(""),a=this.state;const i=this.vm,n=i.options,o=(0,k.isFeatureEnabled)("essentialsjsonview")?this.element.findByClassName("fxc-essentials-jsonview-text").get(0):null,l=(0,k.isFeatureEnabled)("essentialscostview")?this.element.findByClassName("fxc-essentials-costview-text").get(0):null,r=n.resourceId;if(this._bladeInstanceId(E.getBladeContext()?E.getBladeContext().instanceId:null),r){let t;if(this._processAndRender(),(0,k.isFeatureEnabled)("msptitle")){const{diContainer:e}=s;t=Q(_.Promises.cancelOnDispose(this.ltm,Q.all([e.getAsync(h.ServicesProjectedDirectories).then((e=>e.getDirectoryByResourceId(r))),e.getAsync(m.AuthStateManager).then((e=>e.getUserInfo()))]).then((([e,t])=>{if(!e||e.id!==t.directoryId)return this._showTenantInfo(!0),e?{directoryName:e.displayName,directoryId:e.id}:{directoryId:""}}))))}i.resource.subscribeAndRun(this.ltm,(n=>{a.fetchingResourceData(!0);const c=(n?this._getResourceInfo(n):Q(null)).then((e=>e||i.options.skipResourceFetching?e:i.getResourceInfo(a.showTags.value))),d=Q.all([c,t||Q(null)]).spread(((e,t)=>e&&t?MsPortalFx.extend(e,t):e)).then((e=>{this.resourceData=e,a.fetchingResourceData(!1),this._processItems(),this._processTags(),_.Promises.cancelOnDispose(this.ltm,d)}));if((0,k.isFeatureEnabled)("essentialsjsonview")){const t=new L.PdlBladeReference("EssentialsResourceBlade","HubsExtension",{parameters:{resourceId:r}}),a=(0,I.getFxClickSelectable)(s.diContainer,this.ltm,e,"fxClick","fxClickID");$(o).on("click",(e=>{e.preventDefault(),e.stopPropagation(),V("EssentialsClick","Json",{bladeInstance:this._bladeInstanceId(),resourceId:this.vm.options.resourceId||"",accordionState:this.vm.expanded()?"Expanded":"Collapsed"}),a.openContextPane(t),a.invokeClick(this.vm,(()=>{}),e)}))}if((0,k.isFeatureEnabled)("essentialscostview")){const t=new L.PdlBladeReference("CostAnalysis","Microsoft_Azure_CostManagement",{parameters:{scope:r}});$(l).on("click",(a=>{if(a.preventDefault(),a.stopPropagation(),V("EssentialsClick","Cost",{bladeInstance:this._bladeInstanceId(),resourceId:this.vm.options.resourceId||"",accordionState:this.vm.expanded()?"Expanded":"Collapsed"}),i.containerHasMenu&&(0,k.isFeatureEnabled)("essentialscostinmenuview"))i.openBladeInMenuContext(t);else{const i=(0,I.getFxClickSelectable)(s.diContainer,this.ltm,e,"fxClick","fxClickID");i.openBlade(t),i.invokeClick(this.vm,(()=>{}),a)}}))}i.newTags.subscribe(this.ltm,(e=>{this._processTags(e)}))}))}else(0,k.isFeatureEnabled)("essentialsjsonview")&&(o.style.display="none"),(0,k.isFeatureEnabled)("essentialscostview")&&(l.style.display="none"),this._processAndRender()}toggleColumnContainerVisibility(){this.element.findByClassName(b.widgetColumnContainerClass).toggleClass(b.widgetInvisibleClass)}_getColumnLabelMaxWidth(e){const t=this.element.find(`.${b.widgetColumnClass}[data-side='${e}']`);let s=!1;this.element.findByClassName(b.widgetColumnContainerClass).hasClass(b.widgetInvisibleClass)&&(s=!0,this.toggleColumnContainerVisibility());const a=t.findByClassName(b.widgetLabelContainerClass);let i=0;return a.each((function(e,t){const s=$(t).children();let a=s[0].getBoundingClientRect().width;s.length>1&&(a+=s[1].getBoundingClientRect().width+4),a=Math.ceil(a),a>i&&(i=a)})),s&&this.toggleColumnContainerVisibility(),i>=B?B:i}_spreadLayoutProcess(e){let t;t=e||this.element[0].getBoundingClientRect().width;const s=this.state;t-=(0,c.getScrollbarWidth)(),this._lastKnownContainerWidth=t;const a=t/2,i=this.element.findByClassName(b.widgetLabelContainerLeftClass),n=this.element.findByClassName(b.widgetLabelContainerRightClass),o=this.element.findByClassName(b.widgetItemItemValueContainerLeftClass),l=this.element.findByClassName(b.widgetItemItemValueContainerRightClass),r=this.element.findByClassName(b.widgetColumnContainerClass),d=this.element.findByClassName("fxc-essentials-column"),u=this.element.findByClassName("fxc-essentials-tags-container"),p=this.element.findByClassName("fxc-essentials-tags-list");if(d.css("width","50%"),t>=D){r.css("display","block"),i.css("width","100%"),n.css("width","100%"),o.css("width","100%"),l.css("width","100%");const e=this._getColumnLabelMaxWidth("left"),t=this._getColumnLabelMaxWidth("right"),c=T/2,d=Math.floor(a-e-c),u=Math.floor(a-t-c);this.element.addClass(M),i.css("width",`${e}px`),n.css("width",`${t}px`),o.css("width",`${d}px`),l.css("width",`${u}px`),s.spreadOutLayout(!0)}else this.element.removeClass(M),r.css("display","block"),i.css("width","100%"),n.css("width","100%"),o.css("width","100%"),l.css("width","100%"),s.spreadOutLayout(!1),t<623&&(r.css("display","flex"),r.css("flex-direction","column"),t>=463?(this.element.addClass(M),s.spreadOutLayout(!0),u.css("width","50%")):d.css("width","100%"));p.width(o.width())}itemTypeDetector(e){const t=ko.unwrap(e.onClick),s=typeof t;if("function"===s)return 3;if("object"===s){if(t.hasOwnProperty("uri"))return 2;if(t.hasOwnProperty("bladeReference"))return 4;if(t.hasOwnProperty("resourceId"))return 5}return 1}dispose(){this._checkExistsOrRegisterDestroyId(super.dispose)||(this._cleanElement(N),super.dispose())}_getResourceInfo(e){const t=i.ArmId.parse(e.id,!0);return(0,u.isResourceAtAnyLevel)(t)?A(e).then((s=>{e.extendedLocation&&(s=R.extendedLocationFormatString.format(e.extendedLocation.name,s));return(t.subscription?Q(MsPortalFx.Azure.getSubscriptionInfo(t.subscription)):Q(null)).then((a=>({resourceGroupName:t.resourceGroup,resourceGroupId:i.ArmId.stringify(t,4),subscriptionName:a&&a.displayName,subscriptionId:a&&t.subscription,location:s,tags:this._userModifiedTags?this._userModifiedTags:(0,l.convertStringMapToTagInfoArray)(e.tags),zones:e.zones,moveOptions:{resourceGroup:!0,subscription:!0,location:!0}})))})):4===t.kind?A(e).then((s=>MsPortalFx.Azure.getSubscriptionInfo(t.subscription).then((a=>({resourceGroupName:t.resourceGroup,resourceGroupId:e.id,subscriptionName:a.displayName,subscriptionId:t.subscription,location:s,tags:this._userModifiedTags?this._userModifiedTags:(0,l.convertStringMapToTagInfoArray)(e.tags),moveOptions:{resourceGroup:!1,subscription:!0,location:!1}}))))):Q(null)}_createTagPill(e,t,a){return s.create(e,{showRemoveButton:!1,getKeyText:e=>e.key,getOperatorText:e=>":",getValueText:e=>e.value,ariaLabel:`${t} : ${a}`,value:{key:t,value:a},infoBalloonContent:{htmlTemplate:"<span data-bind='text:tagKey'></span><span> : </span><span data-bind='text:tagValue'></span>",viewModel:{tagKey:t,tagValue:a}},createEditor:()=>({onClick:()=>{const e={resourceId:this.vm.options.resourceId,key:t,value:a};_.Promises.cancelOnDispose(this.ltm,this.vm.openBlade(1,e))}})})}_getTagItems(){const e=[];return this.resourceData&&this.resourceData.tags&&this.resourceData.tags.forEach((t=>{(function(e){const t=(e||"").toLowerCase();return t.startsWith("hidden-")||t.startsWith("link:")})(t.key)||e.push(this._createTagPill(this.ltm,t.key,t.value))})),e}_processTags(e){if(e&&(this._userModifiedTags=e,this.resourceData.tags=e),this.state.showTags.value){const e=this._getTagItems();this.state.tagsPillList.items(e),this.state.noTags(!e.length)}}_throttleSpreadLayoutProcess(e){P.requestAnimationFrame((()=>{this._spreadLayoutProcess(e)}))}_processAndRender(){this._processItems(),this._processTags();const e=this.state,t=this.vm,s=(s,a)=>{!t.options.showAllItems&&s.length>5&&e.showViewAllButton(!0),t.options.showAllItems||a||s.length>5&&(s=s.splice(0,5));const i=s.map((e=>{const t=MsPortalFx.initObservable(e.value),s={value:t,icon:MsPortalFx.initObservable(e.icon),loading:MsPortalFx.initObservable(e.loading),valueExists:ko.computed(this.ltm,t,(e=>!MsPortalFx.isNullOrUndefined(e))),movableLabelExists:e.movableLabelExists||!1};return e.lines?(s.type=this.itemTypeDetector(e),s.lines=e.lines.map((e=>{const t=MsPortalFx.initObservable(e.value);return Object.assign(Object.assign({},e),{type:this.itemTypeDetector(e),icon:MsPortalFx.initObservable(e.icon),value:t,loading:MsPortalFx.initObservable(e.loading),valueExists:ko.computed(this.ltm,t,(e=>!MsPortalFx.isNullOrUndefined(e)))})}))):s.type=this.itemTypeDetector(e),Object.assign(Object.assign({},e),s)}));return s.length&&this._throttleSpreadLayoutProcess(),i};(0,y.subscribeAndRun)(this.ltm,[(0,w.toComputation)(t.dynamicLeftArray),e.viewAll],((t,a)=>{e.leftItems(s(this._staticItems.left.concat(t),a))})),(0,y.subscribeAndRun)(this.ltm,[(0,w.toComputation)(t.dynamicRightArray),e.viewAll],((t,a)=>{e.rightItems(s(this._staticItems.right.concat(t),a))})),this.element.addClass(N),this._assignEvents(),r.track(this.ltm,this.element,(e=>{this._lastKnownContainerWidth!==e&&this._spreadLayoutProcess(e),this._lastKnownContainerWidth=e}),{ignoreInitialState:!0})}_getResourceGroup(){const e=this.vm.options,t=e.hiddenChangeLink&&~e.hiddenChangeLink.indexOf(1),{value:s,movableOnClick:a,onClick:i}=this._armData.resourceGroup;if(this.resourceData){s(this.resourceData.resourceGroupName);a((()=>{if(V("EssentialsClick","ChangeResourceGroup",{bladeInstance:this._bladeInstanceId(),resourceId:this.vm.options.resourceId||""}),this.resourceData.moveOptions&&this.resourceData.moveOptions.resourceGroup){const t={resourceId:e.resourceId,moveType:1};_.Promises.cancelOnDispose(this.ltm,this.vm.openBlade(1,t))}})),i.resourceId(this.resourceData.resourceGroupId)}return{label:R.resourceGroup,value:s,movableLabel:t?"":R.move,movableLabelExists:!t,movableOnClick:a,onClick:i,loading:this.state.fetchingResourceData}}_getStatus(){const{value:e}=this._armData.status;return this.vm.status.subscribeAndRun(this.ltm,e),{label:R.status,value:e}}_getLocation(){const e=this.vm.options,t=!(0,k.isFeatureEnabled)("enablelocationchange")||!e.enableLocationChange||e.hiddenChangeLink&&~e.hiddenChangeLink.indexOf(3),{value:s,movableOnClick:a}=this._armData.location;if(this.resourceData){let t=this.resourceData.location;if(this.resourceData.zones){t+=` (${R.zoneFormatString.format(this.resourceData.zones.join(R.zoneDelimiterString+" "))})`}s(t);a((()=>{if(V("EssentialsClick","ChangeLocation",{bladeInstance:this._bladeInstanceId(),resourceId:this.vm.options.resourceId||""}),this.resourceData.moveOptions&&this.resourceData.moveOptions.location){const t={subscriptionId:this.resourceData.subscriptionId,resourceId:e.resourceId,sourceRegion:this.resourceData.location};_.Promises.cancelOnDispose(this.ltm,this.vm.openBlade(3,t))}}))}return{label:R.location,value:s,movableLabel:t?"":R.move,movableLabelExists:!t,movableOnClick:a,loading:this.state.fetchingResourceData}}_getSubscriptionName(){const e=this.vm.options,t=e.hiddenChangeLink&&~e.hiddenChangeLink.indexOf(4),{value:s,movableOnClick:a,onClick:i}=this._armData.subscriptionName;if(this.resourceData){s(this.resourceData.subscriptionName);a((()=>{if(V("EssentialsClick","ChangeSubscription",{bladeInstance:this._bladeInstanceId(),resourceId:this.vm.options.resourceId||""}),this.resourceData.moveOptions&&this.resourceData.moveOptions.subscription){const t={resourceId:e.resourceId,moveType:0};_.Promises.cancelOnDispose(this.ltm,this.vm.openBlade(4,t))}})),i.resourceId("/subscriptions/"+this.resourceData.subscriptionId)}return{label:R.subscription,value:s,movableLabel:t?"":R.move,movableLabelExists:!t,movableOnClick:a,onClick:i,loading:this.state.fetchingResourceData}}_getSubscriptionId(){const{value:e}=this._armData.subscriptionId;return this.resourceData&&e(this.resourceData.subscriptionId),{label:R.subscriptionId,value:e,loading:this.state.fetchingResourceData}}_getDirectoryName(){const{value:e}=this._armData.directoryName,t=this.resourceData;return t&&e(t.directoryName||t.directoryId||F),{label:R.directory,value:e,loading:this.state.fetchingResourceData,visible:this._showTenantInfo}}_getDirectoryId(){const{value:e}=this._armData.directoryId,t=this.resourceData;return t&&e(t.directoryId||F),{label:R.directoryId,value:e,loading:this.state.fetchingResourceData,visible:this._showTenantInfo}}_getItem(e){if("number"==typeof e)switch(e){case 1:return this._getResourceGroup();case 2:return this._getStatus();case 3:return this._getLocation();case 4:return this._getSubscriptionName();case 5:return this._getSubscriptionId();default:O.error("Unknown BuiltInType is used (Illegal Access)")}return e}_processItems(){let e=[],t=[];const s=this.vm.options,a=(0,k.isFeatureEnabled)("msptitle");switch(this.vm.optionType){case 1:{const i=[1,2,3,4,5];s.hiddenBuiltInTypes&&s.hiddenBuiltInTypes.forEach((e=>{const t=i.indexOf(e);t>-1&&i.splice(t,1)})),i.forEach((t=>{e.push(this._getItem(t))})),s.additionalLeft&&(e=e.concat(s.additionalLeft)),s.additionalRight&&(t=[...s.additionalRight]),a&&(e.unshift(this._getDirectoryName()),t.unshift(this._getDirectoryId()));break}case 2:a&&(e.push(this._getDirectoryName()),t.push(this._getDirectoryId())),s.left&&s.left.forEach((t=>{e.push(this._getItem(t))})),s.right&&s.right.forEach((e=>{t.push(this._getItem(e))}));break;case 3:s.left&&s.left.forEach((t=>{e.push(this._getItem(t))})),s.right&&s.right.forEach((e=>{t.push(this._getItem(e))}))}this._staticItems.left=e,this._staticItems.right=t}_assignEvents(){const e=e=>{const t=this.vm.expanded,s=this.vm.options.onExpanderClick,a=!t();t(a),V("EssentialsClick","ToggleExpander",{bladeInstance:this._bladeInstanceId(),resourceId:this.vm.options.resourceId||""},a?"Expanded":"Collapsed"),(0,f.invokeAfterChangePropagation)((()=>{const e=this.element.findByClassName(this.vm.expanded()?b.widgetCollapseButtonClass:b.widgetExpandButtonClass);document.activeElement!==e[0]&&e.focus()})),s&&s(a)};this.ltm.registerForDispose(this.element.setEvents(["click",`.${b.widgetCollapseButtonClass}`,e],["click",`.${b.widgetExpandButtonClass}`,e],["click",`.${b.widgetEditTagClass}`,e=>{V("EssentialsClick","ChangeTags",{bladeInstance:this._bladeInstanceId(),resourceId:this.vm.options.resourceId||""}),e.stopPropagation(),e.preventDefault();const t={resourceId:this.vm.options.resourceId,tag:void 0};this.vm.openBlade(6,t)}],["click",`.${b.widgetViewAllButtonClass}`,e=>{e.stopPropagation(),e.preventDefault(),this.state.viewAll(!this.state.viewAll.value)}])),this.ltm.registerForDispose(this.element.setEvents(["keyup",`.${b.widgetItemValueContainerClass} > .${b.widgetItemValueClass}`,e=>{if(g.isCtrlOrCommandOnly(e)&&67===e.keyCode){const t=e.target,s=P.document.createRange();s.selectNodeContents(t);const a=P.getSelection();a.removeAllRanges(),a.addRange(s),P.document.execCommand("copy"),t.focus(),this.state.copyTextAriaLive(`${a.toString()} ${R.copiedToClipboard}`)}}])),this.ltm.registerForDispose((()=>{this._events.forEach((e=>{e.element.off(e.event,e.handler)}))}))}}t.Widget=W}));
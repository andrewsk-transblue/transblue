define("MsPortalImpl.Controls/Controls/Base/WidgetBinding",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTabIndexProperty=t.chainEnabledTabIndexProperties=t.chainDisabledProperties=t.contextFor=t.createChainedContext=t.createChildContext=t.createIsolatedContext=t.getContext=void 0;var s=MsPortalFx.isUndefined;function i(e,t){let i;return s(e)||(i=ko.unwrap(e)),s(i)?t:i}function o(e,t){const s=d([e.$disabled,t.$disabled]),i=c([e.$enabledTabIndex,t.$enabledTabIndex]);return{$disabled:s,$enabledTabIndex:i,$tabIndex:p(i,s)}}function n(e){return ko.contextFor($(e)[0])}function r(e){return new ko.bindingContext(e)}function a(e,t,s,i){let o=i||n(e);return o=o?o.createChildContext(t):r(t),s&&(o=o.extend(s)),o}function l(e,t){const s=o(e,t);return e.extend(s)}function d(e){return ko.pureComputed((()=>{let t=!1;for(let s=0;s<e.length;s++){const o=i(e[s],!1);t=t||o}return t}))}function c(e){return ko.pureComputed((()=>{let t=0;for(let s=0;s<e.length;s++){const o=i(e[s],0);null===t||null===o?t=null:t<0||(t=o)}return t}))}function p(e,t){return ko.pureComputed((()=>t()?-1:e()))}t.getContext=n,t.createIsolatedContext=function(e,t){return r(e).extend({$dicontainer:t.$dicontainer,$disabled:t.$disabled,$enabledTabIndex:t.$enabledTabIndex,$extensionName:t.$extensionName,$partName:t.$partName,$tabIndex:t.$tabIndex})},t.createChildContext=a,t.createChainedContext=l,t.contextFor=function(e){let t=n(e);return t||(t=r(null)),s(t.$disabled)&&(t=t.extend({$disabled:ko.pureComputed(MsPortalFx.wrap(!1))})),s(t.$tabIndex)&&(t=t.extend({$tabIndex:ko.pureComputed(MsPortalFx.wrap(0))})),s(t.$enabledTabIndex)&&(t=t.extend({$enabledTabIndex:ko.pureComputed(MsPortalFx.wrap(0))})),t},t.chainDisabledProperties=d,t.chainEnabledTabIndexProperties=c,t.makeTabIndexProperty=p,ko.bindingHandlers.context={init:function(e,t,s,i,n){const r=t(),l=o(n,{$disabled:r.$disabled,$enabledTabIndex:r.$tabIndex});r.$dicontainer&&(l.$dicontainer=r.$dicontainer);const d=a(e,i,l,n);return ko.applyBindingsToDescendants(d,e),{controlsDescendantBindings:!0}}},ko.virtualElements.allowedBindings.context=!0;const u=ko.bindingHandlers.template;ko.bindingHandlers.template={init:function(e,t,s,i,o){return u.init(e,t,s,i,o)},update:function(e,t,s,i,o){const n=t();let r=ko.unwrap(n);r="string"==typeof r?{name:n}:ko.utils.extend({},r);let a=r.context;a&&(o=ko.ignoreDependencies((()=>("function"==typeof a&&(a=a(r.data||i)),l(o,{$disabled:a.$disabled,$enabledTabIndex:a.$tabIndex})))),delete r.context);const d=o.$ctl,c=d&&d.templateEngine;return c&&r.name&&!r.templateEngine&&(r.templateEngine=c),t=()=>r,u.update(e,t,s,i,o)}}})),
define("MsPortalImpl/Base/Base.ElementWidgetMap",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAll=t.getAllMatch=t.remove=t.set=void 0;const s=new WeakMap;t.set=function(e,t){if(e&&t){const i=s.get(e);i?i.push(t):s.set(e,[t])}},t.remove=function(e,t){if(e&&t){let i=s.get(e);i&&(i=i.filter((e=>e!==t)),i.length>0?s.set(e,i):s.delete(e))}},t.getAllMatch=function(e,t){if(e){const i=s.get(e);return i&&i.filter((e=>e instanceof t))}},t.getAll=function(e){const t=e&&s.get(e);return t&&t.slice()}})),
define("MsPortalImpl/UI/Compositions/UI.Composition",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBladeType=t.bladeImplementedWithVirtualPart=t.isContextMenuContainer=t.tryGetAssetType=t.deepSubset=t.isPartComposition=t.findCommand=t.getIdMatchFunc=t.CompositionType=t.fxreplacedpartcomposing=t.CompositionInstanceDataName=t.PartContainerModelIdProperty=t.EditScopeIdPropertyName=t.referenceTypeMap=void 0;var s=MsPortalFx.Base.Constants.BladeParameterNames;t.referenceTypeMap={},t.referenceTypeMap[0]="Part",t.referenceTypeMap[1]="BladeInput",t.referenceTypeMap[2]="BladeActionBar",t.referenceTypeMap[3]="BladeProperty",t.referenceTypeMap[4]="Command",t.referenceTypeMap[5]="Constant",t.referenceTypeMap[6]="SelectedItem",t.referenceTypeMap[7]="Adapter",t.referenceTypeMap[8]="Dashboard",t.referenceTypeMap[9]="AdapterInput",t.EditScopeIdPropertyName=s.EditScopeId,t.PartContainerModelIdProperty="##SnapshotContainerId##",t.CompositionInstanceDataName="MsPortalImplCompositionInstance",t.fxreplacedpartcomposing="fxreplacedpartcomposing",function(e){e[e.Unknown=0]="Unknown",e[e.Part=1]="Part",e[e.StartboardPart=2]="StartboardPart",e[e.Lens=3]="Lens",e[e.BladeActionBar=4]="BladeActionBar",e[e.Blade=5]="Blade",e[e.Journey=6]="Journey",e[e.Startboard=7]="Startboard"}(t.CompositionType||(t.CompositionType={})),t.getIdMatchFunc=function(e){return t=>t.id===e},t.findCommand=function(e,t,s){if(!e)throw new Error("Commands list is required.");if(!t)throw new Error("Command name is required.");if(!s)throw new Error("Command container name is required.");return MsPortalFx.find(e,(e=>e.commandName===t))},t.isPartComposition=function(e){const t=e.locator&&e.locator.type;return 5===t||6===t||7===t},t.deepSubset=function(e,t){return Object.keys(t).every((s=>e.hasOwnProperty(s)&&MsPortalFx.deepEquals(t[s],e[s])))},t.tryGetAssetType=function(e){const t=e&&e.assetTypeId;if("string"==typeof t)return t},t.isContextMenuContainer=function(e){const t=e;return t&&t.beforeActivateCommandMenuItems&&"function"==typeof t.beforeActivateCommandMenuItems};const i={1:!0,3:!0,4:!0,2:!0,5:!0,6:!0,7:!0};function o(e){let t;return t=12===e.style?4:e.templateBlade?1:e.frameBlade?2:e.menuBlade?3:16&e.attributes?6:8&e.attributes?5:e.tabMenuBlade?7:0,t}t.bladeImplementedWithVirtualPart=function(e){return!!i[o(e)]},t.getBladeType=o})),
define("MsPortalImpl/Services/Services.Tenants",["require","exports","FxHubs/ArmHelpers/ArmApisStartup","Fx/DependencyInjection","MsPortalImpl/Resources/ImplScriptResources","FxHubs/RpcEndPoints","Fx/Ajax","Fx","FxInternal/AsyncLoader"],(function(e,t,s,i,o,n,r,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEV=t.getHomeTenantsCountHandler=t.TenantsService=void 0;var d=MsPortalFx.Base,c=d.Diagnostics,p=c.Telemetry,u=d.Resources;const m="home",g=c.createLog(e),h="Services.Tenants",f={home:0,projectedby:0,managedby:0},x=(0,a.memoizePromise)((e=>{const t=p.startTrace({source:h,action:e});return Q((0,r.ajax)({uri:u.getAppRelativeUri("/api/directories/List"),type:"POST",dataType:"json",contentType:"application/json",performRetry:!0})).then((e=>(p.completeTrace(t,{tenantsCount:(e.tenants||[]).length,failure:e.failure}),e.tenants.forEach((e=>e.tenantCategory=e.tenantCategory||m)),e))).catch((e=>{throw p.cancelTrace(t),e}))})),b=(0,a.memoizePromise)((()=>{const e=p.start({source:h,action:"_getTenantsMemo"});return Q((0,r.batch)({uri:(0,s.listTenantsApi)(),setTelemetryHeader:"Services.Tenants.getTenants"}).then((t=>{const s=t.content.value||[];p.completeTrace(e,{tenantsCount:s.length});const i={failure:!1,tenants:[]},o={};return s.forEach((e=>{const t=e.displayName||"",s=e.domains||[],n=e.tenantId;let r=(e.tenantCategory||"").toLowerCase();r||(g.warning(`Tenant ${t}(${n}) received from ARM with missing tenantCategory. Treating it as 'Home' tenant.`),r=m);const a={displayName:t,domainName:e.defaultDomain||s[0]||"",id:n,tenantCategory:r};r.split(",").forEach((e=>{f[e]++})),(e.defaultDomain||1===s.length)&&t?i.tenants.push(a):o[n]=a})),p.trace({source:h,action:"tenantsInfo",data:{allTenantsCount:s.length,tenantsWithInfoCount:i.tenants.length,homeTenantsCount:f.home,projectedTenantsCount:f.projectedby,managedByTenantsCount:f.managedby}}),i.tenants.length!==s.length?x("GetTenantsFromArmFallback").then((e=>(e.tenants.forEach((e=>{const t=o[e.id];t&&(t.displayName=e.displayName||e.id,t.domainName=e.domainName||e.id)})),(0,a.forEachKey)(o,((e,t)=>{i.tenants.push(t)})),i))):i})).catch((t=>(p.cancelTrace(e,MsPortalFx.getLogFriendlyMessage(t)),MsPortalFx.Hubs.Notifications.ClientNotification.publish({title:o.tenantErrorTitle,description:o.tenantErrorDescription.format(location.hostname),status:MsPortalFx.Hubs.Notifications.NotificationStatus.Error}),{tenants:[],failure:!0}))))})),v=(0,a.memoizePromise)((()=>b().then((e=>e.tenants.filter((e=>e.tenantCategory.toLowerCase().includes(m)))))));let y=class{getHomeTenantsCount(){return v().then((e=>e.length))}getTenants(){return b()}getHomeTenants(){return v()}};y=__decorate([__metadata("fx:diagnostics",[e,"TenantsService"]),i.Class()],y),t.TenantsService=y,t.getHomeTenantsCountHandler=(0,l.defineHandler)(n.Directories.getHomeTenantsCountEndPoint,(e=>e.diContainer.get(y).getHomeTenantsCount()))})),
define("MsPortalImpl/UI/UI.AuthStateManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.Tenants","FxInternal/AsyncLoader","FxHubs/RpcEndPoints","Fx"],(function(e,t,s,i,o,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCurrentUserEndPointHandler=t.getSubscriptions=t.AuthStateManager=t.hasFlag=void 0;var l=MsPortalFx.Base,d=l.Diagnostics,c=FxImpl.Rpc,p=FxImpl,u=HubsExtension.Internal.Azure,m=d.Telemetry,g=l.Resources;const h=window,f=i.Services.PortalIdentity.tenantNameAndDomainFormat,x=MsPortalFx.ensureSuffix(g.getAppRelativeUri("/"),"/")+"SignOut";function b(e,t){return(e&t)===t}t.hasFlag=b;const v=(0,a.isFeatureEnabled)("persistcachedtokensonrefresh"),y={isAnonymous:!0};class M{constructor(e,t){if(this._diContainer=e,this.bootstrapState=t,this.tokenCache={},this.persist=()=>{this.bootstrapState&&MsPortalImpl.sessionStorage.setItem("authState",JSON.stringify(this.bootstrapState)),v&&this.tokenCache&&Object.keys(this.tokenCache).length&&(m.trace({source:"UIAuthStateManager",action:"persistedTokenCache",data:{extensions:Object.keys(this.tokenCache)}}),MsPortalImpl.sessionStorage.setItem("extensionTokenCache",btoa(JSON.stringify(this.tokenCache))))},this._loadCurrentDirectoryDetailsMemo=(0,a.memoizePromise)((()=>{const e=this.getCurrentUser();if((0,a.isFeatureEnabled)("tenants2020")&&!!e.tenantDisplayName){const{tenantDisplayName:t,tenantDomain:s}=e;return Q({directoryName:t,domainName:s,uniqueDirectoryName:f.format(t,s)})}return this._diContainer.get(o.TenantsService).getHomeTenants().then((t=>{const s=(e.tenantId||"").toLowerCase(),i={};let o="",n="",r="";return t.forEach((t=>{if(s===(t.id||"").toLowerCase()){const s=e.tenantDomain||e.tenantId;t.displayName&&t.displayName!==t.id||(t.displayName=s),t.domainName&&t.domainName!==t.id||(t.domainName=s),o=r=t.displayName,n=t.domainName}else t.displayName?i[t.displayName.toLocaleLowerCase()]=!0:m.trace({source:"UIAuthStateManager",action:"getUserInfo",data:t})})),i[o.toLocaleLowerCase()]&&(r=f.format(o,n)),{directoryName:o,domainName:n,uniqueDirectoryName:r}}))})),(0,a.isFeatureEnabled)("singlesignout")&&h.addEventListener("storage",(e=>{"signOutAll"===e.key&&(this.clear(),h.location.href=x)})),MsPortalImpl.localStorage.getItem("authState")&&(m.trace({source:"UIAuthStateManager",action:"clearAuthState"}),this.clear(!0)),v){const e=MsPortalImpl.sessionStorage.getItem("extensionTokenCache");if(e){try{this.tokenCache=JSON.parse(atob(e)),m.trace({source:"UIAuthStateManager",action:"loadedTokenCache",data:{extensions:Object.keys(this.tokenCache)}})}catch(e){m.trace({source:"UIAuthStateManager",action:"errorLoadingTokenCache",data:{error:MsPortalFx.sanitizeMessage(JSON.stringify(e))}})}MsPortalImpl.localStorage.removeItem("extensionTokenCache")}}this.isMicrosoftOrAmeTenant=["72f988bf-86f1-41af-91ab-2d7cd011db47","33e01921-4d64-4f8c-a055-5bdaffd5e33d"].includes((this.getCurrentUser().tenantId||"").toLowerCase());const s=[];this.onTokensUpdated=e=>{s.push(e)},this._notifyTokensUpdated=()=>{s.forEach((e=>e(this)))}}updateRefreshToken(e,t){m.trace({source:"UIAuthStateManager",action:"updateRefreshToken"});const s=this.bootstrapState||{},{refreshToken:i}=s,o=__rest(s,["refreshToken"]);this.updateBootstrapState(Object.assign(Object.assign({},o),{refreshToken:e,altRefreshToken:t}),"updateRefreshToken")}clear(e){e||(this.updateBootstrapState(null,"clear"),this.tokenCache&&delete this.tokenCache),MsPortalImpl.localStorage.removeItem("authState")}clearSpaAuthCode(){this.bootstrapState.spaAuthCode=""}getUserInfo(e){const t=MsPortalFx.isNullOrUndefined(e)?7:e;return(0,a.memoizePromise)((e=>Q.spread([this.getCurrentUser(),this._loadCurrentDirectoryDetailsMemo()],((t,s)=>{let i={};return b(e,3)&&(i=Object.assign(Object.assign({},i),{email:t.emailAddress,preferredUsername:t.preferredUsername,givenName:t.firstName,surname:t.lastName,isGitHubUser:!!t.gitHubUserId})),b(e,4)&&(i=Object.assign(Object.assign({},i),{directoryId:t.tenantId,directoryName:s&&s.directoryName,domainName:s&&s.domainName,isOrgId:t.isOrgId,objectId:t.objectId,principalId:t.principalId,uniqueDirectoryName:s&&s.uniqueDirectoryName,isTenantAdmin:t.isTenantAdmin,countryCode:t.countryCode,isTenantParityDependent:t.isTenantParityDependent,dataBoundary:t.dataBoundary})),i}))))(t)}getSignedInUserTenant(){return this.getCurrentUser().tenantDomain||""}getCurrentUser(){return this.bootstrapState&&this.bootstrapState.user||y}updateBootstrapState(e,t){m.trace({source:"UIAuthStateManager",action:"updateBootstrapState",data:{caller:t,isBootstrapStateNull:!e}}),this.bootstrapState=e,this._notifyTokensUpdated()}updateExtensionTokens(e,t){if(null==e?void 0:e.length){const s=this.tokenCache;e.forEach((e=>{var i;const o=null!==(i=e.resource)&&void 0!==i?i:"",n=e.name;(s[n]||(s[n]={}))[o]=t})),this._notifyTokensUpdated()}}clearExtensionTokens(e){delete this.tokenCache[e],this._notifyTokensUpdated()}static create(e){return Q(MsPortalEarly.authBootstrapStatePromise).then((t=>new M(e,t)))}}let I;__decorate([__metadata("fx:diagnostics",[e,"AuthStateManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s.Container]),__metadata("design:returntype",Promise)],M,"create",null),t.AuthStateManager=M,p.registerGlobalState({reset:()=>{I=null}}),t.getSubscriptions=function(){if(!I){const e=Q.defer();u.updateSubscriptionInfoEndPoint.register(c.client,"HubsExtension",(t=>{e.resolve(t)})),I=e.promise}return I},t.getCurrentUserEndPointHandler=n.defineHandler(r.Auth.getCurrentUserEndPoint,(e=>e.diContainer.get(M).getCurrentUser()))})),
define("MsPortalImpl/Base/JQueryHelper",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forceShow=t.filterVisible=t.getUnhideSelector=t.isVisible=t.isElementVisible=t.toggle=t.unhide=t.hide=t.findByClassName=t.jBody=void 0;const s="fxs-display-none",i=":not(.fxs-display-none)";function o(e){return e.addClass(s)}function n(e){return e.removeClass(s)}function r(e){return!!e.offsetParent}t.jBody=$(document.body),t.findByClassName=function(e,t){return e.find("."+t)},t.hide=o,t.unhide=n,t.toggle=function(e,t){return(t?n:o)(e)},t.isElementVisible=r,t.isVisible=function(e){return e.toArray().some(r)},t.getUnhideSelector=function(){return i},t.filterVisible=function(e,t){return $(e).find(t+i).filter(((t,s)=>!$(s).parentsUntil(e,".fxs-display-none").length))},t.forceShow=function(e,t){return n(e),e.show(t)}})),
define("MsPortalImpl/UI/UI.NavigationManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/Base/JQueryHelper","FxInternal/AsyncLoader","FxInternal/Redirect","Fx/Ajax"],(function(e,t,s,i,o,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEV=t.forceSignInHandler=t.WindowManager=t.RootElements=t.Browser=void 0;var l=MsPortalFx.Base,d=l.UriBuilder,c=l.Diagnostics,p=l.Resources,u=c.Telemetry;const m=window,g=u.trace,h=MsPortalFx.pathJoin,f=MsPortalFx.ensureSuffix,x=f(p.getAppRelativeUri("/"),"/")+"signout/clearstate";function b(e){return t=>{t?o.unhide(e):o.hide(e)}}let v=class{confirm(e){return m.confirm(e)}};v=__decorate([__metadata("fx:diagnostics",[e,"Browser"]),s.Class()],v),t.Browser=v;class y{constructor(e,t){this.portal=e,this.splashScreen=t,[e,t].forEach((e=>{const t=e.length;if(1!==t)throw new Error("Unexpected length '"+e.selector+"': "+t)})),this.showPortal=b(e),this.showSplash=b(t)}static create(){return new y($(m.document.getElementById("web-container")),$(m.document.querySelectorAll("body>.fxs-splashscreen")))}dispose(){this.showPortal(!1)}}__decorate([__metadata("fx:diagnostics",[e,"RootElements"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",y)],y,"create",null),t.RootElements=y;let M=class{constructor(e,t){this.unloadCallbacks=[],this.unloadCallbacks.push(e.persist);const s=()=>{this.unloadCallbacks.forEach((e=>e()))};m.addEventListener("unload",s),this.location=m.location;const i=e.getCurrentUser(),o=e.bootstrapState;this.redirect=s=>{let n=s.uri||"";const r=Q.defer(),l=s.redirectAction||0;1&l&&e.clear(),2&l&&MsPortalImpl.localStorage.removeItem("LastValidSessionTs"),4&l&&MsPortalImpl.sessionStorage.clear(),8&l&&(0,a.postJSON)({uri:x},{portalAuthorization:o.refreshToken,altPortalAuthorization:o.altRefreshToken,tenant:o.user.tenantId}),t.showSplash(!0),g({source:"Shell",action:"PortalRedirect",actionModifier:"Redirect",data:s});const c=()=>{r.resolve()};s.skipFlushBuffers?c():(Q.all(this.unloadCallbacks.map((e=>e()))).finally(c),setTimeout(c,5e3)),Q.allSettled([s.delayPromise,r.promise]).finally((()=>{if(!n){const e=new d(location.href);e.path=h("/",e.path,i.tenantId||"","/"),n=e.toString()}(e=>{window.location.href=e})(n)}))},this.openWindow=t=>{let s;const i=Q(MsPortalFx.tryImmediateResolve(Q(t),(t=>{if(t){const s=new d(t),i=s.path,o=f(i,"/");if(!MsPortalFx.localeCompareIgnoreCase(o,f(location.protocol+"//"+location.host,"/"))){const i=s.fragment;i.startsWith("#@")||(s.fragment="#@"+e.getSignedInUserTenant()+("#"===i[0]?`/${i.slice(1)}`:""),t=s.toString())}}s?s.location.href=t:s=m.open(t)})));return s||(s=m.open()),i},this.dispose=()=>{m.removeEventListener("unload",s)}}};M=__decorate([__metadata("fx:diagnostics",[e,"WindowManager"]),s.Class(),__metadata("design:paramtypes",[i.AuthStateManager,y])],M),t.WindowManager=M,t.forceSignInHandler=(0,n.defineHandler)(r.forceSignInEndPoint,(t=>MsPortalFx.require(e.normalize("./UI.NavigationManager.ForceSignIn")).then((e=>e.forceSignIn(t.diContainer,t.messageArg,t.messageContext.srcWindowId)))))})),
define("MsPortalImpl/Base/Base.ImplUtils",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/UI/UI.AuthStateManager"],(function(e,t,s,i,o,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.redirectWithCdn=t.getHashQueryStringSegment=t.getHashSegment=t.getQueryStringSegment=t.getPathSegment=t.getPort=t.getPathnameSegment=t.getHost=t.getProtocol=t.mapToQueryString=t.queryStringToMap=t.Uri=t.logIncludingProvenance=t.log=t.logToExtension=t.getLocationFromContext=t.validateAbsoluteHttpUri=t.CompositionProvenance=void 0;var a=MsPortalFx.Base,l=FxImpl.Rpc,d=a.Diagnostics;const c=d.createLog(e),p=/^https?:\/\/.+$/i,u=/^https:\/\/.+$/i,m=MsPortalFx.forEachKey,g=MsPortalFx.isEmpty;let h=class{constructor(e,t){this.locator=e,this.instanceId=t}};function f(e,t){let s,i;if(e&&!e.isDisposed()&&"composition"===e.scope){const t=e.get(h).locator;i=t.name,s=t.getExtensionName()}if(!s)if("string"==typeof t)s=t;else if(t){const e=function(e){const t=$(e),s=t.closest(".fxs-blade-content-container-details,.fxs-blade").data(o.CompositionInstanceDataName);if(s&&o.bladeImplementedWithVirtualPart(s.bladeDefinition))return s.locator;const i=t.closest(".fxs-tile").data(o.CompositionInstanceDataName);return i&&i.locator}(t);e?(i=e.name,s=e.getExtensionName()):s=function(e){const t="data-extensionname";return $(e).closest("[data-extensionname][data-extensionname!='']").attr(t)||"fx"}(t)}return{bladeOrPartName:i,extension:s||"fx"}}function x(e,t,o,n,r={}){let{rpcClient:a}=r;const{contextData:d,diContainer:p}=r;d&&(n+=" "+JSON.stringify(d));try{a||(a=(null==p?void 0:p.get(l.Client))||l.client);const r=f(p,t),d=r.bladeOrPartName;if((d||"").toLowerCase().endsWith("_dx"))return void i.get("MsPortalImpl/Extension/DefinitionCache","DefinitionCache").then((e=>{s.container.get(e).getBladeDefinition(r.extension,r.bladeOrPartName).then((e=>{var t,s;try{const i=MsPortalFx.first(MsPortalFx.find(e.effectiveInputs,(e=>"dxContext"===e.property)).valuesFrom).constantValue.viewKind;a.log(null!==(s=null===(t=e.dxView)||void 0===t?void 0:t.runtimeExtension)&&void 0!==s?s:"Microsoft_Azure_CreateUIDef",{level:o,code:0,area:i,message:MsPortalFx.getLogFriendlyMessage(n)})}catch(e){c.error(MsPortalFx.getLogFriendlyMessage(e))}}))}));const u=d||e.normalize();a.log(r.extension,{level:o,code:0,area:u,message:MsPortalFx.getLogFriendlyMessage(n)})}catch(e){c.error(MsPortalFx.getLogFriendlyMessage(e))}}h=__decorate([__metadata("fx:diagnostics",[e,"CompositionProvenance"]),s.Value("composition"),__metadata("design:paramtypes",[Object,String])],h),t.CompositionProvenance=h,t.validateAbsoluteHttpUri=function(e,t){return((t=t||{}).requireHttps||!1?u:p).test(e)},t.getLocationFromContext=f,t.logToExtension=x,t.log=function(e,t,s,i){i=i?MsPortalFx.extend2(e.contextData,i):e.contextData,x(e.localRequire,e.windowContext,t,s,{contextData:i,diContainer:e.diContainer})},t.logIncludingProvenance=function(e,t,i){try{const o=(i=i||{windowContext:null,localRequire:null,diContainer:s.container}).windowContext,n=f(i.diContainer,o),r=i.localRequire&&i.localRequire.normalize(),a=MsPortalFx.extend2(i.contextData||{},{extensionName:n.extension,bladeOrPartName:n.bladeOrPartName,area:r}),l=MsPortalFx.getLogFriendlyMessage(t);new d.Log(r||n.bladeOrPartName||n.extension).writeEntry(e,l,null,[a])}catch(e){c.error(MsPortalFx.getLogFriendlyMessage(e))}};function b(e=""){const t={},s=e.indexOf("?");return(s>-1?e.slice(s+1):e).split("&").forEach((e=>{if(!e||/^=+$/.test(e))return;const s=e.split("="),i=s.shift(),o=s.length>0?s.join("="):"";t[i]=o})),t}function v(e){let t="",s="";return m(e,((e,i)=>{t+="{0}{1}={2}".format(s,e,i),s||(s="&")})),t}function y(e){const t=e.toString().match(/^([^:/]+):\/\//);return t?t[1]+":":""}function M(e){const t=y(e=e.toString());if(!t)return"";const s=e.slice(t.length+2),i=s.indexOf("/"),o=i>0?s.slice(0,i):s;return!o||o.indexOf("@")>0?"":o.replace(/:.*/,"")}function I(e){const t=P(e),s=M(t),i=C(t),o=y(t),n=(o?o.length+2:0)+s.length+(i?i.length+1:0);return s&&o?t.slice(n):""}function C(e){const t=y(e),s=M(e);if(!t||!s)return"";const i=t.length+2+s.length,o=e.toString().substring(i).match(/^:(\d+)/);return o?o[1]:""}function P(e){const t=e.toString().replace(/#.*/g,"").replace(/\?.*/,"");return M(t)&&y(t)?t:""}function w(e){return e=e.toString().replace(/#.*/g,""),/\?/.test(e)?e.replace(/.*\?/,"?"):""}function _(e){return e=e.toString(),/#/.test(e)?e.replace(/[^#]*#/,"#").replace(/\?.*/,""):""}function S(e){const t=e.indexOf("#"),s=-1===t?-1:e.slice(t).indexOf("?");return-1===t||-1===s?"":e.slice(t+s)}t.Uri=class{constructor(e){this._hashQs={},this._qs={},e=e&&e.toString()||"",this._protocol=y(e),this._host=M(e),this._port=C(e),this._pathname=I(e),this._hash=_(e),this._qsPart=w(e),this._qs=b(this._qsPart),this._hashQsPart=S(e),this._hashQs=b(this._hashQsPart)}getQueryStringValue(e){return this._qs[e]||""}setHashQueryStringValue(e,t){return this._hashQs[e]=t,this}setHashQueryString(e){return this._hashQs=b(e),this}deleteHashQueryStringValue(e){return delete this._hashQs[e],this}clearHashQueryStringIfEmpty(){return g(this._hashQs)&&(this._hashQsPart=""),this}getHashQueryStringValue(e){return this._hashQs[e]||""}setHash(e){return this._hash=e.toString().replace(/\?.*/,""),this}isHashEmpty(){return""===this.hash||"#"===this.hash}toString(){return this.href}get href(){return this.path+this.queryString+this.hash+this.hashQueryString}get host(){return this._host}get path(){return(this.protocol?this.protocol+"//":"")+this.host+(this.port?":"+this.port:"")+this.pathname}get pathname(){return this._pathname}get port(){return this._port}get protocol(){return this._protocol}get queryString(){const e=v(this._qs);return e||this._qsPart?"?"+e:""}get hash(){return this._hash||this.hashQueryString?"#"+(this._hash||"").replace(/^#/,""):""}get hashQueryString(){const e=v(this._hashQs);return this._hashQsPart||e?"?"+e:""}get hashWithHashQueryString(){return this.hash+this.hashQueryString}getHashParts(){return this._cachedHashParts&&this._partsBasedHash===this.hash||(this._partsBasedHash=this.hash,this._cachedHashParts=MsPortalEarly.getHashParts(this.hash)),this._cachedHashParts}},t.queryStringToMap=b,t.mapToQueryString=v,t.getProtocol=y,t.getHost=M,t.getPathnameSegment=I,t.getPort=C,t.getPathSegment=P,t.getQueryStringSegment=w,t.getHashSegment=_,t.getHashQueryStringSegment=S;const F=["cloudsimpleextbearer","tokencaching","internalgraphapiversion","cae"].reduce(((e,t)=>{const s=MsPortalFx.getFeatureValue(t);return s&&(e[`feature.${t}`]=s),e}),{});t.redirectWithCdn=function(e,t){const s=new a.UriBuilder(t.uri+location.search+MsPortalFx.ensurePrefix(t.hash,"#")),i=s.query;MsPortalFx.forEachKey(F,((e,t)=>i.setParameter(e,t))),MsPortalFx.forEachKey(t.parameters,((e,t)=>i.setParameter(e,t))),e.get(r.AuthStateManager).clear(!0),e.get(n.WindowManager).redirect({uri:s.toString(),redirectAction:t.redirectAction||0})}})),
define("MsPortalImpl/Base/Base.BrowserDetection",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isOpera=t.isTouch=t.webKitVersion=t.isMac=t.isIPadOS=t.isIOS=t.isAndroidOrMobile=t.isChromeIos=t.isSafari=t.isIeOrEdgeNonChromium=t.isChromeOrEdgeChromium=t.isChromiumEdge=t.isEdge=t.isChrome=t.isFirefox=t.subscribeToInstalledPwa=t.isInstalledPwa=t.safari_11_webKitVersion=t.safariFeature=t.edgeFeature=t.msieFeature=t.chromeFeature=t.edgeChromiumFeature=t.operaFeature=t.ffFeature=void 0;const s=window.navigator.userAgent;t.ffFeature="undefined"!=typeof InstallTrigger,t.operaFeature=!!window.opr&&!!window.opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,t.edgeChromiumFeature=function(){let e=!1,t=!1;if(navigator.userAgentData){const{brands:s}=navigator.userAgentData;return s.forEach((s=>{"Chromium"===s.brand&&(e=!0),"Microsoft Edge"===s.brand&&(t=!0)})),e&&t}return!1}(),t.chromeFeature=!(!window.chrome||!window.chrome.webstore&&!window.chrome.loadTimes||t.edgeChromiumFeature||t.operaFeature),t.msieFeature=!!document.documentMode,t.edgeFeature=!t.msieFeature&&!!window.StyleMedia,t.safariFeature=/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===(!window.safari||"undefined"!=typeof safari&&safari.pushNotification).toString();const i=/^(?!.*chrome).*safari/i.test(navigator.userAgent),o=/Trident\//i.test(s),n=/ip(?:hone|od|ad)/i.test(s),r=/ipad/i.test(s),a=/CriOS/i.test(s);function l(e){return window.matchMedia(e).matches}function d(e){const t=window.matchMedia("(display-mode: standalone)");return t.addEventListener("change",e),()=>t.removeEventListener("change",e)}t.safari_11_webKitVersion=604,t.isInstalledPwa=l("(display-mode: standalone)"),d((e=>{t.isInstalledPwa=e.matches})),t.subscribeToInstalledPwa=d,t.isFirefox=t.ffFeature,t.isChrome=!(!t.chromeFeature&&!a),t.isEdge=t.edgeFeature,t.isChromiumEdge=t.edgeChromiumFeature,t.isChromeOrEdgeChromium=t.edgeChromiumFeature||t.isChrome,t.isIeOrEdgeNonChromium=t.msieFeature||o||t.edgeFeature,t.isSafari=i&&!a,t.isChromeIos=a,t.isAndroidOrMobile=/Mobile|Android/.test(s)||"true"===MsPortalFx.getFeatureValue("skipautofocus"),t.isIOS=n,t.isIPadOS=r,t.isMac=/Mac/.test(window.navigator.platform),t.webKitVersion=function(){const e=/AppleWebKit\/([\d.]+)/.exec(s);if(e)return parseFloat(e[1])}()||0,t.isTouch=function(){const e="-webkit- -moz- -o- -ms-".split(" ");return"ontouchstart"in window||l(`(${e.join("touch-enabled),(")}touch-enabled)`)}(),t.isOpera=t.operaFeature})),
define("MsPortalImpl/Base/Base.CssSelectorParser",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.subselectorToString=t.parseCssSelector=void 0,t.parseCssSelector=function(e){return e=e.replace("::after",":after").replace("::before",":before"),n=(e,t)=>t,d(e||"",!1)},t.subselectorToString=function(e){return e.map((e=>e.value)).join("")};const s=jQuery.find,i=s.selectors,o=s.selectors.match;let n;
/*!
     * -----------------------------------------------------------------------------
     * The portion of this file from here until "End of jQuery code snippet" is code
     * derived from the jQuery JavaScript Library v2.0.3 - http://jquery.com/
     * Copyright 2005, 2013 jQuery Foundation, Inc. and other contributors
     * Released under the MIT license - http://jquery.org/license
     * Date: 2013-07-03T13:30Z
     */const r=new RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),a=new RegExp("^[\\x20\\t\\r\\n\\f]*,[\\x20\\t\\r\\n\\f]*"),l=new RegExp("^[\\x20\\t\\r\\n\\f]*([>+~]|[\\x20\\t\\r\\n\\f])[\\x20\\t\\r\\n\\f]*"),d=function(e,t){let d,c,p,u;const m=n[e+" "];if(m)return t?0:m.slice(0);u=e;const g=[],h=i.preFilter;for(;u;){d&&!(c=a.exec(u))||(c&&(u=u.slice(c[0].length)||u),g.push(p=[])),d=!1,(c=l.exec(u))&&(d=c.shift(),p.push({value:d,type:c[0].replace(r," ")}),u=u.slice(d.length));for(const e in i.filter)!(c=o[e].exec(u))||h[e]&&!(c=h[e](c))||(d=c.shift(),p.push({value:d,type:e,matches:c}),u=u.slice(d.length));if(!d)break}return t?u.length:u?s.error(e):n(e,g).slice(0)};
/*!
     * End of jQuery code snippet
     * -----------------------------------------------------------------------------
     */let c;c=void 0})),
define("MsPortalImpl/Base/Base.CssSanitizer",["require","exports","MsPortalImpl/Base/Base.CssSelectorParser","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Base/Base.ImplUtils"],(function(e,t,s,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateErrorMessage=t.sanitizeStyleSheetText=t.mediaQueryToClass=t.sanitizeStyleDeclarationString=t.sanitizeDefinition=t.getScopeName=t.domStylePropertyToCssProperty=t.CssSanitizerErrorTypes=t.stylePolicy=void 0;const n=["align-content","align-items","align-self","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-size","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-left","border-left-color","border-left-style","border-left-width","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-shadow","box-sizing","break-after","break-before","break-inside","clear","clip-path","color","content","counter-increment","counter-reset","cursor","display","direction","enable-background","fill","fill-rule","fill-opacity","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","font-feature-settings","font-kerning","font-language-override","font-optical-sizing","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","gap","row-gap","column-gap","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-gap","grid-column-start","grid-column-end","grid-gap","grid-row","grid-row-end","grid-row-gap","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","height","justify-content","justify-items","left","letter-spacing","line-height","list-style-position","list-style-type","margin","margin-left","margin-top","margin-right","margin-bottom","max-height","max-width","min-height","min-width","opacity","order","orphans","outline","outline-color","outline-style","outline-width","overflow","overflow-wrap","overflow-x","overflow-y","padding","padding-top","padding-left","padding-right","padding-bottom","pointer-events","right","scroll-snap-align","scroll-snap-type","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","table-layout","text-align","text-decoration","text-decoration-color","text-decoration-line","text-decoration-style","text-decoration-thickness","text-indent","text-justify","text-orientation","text-transform","text-overflow","top","transform","transform-origin","transition","transition-delay","transition-duration","transition-property","transition-timing-function","user-select","vertical-align","visibility","white-space","widows","width","word-break","word-spacing","word-wrap","-webkit-line-clamp"];i.isFirefox&&n.push("-moz-box-orient","-moz-border-top-colors","-moz-border-right-colors","-moz-border-bottom-colors","-moz-border-left-colors"),(i.isChromeOrEdgeChromium||i.isSafari)&&n.push("background-repeat-x","background-repeat-y","-webkit-border-horizontal-spacing","-webkit-border-vertical-spacing","-webkit-box-orient","-webkit-text-stroke-width","-webkit-text-fill-color","-webkit-text-stroke-color","-webkit-font-smoothing","-webkit-user-drag"),i.isSafari&&n.push("transform-origin-x","transform-origin-y","-webkit-box-shadow","-webkit-tap-highlight"),t.stylePolicy={},n.forEach((e=>{t.stylePolicy[e]=1})),t.stylePolicy["font-family"]=function(e){return/^ *["']?(?:Segoe UI|Consolas)["']? *(?:,|$)/.test(e)},t.stylePolicy.position=["relative","absolute","static","inherit","sticky"],t.stylePolicy["list-style-image"]=["none","inherit","initial"],t.stylePolicy["text-transform"]=function(e){return"none"===e||"uppercase"===e||"lowercase"===e||"capitalize"===e},t.stylePolicy["z-index"]=function(e){return parseInt(e,10)>=0};const r=/\(min-width: (\d+)px\)/,a=/\((min|max)-width: (\d+)px\)/,l=/\W/g,d=/[a-z|A-Z]+/g,c=Object.keys(t.stylePolicy).map((function(e){let t=e.toLowerCase().match(d).reduce(((e,t,s)=>s>0?e+(t=t.charAt(0).toUpperCase()+t.slice(1)):e+t));"float"===t&&(t="cssFloat");return t}));var p;function u(e){return"cssFloat"===e?"float":(e||"").replace(/([A-Z])/g,"-$1").toLowerCase()}function m(e){return"css-scope-"+e.replace(l,"")}function g(e){return`fxt-mq-${"MINWIDTH"===e.type?"min":"max"}w-${e.pixels}`}function h(e,t,o,n){const r=document.implementation.createHTMLDocument(""),l=r.createElement("style");r.body.appendChild(l);const d=function(e,t){const s=t.createElement("style");t.body.appendChild(s),s.textContent=e;const i=s.sheet,o=i&&i.cssRules;return o?Array.prototype.slice.call(o,0):[]}(e,r),c=d.filter((e=>e.type===CSSRule.MEDIA_RULE)).reduce(((e,t)=>{const s=(r=t.media,i.isIeOrEdgeNonChromium?r.mediaText.split(",").map((e=>e.trim())):Array.from(r)).map((e=>MsPortalFx.replaceAll(e,"all and ","").replace(/\((.*):\s*(.*)\)/,"($1: $2)").trim()));var r;s.filter((e=>!x(e))).forEach((e=>{!function(e,t,s){s.push(...e.map((e=>({type:p.MediaQuery,mediaQuery:t,errorMessage:e}))))}(["Media query is not allowed"],e,o)}));const l=s.filter((e=>x(e))).map((e=>{const t=function(e){const t=a.exec(e);return{type:"min"===t[1]?"MINWIDTH":"MAXWIDTH",pixels:Number(t[2])}}(e),s=g(t);return n&&n.push({mediaClass:s,mediaQuery:t}),"."+s}));if(0===l.length)return e;const d=function(e){const t=[];for(let s=0;s<e.length;s++)t[s]=e[s];return t}(t.cssRules).filter(P).map((e=>({selectorText:`${l.join()} ${e.selectorText}`,cssText:e.cssText,style:e.style,type:e.type})));return[...e,...d]}),[]),u=[...d,...c].filter(P).map((e=>{const i=function(e,t,i,o){const n=[],r=function(e,t,i){let o;const n=[];try{o=s.parseCssSelector(e)}catch(t){return i.push("Malformed selector: "+e+"\nException: "+t.toString()),null}return o.forEach((e=>{(function(e,t){return!e.some((e=>{if("CLASS"===e.type){if(e.value&&!MsPortalFx.startsWith(e.value,".ext-")&&!MsPortalFx.startsWith(e.value,".fxt-"))return t.push("Selectors can only refer to extension-specific class names (those starting with .ext- or .fxt-)"),!0}else if("ID"===e.type)return t.push("Selectors cannot refer to elements by ID"),!0}))})(e,i)&&n.push(t+" "+s.subselectorToString(e))})),n.join(", ")}(e.selectorText,i,n).replace(" .fxt-mq-",".fxt-mq-");if(b(n,e,o),r){t.insertRule(r+" {}",0);const s=t.cssRules[0],i=[];return v(e.style,s,i),b(i,e,o),s}return null}(e,l.sheet,t,o);return i?i.cssText:null}));let m=u.join("\n");return["ext-mode-light","ext-mode-dark","ext-mode-standardcontrast","ext-mode-highcontrast","ext-highcontrast-light","ext-highcontrast-dark"].forEach((e=>{const s=["{0} {1}","{1} {0}"].map((s=>s.format(t,"."+e)));m=MsPortalFx.replaceAll(m,s[0],s[1])})),m}function f(e){let t;if(e.type===p.StyleRule)t=`Invalid CSS property - ${e.errorMessage}\nCSS rule: ${e.rule.cssText}`;else t=`Invalid CSS Media Query - ${e.mediaQuery}\nMedia Query: ${e.errorMessage}`;return t}function x(e,t=[r]){return Boolean(t.some((t=>e.match(t))))}function b(e,t,s){s.push(...e.map((e=>({type:p.StyleRule,rule:t,errorMessage:e}))))}function v(e,s,i){const o=function(e){const s=[];for(let i=0,o=e.length;i<o;i++){const o=e[i];if(M[o]&&!(o in t.stylePolicy))return C(e);s.push(o)}return s}(e);for(let n=0,r=o.length;n<r;n++){const r=o[n],a=e.getPropertyValue(r),l=e.getPropertyPriority(r);if("initial"===a)continue;const d=y(l,i);let c=null,p=null;if(t.stylePolicy.hasOwnProperty(r)){c=r;const e=t.stylePolicy[r];if(1===e)p=a;else if(e instanceof Array){const t=e.indexOf(a);t>=0&&(p=e[t])}else"function"==typeof e&&e(a)&&(p=a);p?s.style.setProperty(r,a,d):i.push("Disallowed style value. Property name: {0}, value: {1}".format(c,a))}else r.startsWith("--ext")?(c=r,p=a,s.style.setProperty(r,a,d)):i.push("Disallowed style property. Property name: "+r)}}function y(e,t){return e?(t.push("Disallowed CSS priority value: "+e),""):e}!function(e){e[e.MediaQuery=0]="MediaQuery",e[e.StyleRule=1]="StyleRule"}(p=t.CssSanitizerErrorTypes||(t.CssSanitizerErrorTypes={})),t.domStylePropertyToCssProperty=u,t.getScopeName=m,t.sanitizeDefinition=function(t){const s="."+m(t.name),i=[];return t.styleSheets=(t.styleSheets||[]).map((e=>h(e,s,i))),i.forEach((s=>{const i=`Sanitization error found in style sheet in extension: ${t.name}\n${f(s)}`;o.logToExtension(e,t.name,2,i)})),!i.length},t.sanitizeStyleDeclarationString=function(e,t,s){t.insertRule(".ignored1 { {0} }".format(e),0),t.insertRule(".ignored2 {}",1);const i=t.cssRules[0],o=t.cssRules[1];return i.type===CSSRule.STYLE_RULE?(v(i.style,o,s),o.style.cssText):(s.push("Not a style rule: "+e),null)},t.mediaQueryToClass=g,t.sanitizeStyleSheetText=h,t.generateErrorMessage=f;const M={};var I;function C(e){const t=[];for(let s=c.length-1;s>=0;s--){const i=c[s];e[i]&&t.push(u(i))}return t}function P(e){return e.type===CSSRule.STYLE_RULE}(i.isChromeOrEdgeChromium||i.isSafari)&&(I=M,[].forEach((e=>{I[e]=1})))})),
define("MsPortalImpl/Base/Base.KnockoutBindingSanitizer",["require","exports","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.CssSanitizer"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sanitizeBindingComment=t.sanitizeBindingAttribute=void 0;const o=v(m,h((()=>!0))),n={checked:m,click:function(t,i,o){return s.logToExtension(e,o,1,"Support for the 'click' binding will soon be removed. Replace uses of 'click' with 'fxclick'. Find 'fxclick' samples at: https://aka.ms/portalfx/fxclicklink."),m(t)},clickBubble:m,commands:v(m,h((()=>!0))),disable:m,disableAutoDispose:m,enable:m,event:x(["click","keypress","afterkeypress"]),foreach:v(m,x(["data","as"])),formElement:o,fxclick:m,htmlTemplate:o,if:m,ifnot:m,image:m,options:m,optionsText:b,optionsValue:b,sanitizedAttr:o,sanitizedCss:o,sanitizedHtml:m,selectedOptions:m,style:f(((e,t)=>t.style.hasOwnProperty(i.domStylePropertyToCssProperty(e))),(function(e,t,s){const o=i.domStylePropertyToCssProperty(e),n=s.style[o],r=d.exec(t),a=r?t.slice(1,-1):null;let l=!1;1===n?l=!!r||m(t)===t:n instanceof Array?l=!!r&&n.includes(a):"function"==typeof n&&(l=!!r&&n(a));return l})),submit:m,text:m,uniqueName:m,visible:m,value:m,valueUpdate:(r=["afterkeyup"],function(e,t){return r.some((t=>e==='"'+t+'"'||e==="'"+t+"'"))?e:null}),vtext:m,with:m};var r;const a={attr:"sanitizedAttr",css:"sanitizedCss",html:"sanitizedHtml"};const l=["===","==","!==","!=","<=","<",">=",">","&&","||","-","+","*","/"],d=/^(?:"(?:[^"\\]|\\.)*"|'(?:[^'\\]|\\.)*')$/,c=/^[a-z_$][\w$]*$/i;function p(e,t,s,i,o){const r=[],l=ko.expressionRewriting.parseObjectLiteral(t);let d=!0;return l.forEach((function(t){const l=(t.key||t.unknown||"").trim(),c=function(e){return a[e]||e}(l);let p=n[c];if(p||"pc"!==c.substring(0,"pc".length)||(p=m),p){const n=(t.value||"").trim(),a=p(n,i,e.windowContext);null!==a?r.push(u(c)+": "+a):(d=!1,o.push({provenanceContext:e,reason:6,tag:s,binding:l,val:n}))}else d=!1,o.push({provenanceContext:e,reason:5,tag:s,binding:l})})),d?r.join(", "):null}function u(e){return e&&!d.test(e)&&(c.test(e)||(e="'"+e.replace("'","\\'")+"'")),e}function m(e){const t=g(e);if(null!==t)return t;for(let t=0;t<l.length;t++){const s=e.split(l[t]);if(2===s.length&&g(s[0].trim())&&g(s[1].trim()))return e}return null}function g(e){return/^!?(?:[$\w.'\-"[\]]|\(\))+$/.test(e)||/^\{\s*\}$/.test(e)?e:null}function h(e){return f(e,((e,t,s)=>!!m(t)))}function f(e,t){return function(s,i){const o=ko.expressionRewriting.parseObjectLiteral(s),n=[];let r=!0;return o.forEach((function(s){const o=(s.key||"").trim(),a=(s.value||"").trim();e(o,i)&&t(o,a,i)?n.push(u(o)+": "+a):r=!1})),r?"{ "+n.join(", ")+" }":null}}function x(e){return h(((t,s)=>e.includes(t)))}function b(e){return/^"[^"]*"$/.test(e)||/^'[^']*'$/.test(e)?e:null}function v(...e){return function(t,s){let i,o;for(i=0;i<e.length;i++)if(o=e[i](t,s),null!==o)return o;return null}}t.sanitizeBindingAttribute=p,t.sanitizeBindingComment=function(e,t,s,i){const o=/^\s*ko\s([\s\S]*)/.exec(t);if(o){const t=p(e,o[1],"comment",s,i);return null===t?" ko ":" ko "+t+" "}return/^\s *\/ko/.test(t)?" /ko ":null}})),
define("MsPortalImpl/Base/Base.LruMap",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LruMap=void 0;t.LruMap=class{count(){return this._count}constructor(e){this._map=Object.create(null),this._count=0,this._lastAccessed=0,this._capacity=e}contains(e){return!!this._map[e]}trim(e){"number"!=typeof e&&(e=this._capacity);let t=this.count()-e;if("number"!=typeof e||t<1)return;const s=this._lastAccessed-e+1;MsPortalFx.forEachKey(this._map,((e,t,i)=>{t.lastAccessed<s&&i.push(t)}),[]).sort(((e,t)=>t.lastAccessed-e.lastAccessed)).some((e=>(delete this._map[e.key],t--,t<1))),this._count=e}getOrAdd(e,t){const s=this._map[e];let i;if(s)s.lastAccessed=++this._lastAccessed,i=s.data;else{if(!t)throw new Error(`Unable to find item with key: '${e}'.`);i=t(e),this.addOrUpdate(e,i)}return i}addOrUpdate(e,t,s){const i=this._map[e];return i?(i.data=t,i.lastAccessed=++this._lastAccessed):(this._map[e]={key:e,data:t,lastAccessed:++this._lastAccessed},this._count++,s||this.trim()),!i}remove(e){this._map[e]&&(this._count--,delete this._map[e])}}})),
define("MsPortalImpl/Base/Base.Sanitization",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Base.ImplUtils","FxInternal/Utils/LinkSanitizer"],(function(e,t,s,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAllowListedAttr=t.sanitizeLinkUri=t.sanitizeUri=t.validateDataImage=t.validateLocalUriOnly=t.validateLinkUri=t.validateUriOrBlank=void 0;MsPortalFx.Base.Diagnostics;const n=/^(?:vstfs:|ftp:|ftps:|sftp:|storageexplorer:|adlalink:|adl:|asalink:|vscode:|vsweb:|azuredatastudio:|bfcomposer:|ms-quick-assist:|ms-remote-help:)?\/\/|^mailto:/,r=/^#(?:allservices|asset|blade|create|dashboard|home|menu|resource)\b/,a=/^#/,l=/^data:image\//;function d(e,t,s){return!!(""===e||(0,i.validateAbsoluteHttpUri)(e)||n.test(e)||"_self"===t&&r.test(e))&&(p(e,s),!0)}function c(e){return((null==e?void 0:e.diContainer)||s.container).get(o.LinkSanitizer)}function p(e,t){const s=(0,i.getLocationFromContext)(null==t?void 0:t.diContainer,null==t?void 0:t.windowContext).extension;if(FxImpl.features.isEnabled("logexternaldomainlinks")&&!c(t).isTrustedDomainLink(e,s)){const s=MsPortalFx.sanitizeMessage(e);(0,i.logIncludingProvenance)(1,"Link is external to the known valid domains: "+s,t)}}t.validateUriOrBlank=d,t.validateLinkUri=function(e,t){return!!(""===e||a.test(e)||(0,i.validateAbsoluteHttpUri)(e)||n.test(e))&&(p(e,t),!0)},t.validateLocalUriOnly=function(e){return""===e||a.test(e)},t.validateDataImage=function(e){return""===e||l.test(e)},t.sanitizeUri=function(t,s,o){const n=d(t,s,o);return n||(0,i.logToExtension)(o&&o.localRequire||e,o&&o.windowContext||null,2,"Disallowed URI: "+t),n},t.sanitizeLinkUri=function(e,t){if(""===e||a.test(e))return e;if((0,i.validateAbsoluteHttpUri)(e)||n.test(e)){const s=(0,i.getLocationFromContext)(t.diContainer,t.windowContext).extension;return c(t).getSafeLink(e,s)}return!1};const u=["alt","border","colspan","rowspan","span","disabled","height","width","lang","spellcheck","title","value","dx-content-path","dx-content-property","cx","cy","d","rx","ry","x","y","x1","x2","y1","y2","fill","fill-rule","opacity","points","stroke","stroke-dasharray","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-width","transform","vector-effect","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-current","aria-disabled","aria-expanded","aria-haspopup","aria-hidden","aria-invalid","aria-label","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","role"];t.getAllowListedAttr=function(){return u}})),
define("MsPortalImpl/Base/Base.KnockoutTemplateSanitizer",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.KnockoutBindingSanitizer","MsPortalImpl/Base/Base.CssSanitizer","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.LruMap"],(function(e,t,s,i,o,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sanitizeHTML=t.KODeniedTemplateSanitizer=t.KOAllowedTemplateSanitizer=t.TemplateSanitizer=t.isAllowedCssClassName=t.sanitizeDefinition=t.sanitizeBladeDefinition=t.sanitizeInlineTemplate=void 0;MsPortalFx.Base.Diagnostics;const l=/^(?:az-|ms-|msportalfx|ext-|lang-|fxt-)[\w-]+$/,d=MsPortalFx.getUniqueId().toLowerCase(),c={sanitizeLinkUri:(e,t,s,i,o,n,a)=>r.sanitizeLinkUri(e,a),validateUriOrBlank:(e,t,s,i,o,n,a)=>r.validateUriOrBlank(e,null,a),validateLocalUriOnly:r.validateLocalUriOnly,validateClassNames:function(e,s,i,o,n,r,a){const l=/[\w-]+/g;let d;const c=[];for(;d=l.exec(e);){const e=d[0];(0,t.isAllowedCssClassName)(e)?c.push(e):r.push({provenanceContext:a,reason:2,tag:s,val:e})}return c.join(" ")||null},validateKOBindingString:function(e,t,s,i,n,r,a){return o.sanitizeBindingAttribute(a,e,t,n,r)},mapName:function(e,t,s,i){return i.setAttribute(s,"TemplateSanitizer"+d+"_"+e),!1}},p=["src"],u="data-sanitizer-"+d+"-";function m(e,t,s,i,o){const n=i&&i.htmlTemplateInline;n&&g(e,t,s,n,o,(()=>{n.content=null}))}function g(t,s,i,o,n,r){const a=t.get(v).sanitize({contextData:{File:o.file,TemplateKey:i},diContainer:t,localRequire:e,value:o.content,windowContext:s});!a.errors.length||0===n?o.content=a.sanitizedMarkup:r()}t.sanitizeInlineTemplate=m,t.sanitizeBladeDefinition=function(e,t,s,i){s.isWeave||(s.lenses||[]).forEach((o=>{(o.partInstances||[]).forEach((o=>{m(e,t,`${s.name}/${o.name}`,o.inline,i)}))}))},t.sanitizeDefinition=function(e,t,i=s.container){const o=e.name;MsPortalFx.forEachKey(e.htmlTemplates,((s,n)=>{g(i,o,s,n,t,(()=>{delete e.htmlTemplates[s]}))}))};t.isAllowedCssClassName=function(e){return"string"==typeof e&&l.test(e)};const h=(()=>{function e(e){return e.length?t(e):1}function t(t){const s={};return t.forEach((function(t){if("string"==typeof t)s[t]=1;else for(const i in t){const o=t[i];s[i]=o instanceof Function?o:e(o)}})),s}const s=["ABBR","ADDRESS","ARTICLE","B","BLOCKQUOTE","BR","CAPTION","CITE","CODE","COL","COLGROUP","DD","DEL","DFN","DIV","DL","DT","EM","FIELDSET","FIGURE","FIGCAPTION","FONT","FOOTER","HEADER","H1","H2","H3","H4","H5","H6","HR","I","INS","LABEL","LEGEND","MARK","OL","P","PRE","Q","S","SECTION","SMALL","SPAN","STRONG","SUB","SUP","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","U","UL",{A:[{href:c.sanitizeLinkUri},"target"]},{BUTTON:["value"]},{IMG:[I("src",c.validateUriOrBlank)]},{INPUT:[{type:["text","password","radio","checkbox","submit"]},"checked","maxlength","value"]},{LI:["value"]},{OPTION:["label","selected","value"]},{SELECT:["multiple","size"]},{TEXTAREA:["rows","cols"]},{TIME:["datetime"]},{SVG:["viewBox","focusable",{"xmlns:xlink":c.validateUriOrBlank},{"xmlns:svg":c.validateUriOrBlank},{xmlns:c.validateUriOrBlank}]},{CIRCLE:["r"]},"DEFS","DESC",{ELLIPSE:["id"]},{G:["id"]},{LINE:["id"]},"METADATA",{PATH:["id"]},{POLYGON:["id"]},{POLYLINE:["id"]},{RECT:["id"]},{STOP:["offset"]},{TEXT:["id","font-size"]},"TITLE",{USE:["id",{"xlink:href":c.validateLocalUriOnly}]},{AUDIO:[I("src",c.validateUriOrBlank),"controls","currentTime","duration","preload"]},{VIDEO:[I("src",c.validateUriOrBlank),"controls","poster","preload","autoplay"]},{SOURCE:[I("src",c.validateUriOrBlank),"type"]}],i=[{"data-bind":c.validateKOBindingString},{class:c.validateClassNames},{name:c.mapName},"dx-content-path","dx-content-property","data-click-telemetry",{"data-activatable":["true","false"]},"data-activate-info"].concat(...r.getAllowListedAttr());return{style:n.stylePolicy,elements:{tags:t(s),global:t(i)},comments:o.sanitizeBindingComment}})(),f=[];function x(e,t,s){const a=document.implementation.createHTMLDocument(""),l=document.createDocumentFragment(),d=FxImpl.createElement("div"),m=h.elements,g=m.tags,x=m.global,b=[];let v=!1,y=e.value||"";l.appendChild(d),p.forEach((t=>{try{y=M(y,t,u+t)}catch(t){i.log(e,s,`An error occured processing the untrustedHTMLString '${y}'.\nuntrustedHTMLString is now set to empty string to prevent further errors.\nError message was: '${t.message}'.\nReview binding and any other context provided.`),y=""}})),a.body.innerHTML=y;const I=a.createElement("style");I.setAttribute("type","text/css"),a.head.appendChild(I);const C=I.sheet;function P(s,i,o,n){if(o.hasAttribute(s)&&!n.hasAttribute(s)){const r=o.getAttribute(s),a=[],l=function(s,i,o,n,r,a){if(!t&&s===c.validateKOBindingString)return null;if(1===s)return i;if("object"==typeof s)return i in s?i:null;if(s instanceof Function){const t=s(i,o,n,r,h,a,e);return"boolean"==typeof t?!0===t?i:null:"string"==typeof t?t:null}return null}(i,r,o.nodeName.toUpperCase(),s,n,a);null!==l&&n.setAttribute(s,l),a.length>0?a.forEach((e=>{b.push(e)})):null===l&&b.push({provenanceContext:e,reason:1,tag:o.nodeName.toUpperCase(),attr:s,val:r})}}function w(e,t,s){if("object"==typeof s)for(let i=0,o=e.attributes,n=o.length;i<n;i++){const n=o[i].name;n in s&&P(n,s[n],e,t)}}!function s(i,l){const d=i.nodeName.toUpperCase();if(i.nodeType===Node.ELEMENT_NODE&&(v||(v=i!==a.body)))if(g[d]){const t=FxImpl.createElement(d);w(i,t,g[d]),w(i,t,x);const s=i.getAttribute("style");if(s){const i=[],o=n.sanitizeStyleDeclarationString(s,C,i);i.forEach((t=>{b.push({provenanceContext:e,reason:3,tag:d,attr:"style",val:t})})),t.setAttribute("style",o)}if("A"===d){const s=i.getAttribute("href"),o=i.getAttribute("target");!MsPortalFx.isNullOrWhiteSpace(s)&&r.validateUriOrBlank(s,null,e)&&((MsPortalFx.isNullOrWhiteSpace(o)||"_self"===o)&&t.setAttribute("target","_blank"),t.setAttribute("rel","noopener"))}l.appendChild(t),l=t}else if(b.push({provenanceContext:e,reason:4,tag:d}),!MsPortalFx.isFeatureEnabled("oldsanitizer"))return l;for(let n=0,r=i.childNodes,a=r.length;n<a;n++){const i=r[n];switch(i.nodeType){case Node.TEXT_NODE:l.appendChild(document.createTextNode(i.textContent));break;case Node.ELEMENT_NODE:s(i,l);break;case Node.COMMENT_NODE:{const s=h.comments;if(!(!t&&s===o.sanitizeBindingComment)&&s&&s instanceof Function){const t=[],o=s(e,i.textContent,h,t);null!==o&&l.appendChild(document.createComment(o)),t.length>0&&t.forEach((e=>{b.push(e)}))}break}}}return l}(a.body,d),b.forEach((e=>function(e,t){const s=f[e.reason]||"Unknown";i.log(e.provenanceContext,t,"Sanitization error found: "+s,{Tag:e.tag,Attribute:e.attr,Binding:e.binding,Value:e.val})}(e,s)));let _=d.innerHTML;return p.forEach((e=>{_=M(_,u+e,e)})),{sanitizedMarkup:_,errors:b}}f[1]="Invalid attribute",f[2]="Invalid CSS class name",f[3]="Invalid CSS property",f[4]="Invalid tag",f[5]="Unknown or prohibited binding",f[6]="Invalid binding value";class b{constructor(e){this._allowKnockoutBindings=e,this._templateCache=new a.LruMap(100),this.executionCount=0}sanitize(e,t=2){const s=e.value||"";return this._templateCache.getOrAdd(s,(()=>(this.executionCount++,x(e,this._allowKnockoutBindings,t))))}}t.TemplateSanitizer=b;let v=class extends b{constructor(){super(!0)}};v=__decorate([__metadata("fx:diagnostics",[e,"KOAllowedTemplateSanitizer"]),s.Class(),__metadata("design:paramtypes",[])],v),t.KOAllowedTemplateSanitizer=v;let y=class extends b{constructor(){super(!1)}};function M(e,t,s){if(!e)return e;const i=new RegExp("(\\s+)"+t+"(\\s*\\=)","g");return e.replace(i,"$1"+s+"$2")}function I(e,t){const s={};return s[u+e]=t,s}y=__decorate([__metadata("fx:diagnostics",[e,"KODeniedTemplateSanitizer"]),s.Class(),__metadata("design:paramtypes",[])],y),t.KODeniedTemplateSanitizer=y,t.sanitizeHTML=function(e,t,i,o){return s.container.get(v).sanitize({value:e,localRequire:t,windowContext:i,diContainer:s.container},o)}})),
define("MsPortalImpl/Controls/ControlBindings",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.controlBindingMap=void 0;const s=ko.bindingHandlers;function i(e,s){t.controlBindingMap[e]=s}t.controlBindingMap={},i(127,"pcAccordion"),i(20,"pcArtifactLinks"),i(106,"pcAsyncFileUpload"),i(16,"pcAttachment"),i(63,"pcChart"),i(7,"pcCheckBoxField"),i(208,"pcClipboardButton"),i(75,"pcConsole"),i(40,"pcCopyableLabel"),i(85,"pcCreatorAndSelectorV2"),i(23,"pcCustomHtmlField"),i(91,"pcCustomValueSlider"),i(111,"pcCustomRangeSlider"),i(25,"pcDatePickerField"),i(26,"pcDateTimePickerField"),i(27,"pcDateTimeRangePickerField"),i(92,"pcDayPickerField"),i(76,"pcDeleteAssetConfirmation"),i(33,"pcDiffEditor"),i(32,"pcDockedBalloon"),i(65,"pcDonut"),i(3,"pcDropDownField"),i(99,"pcDurationPickerField"),i(15,"pcSection"),i(37,"pcEditor"),i(120,"pcEssentials"),i(82,"pcFileDownloadButton"),i(12,"pcFilterComboField"),i(67,"pcGraph"),i(125,"pcEditableGrid"),i(130,"pcArrayGrid"),i(131,"pcDataGrid"),i(132,"pcPagedDataGrid"),i(133,"pcSequentialDataGrid"),i(98,"pcGroupDropDownField"),i(77,"pcHeroBanner"),i(19,"pcHistory"),i(84,"pcHotSpot"),i(108,"pcIFrame"),i(113,"pcIFrame2"),i(78,"pcInfoBox"),i(121,"pcIntuneAppFileUpload"),i(118,"pcLegend"),i(88,"pcHotSpot"),i(87,"pcInfoBox"),i(58,"pcLogStream"),i(68,"pcMap"),i(109,"pcMediaPlayer"),i(115,"pcMenu"),i(69,"pcMetrics"),i(126,"pcMonitorChart"),i(126,"pcMonitorChartV2"),i(204,"pcMetricGrid"),i(13,"pcMultiLineTextField"),i(79,"pcNotice"),i(10,"pcNumericTextBoxField"),i(29,"pcOAuthButtonField"),i(4,"pcOptionsGroupField"),i(209,"pcPager"),i(212,"pcPager2"),i(70,"pcPairedTimeline"),i(94,"pcPairedTimelineBadges"),i(5,"pcPasswordField"),i(39,"pcCheckBox"),i(42,"pcDropDown"),i(43,"pcFilterCombo"),i(54,"pcGrid"),i(56,"pcObsoleteListView1"),i(110,"pcMarkdown"),i(45,"pcMultiLineTextBox"),i(46,"pcMultiselectDropDown"),i(47,"pcNumericTextBox"),i(48,"pcOptionPicker"),i(49,"pcPassword"),i(50,"pcRangeSlider"),i(52,"pcSlider"),i(57,"pcTreeView"),i(112,"pcPartPinner"),i(128,"pcPill"),i(129,"pcPillCollection"),i(123,"pcPillList"),i(89,"pcPreviewTag"),i(71,"pcProgressBar"),i(72,"pcQuotaGauge"),i(9,"pcRangeSliderField"),i(93,"pcSearchBox"),i(86,"pcRangeSelection"),i(114,"pcResourceFilter"),i(1,"pcFormSection"),i(11,"pcSelectorField"),i(100,"pcSimpleButton"),i(206,"pcRecommendations"),i(97,"pcChart"),i(73,"pcSingleValueGauge"),i(6,"pcSliderField"),i(95,"pcSpecComparisonTable"),i(21,"pcSplitter"),i(207,"pcSplitter2"),i(134,"pcSummary"),i(135,"pcPricingControl"),i(124,"pcResourceDropDown"),i(136,"pcTagsByResource"),i(101,"pcTextBlock"),i(2,"pcTextField"),i(24,"pcTimePickerField"),i(62,"pcToolbar"),i(22,"pcTriStateCheckBox"),i(116,"pcVideo"),i(107,"pcWizard"),i(119,"pcHeatMap"),i(137,"pcArmErrorList"),i(138,"pcDocsControl"),i(201,"pcFileShareDropDown"),i(202,"pcStorageAccountDropDown"),i(205,"pcToggle"),i(104,"pcList2"),i(203,"pcBlobContainerDropDown"),i(210,"pcManagementGroupDropDown"),i(211,"pcTabMenu");const o={};function n(e,t,i){const o=ko.unwrap(e());if(o){const e=t[o.controlType];if(!e)throw new Error(`Unsupported ControlType in formControl binding handler: ${o.controlType}. Extension: ${i.$extensionName} ContentName: ${i.$partName}`);return s[e]}}function r(e,t,s,i,o,r){const a=n(t,r,o);if(a){const n=$(e);return n.attr("data-formelement",n.attr("data-bind")),a.init(e,t,s,i,o)}}function a(e,t,s,i,o,r){if(e){const a=n(t,r,o);if(a)return a.update(e,t,s,i,o)}}[127,20,16,7,208,85,23,91,111,25,26,27,92,138,3,99,15,120,201,12,98,124,19,108,113,110,13,8,10,29,4,112,5,128,129,123,135,89,9,1,11,6,21,207,202,134,136,2,24,22,210].forEach((e=>o[e]=t.controlBindingMap[e])),s.pcControl={init:function(e,s,i,o,n){return r(e,s,i,o,n,t.controlBindingMap)},update:function(e,s,i,o,n){return a(e,s,i,o,n,t.controlBindingMap)}},s.formElement={init:function(e,t,s,i,n){return r(e,t,s,i,n,o)},update:function(e,t,s,i,n){return a(e,t,s,i,n,o)}}})),
define("Viva.Controls/Controls/Base/Viva.KnockoutExtensions",["require","exports","MsPortalImpl.Controls/Controls/Base/WidgetBinding"],(function(e,t,s){"use strict";var i;return function(e){const t=ko.bindingHandlers;function i(e){return(s,i,o,n,r)=>{const a=ko.unwrap(i());let l,d,c,p;if(a&&(l=a.text,d=a.visible,c=a.disabled,p=a.handler),!(a&&l&&d&&c&&p&&a.execute))throw new Error("Command");let u=t.text[e];u&&u(s,(()=>l),o,n,r),u=t.value[e],u&&u(s,(()=>l),o,n,r),u=t.visible[e],u&&u(s,(()=>d),o,n,r),u=t.disable[e],u&&u(s,(()=>{const e=c()||ko.unwrap(r.$disabled||!1),t=p(),i=!!t&&t.canExecute(),o=e||!i;return s&&$(s).toggleClass("azc-command-disabled",o),o}),o,n,r),u=t.click[e],u&&u(s,(()=>()=>{const e=p();e&&!c()&&e.canExecute()&&a.execute()}),o,n,r)}}t.azcCommand={init:i("init"),update:i("update")},t.stopBindings={init:function(e,t,s,i){return{controlsDescendantBindings:ko.unwrap(t())}}};const o="__ko__disableAutoDispose",n=ko.utils.domNodeIsAttachedToDocument;function r(e){const t=s.createIsolatedContext(e.$data,e);return t.createChildContext=function(t,i){return s.createIsolatedContext(t,e)},t}ko.utils.domNodeIsAttachedToDocument=function(e){return!!$(e).data(o)||n.call(this,e)},t.disableAutoDispose={init:(e,t,s)=>{$(e).data(o,!0)}},t.privateTemplate={init:function(e,s,i,o,n){return t.template.init(e,s,i,o,r(n))},update:function(e,s,i,o,n){return t.template.update(e,s,i,o,r(n))}};const a={};t.vivaControl={registerCallback:function(e){const t=MsPortalFx.getUniqueId();return a[t]=e,t},unregisterGuid:function(e){delete a[e]},init:function(e,s,i,o,n){const r=ko.unwrap(s()),l=a[r];return ko.utils.domNodeDisposal.addDisposeCallback(e,(function(){const e=l().ltm;t.vivaControl.unregisterGuid(r),MsPortalFx.disposeDisposable(e)})),t.privateTemplate.init(e,l,i,o,n)},update:function(e,s,i,o,n){const r=ko.unwrap(s()),l=a[r];return t.privateTemplate.update(e,l,i,o,n)}}}(i||(i={})),i})),
define("Viva.Controls/Util/Viva.Util.Private",["require","exports"],(function(e,t){"use strict";var s;return function(e){let t,s=null;const i=window;e.DataTransfer2=class{constructor(e){this._prefixCode=";;;",this._dataTransfer=e}get dropEffect(){return this._dataTransfer.dropEffect}set dropEffect(e){if("none"!==e&&"copy"!==e&&"link"!==e&&"move"!==e)throw new Error("Drop effect must be either none, copy, link, or move.");this._dataTransfer.dropEffect=e}get effectAllowed(){return this._dataTransfer.effectAllowed}set effectAllowed(e){if("none"!==e&&"copy"!==e&&"copyLink"!==e&&"copyMove"!==e&&"link"!==e&&"linkMove"!==e&&"move"!==e&&"all"!==e&&"uninitialized"!==e)throw new Error("Effect allowed must be either none, copy, copyLink, copyMove, link, linkMove, move, all, or uninitialized.");this._dataTransfer.effectAllowed=e}get types(){let e,i,o,n=this._dataTransfer.types;if(null===s&&this.getData(""),s){i=this._getLegacyData();const e=Object.keys(i).some((e=>""!==i[e]));return Object.keys(e?i:t)}if(n&&!n.forEach)for(o=n,n=[],e=0;e<o.length;e++)n.push(o[e]);return n}get files(){return this._dataTransfer.files}static isLegacyDataTransfer(){if(null===s){return!(i.DataTransfer||i.Clipboard).prototype.setDragImage}return s}setDragImage(e,t,s){this._dataTransfer.setDragImage&&this._dataTransfer.setDragImage(e,t,s)}addElement(e){this._dataTransfer.addElement&&this._dataTransfer.addElement(e)}getData(e){if(this._checkFormat(e),s)return this._getLegacyDataTransfer(e);try{return s=!1,this._dataTransfer.getData(e)}catch(t){return s=!0,this.getData(e)}}setData(e,t){if(this._checkFormat(e),s)this._setLegacyDataTransfer(e,t);else try{s=!1,this._dataTransfer.setData(e,t)}catch(i){s=!0,this.setData(e,t)}}clearData(e){if(this._checkFormat(e),s)this._clearLegacyDataTransfer(e);else try{s=!1,this._dataTransfer.clearData(e)}catch(t){s=!0,this.clearData(e)}}_checkFormat(e){if(e&&e.toLowerCase()!==e)throw new Error("Format must be in lowercase.")}_getLegacyData(){const e=this._dataTransfer.getData("Text");return e&&e.slice(0,this._prefixCode.length)===this._prefixCode?JSON.parse(e.slice(this._prefixCode.length)):{Text:e}}_stringifyLegacyData(e){return this._prefixCode+JSON.stringify(e)}_getLegacyDataTransfer(e){return this._getLegacyData()[e]||""}_setLegacyDataTransfer(e,s){const i=this._getLegacyData();i[e]=s,t=i,this._dataTransfer.setData("Text",this._stringifyLegacyData(i))}_clearLegacyDataTransfer(e){if(t={},e){const s=this._getLegacyData();delete s[e],t=s}this._dataTransfer.setData("Text",this._stringifyLegacyData(t))}},document.addEventListener("dragend",(function(){t={}}),!1)}(s||(s={})),s})),
define("Viva.Controls/Util/Viva.Util",["require","exports","Viva.Controls/Util/Viva.Util.Private"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataTransfer=t.setClassList=t.getClassList=t.DOMTokenListShim=t.existsOrRegisterId=t.fillObserableFields=t.cloneEvent=t.setFocusToFirstFocusableChild=t.shapeContains=t.getObjectBasicShape=t.executeSetFocusOn=t.findContainingControl=t.getScrollableParents=t.forceScreenRead=void 0;var i=MsPortalFx.isNullOrUndefined;function o(e){let t;return!(!$(e).attr("data-canfocus")||(t=e["data-canfocus"],!t))&&t()}function n(e,t,s){let n,r,a,l=0;do{if(n=null,a=e.find(t+":eq("+l+")"),a.length>0&&(n=a[0],r=s(n),r&&o(n)))return!0;l++}while(!i(n));return!1}t.forceScreenRead=function(e,t){let s,i;switch(e.tagName){case"TABLE":s="tr";break;case"TR":s="td";break;case"UL":s="li";break;default:s="span"}t&&(i=e.getAttribute("aria-live"),e.setAttribute("aria-live","assertive"));const o=FxImpl.createElement(s);e.appendChild(o),e.removeChild(o),t&&(i?e.setAttribute("aria-live",i):e.removeAttribute("aria-live"))},t.getScrollableParents=function(e,t){let s=e.parents().filter((function(e,t){const s=$(t),i=s.css("overflow-x"),o=s.css("overflow-y");return!("hidden"===i&&"hidden"===o||"visible"===i&&"visible"===o)}));return t&&(s=s.add(window)),s},t.findContainingControl=function(e){if(e){const t=$(e);let s;if(t.attr("data-control"))return e;if(s=t.closest("[data-control='true']"),s.length>0)return s[0]}return null},t.executeSetFocusOn=o,t.getObjectBasicShape=function(e,t=!0){const s=Object.keys(e);return t?s.sort(((e,t)=>e<t?1:-1)):s},t.shapeContains=function(e,t){if(t.length<=e.length){let s=-1;for(let i=0;i<t.length;i++){const o=t[i];if(s=MsPortalFx.findIndex(e,(e=>e===o),s+1),s<0)return!1}return!0}return!1},t.setFocusToFirstFocusableChild=function(e,t){const s="[data-focus-first='true']",i=":not("+s+")",o="[data-canfocus='true']",r=function(e){return e};let a=!1;return t&&(a=n(e,o+s,t),a||(a=n(e,o+i,t))),a||(a=n(e,o+s,r),a||(a=n(e,o+i,r))),a},t.cloneEvent=function(e,t){const s=t||e.type;return $.Event(e,{type:s,target:e.target,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,metaKey:e.metaKey,currentTarget:e.currentTarget,isImmediatePropagationStopped:e.isImmediatePropagationStopped,isPropagationStopped:e.isPropagationStopped,preventDefault:e.preventDefault,stopImmediatePropagation:e.stopImmediatePropagation,stopPropagation:e.stopPropagation})},t.fillObserableFields=function(e,t,s){const i=s?s.length:0;let o,n,r;for(let a=0;a<i;a++)o=s[a],n=t[o]||ko.observable(),r=e[o],n(ko.isObservable(r)?r.peek():r),t[o]||(t[o]=n)},t.existsOrRegisterId=function(e,t){const s=e.indexOf(t)<0;return s&&e.push(t),!s};class r{constructor(e=null){this._fields=e?e.split(" "):[]}add(e){this._fields.indexOf(e)<0&&this._fields.push(e)}remove(e){for(;this._fields.indexOf(e)>=0;)this._fields.splice(this._fields.indexOf(e),1)}contains(e){return this._fields.indexOf(e)>=0}get length(){return this._fields.length}toggle(e){return this._fields.indexOf(e)>=0?(this.remove(e),!1):(this.add(e),!0)}item(e){return this._fields[e]}toString(){return this._fields.toString()}}t.DOMTokenListShim=r,t.getClassList=function(e){const t=e.getAttribute("class");return t?new r(t):new r},t.setClassList=function(e,t){e.setAttribute("class",t._fields.join(" "))},t.DataTransfer=s.DataTransfer2})),
define("_generated/Less/MsPortalImpl.Controls/Controls/Base.css",["module"],(function(e){"use strict";return{css:".fxc-base-fill-container-width{width:100%}.fxc-base-fill-container-height{height:100%}.fxc-base-loading{position:relative;height:100%}.fxc-base-loading .fxc-base-loadingImage{position:absolute;top:calc(50% - 30px/2);left:calc(50% - 30px/2)}",moduleId:e.id}})),
define("MsPortalImpl.Controls/Controls/Base/Base",["require","exports","Fx/DependencyInjection","Viva.Controls/Util/Viva.Util","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl.Controls/Controls/Base/WidgetBinding","FxInternal/ProxiedObservables","MsPortalImpl/Base/Base.ElementWidgetMap","FxInternal/Css","_generated/Less/MsPortalImpl.Controls/Controls/Base.css","MsPortalImpl/Controls/ControlBindings","MsPortalImpl/UI/Compositions/UI.Composition","Viva.Controls/Controls/Base/Viva.KnockoutExtensions"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.WidgetUIState=t.isViewModelTrusted=t.setTrustedViewModel=t.getWidgets=t.getWidget=void 0;var m=MsPortalFx.Base.Diagnostics.Telemetry;(0,d.injectCss)(c);const g="remove.fxWidget",h="fxs-display-none";function f(e,t){return(t?l.getAllMatch(e[0],t):l.getAll(e[0]))||[]}function x(e){return!!e._isTrusted}t.getWidget=function(e,t){return MsPortalFx.first(f(e,t))||null},t.getWidgets=f,t.setTrustedViewModel=function(e){return e._isTrusted=!0,e},t.isViewModelTrusted=x;t.WidgetUIState=class{constructor(){this.tabIndex=ko.observable(0),this.disabled=ko.observable(!1),this._ltm=new FxImpl.TriggerableLifetimeManager}dispose(){this._ltm.dispose()}};t.Widget=class{constructor(t,i,d={},c){if(this._destroyIds=[],this._cssClassMap={},!t||!t.length)throw new Error("You must specify an element to associate a control to it. Your element is either null or an empty collection.");(0,a.setPoUndefined)(this),this.isTrusted=d.isTrusted||x(i),this.element=t,this.vm=i,this.state=c;const p=this.weaveContext=d.weaveContext,u=this.ltm=new FxImpl.TriggerableLifetimeManager;this.vmBasicOption={ltm:u},c&&u.registerForDispose(c),this._bindingContext=p?null:d.bindingContext;const m=p?null:this._bindingContext||r.contextFor(t);this._diContainer=d.diContainer||p&&p.diContainer||m&&m.$dicontainer||s.container,l.set(t[0],this);const g=i.controlType;if(0!==g&&94!==g){let e;const s=t.attr("data-bind")||"";if(s.length&&s.indexOf("visible")>=0){e=(ko.expressionRewriting.parseObjectLiteral(s)||[]).some((e=>"visible"===e.key))}if(!e){const e=i.visible;e&&e.subscribeAndRun(this.ltm,(e=>{MsPortalFx.isNullOrUndefined(e)||t.toggleClass(h,!e)}))}}const f=i&&i.cssClass;f&&f.subscribeAndRun(u,(s=>{s=s||"";const i=this._cssClassMap;this._cssClassMap={},s.split(/\s+/).forEach((s=>{s&&(this.isTrusted||n.isAllowedCssClassName(s)?(this._cssClassMap[s]=s,delete i[s]):(0,o.logToExtension)(e,t,2,`Invalid control css class name: ${s}`))}));const r=Object.keys(i);r.length&&this.element.removeClass(r.join(" "));const a=Object.keys(this._cssClassMap);a.length&&this.element.addClass(a.join(" "))})),this._registerDispose(),MsPortalFx.isFeatureEnabled("controlstelemetry")&&0!==g&&(this._initializeTelemetry(),this._attachTelemetryEvents(),this._trace({action:"ControlInitialized"}))}isDisposed(){return this._destroyIds.length>0}dispose(){if(this._checkExistsOrRegisterDestroyId(null))return;this.ltm&&this.ltm.dispose();const e=this.element;e.removeClass(`fxs-display-none ${Object.keys(this._cssClassMap).join(" ")}`),l.remove(e[0],this),this._disposeCallback&&(this._unregisterDispose(),this._disposeCallback=null)}_checkExistsOrRegisterDestroyId(e){return i.existsOrRegisterId(this._destroyIds,e)}_cleanDescendants(){ko.utils.cleanDescendantNodes(this.element)}_cleanElement(...e){const t=this.element;this.weaveContext||this._cleanDescendants(),e.length&&t.removeClass(e.join(" ")),this.weaveContext||t.empty()}_registerDispose(){const e=this.element;this._bindingContext?ko.utils.domNodeDisposal.addDisposeCallback(e[0],this._disposeCallback=e=>{this.dispose()}):e.on(g,this._disposeCallback=t=>{t.target!==e[0]||this._destroyTriggered||(this._destroyTriggered=!0,this.dispose())})}_unregisterDispose(){const e=this.element,t=this._disposeCallback;this._bindingContext?ko.utils.domNodeDisposal.removeDisposeCallback(e[0],t):e.off(g,t)}_trace(e){this._telemetryInfo||this._initializeTelemetry();const t=ko.unwrap(this.vm.telemetryName);m.trace({source:this._telemetryInfo.telemetrySource,extension:this._telemetryInfo.extensionName,name:t||FxImpl.Po.getMetadataId(this.vm),action:e.action,actionModifier:e.actionModifier,data:Object.assign({controlType:this._telemetryInfo.controlType,vmKind:this._telemetryInfo.vmKind},e.data),lowPriority:!0})}_startTrace(e){this._telemetryInfo||this._initializeTelemetry();const t=ko.unwrap(this.vm.telemetryName);return m.startTrace({source:this._telemetryInfo.telemetrySource,extension:this._telemetryInfo.extensionName,name:t||FxImpl.Po.getMetadataId(this.vm),action:e.action,actionModifier:e.actionModifier,data:Object.assign({controlType:this._telemetryInfo.controlType,vmKind:this._telemetryInfo.vmKind},e.data),lowPriority:!0})}_initializeTelemetry(e){const t=this.vm.controlType,s=this.element.closest(".fxs-blade")[0],i=s&&$.data(s,u.CompositionInstanceDataName),o=i&&i.locator,n=o&&o.toFriendlyString(),r=o&&o.getExtensionName(),a=p.controlBindingMap[t]||t||"UNKNOWN",l=this.vm.vmKind||"INVALID";this._telemetryInfo={telemetrySource:n,extensionName:r,controlType:a,vmKind:l}}_attachTelemetryEvents(){const e=this.element,t=()=>{this._trace({action:"ControlClicked",actionModifier:"click"})},s=()=>{this._focusTrace&&(m.cancelTrace(this._focusTrace),this._focusTrace=null),this._focusTrace=this._startTrace({action:"ControlFocused",actionModifier:"focusout"}),this._trace({action:"ControlFocused",actionModifier:"focusin"})},i=()=>{this._focusTrace?(m.endTrace(this._focusTrace,"focusout"),this._focusTrace=null):this._trace({action:"ControlFocused",actionModifier:"focusout"})};e.on("focusin",s),e.on("focusout",i),e.get(0).addEventListener("click",t,!0),this.ltm.registerForDispose((()=>{e.off("focusin",s),e.off("focusout",i),e.get(0).removeEventListener("click",t,!0),this._focusTrace&&m.cancelTrace(this._focusTrace)}))}}})),
define("MsPortalImpl.Controls/Controls/Base/OptionsBase",["require","exports","MsPortalImpl.Controls/Controls/Base/Base","MsPortalImpl.Controls/Controls/Base/WidgetBinding","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","FxInternal/Weave","FxInternal/Css","_generated/Less/MsPortalImpl.Controls/Controls/Base.css"],(function(e,t,s,i,o,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.isHtmlContent=void 0,(0,r.injectCss)(a);var l=MsPortalFx.Base,d=l.Promises.CancelationToken,c=l.Promises.makeCancelable,p=MsPortalFx.Errors;const u="fxc-base",m="fxc-base-fill-container-width",g="fxc-base-fill-container-height",h=[];t.isHtmlContent=function(e){return e&&!!e.htmlTemplate};class f extends s.Widget{constructor(e,t,s,o){super(e,t,s,o),this._addDisposablesToCleanUp=e=>this.ltm.registerForDispose(e),s=s||{},this._options=t,this._widgets=[],this._waitToken=new d,e.addClass(u);switch(s.fillBehavior||0){case 1:e.addClass(m);break;case 2:e.addClass(g);break;case 3:e.addClass("fxc-base-fill-container-width fxc-base-fill-container-height")}const r=h.length;if(r){h[r-1].push(this)}const a=this.tabindex=this.state?this.state.tabIndex:ko.observable(0),l=this.disabled=this.state?this.state.disabled:ko.observable(!1),c=this.weaveContext,p=c?null:this._bindingContext||i.getContext(e)||{},f=c?(0,n.toObservable)(this.ltm,c.disabled):p.$disabled,x=c?(0,n.toObservable)(this.ltm,c.enabledTabIndex):p.$enabledTabIndex;this.$disabled=i.chainDisabledProperties([f,l,t.disabled]),this.$enabledTabIndex=i.chainEnabledTabIndexProperties([x,a]),this.$tabIndex=i.makeTabIndexProperty(this.$enabledTabIndex,this.$disabled)}dispose(){if(this._checkExistsOrRegisterDestroyId(super.dispose))return;this._waitToken.cancel(new p.DisposedCanceledError),this._widgets&&(this._widgets.forEach((e=>{e&&e.dispose()})),this._widgets=null),this.element.removeClass("fxc-base fxc-base-fill-container-width fxc-base-fill-container-height").removeAttr("role");const e=h.length;if(e){const t=h[e-1];MsPortalFx.remove(t,this)}super.dispose()}get options(){return this._options}widget(){return this.element}get widgets(){return this._widgets}awaitContentRevealed(){return Q(!1)}static beginTracking(e=[]){h.push(e)}static endTracking(){return h.pop()}trigger(e,t,s,i){const o=this.options[e],n=this.element;return s=s||{},(t=t||$.Event(e)).type=e,t.target=i||n[0],n.trigger(t,s),!($.isFunction(o)&&!1===o.apply(n[0],[t].concat(s))||t.isDefaultPrevented())}waitFor(e){return Q(c(e,this._waitToken))}sanitizeTemplate(t){return t&&!this.isTrusted?o.sanitizeHTML(t,e,this.element).sanitizedMarkup:t}_bindDescendants(e={},t){const s=this.options,i=$(t||this.element)[0];ko.utils.extend(e,{data:s});const o=this._createBindingContext(e,s,i);ko.applyBindingsToDescendants(o,i)}_bindElement(e,t){const s=$(t)[0],i=this._createBindingContext(e,e,s);ko.applyBindings(i,s)}_createBindingContext(e,t,s){return i.createChildContext(s,e,{$ctl:this,$vm:t,$disabled:this.$disabled,$enabledTabIndex:this.$enabledTabIndex,$tabIndex:this.$tabIndex,$dicontainer:this._diContainer},this._bindingContext)}_isRtl(){return"rtl"===$.querySelectorAll("html").attr("dir")}}t.Widget=f})),
define("MsPortalImpl.Controls/Controls/ResourceFilterHelper",["require","exports","FxHubs/ResourceManagement","Fx"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLocations=t.getResourceTypes=t.initialize=t.Internal=void 0;var o=MsPortalFx.Base,n=MsPortalFx.Extension.ResourceRoutingType;let r;t.Internal={},t.initialize=function(e){t.Internal.assetTypeService=e},t.getResourceTypes=function(e){let i=[];if(e&&e.length)return i=e.map((e=>({name:e.compositeDisplayName.plural,key:e.resourceType.toLowerCase(),keywords:e.keywords}))),MsPortalFx.stableSort(i,((e,t)=>MsPortalFx.localeCompareIgnoreCase(e.name,t.name)));if(!r){i=(t.Internal.assetTypeService.assetTypes||[]).filter((e=>{const t=e.assetTypeManifest,i=t.resourceType;return 1===t.browseType&&!(0,s.supportsOption)(t.options,1)&&e.lowerCaseResourceType!==o.Constants.ResourceTypes.ResourceGroups.toLowerCase()&&!(i&&(i.routingType===n.Tenant||i.routingType===n.ProviderProxy||i.routingType===n.Extension))})).map((e=>({name:e.compositeDisplayName.plural,key:e.lowerCaseResourceType,keywords:e.assetTypeManifest.keywords&&e.assetTypeManifest.keywords.split(",")}))),r=MsPortalFx.stableSort(i,((e,t)=>MsPortalFx.localeCompareIgnoreCase(e.name,t.name)))}return r},t.getLocations=(0,i.memoizePromise)((()=>Q(MsPortalFx.Azure.getLocations()).then((e=>{const t=(0,i.forEachKey)(e,((e,t,s)=>{s.push({displayName:t,name:e})}),[]);return MsPortalFx.stableSort(t,((e,t)=>MsPortalFx.localeCompareIgnoreCase(e.displayName,t.displayName)))}))))})),
define("MsPortalImpl.Controls/Controls/SimpleButton",["require","exports","Weave/DirectMode","MsPortalImpl.Controls/Controls/Base/OptionsBase","FxInternal/WeaveControls/Button.Component.Internal","FxInternal/Weave"],(function(e,t,s,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.InnerTsxComponent=void 0;const r="fxc-simplebutton";t.InnerTsxComponent=function(e){const t=e.vm;return s(o.ButtonInner,{onClick:t.onClick,text:(0,n.toComputation)(t.text),style:(0,n.toComputation)(t.style),disabled:(0,n.toComputation)(t.disabled),ariaLabel:(0,n.toComputation)(t.ariaLabel),loading:(0,n.toComputation)(t.loading),loadingText:(0,n.toComputation)(t.loadingText),icon:(0,n.toComputation)(t.icon)})};class a extends i.Widget{constructor(e,t,s){super(e,t,s),this.element.addClass(r)}dispose(){this._checkExistsOrRegisterDestroyId(super.dispose)||(this._cleanElement(r),super.dispose())}}t.Widget=a})),
define("MsPortalImpl.Controls/Fields/Base/FormValidation",["require","exports","MsPortalImpl/Base/JQueryHelper"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.focusOnFirstInvalidField=t.performFieldValidation=t.gatherFormFields=t.gatherFormFieldsFromElements=t.markFormFieldElement=t.gridEnableValidation=t.ensureFormFieldValidation=void 0;const i=MsPortalFx.identity;MsPortalFx.Base.Diagnostics.createLog(e);function o(e){e.forEach((e=>{const t=e&&e.rowMetadata;t&&t.editState&&t.editState()&&e.performValidation&&!e.performValidation()&&e.performValidation(!0)}))}t.ensureFormFieldValidation=function(e,t=!0,s=!1){const i=c(e,s),n=i.map((e=>e.field)),r=i.map((e=>e.viewmodel)).filter(MsPortalFx.identity);return t&&o(r),0===n.length?Q(!0):p(n)},t.gridEnableValidation=o;const n="data-validatable",r="field",a="viewmodel",l="widgetviewmodel";function d(e,t,i){return e.filter((e=>{const o=$(e);return e&&e.hasAttribute(n)&&o.closest(".fxs-suppresschildvalidation").length<1&&o.data(r)&&(!t||t(e))&&(i||s.isElementVisible(e))})).map((e=>{const t=$(e);return{viewmodel:t.data(a),widgetviewmodel:t.data(l),field:t.data(r)}}))}function c(e,t=!1,s){return e.length?d(e.find("[data-validatable]").toArray(),(e=>$(e).data(r)&&(!s||s(e))),t):[]}function p(e){const t=[];return e.filter((e=>e.triggerValidation)).map((e=>{t.push(e.triggerValidation())})),Q.all(t).then((e=>e.every(i)))}t.markFormFieldElement=function(e,t,s,i){const o=$(e);o.attr(n,"true"),o.data(r,i),o.data(a,t),o.data(l,s);const d=(!!i.fieldsData?o.parent():o).closest(".fxs-validationContainer");let p;if(d.length&&d.hasClass("fxs-part-content")){const t=d.parent(),s=ko.dataFor(t[0]),i=s&&s.context;p=i&&i.validateElements,p&&p.push(e)}else if(d.length){const e=d.data(r);e&&e.fieldsData&&e.fieldsData(c(d,!0))}i.ltm.registerForDispose((()=>{p&&p.remove(e),o.data(r,null),o.data(a,null),o.data(l,null)}))},t.gatherFormFieldsFromElements=d,t.gatherFormFields=c,t.performFieldValidation=p,t.focusOnFirstInvalidField=function(e){e.findByClassName("fxs-bg-error").eq(0).closest("[data-validatable='true']").findByClassName("azc-input").eq(0).focus()}})),
define("MsPortalImpl/AzFramework/AzBladeViewModel",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileViewModel=t.BladeViewModel=void 0;class s{constructor(){this._initializedPromiseDeferred=Q.defer(),this._onInputsSetCalledDeferred=Q.defer()}hookOnInputsSet(e){return this._initializedPromiseDeferred.resolve(e),this._onInputsSetCalledDeferred.promise}onInputsSet(e){return this._onInputsSetCalledDeferred.resolve({parameters:e.parameters}),this._initializedPromiseDeferred.promise.then((e=>e))}}t.BladeViewModel=class extends s{constructor(e){super(),this.title=ko.observable(),this.subtitle=ko.observable(),this.icon=ko.observable(),this.statusBar=ko.observable(),this.menuContent={title:ko.observable(),subtitle:ko.observable()},this._onPinHandler=ko.observable(),this._msPortalFxV2ShellApi=ko.computed(e,(()=>({onPin:this._onPinHandler()})))}setOnPinHandler(e){this._onPinHandler(e)}};t.TileViewModel=class extends s{constructor(e){super(),this._container=e,this.onClick=ko.observable()}setOnClickHandler(e){this.onClick(e)}setUpdatableHeaderHandler(e,t){this._container.updatableHeader.enableForExtensionRenderedHeader((t=>{e(t)}),t)}}})),
define("MsPortalImpl/Extension/CachedManifestClient",["require","exports","Fx/DependencyInjection"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CachedManifestClient=void 0;var i=MsPortalFx.Base;const o=i.Diagnostics.createLog(e);class n{constructor(e,t){this.getManifests=t=>{const s="assetTypes"===t?Q(e):function(e){return Q(MsPortalEarly.getCachedManifestUri(e)).then((e=>e?i.Net2.ajax({uri:e,performRetry:!0,type:"GET",dataType:"json",contentType:"application/json",useRawAjax:!0}).catch((e=>(o.error(e),null))):{manifestResponse:{}}))}(t);return s.then((e=>e.manifest||{}))},this.getMetadata=()=>t}static create(){return Q(MsPortalEarly.manifestCachePromise).then((e=>{const t={},s=fx.bootParameters.environment.extensionsPageVersion;return Object.keys(s).forEach((i=>{const o=e.manifest[i]||{},n=MsPortalEarly.pickExtensionStamp(s[i]).split("/");o.pageVersion=n[0],o.prewarmerScript=n[1]&&[n[1],null],t[i]=o})),new n({manifest:t},e.metadata)})).catch((e=>{throw MsPortalEarly.navigateError("NoExtensions",[["stack",encodeURIComponent(e&&e.stack).slice(0,1e3)]]),e}))}}__decorate([__metadata("fx:diagnostics",[e,"CachedManifestClient"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",Promise)],n,"create",null),t.CachedManifestClient=n})),
define("MsPortalImpl/Extension/Extension.DefinitionValidator",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validatePartType=t.validateBlade=t.validateIsArray=t.validateIsBoolean=t.validateIsString=t.validateDefinition=t.ValidationResult=void 0;var s=MsPortalFx.Extension.SetRequirement;function i(e,t){MsPortalFx.forEachKey(e,((e,s)=>{void 0!==s&&t(e,s)}))}function o(e,t,s){"string"!=typeof t&&s.push("{0} is not a valid string.".format(e))}function n(e,t,s){"boolean"!=typeof t&&s.push("{0} is not a valid boolean.".format(e))}function r(e,t,s){const i=Array.isArray(t);return i||s.push("The '{0}' property is not a valid array.".format(e)),i}function a(e,t,s,i){const o=t.name;t.inputs&&r("Blade: {0}. Property: blades[{1}].inputs".format(o,s),t.inputs,i),t.optionalInputs&&r("Blade: {0}. Property: blades[{1}].optionalInputs".format(o,s),t.optionalInputs,i),r("Blade: {0}. Property: blades[{1}].lenses".format(o,s),t.lenses,i)&&t.lenses.forEach(((e,t)=>{const n="Blade: {0}. Lens: {1}. Property: blades[{2}].lenses[{3}].".format(o,e.name,s,t);e.partInstances&&r(n,e.partInstances,i)&&e.partInstances.forEach(((n,r)=>{c("Blade: {0}. Lens: {1}. Part: {2}. Property: blades[{3}].lenses[{4}].partInstances[{5}]".format(o,e.name,n.name,s,t,r),n,i)}))})),t.permissions&&r("Blade: {0}. Property: blades[{1}].permissions".format(o,s),t.permissions,i)&&t.permissions.forEach(((e,t)=>{d("Blade: {0}. Property: blades[{1}].permissions[{2}]".format(o,s,t),e,i)})),function(e,t,s){if(!e)return;e.source?l(e.source,t+".source",s):s.push("Source not specified for toolbar. "+t)}(t.toolbar,"Blade: {0}. Property: blades[{1}].toolbar".format(o,s),i),function(e,t,s){e&&e.source&&l(e.source,t+".source",s)}(t.actionBar,"Blade: {0}. Property: blades[{1}].actionBar".format(o,s),i)}function l(e,t,s){e.property&&o(t+".property",e.property,s),e.optional&&"boolean"!=typeof e.optional&&s.push("The attribute 'optional' should be of type boolean. "+t),e.isIdentityInput&&"boolean"!=typeof e.isIdentityInput&&s.push("The attribute 'isIdentityInput' should be of type boolean. "+t),r(t+".valuesFrom",e.valuesFrom,s)&&e.valuesFrom.forEach(((e,i)=>{!function(e,t,s){switch(t.referenceType){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:break;default:s.push("Unknown reference type '{0}' found for {1}.referenceType.".format(t.referenceType,e))}o(e+".property",t.property,s),t.part&&o(e+".part",t.part,s)}(t+".valuesFrom[{0}]".format(i),e,s)}))}function d(e,t,i){switch(t.permissionType){case 0:{const s=t;s.extensionName&&o(e+".extensionName",s.extensionName,i),o(e+".assetType",s.assetType,i),s.assetId?function(e,t,s){switch(t.sourceType){case 0:t.providerKey&&s.push("Asset ID source source type of FromInput with provider key (should be null) found for {0}.sourceType.".format(e));break;case 1:t.providerKey||s.push("Asset ID source source type of FromProvider with missing provider key found for {0}.sourceType.".format(e)),o(e+".providerKey",t.providerKey,s);break;case 2:t.providerKey||s.push("Asset ID source source type of FromSourceProvider with missing provider key found for {0}.sourceType.".format(e)),o(e+".providerKey",t.providerKey,s);break;default:s.push("Unknown asset ID source source type '{0}' found for {1}.sourceType.".format(t.sourceType,e))}o(e+".property",t.property,s)}(e+".assetId",s.assetId,i):i.push("Permission missing assetId found for {0}.assetId.".format(e)),o(e+".action",s.action,i);break}case 1:{const o=t;switch(o.requirement){case s.All:case s.Any:break;default:i.push("Unknown permission set requirement '{0}' found for {1}.requirement.".format(o.requirement,e))}r(e+".permissions",o.permissions,i)&&o.permissions.forEach(((t,s)=>{d("{0}.permissions[{1}]".format(e,s),t,i)}));break}default:i.push("Unknown permission type '{0}' found for {1}.permissionType.".format(t.permissionType,e))}}function c(e,t,s){t.reference||t.inline?t.reference&&t.inline?s.push("'reference' and 'inline' properties cannot be set at the same time on PartInstanceDefinition. Property: {0}".format(e)):t.reference&&!t.reference.partTypeName?s.push("'partTypeName' property is required on part reference. Property: {0}".format(e)):t.inline&&p(e,t.inline,s):s.push("'reference' or 'inline' property required on PartInstanceDefinition. Property: {0}".format(e))}function p(e,t,s){t&&(!function(e,t,s){if(!t)return;const i=t.inputIdentityProperties||[],o=t.sharedProperties||[],n=i.concat(o.map((e=>e.property))),r=o.map((e=>e.key)),a=u(n),l=u(r);a&&a.length>0&&s.push("Part view model properties cannot be used in multiple part settings. Duplicated properties: '{0}'. Path: '{1}'.".format(JSON.stringify(a),e));l&&l.length>0&&s.push("Shared key settings cannot be used in multiple part settings. Duplicated keys: '{0}'. Path: '{1}'.".format(JSON.stringify(l),e))}(e,t.partState,s),t.permissions&&r("{0}.permissions".format(e),t.permissions,s)&&t.permissions.forEach(((t,i)=>{d("{0}.permissions[{1}]".format(e,i),t,s)})))}function u(e){const t={},s=[];return(e||[]).forEach((e=>{t[e]&&s.push(e),t[e]=!0})),s}function m(e,t){e.inputDefinitions&&r("PartType: {0}. Property: inputDefinitions".format(e.name),e.inputDefinitions,t),e.reference&&function(e,t){(e.reference.bindings||[]).forEach((s=>{(s.valuesFrom||[]).forEach((s=>{7!==s.referenceType&&9!==s.referenceType&&5!==s.referenceType&&t.push("Adapted Part: {0} can only have Adapter, AdapterInput and Constant bindings for its referenced part.".format(e.name))}))}))}(e,t),p("PartType: {0}".format(e.name),e,t)}t.ValidationResult=class{constructor(){this.errors=[]}valid(){return!this.errors.length}},t.validateDefinition=function(e,t){return t=t||[],e?i(e,((s,l)=>{switch(s){case"name":o("Extension name",l,t);break;case"version":case"hash":case"schemaVersion":case"sdkVersion":case"buildDescription":o(s,l,t);break;case"isPreview":n(s,l,t);break;case"assetTypes":r(s,l,t);break;case"blades":!function(e,t,s){t&&r("blades",t,s)&&t.forEach(((t,i)=>{a(e,t,i,s)}))}(e,l,t);break;case"startBoardParts":!function(e,t){r("startBoardParts",e,t)&&e.forEach(((e,s)=>{c("startBoardParts[{0}]".format(s),e,t)}))}(l,t);break;case"partsCatalog":!function(e,t){if(!e)return;r("partsCatalog",e,t)&&e.forEach((e=>{m(e,t)}))}(l,t);break;case"commandsCatalog":!function(e,t){if(!e)return;r("commandsCatalog",e,t)&&e.forEach((e=>{const s="Commands in 'commandsCatalog' ";e.name||t.push(`${s}must have names.`),e.reference&&t.push(`${s}cannot specify a 'reference' property.`)}))}(l,t);break;case"commandGroups":!function(e,t){if(!e)return;r("commandGroups",e,t)&&MsPortalFx.mapMany(e,(e=>e.commands)).forEach((e=>{e.reference&&function(e,t){if(!e||!e.reference)return;let s=!1;i(e,(e=>{"name"!==e&&"bindings"!==e&&"reference"!==e&&(s=!0)})),s?t.push("Command reference can only define 'name' and 'bindings' properties. Definition: {0}".format(ko.toJSON(e))):e.reference.commandType||t.push("Command reference must specify the 'commandType' property. Definition: {0}".format(ko.toJSON(e)))}(e,t)}))}(l,t);break;case"htmlTemplates":!function(e,t){i(e,((e,s)=>{"string"!=typeof s&&(o("htmlTemplates['{0}'].file".format(e),s.file,t),o("htmlTemplates['{0}'].content".format(e),s.content,t))}))}(l,t);break;case"styleSheets":!function(e,t){Array.isArray(e)?e.forEach(((e,s)=>{o("StyleSheet at position {0}".format(s),e,t)})):t.push("Invalid type for 'styleSheets' property on definition.")}(l,t);break;case"galleryService":case"bladeMap":case"partTypeMap":case"requireConfig":case"dashboardProvider":break;default:t.push("Unexpected attribute '{0}' on definition.".format(s))}})):t.push("Definition is null or undefined."),!t.length},t.validateIsString=o,t.validateIsBoolean=n,t.validateIsArray=r,t.validateBlade=a,t.validatePartType=m})),
define("MsPortalImpl/Extension/ExtensionManagerOptions",["require","exports","FxInternal/AsyncLoader","Fx/DependencyInjection","MsPortalImpl/Extension/CachedManifestClient"],(function(e,t,s,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.postBoot=t.getCatalogApiCacheContent=t.listTestExtensions=t.unregisterTestExtensions=t.registerTestExtensions=t.getExtensionRegistration=t.PostBootCache=t.ExtensionManagerOptions=t.TestExtensionsSource=void 0;const n=fx.environment,r=/\{extName\}/g,a=/\{envSuffix\}/g,l=/\{0\}/g,d="feature.canmodifyextensions=true";function c(e,t,s,i){return e.replace(r,t).replace(a,i?MsPortalEarly.hostingServiceSuffix:"").replace(l,s||"")}function p(e,t,s){const i=!e.isEnabled("disableextensions"),o=[],r={};return t.forEach((t=>{if(r[t.name])return;r[t.name]=!0;const a=t.name.toLowerCase(),d=(/^[\w\-]+$/.exec(e.getValue(a)||"")||[""])[0];let p=d||i&&!(1&t.flags)&&!s.includes(t.name);if("false"===d&&(p=!1),p){const s="true"!==d&&"false"!==d?d:"",i=e.getValue(a+"_urlredirect"),r="string"==typeof i&&/^[a-z0-9]+$/i.test(i)?i:null,p=function(e){return void 0!==e.hostingServiceName}(t)?function(e,t,s){const i=s||e.hostingServiceName,o=16&e.flags?n.hostingServiceConfiguration.thirdParty:n.hostingServiceConfiguration.default,r=c(o.uriFormat,i,t,!0),a=o.prewarmUriFormats.map((e=>c(e,i,"",!0))),l=a.filter((e=>!MsPortalEarly.blockedHosts.includes(new URL(e).hostname))),d=l.length>0?l[0]:a[0],p=c(o.uriFormat,i,"",!1),u=(o.baseDomains||[]).map((e=>c(e,i,t,!0))),m=!s&&!t;return{name:e.name,flags:e.flags,redirectTo:e.redirectTo,uri:r,prewarmUri:d,homePageUri:p,baseDomains:u,isTestExtension:!1,stamp:t,useBootProvidedVersion:m,isSideloaded:e.missingCachedManifest||!m,azBaseUri:e.azBaseUri,serviceTreeId:e.serviceTreeId}}(t,s,r):function(e,t){const s=t&&e.uriFormat?e.uriFormat.replace(l,t):e.uri,i=e.azExtension?256:0,o=!e.isTestExtension&&!t;return{name:e.name,flags:e.flags|i,redirectTo:e.redirectTo,uri:s,prewarmUri:s,homePageUri:s,baseDomains:[],isTestExtension:e.isTestExtension,stamp:t,useBootProvidedVersion:o,isSideloaded:e.missingCachedManifest||!o,azBaseUri:e.azBaseUri,serviceTreeId:e.serviceTreeId,armResourceId:e.armResourceId}}(t,s);o.push(p)}})),o}class u{constructor(e){this.value=e}static create(e,t){const i=e.isEnabled("canmodifyextensions"),o=()=>Q(t.getAsync(s.get("MsPortalImpl/Extension/ExtensionMetadataSource","ExtensionMetadataSource"))),n=i&&t.getAsync(s.get("MsPortalImpl/Extension/ExtensionPatch","PatchMetadataSource")),r=i&&o().then((e=>e.getCodeComponentsMetadata()));return MsPortalImpl.Extension={registerTestExtension:(e,t)=>o().then((s=>s.registerTestExtension(e,t))),unregisterAll:()=>o().then((e=>e.unregisterAll())),listTestExtensions:()=>o().then((e=>e.listTestExtensions()))},Q.spread([r,n],(e=>new u(e||[])))}}__decorate([__metadata("fx:diagnostics",[e,"TestExtensionsSource"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[FxImpl.Features,i.Container]),__metadata("design:returntype",Promise)],u,"create",null),t.TestExtensionsSource=u;class m{constructor(e,t,s){this._normalizedNameMap={};const i=(e.getValue("disabledextensionredirects")||"").toLowerCase().split(","),o=p(e,t,s||[]),n=FxImpl.partition(o,(e=>e.redirectTo&&!i.includes(e.name.toLowerCase())));this.extensionRedirectMap=MsPortalFx.convertArrayToMap(n[0],(e=>e.name),(e=>e.redirectTo)),this.extensionsAsArray=n[1],this.extensionsAsMap=MsPortalFx.convertArrayToMap(this.extensionsAsArray,(e=>e.name)),this._normalizedNameMap=MsPortalFx.convertArrayToMap(o,(e=>e.name.toLowerCase()),(e=>e.name))}static create(e,t,s){return new m(t,e.value.concat(s.getMetadata()),fx.environment.disabledExtensions)}getNormalizedMetadata(e,t){const s=e?this._normalizedNameMap[e.toLowerCase()]:e;if(t&&!s)throw new Error(`The extension name '${e}' is not valid`);return s&&this.extensionsAsMap[this.resolveExtensionName(s)]}resolveExtensionName(e){return this.extensionRedirectMap[e]||e}}__decorate([__metadata("fx:diagnostics",[e,"ExtensionManagerOptions"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[u,FxImpl.Features,o.CachedManifestClient]),__metadata("design:returntype",m)],m,"create",null),t.ExtensionManagerOptions=m;let g=class{constructor(){this._value={}}get(e){return this._getEntry(e).promise}set(e,t){this._getEntry(e).resolve(t)}_getEntry(e){return this._value[e]||(this._value[e]=FxImpl.defer())}};g=__decorate([__metadata("fx:diagnostics",[e,"PostBootCache"]),i.Class()],g),t.PostBootCache=g,t.getExtensionRegistration=s.defineHandler(FxImpl.Extension.getExtensionRegistrationEndPoint,(e=>{const t=e.diContainer.get(m).extensionsAsMap[e.messageArg];return{baseUri:MsPortalEarly.ExtensionLoader.getUri(t),resourceId:t.armResourceId}})),t.registerTestExtensions=s.defineHandler(FxImpl.Extension.CreateUiDef.registerTestExtensionsEndPoint,(async e=>{const t=await e.diContainer.getAsync(s.get("MsPortalImpl/Extension/ExtensionMetadataSource","ExtensionMetadataSource")),i=e.messageArg.map((e=>t.registerTestExtension(e)));await Promise.all(i);const o=globalThis.location;o.search?o.search=o.search.concat("&"+d):o.search="?"+d})),t.unregisterTestExtensions=s.defineHandler(FxImpl.Extension.CreateUiDef.unregisterTestExtensionsEndPoint,(async e=>{const t=await e.diContainer.getAsync(s.get("MsPortalImpl/Extension/ExtensionMetadataSource","ExtensionMetadataSource")),i=e.messageArg.map((e=>t.unregisterTestExtension(e)));await Promise.all(i),globalThis.location.reload()})),t.listTestExtensions=s.defineHandler(FxImpl.Extension.CreateUiDef.listTestExtensionsEndPoint,(async e=>(await e.diContainer.getAsync(s.get("MsPortalImpl/Extension/ExtensionMetadataSource","ExtensionMetadataSource"))).listTestExtensions())),t.getCatalogApiCacheContent=s.defineHandler(FxImpl.Extension.getCatalogApiCacheContentEndPoint,(()=>Q(MsPortalEarly.manifestCachePromise).then((e=>e.catalogApi)).then((e=>Object.assign({},e))))),t.postBoot=s.defineHandler(FxImpl.Extension.postBootEndPoint,(e=>{e.diContainer.get(g).set(e.messageContext.srcWindowId,e.messageArg)}))})),
define("MsPortalImpl/Extension/Extension.Manifest",["require","exports","Fx/DependencyInjection","FxHubs/ResourceManagement","FxInternal/AsyncLoader","MsPortalImpl/Extension/CachedManifestClient","MsPortalImpl/Extension/Extension.DefinitionValidator","MsPortalImpl/Extension/ExtensionManagerOptions","Fx/Experimentation"],(function(e,t,s,i,o,n,r,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ManifestCache=t.RedirectMap=t.assetRedirectKey=t.bladeRedirectKey=t.partRedirectKey=void 0;var d=MsPortalFx.Extension,c=MsPortalFx.Base.Diagnostics,p=MsPortalFx.isNullOrWhiteSpace,u=(MsPortalFx.Extension.BrowseType,MsPortalFx.Base.Diagnostics.Telemetry);const m=window;function g(e,t,s,i,o){return`[${e}]${t}-${s}-${i}-${o}`.toLowerCase()}function h(e,t){return`${e}-${t}`.toLowerCase()}function f(e,t,s){return`${e}_${t}${s?"."+s:""}`.toLowerCase()}t.partRedirectKey=g,t.bladeRedirectKey=h,t.assetRedirectKey=f;const x=c.createLog(e);function b(e){if(!e)return;const t={hideassettype:1,hideinstances:2,showassettype:4,showinstances:8,disabled:16},s=(e,s,i)=>{if("number"==typeof i)e[s]={options:i};else if("string"==typeof i){let o=0;(i||"").toLowerCase().split(",").forEach((e=>{e=(e||"").trim(),t[e]&&(o|=t[e])})),e[s]={options:o}}},i=(e,t,s)=>{"boolean"==typeof s&&(e[t]?e[t].hideBrowseInfoBox=s:e[t]={hideBrowseInfoBox:s})},o=Object.create(null);return MsPortalFx.forEachKey(e,((e,t)=>{t&&(s(o,e,t.options),i(o,e,t.hidebrowseinfobox),t.kinds&&(o[e]=o[e]||Object.create(null),o[e].kinds=Object.create(null),MsPortalFx.forEachKey(t.kinds,((t,n)=>{n&&(s(o[e].kinds,t,n.options),i(o[e].kinds,t,n.hidebrowseinfobox))}))),t.featureCardOptions&&(o[e]=o[e]||Object.create(null),o[e].featureCardOptions=t.featureCardOptions))})),o}let v=class{constructor(e){this._partRedirectsMap={},this._bladeRedirectsMap={},this._assetRedirectsMap={},MsPortalEarly.preload.then((()=>{e.getAssignments().then((e=>{this._experimentAssignments=e}))}))}addPartRedirect(e){this._partRedirectsMap[g(e.type,e.fromExtension,e.fromPart,e.fromBlade,e.fromLens)]=e}addBladeRedirect(e){this._bladeRedirectsMap[h(e.fromExtension,e.fromBlade)]=e}addAssetRedirect(e){this._assetRedirectsMap[f(e.fromExtension,e.fromAsset,e.fromKind)]=e}getPartRedirect(e,t,s,i,o){const n=g(e,t,s,i,o);return{key:n,definition:this._partRedirectsMap[n]}}getBladeRedirect(e,t){const s=h(e,t),i=this._bladeRedirectsMap[s],o=!(i&&i.useFlighting&&this._experimentAssignments)||!!this._experimentAssignments.getBooleanValue(`RedirectBlade-${i.fromExtension}-${i.fromBlade}`);return i&&u.trace({source:"ExtensionManifest.RedirectMap",action:"getBladeRedirect.redirection",data:{redirect:i,redirectApplied:o,nullExperimentAssignments:!!this._experimentAssignments}}),{key:s,definition:o?i:null}}getAssetRedirect(e){return this._assetRedirectsMap[e.toLowerCase()]}};function y(e,t,s,i){e.push(t.format(s,i))}v=__decorate([__metadata("fx:diagnostics",[e,"RedirectMap"]),s.Class(),__metadata("design:paramtypes",[l.Experimentation])],v),t.RedirectMap=v;const M={},I={};let C=class{constructor(e,t,s,i,n){this._redirectMap=t,this._cachedManifestClient=i,this._features=n,this._cachedManifestsLoaded={},this._cache={},this._asyncCache={},this._extensionBlockBladeRedirect=(n.getValue("blockbladeredirect")||"").toLowerCase(),function(e){const t=(e,t)=>{e&&e.split(",").forEach(t)};t(e.getValue("assettypeapiversion"),(e=>{const t=e.split(":");2===t.length&&t[0]&&(M[t[0].toLowerCase()]=t[1])}));const s=e=>t=>{t&&(I[t.toLowerCase()]=e)};t(e.getValue("showassettypes"),s(!0)),t(e.getValue("hideassettypes"),s(!1))}(this._features),n.isEnabled("prefetchbrowsequerymanifest")&&this._cachedManifestClient.getManifests("assetTypesBrowse"),n.isEnabled("prefetchfeaturecardsmanifest")&&this._cachedManifestClient.getManifests("featureCards");const r=FxImpl.partition(s.extensionsAsArray,(e=>e.isSideloaded)),a=FxImpl.partition(r[0],(e=>!!(256&e.flags))),l=a[0].map((t=>e.getAsync(o.get("MsPortalImpl/AzFramework/SideloadAzMetadataClient","SideloadAzMetadataClient")).then((e=>e.loadMetadataAsManifest(t.name,t.uri).then((e=>{this.trySetAllManifest(t.name,e)}))))));a[1].length&&l.push(e.getAsync(o.get("MsPortalImpl/Extension/SideloadManifestClient","SideloadManifestClient")).then((e=>e.getManifests(a[1]))).then((e=>{MsPortalFx.forEachKey(e,((e,t)=>{this.trySetAllManifest(e,t)}))}))),this._sideloadManifestsLoaded=Q.all(l).then((()=>r[1]))}getManifests(e,t){const s=Object.create(null);t&&Object.keys(this._cache).forEach((i=>{const o=this.getManifest(i,e);o&&(s[i]=!0,t(i,o))}));let i=this._cachedManifestsLoaded[e]||(this._cachedManifestsLoaded[e]=Q.spread([this._sideloadManifestsLoaded,this._cachedManifestClient.getManifests(e)],((t,s)=>{t.forEach((t=>{this.trySetManifest(t.name,e,s[t.name]||{})}))})));return t&&(i=Q(MsPortalFx.tryImmediateResolve(i,(()=>{Object.keys(this._cache).forEach((i=>{s[i]||t(i,this.getManifest(i,e))}))})))),i}getManifest(e,t){return this._getCache(e)[t]}getManifestAsync(e,t){return Q(MsPortalFx.tryImmediateResolve(MsPortalFx.tryImmediateResolve(this.getManifests(t),(()=>this._getAsyncCache(e)[t].promise)),(()=>this._getCache(e)[t])))}trySetManifest(e,t,s,i){if(this._validateAndProcessManifest(e,s,i))return this._setManifest(e,t,s),!0}trySetAllManifest(e,t,s){if(this._validateAndProcessManifest(e,t,s))return MsPortalEarly.cachedManifestTypes.forEach((s=>{this._setManifest(e,s,t)})),!0}getVersion(e){const t=this.getManifest(e,"assetTypes");return t&&t.pageVersion}getHostOverride(){return this._features.getValue("manifesthost")}_setManifest(e,t,s){this._getCache(e)[t]||(this._getCache(e)[t]=s,this._getAsyncCache(e)[t].resolve())}_getCache(e){return this._cache[e]||(this._cache[e]={})}_getAsyncCache(e){return this._asyncCache[e]||(this._asyncCache[e]={assetTypes:Q.defer(),assetTypesBrowse:Q.defer(),assetTypesMenu:Q.defer(),featureCards:Q.defer(),galleryParts:Q.defer(),surveys:Q.defer(),uiDefinition:Q.defer(),extensionConfiguration:Q.defer(),sourceMappings:Q.defer()})}_validateAndProcessManifest(e,t,s){const o=s||[],n=[];if(!t){const e="Manifest was not specified for the extension. Ensure that you passing a valid manifest to the MsPortalFx.Extension.register/FxExtension.registerAmd call that is used to register your extension with the portal.";o.push(e)}const a=this._features.getValue("manifesthost"),l=/([^:]*)/.exec(m.location.host)[1],c=t.assetTypes;if(c){(0,r.validateIsArray)("manifest.assetTypes",c,o)&&c.forEach((t=>{!function(e,t,s,i){const o=e.name;if(p(o)&&y(s,"The name for the asset type in manifest '{0}' was not specified.",t),void 0!==e.options&&"number"!=typeof e.options&&y(s,"The asset type options property present for the asset type '{0}' in manifest '{1}' was not a number.",o,t),void 0!==e.browseType&&"number"!=typeof e.browseType&&y(s,"The browse type for the asset type '{0}' in manifest '{1}' was not a number.",o,t),e.browseLinkUri&&"string"!=typeof e.browseLinkUri&&y(s,"The browse link URI for the asset type '{0}' in manifest '{1}' was not a string.",o,t),void 0!==e.privateBrowse&&"boolean"!=typeof e.privateBrowse&&y(s,"The private browse flag present for the asset type '{0}' in manifest '{1}' was not a boolean.",o,t),void 0!==e.browseRequiresRdfe&&"boolean"!=typeof e.browseRequiresRdfe&&y(s,"The requires RDFE browse flag was present for the asset type '{0}' in manifest '{1}' was not a boolean.",o,t),void 0!==e.browseRequirements&&"number"!=typeof e.browseRequirements&&y(s,"The browse requirements was present for the asset type '{0}' in manifest '{1}' was not a number.",o,t),void 0!==e.browseType){switch(e.browseType){case 1:case 2:case 3:case 999:break;default:"internalsamplesextension"!==t.toLowerCase()&&"samplesextension"!==t.toLowerCase()&&y(i,"The browse for the asset type '{0}' in manifest '{1}' is deprecated: '"+e.browseType+"'.",o,t)}p(e.pluralDisplayName)&&p(e.text)&&y(s,"The pluralDisplayName for the asset type '{0}' in manifest '{1}' was not specified and asset type was set to browse.",o,t),MsPortalFx.isNullOrUndefined(e.icon)&&y(s,"The icon for the asset type '{0}' in manifest '{1}' was not specified and asset type was set to browse.",o,t)}else void 0!==e.privateBrowse&&y(s,"The asset type '{0}' in manifest '{1}' has a private blade flag but no browse type.",o,t);e.propertyProviderServiceViewModel&&"string"!=typeof e.propertyProviderServiceViewModel&&y(s,"The property provider service view model for the asset type '{0}' in manifest '{1}' was not a string.",o,t)}(t,e,o,n)}));const s=this._features.getValue(`${e}_hideassettypes`),u=this._features.getValue(`${e}_showassettypes`),m=this._features.getValue(`${e}_assettypeoptions`),g=this._features.getValue(`${e}_resourcetypeapiversions`),h=this._features.getValue(`${e}_argbrowseoptions`),f=this._features.getValue(`${e}_showargcolumns`),x=this._features.getValue(`${e}_hideassettypecommands`);let v;const C=s&&s.toLowerCase().split(","),P=u&&u.toLowerCase().split(",");let w;const _=m&&b(JSON.parse(m.toLowerCase()));let S;const F=g&&JSON.parse(g.toLowerCase());let k;const T=h&&JSON.parse(h.toLowerCase());let D;const E=f&&JSON.parse(f.toLowerCase());let B;const A=x&&JSON.parse(x.toLowerCase());let N,O;const R=t.environmentConfiguration;if(R){const e=R[R[a]&&a||R[l]&&l||MsPortalFx.find(Object.keys(R),(e=>l.endsWith(e)))||"*"];e&&(v=e.hideAssetTypes,w=b(e.assetTypeOptions),S=e.resourceTypeApiVersions,k=e.argBrowseOptions,D=e.showArgColumns,B=e.hideAssetTypeCommands,N=e.assetTypeBrowseCommandsExperiments,O=e.assetTypeExtensibleCommandsApiVersions)}if((P||C||v||_||w||F||S||T||k||E||D||A||B||N||O)&&c.forEach((e=>{const t=e.name.toLowerCase(),s=s=>{const o=s[t];o&&(void 0!==o.options&&(e.options=o.options),e.hideBrowseInfoBox=o.hideBrowseInfoBox,e.privateBrowse=(0,i.supportsOption)(e.options,1),e.resourceType&&e.resourceType.kinds&&e.resourceType.kinds.forEach((e=>{const t=e.name.toLowerCase();if(o.kinds){const s=o.kinds[t];s&&(void 0!==s.options&&(e.options=s.options),e.hideBrowseInfoBox=s.hideBrowseInfoBox)}})),o.featureCardOptions&&(e.featureCardOptions=o.featureCardOptions))},o=s=>{const i=s[t];i&&(e.hiddenCommands=i)},n=s=>{s.includes(t)&&(e.privateBrowse=!0,e.options=1|e.options)};w?s(w):v&&n(v),_?s(_):P?P.includes(t)&&(e.privateBrowse=!1,e.options=-2&e.options):C&&n(C);const r=e.resourceType;if(r){const e=S&&S[r.resourceTypeName.toLowerCase()];e&&(r.apiVersion=e);const t=F&&F[r.resourceTypeName.toLowerCase()];t&&(r.apiVersion=t)}if(k){const s=(k[t]||"").toLowerCase();e.argBrowseOption=d.ArgBrowseFeatureValueToEnumMap[s]}if(T){const s=(T[t]||"").toLowerCase();e.argBrowseOption=d.ArgBrowseFeatureValueToEnumMap[s]}D&&(e.showArgColumns=D[t]),E&&(e.showArgColumns=E[t]),B&&o(B),A&&o(A),e.browseCommandExperiments=null==N?void 0:N[t],e.extensibleCommandsApiVersions=null==O?void 0:O[t]})),M||I){const t=(e||"").toLowerCase()+"_";c.forEach((e=>{const s=t+(e.name||"").toLowerCase(),i=e.resourceType;void 0!==M[s]&&i&&(i.apiVersion=M[s]),void 0!==I[s]&&(e.privateBrowse=!I[s],e.options=e.privateBrowse?1|e.options:-2&e.options)}))}}const u=t.featureCards;if(u){const s=this._features.getValue(`${e}_featurecardoptions`);let i;const o=s&&JSON.parse(s.toLowerCase()),n=t.featureCardEnvironmentConfiguration;if(n){const e=n[n[a]&&a||n[l]&&l||MsPortalFx.find(Object.keys(n),(e=>l.endsWith(e)))||"*"];e&&(i=e.featureCardOptions)}(o||i)&&u.forEach((e=>{const t=e.id.toLowerCase();if(i){(i[t]||[]).forEach((t=>{MsPortalFx.forEachKey(e.resourceTypes,(s=>{var i;s.toLowerCase()===(null===(i=t.resourceType)||void 0===i?void 0:i.toLowerCase())&&(e.resourceTypes[s]=t.enabled)}))}))}if(o){(o[t]||[]).forEach((t=>{MsPortalFx.forEachKey(e.resourceTypes,(s=>{var i;s.toLowerCase()===(null===(i=t.resourceType)||void 0===i?void 0:i.toLowerCase())&&(e.resourceTypes[s]=t.enabled)}))}))}}))}if(!o.length){return(t.redirects||[]).forEach((t=>{if(t.toExtension=t.toExtension||(3!==t.type?e:""),t.fromExtension=t.fromExtension||e,t.useFlighting=!!t.useFlighting,t.toExtension===e||t.fromExtension===e||"HubsExtension"===t.toExtension)switch(t.type){case 2:case 3:{const e=t;e.fromBlade&&(this._extensionBlockBladeRedirect&&e.toExtension.toLowerCase()===this._extensionBlockBladeRedirect||this._redirectMap.addBladeRedirect(e));break}case 4:case 5:this._redirectMap.addPartRedirect(t);break;case 6:this._redirectMap.addAssetRedirect(t)}})),!0}s||x.error(`The manifest for '${e}' has validation errors. Errors: ${JSON.stringify(o)}`),n.length&&x.error(`The manifest for '${e}' has non-fatal validation errors. Errors: ${JSON.stringify(n)}`)}};C=__decorate([__metadata("fx:diagnostics",[e,"ManifestCache"]),s.Class(),__metadata("design:paramtypes",[s.Container,v,a.ExtensionManagerOptions,n.CachedManifestClient,FxImpl.Features])],C),t.ManifestCache=C})),
define("MsPortalImpl/ViewModels/ViewModels.BladeCaller",["require","exports"],(function(e,t){"use strict";var s;return function(e){e.bindingName_bladeCallId="internal_bladeCallId",e.bindingName_bladeCallerParams="internal_bladeCallerParams",e.bindingName_bladeCallerResult="internal_bladeCallerResult",e.addCallerBindings=function(t,s,i){const o=s.additionalInputArguments=s.additionalInputArguments||[];s.outputArguments=s.outputArguments||[];const n=t+".";o.push({property:e.bindingName_bladeCallId,valuesFrom:[{referenceType:i,property:n+e.bindingName_bladeCallId}]}),o.push({property:e.bindingName_bladeCallerParams,valuesFrom:[{referenceType:i,property:n+e.bindingName_bladeCallerParams}]}),s.outputArguments.push({property:e.bindingName_bladeCallerResult,valuesFrom:[{referenceType:1,property:e.bindingName_bladeCallerResult}]})},e.addCallablePartInputs=function(t){t.inputs=t.inputs||[],t.inputs.push(e.bindingName_bladeCallId,e.bindingName_bladeCallerParams)},e.addCallableBindings=function(t,s,i,o){const n=s.inputs=s.inputs||[];let r;if(s.outputs=s.outputs||[],s.bindings=s.bindings||[],o.inline)r=o.inline.bindings=o.inline.bindings||[];else{if(!o.reference)throw new Error("Part is neither inline nor a reference, so cannot add blade callable bindings");r=o.reference.bindings=o.reference.bindings||[]}n.push(e.bindingName_bladeCallId),r.push({property:e.bindingName_bladeCallId,valuesFrom:[{referenceType:1,property:e.bindingName_bladeCallId}]}),n.push(e.bindingName_bladeCallerParams),r.push({property:e.bindingName_bladeCallerParams,valuesFrom:[{referenceType:1,property:e.bindingName_bladeCallerParams}]}),s.outputs.push(e.bindingName_bladeCallerResult),s.bindings.push({property:e.bindingName_bladeCallerResult,valuesFrom:[{referenceType:0,property:t+"."+e.bindingName_bladeCallerResult,part:i}]})}}(s||(s={})),s})),
define("MsPortalImpl/Extension/DefinitionPreprocessor",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/ViewModels/ViewModels.BladeCaller","FxInternal/Utils/LinkSanitizer"],(function(e,t,s,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processCommands=t.processBlade=t.processPart=t.preprocessDefinition=t.collisionPrefix=t.PinPrefix=void 0;var r=MsPortalFx.Base.Constants.BladeParameterNames,a=MsPortalFx.Parts.PartKind,l=MsPortalFx.Composition.Configuration;const d="internal_parameterProviderActionBarOutput",c="content.parameterProvider",p=MsPortalFx.isDevelopmentMode?1:0;t.PinPrefix="InferredBladePinPart",t.collisionPrefix="inferredBladePinPartInputs.";const u="Microsoft_Azure_Insights",m="MetricsSummaryPart",g="timeRange",h="_msPortalFxTimeRange";function f(e,t){e&&e.extension&&(e.extension=t[e.extension]||e.extension)}function x(e,t){e&&e.length&&e.forEach((e=>{e.bladeExtension&&(e.bladeExtension=t[e.bladeExtension]||e.bladeExtension)}))}function b(e,t,o,r){if(o.processed)return o;r=r||{},f(o.reference,r),x(o.details,r),e.partTypeMap[o.name.toLowerCase()]=o,o.assetTypeDefinition=MsPortalFx.find(t.assetTypes,(e=>e.partName===o.name&&!e.partExtensionName)),C(o.details,0),o.parameterProvider&&P(o),function(e,t){const s=t.reference;if(s){if(s.partTypeName===m&&(s.extension===u||!s.extension&&e.name===u)){const e=s.bindings;MsPortalFx.find(e,(e=>e.property===g))||(e.push({property:g,valuesFrom:[{referenceType:9,property:h}],optional:!0}),t.inputDefinitions.push({name:h,type:l.TimeRangeValueType,optional:!0}))}}}(e,o);const a=s.container;return o.trustedLinkedDomains&&a.get(n.LinkSanitizer).processTrustedLinkedDomains(e.name,o.trustedLinkedDomains),i.sanitizeInlineTemplate(a,e.name,o.name,o,p),o.processed=!0,o}function v(e,l,u,m){if(m=m||{},u.processed)return u;MsPortalFx.isNullOrUndefined(u.pinnable)&&(u.pinnable=!!u.pinnedPart),2&u.attributes&&(u.optionalInputs=u.optionalInputs||[],u.optionalInputs.push("_provisioningContext")),u.templateBlade&&function(e){const t=e.templateBlade,s=t.isV2,i=t.isV2?9:t.partSize||8,o=M(e.name,e,t.htmlTemplate,t.htmlTemplateInline,i,t.partState,t.parameterProvider,t.styleSheets,e.permissions,12===e.style?a._Internal_App:null,s);e.lenses=e.lenses||[],e.lenses.push({name:"TemplateBladeVirtualLens",partInstances:[o]}),e.locked=!0,s&&(e.style=8);const n=o.inline;y(n,e.inputs,e.templateKeyInputs,void 0,e.effectiveInputs),y(n,e.optionalInputs,[],!0,e.effectiveInputs);const r=e.effectiveInputs=n.bindings;e.outputs&&e.outputs.forEach((t=>{e.bindings=e.bindings||[],e.bindings.push({property:t,valuesFrom:[{referenceType:0,property:"content."+t,part:o.name}]})})),e.editScopeType&&r.push({property:"editScopeId",valuesFrom:[{referenceType:1,property:"editScopeId"}]});e.actionBar&&(e.actionBar.source={valuesFrom:[{referenceType:0,part:o.name,property:"content.actionBar"}]});e.toolbar&&(e.toolbar.source={valuesFrom:[{referenceType:0,part:o.name,property:"content.commandBar"}]});n.details=t.details}(u),u.menuBlade&&function(e){const t=e.name,s=e.menuBlade.isV2,i=M(t,e,void 0,{content:`<div data-bind='pcControl: ${s?"viewModel && viewModel._msPortalFxMenu":"menu"}' class='ext-menublade-part'></div>`,file:t+MsPortalFx.getUniqueId()},9,void 0,!1,[],void 0);y(i.inline,e.inputs,e.templateKeyInputs,void 0,e.effectiveInputs),y(i.inline,e.optionalInputs,[],!0,e.effectiveInputs);const o={name:t,partInstances:[i]};e.lenses.splice(0,0,o),e.effectiveInputs=i.inline.bindings,MsPortalFx.isNullOrUndefined(e.pinnable)&&(e.pinnable=!0)}(u),u.tabMenuBlade&&function(e){const t=e.name,s=e.tabMenuBlade.isV2,i=M(t,e,void 0,{content:`<div data-bind='pcControl: ${s?"viewModel && viewModel._msPortalFxTabMenu":"tabMenu"}' class='ext-tabmenublade-part'></div>`,file:t+MsPortalFx.getUniqueId()},9,void 0,!1,[],void 0);y(i.inline,e.inputs,e.templateKeyInputs,void 0,e.effectiveInputs),y(i.inline,e.optionalInputs,[],!0,e.effectiveInputs);const o={name:t,partInstances:[i]};e.lenses.splice(0,0,o),e.effectiveInputs=i.inline.bindings,e.style=10,MsPortalFx.isNullOrUndefined(e.pinnable)&&(e.pinnable=!0)}(u),u.frameBlade&&function(e){const t=e.name,s=M(t,e,void 0,void 0,9,e.frameBlade.partState,!1,[],e.permissions,a.Frame);y(s.inline,e.inputs,e.templateKeyInputs,void 0,e.effectiveInputs),y(s.inline,e.optionalInputs,[],!0,e.effectiveInputs),e.toolbar={source:{valuesFrom:[{referenceType:0,part:t,property:"content.commandBar"}]}};const i={name:t,partInstances:[s]};e.lenses.splice(0,0,i),e.effectiveInputs=s.inline.bindings}(u),(u.lenses||[]).forEach((e=>{(e.partInstances||[]).forEach((e=>{f(e.reference,m),x(e.inline&&e.inline.details,m)}))})),e.bladeMap[u.name.toLowerCase()]=u,u.assetTypeDefinition=MsPortalFx.find(l.assetTypes,(e=>e.bladeName===u.name)),function(e){e.lenses&&e.lenses.forEach((t=>{t.partInstances&&t.partInstances.forEach((t=>{t.inline&&(t.parameterProvider&&P(t.inline),C(t.inline.details,0)),function(e,t,s){if(s.parameterProvider&&(e.attributes|=1,o.addCallableBindings(c+".bladeCallable",e,t,s),e.actionBar)){e.actionBar.bindings=e.actionBar.bindings||[];e.actionBar.bindings.some((e=>"input"===e.property))||e.actionBar.bindings.push({property:"input",valuesFrom:[{referenceType:0,part:t,property:c+".defaultActionBarInput"}]}),e.templateBlade||(s.inline||s.reference).bindings.push({property:d,valuesFrom:[{referenceType:2,property:"content.output"}]})}}(e,t.name,t)}))}))}(u),u.effectiveInputs||(u.effectiveInputs=u.viewModelInputs||[]);const g=function(e){const s=t.PinPrefix+e.name;e.pinnedPart||(e.pinnedPart=s);const i={name:s,viewModel:"Shell.InferredBladePinPart"+e.name,partKind:a.Button,inputs:e.inputs,initialSize:2,details:[{blade:e.name,invocationInputArguments:[{valuesFrom:[{property:"container.selectable.value",referenceType:0}]}],additionalInputArguments:[]}],bindings:[],viewStateProperties:["container.selectable.isSelected"],commandGroup:e.commandGroup,commandGroupReference:e.commandGroupReference,assetIdInputProperty:e.assetIdInputProperty,assetType:e.assetType};(e.inputs||[]).forEach((e=>{i.bindings.push({property:t.collisionPrefix+e,valuesFrom:[{property:e,referenceType:1}]})})),(e.optionalInputs||[]).forEach((e=>{e!==r.ReferrerInfo&&i.bindings.push({property:t.collisionPrefix+e,optional:!0,valuesFrom:[{property:e,referenceType:1}]})})),e.viewModelInputs&&e.viewModelInputs.forEach((t=>{t.property===e.assetIdInputProperty&&i.bindings.push(t)}));return i}(u);e.partTypeMap[g.name.toLowerCase()]=g;const h=s.container;return u.trustedLinkedDomains&&h.get(n.LinkSanitizer).processTrustedLinkedDomains(e.name,u.trustedLinkedDomains),i.sanitizeBladeDefinition(h,e.name,u,p),u.processed=!0,u}function y(e,t,s,i,o){t&&t.forEach((t=>{const n=!i&&s&&s.indexOf(t)>-1;e.inputs.push(t),e.bindings.push(o&&MsPortalFx.find(o,(e=>e.property===t))||{property:t,optional:i,isIdentityInput:n,valuesFrom:[{referenceType:1,property:t}]})}))}function M(e,t,s,i,o,n,r,l,d,c,p){return{name:e,inline:{bindings:[],details:[],inputs:[],partKind:c||a.Custom,viewModelLocator:t.viewModelLocator,viewModel:t.viewModelName,htmlTemplate:s,htmlTemplateInline:i,assetType:t.assetType,assetIdInputProperty:t.assetIdInputProperty,initialSize:o,viewStateProperties:[],shareVmWithParentBlade:!0,partState:n,styleSheets:l,permissions:d,noFxContentPadding:p},parameterProvider:r}}function I(e){e.commandsCatalog&&e.commandsCatalog.forEach((e=>{C([e.details],4)})),e.commandGroups&&e.commandGroups.forEach((e=>{e.commands&&e.commands.forEach((e=>{C([e.details],4)}))}))}function C(e,t){e&&e.filter((e=>e&&!!e.parameterCollector)).forEach((e=>{o.addCallerBindings(e.parameterCollector+".bladeCaller",e,t)}))}function P(e){e.editScopeType=e.editScopeType||"PDLEditScope",e.inputs=e.inputs||[],e.inputs.push(d),o.addCallablePartInputs(e)}t.preprocessDefinition=function(e,t){const s=e;return s.partTypeMap=s.partTypeMap||{},s.bladeMap=s.bladeMap||{},(s.partsCatalog||[]).forEach((e=>b(s,t,e,{}))),(s.blades||[]).forEach((e=>v(s,t,e,{}))),function(e){e.startBoardParts&&e.startBoardParts.forEach((e=>{e.inline&&C(e.inline.details,0)})),I(e)}(e),s},t.processPart=b,t.processBlade=v,t.processCommands=I})),
define("MsPortalImpl/Extension/ShellPart",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isShellPart=t.shellParts=void 0,t.shellParts={ResourcePart:{viewModelName:"ResourcePartViewModel",shellModule:"MsPortalImpl/UI/UI.ResourcePart"}},t.isShellPart=function(e){const s=e.name;return"HubsExtension"===e.getExtensionName()&&!!t.shellParts[s]}})),
define("MsPortalImpl/Extension/Extension",["require","exports","Fx/DependencyInjection","MsPortalImpl/Extension/Extension.Manifest"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShellWorkerExtension=t.ExtensionFactory=t.InitializedManifestCache=void 0;var o=FxImpl.Extension,n=FxImpl.Rpc;class r{static create(e){return e.getManifests("assetTypes").then((()=>null))}}__decorate([__metadata("fx:diagnostics",[e,"InitializedManifestCache"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[i.ManifestCache]),__metadata("design:returntype",Promise)],r,"create",null),t.InitializedManifestCache=r;let a=class{constructor(e,t){this.createExtension=s=>{const i=t.getManifest(s.name,"assetTypes")||{};return 256&s.flags?new d(s.name,s.serviceTreeId):new l(s,32&i.flags?null:e)}}};a=__decorate([__metadata("fx:diagnostics",[e,"ExtensionFactory"]),s.Class(),__metadata("design:paramtypes",[n.Client,i.ManifestCache])],a),t.ExtensionFactory=a;class l{constructor(e,t){this.isLoaded=ko.observable(),this.lastError=ko.observable(),this.refCount=ko.observable(0);const{name:s,serviceTreeId:i}=e;this.name=s,this.serviceTreeId=i,this.processMessages=t?()=>o.pingEndPoint.invoke(t,s,void 0):()=>Q(),this.waitForIdle=t?(e,i)=>FxImpl.Extension.waitForExtensionIdleEndPoint.invoke(t,s,{bladeName:e,bladeInstanceId:i}):()=>Q(),this.onStateChange=e=>{const{loadTime:t,error:s,refCount:i}=e;void 0!==t&&(this.isLoaded(!!t),t&&(this.loadTime=t)),s&&this.lastError(s),MsPortalFx.isNullOrUndefined(i)||this.refCount(i)}}}t.ShellWorkerExtension=l;class d{constructor(e,t){this.name=e,this.serviceTreeId=t,this.lastError=ko.observable(),this.isLoaded=ko.observable(!0)}processMessages(){return Q()}waitForIdle(){return Promise.resolve({pendingOperationsCount:0,waitDuration:0,interruptedByChild:!1})}}})),
define("MsPortalImpl/Extension/ExtensionManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Extension/Extension","MsPortalImpl/Extension/ExtensionManagerOptions","ShellWorker/ExtensionManager"],(function(e,t,s,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionManager=t.ExtensionManagerImpl=t.ExtensionLoader=t.ExtensionManagerOptions=void 0,Object.defineProperty(t,"ExtensionManagerOptions",{enumerable:!0,get:function(){return o.ExtensionManagerOptions}});var r=MsPortalFx.Base.Diagnostics,a=FxImpl.Rpc;const l=r.createLog(e);let d=class{constructor(e,t){this._options=e,this._rpcClient=t}startRpc(e){this._rpcClient.start({instanceIndex:0,loadChannelFunction:void 0,originId:"fx",shellChannel:new FxImpl.Rpc.RpcChannel(FxImpl.localRpcPort),windowRedirectMap:this._options.extensionRedirectMap}),n.onExtensionStateChangeEndPoint.register(this._rpcClient,"fxw",(t=>{e[t.name].onStateChange(t)}))}setRequestedBlade(e,t){n.setRequestedBladeEndPoint.invoke(this._rpcClient,"fxw",{extensionName:e,bladeName:t})}};d=__decorate([__metadata("fx:diagnostics",[e,"ExtensionLoaderImpl"]),s.Class(),__metadata("design:paramtypes",[o.ExtensionManagerOptions,a.Client])],d);class c{static create(e,t){return t}}__decorate([__metadata("fx:diagnostics",[e,"ExtensionLoader"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[i.InitializedManifestCache,d]),__metadata("design:returntype",c)],c,"create",null),t.ExtensionLoader=c;let p=class{constructor(e,t,s){this._options=s,this.lastExtensionError=ko.observable(),this.initializedExtensions=[],this._callbacks=$.Callbacks(),this._unloadCallbacks=$.Callbacks(),this._ltm=new FxImpl.TriggerableLifetimeManager,this._extensionsMap=FxImpl.mapValues(s.extensionsAsMap,(t=>{const s=e.createExtension(t);return s.lastError.subscribeAndRun(this._ltm,(e=>{e&&this.lastExtensionError(s)})),s.isLoaded.subscribeAndRun(this._ltm,(e=>{e?(this.initializedExtensions.push(s),this._callbacks.fire(s.name)):(MsPortalFx.remove(this.initializedExtensions,s),this._unloadCallbacks.fire(s.name))})),s})),t.startRpc(this._extensionsMap)}getExtension(e){const t=this._options.getNormalizedMetadata(e);return t&&this._extensionsMap[t.name]}onLoad(e){const t=this.initializedExtensions.slice(0),s=t=>{try{e(t)||this._callbacks.remove(s)}catch(e){l.error("onLoad event callback has thrown an exception.",2,e)}};this._callbacks.add(s),t.forEach((t=>{e(t.name)}))}onUnload(e){const t=s=>{try{e(s)||this._unloadCallbacks.remove(t)}catch(e){l.error("onUnload event callback has thrown an exception.",3,e)}};this._unloadCallbacks.add(t)}dispose(){this._ltm.dispose()}getExtensions(){return Object.keys(this._extensionsMap).map((e=>this._extensionsMap[e]))}};p=__decorate([__metadata("fx:diagnostics",[e,"ExtensionManagerImpl"]),s.Class(),__metadata("design:paramtypes",[i.ExtensionFactory,c,o.ExtensionManagerOptions])],p),t.ExtensionManagerImpl=p;class u{static create(e){return e}}__decorate([__metadata("fx:diagnostics",[e,"ExtensionManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[p]),__metadata("design:returntype",u)],u,"create",null),t.ExtensionManager=u})),
define("MsPortalImpl/Services/Services.ExtensionStorageManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Extension/ExtensionManager"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionStorageManager=void 0;const o=MsPortalFx.Base.Diagnostics.createLog(e),n="LocalStorage",r=e=>{var t,s;o.error(`error creating store transaction: ${null===(s=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.error)||void 0===s?void 0:s.toString()}`)},a=e=>e.transaction(n,"readwrite").objectStore(n),l=(e,t)=>{const s=`ExtensionStorage${e}`,i=new Set;let l=Object.create(null);const d="localStorage"===t&&indexedDB?"localStorage":"sessionStorage";let c="sessionStorage"===d,p=!1;const u=new Promise((e=>{c?e():((e,t)=>{const s=indexedDB.open(e,1);let i=e=>{const s=a(e).openCursor(),o=[];s.onsuccess=e=>{const s=e.target.result;s?(o.push({key:s.key,value:s.value.value}),s.continue()):t(o.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.key]:t.value})),{}))},i=MsPortalFx.noop};s.onsuccess=()=>{i(s.result)},s.onerror=function(e){var s,i;o.debug(`call to indexedDB.open failed for StorageKind.LocalStorage (expected for Private mode): ${null===(i=null===(s=null==e?void 0:e.target)||void 0===s?void 0:s.error)||void 0===i?void 0:i.toString()}`),t(Object.create(null),!0)},s.onupgradeneeded=e=>{const t=e.target.result;t.createObjectStore(n,{keyPath:"key"}).transaction.oncomplete=()=>{i(t)}}})(s,((t,s)=>{l=t,c=!0,p=s,m(),e()}))})),m=()=>{i.forEach((e=>e({storage:t,serializedStorage:l})))},g=e=>{"localStorage"===d&&u.then((()=>{p||((e,t)=>{const s=indexedDB.open(e,1);s.onsuccess=()=>{const e=s.result,i=a(e);t(i).onerror=r},s.onerror=r})(s,e)}))};return{setItem:(e,t)=>{l[e]=t,g((s=>s.put({key:e,value:t}))),m()},removeItem:e=>{delete l[e],g((t=>t.delete(e))),m()},clear:()=>{l=Object.create(null),g((e=>e.clear())),m()},serialize:()=>l,registerChangeListener:e=>{i.add(e);return()=>{i.delete(e)}},ready:u,isReady:c}};let d=class{constructor(e){this._storageByExtension=new Map,e.extensionsAsArray.forEach((e=>{const t=function(e){const t={sessionStorage:l(e,"sessionStorage"),localStorage:l(e,"localStorage")};let s;return{setItem:e=>{t[e.storage].setItem(e.keyName,e.keyValue)},removeItem:e=>{t[e.storage].removeItem(e.keyName)},clear:e=>{t[e.storage].clear()},registerChangeListener:e=>{const s=Object.keys(t).map((s=>t[s].registerChangeListener(e)));return()=>s.forEach((e=>{e()}))},serialize:()=>({sessionStorage:t.sessionStorage.serialize(),localStorage:t.localStorage.serialize()}),ready:t.localStorage.ready,forceReady:()=>{if(t.localStorage.isReady)return Promise.resolve();{const i=fx.getTimestamp();return Promise.race([t.localStorage.ready,new Promise((n=>{s=setTimeout((()=>{o.warning(`initializing localStorage for extension ${e} exceeded limit`),t.localStorage.ready.then((()=>{o.warning(`initializing localStorage for extension ${e} exceeded actually took ${fx.getTimestamp()-i}`)})),n()}),500)}))]).then((()=>{clearTimeout(s)}))}}}}(e.name);this._storageByExtension.set(e.name,t)}))}getStorageForExtension(e){return this._storageByExtension.get(e)}};d=__decorate([__metadata("fx:diagnostics",[e,"ExtensionStorageManager"]),s.Class(),__metadata("design:paramtypes",[i.ExtensionManagerOptions])],d),t.ExtensionStorageManager=d})),
define("MsPortalImpl/Extension/DefinitionCache",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Extension/DefinitionPreprocessor","MsPortalImpl/Extension/Extension.DefinitionValidator","Fx/Ajax","MsPortalImpl/Extension/ShellPart","FxHubs/RpcEndPoints","Fx","MsPortalImpl/Services/Services.ExtensionStorageManager"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.doesBladeDefinitionExist=t.DefinitionCache=t.DefinitionSource=void 0;var m=MsPortalFx.Base,g=FxImpl.Extension,h=m.UriBuilder;const f=window.fx.environment,x=new RegExp("^[\\w$]*(\\"+".ReactView".toLowerCase()+")?$"),b=(0,p.memoizePromise)((()=>{return Q.all([(e=new h(f.azFrameworkBundles.blade).path,(0,l.ajax)({uri:e,useRawAjax:!0,ignoreUnknownNetworkError:!0,dataType:"text"})),MsPortalFx.require("MsPortalImpl/AzFramework/Parts.Az")]);var e}));function v(e){return{commandsCatalog:MsPortalFx.convertArrayToMap(e.commandsCatalog,(e=>e.name)),commandGroups:MsPortalFx.convertArrayToMap(e.commandGroups,(e=>e.name))}}let y=class{getDefinition(e){return null}};y=__decorate([__metadata("fx:diagnostics",[e,"DefinitionSource"]),s.Class()],y),t.DefinitionSource=y;let M=class{constructor(e,t,s,i,o){this._diContainer=e,this._definitionSource=t,this._extensionManagerOptions=s,this._manifestCache=i,this._rpcClient=o,this._cache={},this._azCache={}}getDefinition(e){return 256&this._extensionManagerOptions.getNormalizedMetadata(e,!0).flags?this._getAzDefinition(e):this._getEntry(e).definition}getCommandGroup(e,t){return this._getCommandDefinitions(e,t,(e=>e.commandGroups))}getCommand(e,t){return this._getCommandDefinitions(e,t,(e=>e.commandsCatalog))}getBladeDefinition(e,t,s){if(256&this._extensionManagerOptions.getNormalizedMetadata(e,!0).flags)return b(),function(e,t){Q(t.getAsync(i.get("MsPortalImpl/Services/Services.ExtensionTokensManager","ExtensionTokensManager"))).then((t=>t.createAuthTokenCache(e).getToken()))}(e,this._diContainer),Q(this._getAzBladeDefinition(t,e,MsPortalFx.Parts.PartKind._Internal_Az));{const i=this._getEntry(e),o=i.definition,n=t.toLowerCase(),r=o.bladeMap[n];if(r)return Q(r);const a=i.bladeDefMap;return x.test(null==t?void 0:t.toLowerCase())?(this._diContainer.get(u.ExtensionStorageManager).getStorageForExtension(e),t.toLowerCase().endsWith(".ReactView".toLowerCase())?Q(this._getAzBladeDefinition(t,e,MsPortalFx.Parts.PartKind._Internal_React)):n.endsWith("_dx")?Q(a[n]||this.setDxBladeDefinition(e,t)):Q(a[n]||!s&&this.setBladeDefinition(e,t,g.getBladeDefinitionEndPoint.invoke(this._rpcClient,e,t)))):Q.reject(FxImpl.createError("Blade name is invalid identifier"))}}doesBladeDefinitionExist(e,t){if(t.toLowerCase().endsWith("_dx")){let s;try{s=this._extensionManagerOptions.getNormalizedMetadata(e,!0)}catch(e){return Q(!1)}return i.get("MsPortalImpl/Extension/DxDefinitionCache","getDxBladeDefinition").then((i=>i(this._diContainer,this,e,t,s,!0))).then((e=>!!e))}throw new Error("Not implemented")}async setDxBladeDefinition(e,t){const s=this._extensionManagerOptions.getNormalizedMetadata(e,!0),o=i.get("MsPortalImpl/Extension/DxDefinitionCache","getDxBladeDefinition").then((i=>i(this._diContainer,this,e,t,s)));return this.setBladeDefinition(e,t,o)}setBladeDefinition(e,t,s){const i=this._getEntry(e),o=i.definition,n=t.toLowerCase(),l=i.bladeDefMap;return l[n]=s.then((t=>r.processBlade(o,this._manifestCache.getManifest(e,"assetTypes"),t,this._extensionManagerOptions.extensionRedirectMap))).then((e=>{const t=[];if(a.validateBlade(o,e,null,t),t.length)throw new Error("Invalid blade definition. Errors: "+t.join("\n"));return e})).finally((()=>{delete l[n]}))}loadPartDefinition(e,t){if("HubsExtension"===e){const e=d.shellParts[t];if(e)return Q(MsPortalFx.tryImmediateResolve(MsPortalFx.require(e.shellModule),(e=>("resourcepart"===t.toLowerCase()&&(e.partDefinition.resizeMode=2,e.partDefinition.initialSize=10),e.partDefinition))))}return Q(g.getPartDefinitionEndPoint.invoke(this._rpcClient,e,t))}getPartDefinition(e,t){const s=this._getEntry(e),o=s.definition,n=t.toLowerCase(),l=o.partTypeMap[n];if(l)return Q(l);if(t.toLowerCase().endsWith(".ReactTile".toLowerCase())){if(!["hubsextension","samplesextension","internalsamplesextension","microsoft_azure_playground"].includes(e.toLowerCase()))throw new Error("ReactTiles are not publicly available yet.");return Q(this._diContainer.getAsync(i.get("MsPortalImpl/AzFramework/AzExtensionCore","AzDefinitionCache"))).then((s=>s.getPartDefinition(this._getAzDefinition(e),t,e,MsPortalFx.Parts.PartKind._Internal_React)))}const d=s.partDefMap;return d[n]||(d[n]=this.loadPartDefinition(e,t).then((t=>{t=r.processPart(o,this._manifestCache.getManifest(e,"assetTypes"),t,this._extensionManagerOptions.extensionRedirectMap);const s=[];if(a.validatePartType(t,s),s.length)throw new Error("Invalid part type definition. Errors: "+s.join("\n"));return t})).finally((()=>{delete d[n]})))}_getAzBladeDefinition(e,t,s){return this._diContainer.getAsync(i.get("MsPortalImpl/AzFramework/AzExtensionCore","AzDefinitionCache")).then((i=>i.getBladeDefinition(this._getAzDefinition(t),e,t,s)))}_getCommandDefinitions(e,t,s){if(!t)return Q();const i=this._getEntry(e);if(!i.commandDefMap){const t=i.definition;i.commandDefMap=t.commandGroups||t.commandsCatalog?Q(v(t)):Q(FxImpl.Extension.getCommandsDefinitionEndPoint.invoke(this._rpcClient,e,void 0)).then((e=>(r.processCommands(e),v(e))))}return Q(MsPortalFx.tryImmediateResolve(i.commandDefMap,(e=>s(e)[t])))}_getAzDefinition(e){return this._azCache[e]||(this._azCache[e]={name:e,bladeMap:{},partTypeMap:{}})}_getEntry(e){return this._cache[e]||(this._cache[e]={definition:this._definitionSource.getDefinition(e)||{name:e,bladeMap:{},partTypeMap:{}},bladeDefMap:{},partDefMap:{},commandDefMap:null})}};M=__decorate([__metadata("fx:diagnostics",[e,"DefinitionCache"]),s.Class(),__metadata("design:paramtypes",[s.Container,y,n.ExtensionManagerOptions,o.ManifestCache,FxImpl.Rpc.Client])],M),t.DefinitionCache=M,t.doesBladeDefinitionExist=i.defineHandler(c.Provisioning.doesBladeDefinitionExistEndPoint,(e=>{const t=e.messageArg;return Q(e.diContainer.get(M).doesBladeDefinitionExist(t.extensionName,t.bladeName))}))})),
define("MsPortalImpl/Extension/Extension.Definition.Locator",["require","exports","Fx/DependencyInjection","Fx/ResourceManagement","FxInternal/AsyncLoader","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Extension/DefinitionPreprocessor","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Extension/DefinitionCache","FxHubs/RpcEndPoints"],(function(e,t,s,i,o,n,r,a,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBladeDefinitionLocator=t.resourceMenu=t.hubsLocator=t.DefinitionFinder=t.DefinitionFinderImpl=t.Locator=t.LocatorContext=t.LocatorError=t.LocatorTypeMap=void 0;var p=MsPortalFx.Base.Constants,u=MsPortalFx.Base.Diagnostics;MsPortalFx.Extension.BrowseType;const m=u.createLog(e),g="Unable to locate {0} '{1}'. Search path:'{2}'.";function h(e,t){const s=[];let i=e;for(;i;)s.unshift(i.getCacheKeyPart()),i=i.parent;const o=s.join("-");return t?o:o.toLowerCase()}function f(e,t,s){return e.definitionCache.getDefinition(t.name).partTypeMap[s.toLowerCase()]}function x(e,t){let s="<InvalidJsonString>";try{s=JSON.stringify(t)}catch(e){}return m.error("{0} JSON: {1}".format(e,s)),M.forExtension("##ErrorDeserializingLocator##-{0}".format(s))}var b;!function(e){e[e.Extension=0]="Extension",e[e.Blade=1]="Blade",e[e.Lens=2]="Lens",e[e.AssetType=3]="AssetType",e[e.CommandGroup=4]="CommandGroup",e[e.PartInstance=5]="PartInstance",e[e.PartType=6]="PartType",e[e.StartboardPartInstance=7]="StartboardPartInstance",e[e.BladeActionBar=8]="BladeActionBar",e[e.Command=9]="Command",e[e.Hub=11]="Hub",e[e.CustomLen_Unused=12]="CustomLen_Unused",e[e.CommandType=13]="CommandType",e[e.BladeRedirect=14]="BladeRedirect",e[e.PartInstanceRedirect=15]="PartInstanceRedirect",e[e.PartTypeRedirect=16]="PartTypeRedirect",e[e.AssetTypeForBrowse=17]="AssetTypeForBrowse",e[e.HtmlTemplate=18]="HtmlTemplate"}(b=t.LocatorTypeMap||(t.LocatorTypeMap={}));class v extends MsPortalFx.Errors.Error{constructor(e,t,s,i){super({message:s,innerErrors:i}),this.source=t,this.data=e}}t.LocatorError=v;let y=class{constructor(e,t,s,i){this.extensionManager=e,this.manifestCache=t,this.definitionCache=s,this.redirectMap=i}tryLocateAssetDefinitionFromResourceId(e,t){const s=i.ArmId.parse(e,!0).resourceType,o=i.ArmId.parse(e).resourceType;return!!this.tryLocateAssetDefinitionFromResourceType(s,t)||this.tryLocateAssetDefinitionFromResourceType(o,t)}tryLocateAssetDefinitionFromResourceType(e,t){const s=e.toLowerCase(),i=this.extensionManager.getExtensions().some((e=>{const i=this.manifestCache.getManifest(e.name,"assetTypes"),o=i&&MsPortalFx.find(i.assetTypes,(e=>e.resourceType&&e.resourceType.resourceTypeName&&e.resourceType.resourceTypeName.toLowerCase()===s&&3!==e.browseType));return o&&(t.extensionName=e.name,t.value=o),!!o}));return i||(t.error="Unable to locate extension for resource type '{0}'.".format(e),t.value=null),i}};y=__decorate([__metadata("fx:diagnostics",[e,"LocatorContext"]),s.Class(),__metadata("design:paramtypes",[l.ExtensionManager,a.ManifestCache,d.DefinitionCache,a.RedirectMap])],y),t.LocatorContext=y;class M{constructor(e,t,s,i,o,n,r){this.type=e,this.name=t,this.parent=o,this.enumerate=s,this.getValue=n,this.getValueAsync=r,this.typeDisplayName=i}static forExtension(e){return new M(0,e,void 0,"extension",void 0,(t=>t.extensionManager.getExtension(e)),null)}static fromJSON(e,t){if(!t||"object"!=typeof t)return x("Locator object is invalid.",t);const s=t.parent?M.fromJSON(e,t.parent):null,i=b[t.type],o="with{0}".format(i);if(!s&&0!==t.type)return x("Locator with name '{0}' has no parent.".format(t.name),t);let n;return 0===t.type?(n=e.resolveExtensionName(t.name),M.forExtension(n)):o in s?s[o](t.name):x("Unknown locator type: {0}.".format(i),t)}getCacheKeyPart(){return`[${this.type}]${this.name}`}getCacheFriendlyKeyPart(e="/"){return`${b[this.type]}${e}${this.name}`}withBlade(e){return new M(1,e,void 0,"blade",this,((e,t,s)=>e.definitionCache.getDefinition(t.name).bladeMap[s.toLowerCase()]),((t,s)=>t.definitionCache.getBladeDefinition(s.name,e)))}withPartInstance(e){return new M(5,e,((e,t)=>t.partInstances),"part instance",this)}tryLocate(e,t,s){const i=h(this),o={};let n=!1;if(!t.hasOwnProperty(i)&&(this.parent&&this.parent.tryLocate(e,t,o),!this.parent||o.value))if(this.getValue){const s=this.getValue(e,o.value,this.name);void 0!==s&&(t[i]=s)}else{const s=this.enumerate(e,o.value);this._fillCacheFromArray(t,s)}const r=t[i];return r?(s.value=r,n=!0):(s.error=g.format(this.typeDisplayName,this.name,this.toString()),o.error&&(s.error=o.error+"\n"+s.error)),n}locateAsync(e,t){const s={};if(this.tryLocate(e,t,s))return Promise.resolve(s.value);{let i;const o=this.parent;return i=o?o.locateAsync(e,t):Promise.resolve(),i.then((i=>{if(this.tryLocate(e,t,s))return s.value;if(this.getValueAsync)return this.getValueAsync(e,i);throw new v(this.type,this.toFriendlyString(),s.error)}),(e=>{const t=g.format(this.typeDisplayName,this.name,this.toString());throw new v(this.type,this.toFriendlyString(),t,e)})).then((e=>t[h(this)]=e))}}_fillCacheFromArray(e,t){t&&t.forEach((t=>{const s=h(new M(this.type,t.name,this.enumerate,this.typeDisplayName,this.parent,this.getValue,this.getValueAsync));e[s]=t}))}static forPartInstanceRedirect(e,t,s,i){return new M(15,(0,a.partRedirectKey)(5,e,t,s,i),void 0,"part instance redirect",void 0,(o=>{const n=o.redirectMap.getPartRedirect(5,e,t,s,i);return n.definition&&MsPortalFx.extend({name:n.key},n.definition)}))}static forPartTypeRedirect(e,t){return new M(16,(0,a.partRedirectKey)(4,e,t),void 0,"part type redirect",void 0,(s=>{const i=s.redirectMap.getPartRedirect(4,e,t);return i.definition&&MsPortalFx.extend({name:i.key},i.definition)}))}static forBladeRedirect(e,t){return new M(14,(0,a.bladeRedirectKey)(e,t),void 0,"blade redirect",void 0,(s=>{const i=s.redirectMap.getBladeRedirect(e,t);return i.definition&&MsPortalFx.extend({name:i.key},i.definition)}))}withBladeActionBar(e){return new M(8,e,((e,t)=>t.actionBar?[t.actionBar]:[]),"blade actionbar",this)}withStartboardPartInstance(e){return new M(7,e,((e,t)=>e.definitionCache.getDefinition(t.name).startBoardParts),"startboard part instance",this)}withPartType(e){return new M(6,e,void 0,"part type",this,f,((t,s)=>{if(MsPortalFx.startsWith(e,r.PinPrefix)){const i=e.slice(r.PinPrefix.length);return t.definitionCache.getBladeDefinition(s.name,i).then((()=>f(t,s,e)))}return t.definitionCache.getPartDefinition(s.name,e)}))}withLens(e){return new M(2,e,((e,t)=>t.lenses),"lens",this)}withAssetType(e){return new M(3,e,((e,t)=>e.manifestCache.getManifest(t.name,"assetTypes").assetTypes),"asset type",this)}withAssetBrowseType(e){return new M(17,e,((e,t)=>{const s=e.manifestCache.getManifest(t.name,"assetTypesBrowse");return s&&s.assetTypesBrowse}),"asset browse type",this,void 0,((t,s)=>t.manifestCache.getManifestAsync(s.name,"assetTypesBrowse").then((t=>MsPortalFx.find(t.assetTypesBrowse,(t=>e===t.name))||Q.reject(new MsPortalFx.Errors.NotFoundDataError({dataSetName:"assetTypesBrowse"}))))))}withCommand(e){return new M(9,e,null,"command",this)}withHtmlTemplate(e){return new M(18,e,null,"html template",this,((e,t,s)=>e.definitionCache.getDefinition(t.name).htmlTemplates[s]))}getExtensionLocator(){let e=this;for(;e.parent;)e=e.parent;return e}getExtensionName(){return this.getExtensionLocator().name}toString(){return h(this,!0)}toFriendlyString(e="/"){return function(e,t){const s=[];let i=e;for(;i;)s.unshift(i.getCacheFriendlyKeyPart(t)),i=i.parent;return s.join(t)}(this,e)}equals(e){if(this.name&&e&&e.name&&this.name===e.name&&this.type===e.type){if(this.parent)return this.parent.equals(e.parent);if(!e.parent)return!0}return!1}toJSON(){return{name:this.name,type:this.type,parent:this.parent&&this.parent.toJSON()}}}t.Locator=M;class I{static populateCache(e,t,s){return e[h(t)]=s,e}constructor(e,t){this._locatorContext=e,this._cache=t||{}}locateAsync(e){return e.locateAsync(this._locatorContext,this._cache)}locate(t,s){const i={};let o=null;if(this.tryLocate(t,i))o=i.value;else{const o=s||t.getExtensionName();(0,n.logToExtension)(e,o,2,i.error)}return o}tryLocate(e,t){return e.tryLocate(this._locatorContext,this._cache,t)}}t.DefinitionFinderImpl=I;class C{static create(e){return new I(e)}}__decorate([__metadata("fx:diagnostics",[e,"DefinitionFinder"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[y]),__metadata("design:returntype",C)],C,"create",null),t.DefinitionFinder=C;const P=p.BladeNames.Hubs.ResourceMenuBlade;t.hubsLocator=M.forExtension("HubsExtension"),t.resourceMenu=t.hubsLocator.withBlade(P),t.getBladeDefinitionLocator=o.defineHandler(c.Provisioning.getBladeDefinitionLocatorEndPoint,(e=>{const t=e.messageArg;return Q(e.diContainer.get(C).locateAsync(M.forExtension(t.extensionName).withBlade(t.bladeName)).then((e=>Object.assign({},e))))}))})),
define("MsPortalImpl/Services/Services.SecurityTokens",["require","exports","Fx/DependencyInjection","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/Resources/ImplScriptResources","Fx/UriBuilder","Fx/Experimentation"],(function(e,t,s,i,o,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEV=t.SecurityTokensManager=void 0;var l=MsPortalFx.Base,d=l.Net2,c=l.Constants,p=l.Diagnostics,u=p.Telemetry,m=l.Resources,g=l.Security,h=FxImpl.Security;const f=window,x=p.createLog(e),b=c.Shell,v=["cloudsimpleextbearer","cacheextensionapp","internalgraphapiversion","cae","prefetchtokensinparallel"].reduce(((e,t)=>{const s=MsPortalFx.getFeatureValue(t);return s&&(e[`feature.${t}`]=`${s}`),e}),{}),y=m.getAppRelativeUri("/api/DelegationToken"),M=m.getAppRelativeUri("/api/PortalAuthorization/GetPopToken"),I=m.getAppRelativeUri("/api/PortalAuthorization/GetThirdPartyToken"),C=h.tokenErrors,P=fx.environment.auth.portalClientId,w=fx.environment.auth.armAadResource,_=/\{(.*?)\}/,S=new Map([["{graph}",FxImpl.internalEnv.fxGraphEndpoint],["{msgraph}",FxImpl.internalEnv.fxMsGraphEndpoint]]),F={},k=C.unknown,T=C.sessionEnded,D=C.credentialsExpired,E=C.networkError,B=C.badRequest,A={[C.requiresMFA.toLowerCase()]:!0,[C.tooManyRequests.toLowerCase()]:!0,[C.missingBrokerReplyUrl.toLowerCase()]:!0,[C.deviceUncompliant.toLowerCase()]:!0,[C.passthroughUserError.toLowerCase()]:!0},N=Object.create(null),O=Date.now,R=["","self"];let L=null,z=e=>MsPortalFx.isFeatureEnabled("msaljs")&&e.getBooleanValue("msaljsexp");function H(e){const t=e.toLowerCase();return(MsPortalFx.getFeatureValue("xmscc")+"").toLowerCase().split(",").includes(t)}function U(e,t,s){if(!z(e))return!1;L||function(e){L={};let t={};try{t=JSON.parse(e)}catch(t){u.trace({source:"Services.SecurityTokens",action:"MsaljsOptedOutExtensionsParseError",data:{inputString:e}})}MsPortalFx.forEachKey(t,((e,t)=>{const s=e.toLowerCase();s in L||(L[s]=new Set),(t||[]).forEach((e=>{e&&L[s].add(e.toLowerCase())}))}))}(e.getStringValue("msaljsoptedoutextensions"));const i=L[t];return u.trace({source:"Services.SecurityTokens",action:"checkMsalJsEnabledForExtensionResource",data:{normalizedExtensionNameLowerCase:t,resourceNameLowerCase:s,extensionLevelOptOut:null==i?void 0:i.has("*"),resourceLevelOptOut:null==i?void 0:i.has(s)}}),!i||!i.has("*")&&!i.has(s)}let W=class{constructor(e,t,s,i){var o,n,r;this._authStateManager=e,this._experimentation=t,this.saveMruTokenFunc=MsPortalFx.noop,this.sessionEndedHandler=MsPortalFx.noop,this.tokenFailedHandler=MsPortalFx.noop,this.unauthorizedTokenHandler=MsPortalFx.noop,this.tokenMfaErrorHandler=MsPortalFx.noop,this.tokenClaimsErrorHandler=MsPortalFx.noop,this.portalAuthHandlerPromise=Q(null),this._sessionEnded=!1,this._extensionsAuthMetadataLoadPromise=null,this.portalAuthHandlerPromise=this._experimentation.getAssignments().then((t=>{if(z(t)){this._extensionsAuthMetadataLoadPromise=MsPortalEarly.extensionAuthMetadataInPortalConfig;const t=u.start({source:"Services.SecurityTokens",action:"msalModuleLoad"});return MsPortalFx.require("MsPortalImpl/Services/PortalAuthHandler").then((o=>(u.completeTrace(t),o.MsalClientAuth.getInstance(e,s,i))))}return Q(null)}));const a=null!==(o=e.bootstrapState)&&void 0!==o?o:{},l=null!==(n=a.createdOn)&&void 0!==n?n:O();this._userUsedMfa=e.getCurrentUser().isMfa;const c=this._user=null!==(r=a.user)&&void 0!==r?r:{};this._tenantId=c.tenantId,this._ongoingTokenRequest=Q(),this.shellTokenCache=this._createShellTokenCache(a.oAuthToken,a.selfOAuthToken,l),this.getTokenFunc=e=>{const{sshTokenData:t,resourceName:s}=e;return MsPortalFx.isFeatureEnabled("enableauthtelemetrycli")&&!F[s]&&(u.trace({source:"Services.SecurityTokens",action:"GetTokenFuncRequestSummary",data:{resourceName:s,audience:e.audience,tenantId:e.tenantId,includesSshTokenData:!!t}}),F[s]=!0),this._experimentation.getAssignments().then((s=>{if(t&&z(s)){const s=O();return Q.all([this._extensionsAuthMetadataLoadPromise,this.portalAuthHandlerPromise]).then((([s,i])=>{const o=((s["HubsExtension".toLowerCase()]||{}).resourceAccessMap||{})[e.resourceName]||{};return i.acquireTokenForExtension({scopes:[o.resource+"/.default"],extensionClientId:o.overrideClientId,tenantId:this._tenantId,sshTokenData:t})})).then((e=>({header:e.authHeader,expiresAt:s+e.expiresInMs,tokenType:e.tokenType,errorMessage:e.errorMessage})))}return Q(this.shellTokenCache.getToken(e)).then((e=>({header:(e=e||{}).header,expiresAt:e.expiresAt,tokenType:""}))).catch((e=>{var t;const s=e.innerErrors;return{header:"",expiresAt:null,tokenType:"",errorMessage:s.length?null===(t=s[0])||void 0===t?void 0:t.errorMessage:e.message}}))}))},d.initialize((e=>this.getTokenFunc(e).then((e=>e.header))))}isSessionEnded(){return this._sessionEnded}getDiagnosticsData(){return{user:this._user}}async getToken(e){const t=(e=e||{}).skipCache||!!e.wwwAuthHeader||!!e.tenantId,s=!e.tenantId,{extensionName:i,isBackground:o,isThirdPartyExtension:r}=e;let{resourceName:a,audience:l}=e;a=a||"";let c=i===b?"HubsExtension":i,p=a;"telemetrytoken"===a.toLowerCase()&&(c="HubsExtension",p=MsPortalFx.isFeatureEnabled("selftoken")?"self":"");const m=this.shellTokenCache;let g=1;const h=await this._experimentation.getAssignments(),v=z(h),y=async()=>{if(!t){const e=this._authStateManager.tokenCache[c];if(e){const t=e[p];if(t){const e=t.header,s=t.expiresAt;if(s>O())return u.trace({source:"Services.SecurityTokens",action:e?"GetCachedToken":"GetCachedErrorResponse",name:i,data:{normalizedExtensionName:c,normalizedResourceName:p,resourceName:a,cacheEntryExpirationTicks:s}}),Promise.resolve(Object.assign(Object.assign({},t),{token:e?{header:e,expiresAt:s}:null}));this._authStateManager.clearExtensionTokens(c)}}}let d="";if(v){const e=(await this._extensionsAuthMetadataLoadPromise)[c.toLowerCase()];if(!e){x.warning(`The extension '${c}' was not found in the list of extensions registered with the portal. The portal's ARM token will be returned by default.`);const e=this._authStateManager.tokenCache.HubsExtension,t=e&&e[""];if(t)return Q(Object.assign(Object.assign({},t),{token:t||null}));l=w,d=P}if(d=d||e.oAuthClientId,d||(x.warning(`The extension '${c}' does not have an oAuthClientId specified. The portal's client ID will be used to make this request.`),d=P),p&&p.toLowerCase()!==FxImpl.nonCaeArmAliasLowerCase||(l=w,d=P),!l){const t=e.resourceAccessMap;if(!t)return u.trace({source:"Services.SecurityTokens",action:"EmptyAudienceInPortalConfig",name:c,data:{normalizedResourceName:p}}),Q.reject(`The extension '${c}' has not defined any resource access in the portal's configuration.`);const s=t[p.toLowerCase()];if(!s)return u.trace({source:"Services.SecurityTokens",action:"MissingResourceInPortalConfig",name:c,data:{normalizedResourceName:p}}),Q.reject(`The extension '${c}' has not defined the resource access for resource '${p}' in the extension's configuration, or in the portal's configuration.`);if(l=s.resource,d=s.overrideClientId||d,!l)return u.trace({source:"Services.SecurityTokens",action:"MissingAudienceInPortalConfig",name:c,data:{normalizedResourceName:p}}),Q.reject(`The extension '${c}' has an invalid audience for the resource '${p}' in the extension's configuration or portal's configuration.`)}const t=_.exec(l);if(t&&t.length){const e=l;if(l=S.get(t[0]),!l)return Q.reject(`The extension '${c}' has an unsupported placeholder '${e}' as the audience for the resource '${p}' in the extension's configuration or portal's configuration.`)}l===d&&(d=P),u.trace({source:"Services.SecurityTokens",action:"ExtensionTokenRequestSummary",name:i,data:{normalizedExtensionName:c,normalizedResourceName:p,audience:l,extensionClientId:d,isThirdPartyExtension:r}})}const M=O(),I=Object.assign(Object.assign({},e),{extensionName:c,resourceName:p,skipCache:t,extensionClientId:d,audience:l}),F=U(h,c.toLowerCase(),p.toLowerCase()),E=u.start({source:"Services.SecurityTokens",action:"GetTokenResult"});return(F?this._getTokenFromMsalJs(I):this._getTokenFromServer(I)).then((r=>{var h;const v=(r=r||{}).value||{};let I=v.status,P=v.errorMessage;const w=v.missingClaims,_=v.authHeader;let S;const B=(null===(h=r.relatedExtensionMetadata)||void 0===h?void 0:h.length)?r.relatedExtensionMetadata:[{name:c,resource:p}];if(u.endTrace(E,!!_,{enableMsalJs:F,extensionClientId:d,extensionName:i,normalizedExtensionName:c,resourceName:a,normalizedResourceName:p,audience:l,status:I,errorMessage:P,missingClaimsReceived:!!w}),_&&(MsPortalFx.isFeatureEnabled("prefetchtokens")||MsPortalFx.isFeatureEnabled("msaljsprefetch"))&&this.saveMruTokenFunc({extension:c,resource:p,audience:l}),w)return this.tokenClaimsErrorHandler(i,a,w,P),{token:null,error:"MissingClaims",errorMessage:"Token request failed due to missing claims"};if(_)if(I)x.warning(`Received malformed token with non-null 'authHeader' and 'status' values. If the token has a valid authHeader, the status must be null and vice-versa. Extension: ${i}, resource: ${a}, status: ${I}`);else{const e=O();if(S=M+v.expiresInMs,!(S<=e)){const e={header:v.authHeader,expiresAt:S};return s&&this._persistResponseInCache(B,e),{token:e}}if(!(g>3))return x.warning(`Token fetch took longer than token lifetime, retrying operation. Retry attempt: ${g++}, Token expiration: ${S}, Current time: ${e}`,null,{extensionName:i,resourceName:a,normalizedExtensionName:c,normalizedResourceName:p,isBackground:o,skipCache:t}),y();x.error("Unable to get token after {0} retry attempts.".format(g)),I=k}if(I||(I="NullTokenNullError",x.warning(`Token missing both authHeader and status. The token must contain a valid status if the authHeader could not be obtained. Setting status to "${I}". Extension: ${i}, resource: ${a}`)),I===C.missingBrokerReplyUrl?P=n.missingBrokerReplyUrlError.format(i,d,"https://aka.ms/portalfx/msaljsreplyurl"):I===C.passthroughUserError&&(P=n.passthroughUserError.format(i,this._tenantId,P)),s&&A[I.toLowerCase()]){const e={header:null,expiresAt:M+6e4,error:I,errorMessage:P};this._persistResponseInCache(B,e)}const N=I===D;if(I===T&&["UnauthorizedRefreshToken","AccountIdentifierMismatch"].includes(P))this.unauthorizedTokenHandler(i,a,P);else if(I===T||N){if(this._sessionEnded=!0,N||!m)S=M;else{const e=i===b?a:"";S=m.getTokenExpiresAt(e)}this.sessionEndedHandler(i,S||M)}else if(I===C.requiresMFA){const e=this._userUsedMfa?n.mfaFailureUserHasMfa:n.mfaFailureUserHasNoMfa.format(f.fx.environment.links.mfa);this.tokenMfaErrorHandler(i,a,e)}else if(!o&&(e.extensionIsSideloaded&&(P+=" Testing extension authorization configuration changes by sideloading is not supported. Please deploy your changes to test."),I!==C.brokerTimeout&&this.tokenFailedHandler(i,a,P),i!==b)){const e="Failed to get token for {0} & {1}. Error:{2}. Message:{3}".format(i,a,I,P);I===k?x.error(e):x.verbose(e)}return{token:null,error:I,errorMessage:P}}))};return Q(y()).then((e=>{const t=null==e?void 0:e.token;return v&&r&&t.header?async function(e,t){var s;const i=e.header,o=u.start({source:"Services.SecurityTokens",action:"GetThirdPartyEncryptedToken",name:t}),{encryptedToken:n}=await d.postJSON({uri:I,dataType:"json",setAuthorizationHeader:!1,headers:{authorization:i},performRetry:!1},{extensionName:t});let r;return r=n?{token:{header:n,expiresAt:e.expiresAt}}:{error:k,errorMessage:"Failed to encrypt the authorization header."},u.endTrace(o,!!(null===(s=r.token)||void 0===s?void 0:s.header),{isNonEmptyTokenHeader:!!i}),r}(t,i):e}))}async getPopToken(e){const t=this._authStateManager.bootstrapState.refreshToken,s=this._authStateManager.bootstrapState.altRefreshToken,i=new r(M);return(await d.postJSON({uri:i.toString(),dataType:"json",setAuthorizationHeader:!1,performRetry:!1},{extensionName:e.extensionName,portalAuthorization:t,altPortalAuthorization:s,tenant:this._tenantId,httpMethod:e.resourceRequestMethod,scopes:e.scopes,requestUri:e.resourceRequestUri,shrClaims:e.shrClaims})).value}_getTokenFromMsalJs(e){const t=[e.audience+"/.default"],{extensionName:s,extensionClientId:i,tenantId:o,popTokenData:n,wwwAuthHeader:r}=e;let a;if(i.toLowerCase()===P){const i=MsPortalFx.isFeatureEnabled("cae")&&e.resourceName.toLowerCase()!==FxImpl.nonCaeArmAliasLowerCase||H(s);a=this.portalAuthHandlerPromise.then((e=>e.acquireTokenForPortal({scopes:t,wwwAuthHeader:r,addXmsCcClaim:i})))}else a=this.portalAuthHandlerPromise.then((e=>e.acquireTokenForExtension({scopes:t,extensionClientId:i,tenantId:o,popTokenData:n,wwwAuthHeader:r,addXmsCcClaim:H(s)})));return a.then((e=>({value:e,portalAuthorization:"",altPortalAuthorization:""})))}_getTokenFromServer(e){if(MsPortalFx.isFeatureEnabled("paralleltokens")){const{extensionName:t,resourceName:s}=e,i=(t+"_"+s).toLowerCase();let o=N[i];return o&&!e.skipCache||(N[i]=o=this._getToken(e)),o.finally((()=>{N[i]=null}))}return this._ongoingTokenRequest=this._ongoingTokenRequest.then((()=>this._getToken(e))),this._ongoingTokenRequest}_getToken(e){const{extensionName:t,resourceName:s}=e,i=this._authStateManager.bootstrapState.refreshToken,o=this._authStateManager.bootstrapState.altRefreshToken,n=function(e){const t={extensionName:e.extensionName,resourceName:e.resourceName,tenant:e.tenant,portalAuthorization:e.portalAuthorization,wwwAuthHeader:e.wwwAuthHeader,authConfigStamp:e.authConfigStamp,altPortalAuthorization:e.altPortalAuthorization,sshTokenData:e.sshTokenData},s=u.start({source:"Services.SecurityTokens",action:"Get",name:e.extensionName});let i="",o="";const n=new r(y),a=Object.assign({},v);return H(e.extensionName)&&(a["feature.cae"]="true"),e.skipCache?a["feature.tokencaching"]="false":a["feature.tokencaching"]=`${MsPortalFx.isFeatureEnabled("tokencaching")}`,Q(d.postJSON({uri:n.toString(),dataType:"json",setAuthorizationHeader:!1,performRetry:!1,headers:{"x-ms-feature-flags":JSON.stringify(a)}},t)).catchError(MsPortalFx.Errors.AjaxError,(t=>{var s,n,r,a;i="Failed to get tokens for extension '{0}' resource '{1}'. {2} {3} {4}".format(e.extensionName,e.resourceName,null!==(n=null===(s=null==t?void 0:t.jqXHR)||void 0===s?void 0:s.status)&&void 0!==n?n:"",null!==(r=null==t?void 0:t.textStatus)&&void 0!==r?r:"",null!==(a=null==t?void 0:t.errorThrown)&&void 0!==a?a:"");let l="";return t?t.jqXHR?t.jqXHR.responseText||(l="response.jqXHR.responseText"):l="response.jqXHR":l="response",o=l?`${l} was undefined.`:t.jqXHR.responseText.slice(0,20),Q.reject(t)})).finally((()=>{u.endTrace(s,!i,{error:i,resourceName:e.resourceName,skipCache:e.skipCache,errorResponseText:o})}))}({extensionName:t,tenant:this._tenantId,resourceName:null!=s?s:"",portalAuthorization:i,skipCache:e.skipCache,wwwAuthHeader:e.wwwAuthHeader,authConfigStamp:e.authConfigStamp,altPortalAuthorization:o}).catch((e=>{var t,s,n,r,a;const l=null!==(t=e.data)&&void 0!==t?t:{},d=l.status;let c;c=401===d?D:400===d?B:d?k:E;const p=null!==(r=null===(n=null===(s=null==e?void 0:e.jqXHR)||void 0===s?void 0:s.responseJSON)||void 0===n?void 0:n.message)&&void 0!==r?r:e.message,u=null!==(a=null==e?void 0:e.stack)&&void 0!==a?a:"";return{portalAuthorization:i,value:{authHeader:null,expiresInMs:0,refreshToken:null,status:c,errorMessage:`code: ${d}, statusText: ${l.statusText}, message: ${p}, stack: ${u}`},altPortalAuthorization:o}}));return n.then((e=>(this._authStateManager.updateRefreshToken(e.portalAuthorization||i,e.altPortalAuthorization||o),e)))}_persistResponseInCache(e,t){this._authStateManager.updateExtensionTokens(e,t)}_createShellTokenCache(e,t,s){var i,o;const n=Object.create(null);if(e){const t=null!==(i=e.expiresInMs)&&void 0!==i?i:1;n[""]={header:e.authHeader,expiresAt:t>0?s+t:-1}}if(t){const e=null!==(o=t.expiresInMs)&&void 0!==o?o:1;n.self={header:t.authHeader,expiresAt:e>0?s+e:-1}}return g.createAuthTokenCache((s=>this._sessionEnded?Q({error:T}):this.getToken(Object.assign(Object.assign({},s),{extensionName:b,resourceName:s?s.resourceName:"",skipCache:s.skipCache})).then((i=>{var o;const n=(null!=i?i:{}).token;if(n&&R.includes(s.resourceName)){const i=O(),r=null!==(o=this._authStateManager.bootstrapState)&&void 0!==o?o:{};let a,l;""===s.resourceName?(a={authHeader:n.header,expiresInMs:n.expiresAt-i},l=t):(a=e,l={authHeader:n.header,expiresInMs:n.expiresAt-i});const d=Object.assign(Object.assign({},r),{createdOn:i,oAuthToken:a,selfOAuthToken:l});this._authStateManager.updateBootstrapState(d,"getTokenFunc")}return i}))),n)}};W=__decorate([__metadata("fx:diagnostics",[e,"SecurityTokensManager"]),s.Class(),__metadata("design:paramtypes",[i.AuthStateManager,a.Experimentation,o.WindowManager,s.Container])],W),t.SecurityTokensManager=W})),
define("MsPortalImpl/Services/Services.Settings",["require","exports","Fx/DependencyInjection","FxHubs/HubsSettingsSchema","MsPortalImpl/Services/Services.SecurityTokens","MsPortalImpl/UI/UI.NavigationManager","FxHubs/RpcEndPoints","FxInternal/AsyncLoader","Fx"],(function(e,t,s,i,o,n,r,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.readExtUserSettingsHandler=t.readBrowserStorageSettingsHandler=t.writeBrowserStorageSettingsHandler=t.writeUserSettingsHandler=t.readUserSettingsHandler=t.deleteUserSettingsHandler=t.deleteUserSettings=t.writeUserSettings=t.readUserSettings=t.flush=t.SettingsManager=t.Internal=t.queryStores=t.getDashboardStoreId=t.getDashboardStoreName=t.getAllStoreIds=t.PortalStartupMarkers=void 0;var d=MsPortalFx.Base,c=d.Net2,p=MsPortalFx.Base.Diagnostics,u=MsPortalFx.tryImmediateResolve;const m=fx.environment,g=fx.environment.applicationPath+"/api/Settings{0}",h=g.format("/Update"),f=g.format("/Select"),x=g.format("/Clear"),b=g.format("/ClearAll"),v=d.Diagnostics.createLog(e);d.getVersionFromString(m.version).revision=0;const y={General:0,Blade:1,Part:2,LensState:3,Startboard:4,SharedPart:5,HubsExtension:6,CrossTenant:7,Favorites:8,DashboardInventory:9,FileUpload:10,FirstVisited:12,StartupNotifications:13,ArgQueryInventory:14,Browse:15,Recents:16,Hats:18,ResourceFilters:19,TrialLanding:20,Contactability:21},M=(0,l.forEachKey)(y,((e,t,s)=>{s[t]=e}),[]);(()=>{for(let e=0;e<100;e++){const t="Dashboard"+e,s=e+1e3;y[t]=s,M[s]=t}})();let I=class{};function C(e,t,s){const i={};return i[t]=s,{store:e,settings:i}}var P;I=__decorate([__metadata("fx:diagnostics",[e,"PortalStartupMarkers"]),s.Class()],I),t.PortalStartupMarkers=I,t.getAllStoreIds=function(){return MsPortalFx.map(y,MsPortalFx.identity)},t.getDashboardStoreName=function(e){return M[e+1e3]},t.getDashboardStoreId=function(e){return y[e]},t.queryStores=function(e,t){if(!t||!t.length)return Q(new Map);const s=t.map((t=>e.queryStore(t)),e);return Q.all(s).then((e=>{const s=new Map;return e.forEach(((e,i)=>{s.set(t[i],e)})),s}))},function(e){const t=FxImpl.features.isEnabled("selftoken");function s(e){const t=M[e];if(!t)throw new Error(`Invalid store: ${e}`);return t}function i(e,t){const i={};return t&&t.forEach(((t,o)=>{const n="string"==typeof o?o:s(o);i[n]=t,e&&delete e[n]})),i}function o(e){const t={};var s;e.keys.forEach((s=null,function(e){this[e]=s}),t);const i=new Map;return i.set(e.store,t),i}function n(e,t){const s=MsPortalFx.merge(e,t);let i={settingsToSet:new Map,settingsToDelete:new Map};return i=s.reduce(((e,t)=>(r(e.settingsToSet,e.settingsToDelete,t.settingsToSet),r(e.settingsToDelete,e.settingsToSet,t.settingsToDelete),e)),i),[i]}function r(e,t,s){s&&s.forEach(((i,o)=>{const n="string"==typeof o?o:parseInt(o),r=s.get(n);if(e&&(e.get(n)||e.set(n,{}),a(r,e.get(n))),t){const e=t.get(n);e&&(p(r,e),MsPortalFx.isEmpty(e)&&t.delete(n))}}))}function a(e,t){(0,l.forEachKey)(e,((e,s)=>{t[e]=s}))}function p(e,t){(0,l.forEachKey)(e,(e=>{delete t[e]}))}e.createUserSettingsManager=function(e,t,s,i){return new w(new y(e,new m(g.createWithWriteDeleteBufferTimeout(t,i),s)))},e.getSettingStoreName=s,e.convertSettingQueryToDictionary=o,e.updateDictionary=r,e.updateSettingsDictionary=a,e.sanitizeSettingsDictionary=p;e.InMemorySettingsManagerImpl=class{constructor(){this._maps={}}setSettings(e){(0,l.forEachKey)(e.settings,((e,t,s)=>{s.set(e,JSON.stringify(t))}),this._getMap(e.store))}queryStore(e){const t=this._getMap(e),s={};return t.forEach(((e,t)=>{s[t]=JSON.parse(e)})),Promise.resolve(s)}deleteSettings(e){if(e.keys){const t=this._getMap(e.store);e.keys.forEach((e=>{t.delete(e)}))}}clearSettings(){return Promise.resolve(this._maps={})}flushSettings(){return Promise.resolve()}dispose(){}_getMap(e){return this._maps[e]=this._maps[e]||new Map}};class m{constructor(e,t){this._baseManager=e,this._managersDictionary=new Map,this._managers=[this._baseManager],t&&t.forEach((e=>{this._managers.push(e.manager),e.stores.forEach((t=>{this._managersDictionary.set(t,e.manager)}))}))}queryStore(e,t){return this._getManager(e).queryStore(e,t)}deleteSettings(e,t){return this._getManager(e.store).deleteSettings(e,t)}setSettings(e,t){return this._getManager(e.store).setSettings(e,t)}clearSettings(){return Q.all(this._managers.map((e=>e.clearSettings())))}flushSettings(){return this._baseManager.flushSettings()}dispose(){this._baseManager.dispose()}_getManager(e){return this._managersDictionary.get(e)||this._baseManager}}e.RoutingSettingsManager=m;e.UserSettingsManagerImpl=class{constructor(e,t){this._ajaxState=0,this._memoizedQueryStore=(0,l.memoizePromise)((e=>{const t=(0,l.startTimer)();return Q(this._ajax(f,[e])).then((s=>{this._setAjaxState(1);const i=(null==s?void 0:s.content)&&s.content[e]||{},o=t();return o>5e3&&v.warning(`\n                        Request to store '${e}' took more than 5s to complete.\n                        Request time: ${o}ms.\n                        Response size: ${s&&s.jqXHR&&s.jqXHR.responseText.length}\n                    `),i})).catch((e=>(this._setAjaxState(2,e,`queryStore(duration:${t()})`),{})))})),this._clearAllUserSettings=e.isEnabled("clearallusersettings"),this._useInMemorySettings=e.isEnabled("inmemorysettings"),t=Promise.resolve(t),this._preloadingStores=t.then((e=>(this._setAjaxState(1),e&&e.settings||{})),(e=>(MsPortalFx.Helpers.isXMLHttpRequestLike(e)&&c.isRetryable(e)||v.error(new MsPortalFx.Errors.Error({message:"Early Failed to preload stores.",innerErrors:e}),1),{}))),this._preloadingStores.then((e=>{this._preloadStores=(0,l.forEachKey)(e,((e,t,s)=>{t&&(s[e]=Promise.resolve(t))}),{}),this._preloadingStores=null}))}_ajax(e,s){return s||e!==h&&e!==f?c.ajaxExtended({uri:e,type:"POST",dataType:"json",data:s&&JSON.stringify(s),contentType:"application/json;charset=utf-8",timeout:3e4,performRetry:!0,maxRetryDuration:3e4,setAuthorizationHeader:!t||{resourceName:"self"},headers:{"x-ms-feature-flags":JSON.stringify(MsPortalEarly.earlyBaseFeatureFlags)}}).catchError(MsPortalFx.Errors.AjaxError,(t=>{var i,o;return 400===(null===(i=t.jqXHR)||void 0===i?void 0:i.status)?v.error(`Setting _ajax 400 occurred. uri: ${e}, data: ${MsPortalFx.getObjectDescriptor(s,!0)}.`):(null===(o=t.jqXHR)||void 0===o?void 0:o.status)>=500&&v.error(`Setting _ajax 5xx occurred. uri: ${e}, response: ${t.jqXHR.responseText}.`),Promise.reject(t)})):Promise.reject(FxImpl.createError(`Invalid setting ajax call uri: ${e}, data: ${MsPortalFx.getObjectDescriptor(s)}`))}_setAjaxState(e,t,s){if(e>this._ajaxState&&(this._ajaxState=e,2===e)){(t&&t.data&&0===t.data.status?v.warning:v.error).bind(v)(new MsPortalFx.Errors.Error({message:`${s} Setting is transitioned into HasFailRequests state. All further querystore/updatesetting will be in-memory mode.`,innerErrors:t}))}}queryStore(e,t){const i="string"==typeof e?e:s(e);return this._ajaxState>=2?Q({}):(t&&this._memoizedQueryStore.delete(i),this._preloadingStores?this._preloadingStores.then((e=>e[i]||this._memoizedQueryStore(i))):this._preloadStores[i]||this._memoizedQueryStore(i))}clearSettings(){(0,l.forEachKey)(this._preloadStores,(e=>{delete this._preloadStores[e]})),this._memoizedQueryStore.clear();const e=(0,l.startTimer)();return this._ajax(this._clearAllUserSettings?b:x).catch((t=>{this._setAjaxState(2,t,`clearSetting(duration:${e()}):`)}))}updateSettings(e){if(!this._useInMemorySettings&&1===this._ajaxState){const t={save:i(this._preloadStores,e.settingsToSet),remove:i(this._preloadStores,e.settingsToDelete)};if(t.save||t.remove){const e=(0,l.startTimer)();return this._ajax(h,t).catch((t=>(this._setAjaxState(2,t,`updateSettings(duration:${e()}):`),Promise.reject(t))))}}return Promise.resolve()}};class g{constructor(e,t,s,i){this._primitiveSettingsManager=e,this._sequencer=t(n,(e=>this._executeMethod(e[0])),s,!0,{optionalDataInterval:i})}static createWithWriteDeleteBufferTimeout(e,t,s){return new g(e,((e,t,s,i,o)=>new d.Debouncer(e,t,s,i,o)),t||5e3,s||3e5)}queryStore(e,t){return this._primitiveSettingsManager.queryStore(e,t)}setSettings(e,t){return MsPortalFx.isEmpty(e.settings)?Promise.resolve():new Promise(((s,i)=>{const o=new Map;o.set(e.store,e.settings),this._sequencer.execute([{settingsToSet:o,settingsToDelete:null}],1===t,s,i)}))}deleteSettings(e,t){return e.keys&&e.keys.length?new Promise(((s,i)=>{this._sequencer.execute([{settingsToSet:null,settingsToDelete:o(e)}],1===t,s,i)})):Promise.resolve()}flushSettings(){return this._sequencer.flush()}clearSettings(){const e=Q.defer();return this.flushSettings().finally((()=>{this._primitiveSettingsManager.clearSettings().finally((()=>{e.resolve()}))})),e.promise}dispose(){this.flushSettings()}_executeMethod(e){return this._primitiveSettingsManager.updateSettings(e)}}e.SequencingSettingsManager=g;class y{constructor(e,t){this._cache=new Map,this._activeUpdatePromises=new Map,this._uniqueId=1,this._memoizedQueryPromises=(0,l.memoizePromise)((e=>{const t=this._verifySettings()?Q(this._baseManager.queryStore(e)):Q({});return Q(u(t,(t=>this._updateCaches(e,t))))})),this._useInMemorySettings=e.isEnabled("inmemorysettings"),this._baseManager=t}queryStore(e,t){return t?(this._memoizedQueryPromises.delete(e),this._baseManager.queryStore(e,t).then((t=>this._updateCaches(e,t)))):this._memoizedQueryPromises(e)}setSettings(e,t,s){return new Promise(((i,o)=>{this._execute(this._setSettingsInternal,e,t,i,o,s)}))}dispose(){this._baseManager.dispose()}_setSettingsInternal(e,t,s,i,o,n){const r=this._writeSettingsToCache(e,!0),a=()=>{var e;return null===(e=this._baseManager.setSettings(r,t))||void 0===e?void 0:e.then(i).catch(o)};n?(a(),this._resolveSetPromise(s)):this._executeIfBaseManagerCallIsAllowed(a,s)}_resolveSetPromise(e){const t=this._activeUpdatePromises.get(e);t&&(t.resolve(),this._activeUpdatePromises.delete(e))}_execute(e,t,s,i,o,n){const r=this._uniqueId++;if(this._activeUpdatePromises.set(r,Q.defer()),t){const a=t.store,l=()=>{e.call(this,t,s,r,i,o,n)};this._cache.get(a)?l():this.queryStore(a).then(l)}}deleteSettings(e,t){return new Promise(((s,i)=>{this._execute(this._deleteSettingsInternal,e,t,s,i)}))}_deleteSettingsInternal(e,t,s,i,o){this._deleteSettingsFromCache(e),this._executeIfBaseManagerCallIsAllowed((()=>{var s;null===(s=this._baseManager.deleteSettings(e,t))||void 0===s||s.then(i).catch(o)}),s)}clearSettings(){const e=Q.defer();return this.flushSettings().finally((()=>this._baseManager.clearSettings().finally((()=>{this._cache=new Map,this._memoizedQueryPromises.clear(),e.resolve()})))),e.promise}flushSettings(){const e=[];return this._activeUpdatePromises.forEach((t=>e.push(t))),Q.all(e).then((()=>this._baseManager.flushSettings()))}_updateCaches(e,t){return this._writeSettingsToCache({store:e,settings:t}),this._cache.get(e)}_verifySettings(){return!this._useInMemorySettings}_executeIfBaseManagerCallIsAllowed(e,t){e(),this._resolveSetPromise(t)}_deleteSettingsFromCache(e){const t=this._cache.get(e.store);e.keys&&t&&e.keys.forEach((e=>{delete t[e]}))}_writeSettingsToCache(e,t){const s=e.store;if(e){this._cache.has(s)||this._cache.set(s,{});const i=this._cache.get(s),o={};return(0,l.forEachKey)(e.settings,((e,s)=>{(!t||i[e]!==s&&JSON.stringify(i[e])!==JSON.stringify(s))&&(i[e]=o[e]=s)})),{store:s,settings:o}}return null}}e.CachingSettingsManagerImpl=y}(P=t.Internal||(t.Internal={}));class w{constructor(e){this._baseManager=e}deleteSettings(e,t){this._baseManager.deleteSettings(e,t)}deleteSettingsWithPromise(e,t){return this._baseManager.deleteSettings(e,t)}clearSettings(){return this._baseManager.clearSettings()}flushSettings(){return this._baseManager.flushSettings()}dispose(){this._baseManager.dispose()}async queryStore(e,t,s){const i=await this._baseManager.queryStore(e,t);return s?i:_(i)}querySettings(e,t){return e.keys&&e.keys.length>0?this.queryStore(e.store,t,!0).then((t=>{const s={};if(t){e.keys.filter((e=>e in t)).forEach((e=>{s[e]=t[e]}))}return _(s)})):this.queryStore(e.store,t)}querySetting(e,t,s){return this.querySettings({store:e,keys:[t]},s).then((e=>{if(e){const s=e[t];return void 0===s?null:s}return null}))}setSettings(e,t){this._baseManager.setSettings(_(e),t)}setSetting(e,t,s,i){this.setSettings(C(e,t,s),i)}setSettingWithPromise(e,t,s,i){return this._baseManager.setSettings(_(C(e,t,s)),i)}readSettingsRpc(e,t){const s=e,o=MsPortalFx.find(e,(e=>!i.allowedUserSettingsKeys.includes(e)));if(o)throw p.createIgnoreUnhandledRejectionError(`${t.srcWindowId} is not allowed to read the user setting ${o}.`);return F(this,s).then((e=>{const t={};return Object.getOwnPropertyNames(e).forEach((s=>{t[s]=e[s]})),t}))}static create(e,t,s){const i={manager:new P.InMemorySettingsManagerImpl,stores:[11]},o=e.isEnabled("day0settings"),n=P.createUserSettingsManager(e,new P.UserSettingsManagerImpl(e,!o&&MsPortalEarly.preload),[i]);return t.unloadCallbacks.push((()=>S(n))),o?n.clearSettings().then((()=>{const e=new d.UriBuilder(t.location.href);return e.query.removeParameters(["day0settings","feature.day0settings"]),t.redirect({uri:e.toString(),skipFlushBuffers:!0,reason:"useDayZeroSettings"}),Q.defer().promise})):n}}function _(e){return JSON.parse(JSON.stringify(e))}function S(e){const t=[e?e.flushSettings():Promise.resolve(),p.Telemetry.flush(),p.Upload.flush()];return Promise.all(t)}function F(e,t,s){const i={store:MsPortalFx.isNullOrUndefined(s)?6:s,keys:t};return e.querySettings(i).then((e=>t.length?MsPortalFx.convertArrayToMap(t,MsPortalFx.identity,(t=>e[t])):e))}function k(e,t,s,i){const o={store:i||6,settings:t};e.setSettings(o,s)}function T(e,t,s){const i={store:s||6,keys:t};e.deleteSettings(i)}__decorate([__metadata("fx:diagnostics",[e,"SettingsManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[FxImpl.Features,n.WindowManager,o.SecurityTokensManager]),__metadata("design:returntype",Object)],w,"create",null),t.SettingsManager=w,t.flush=S,t.readUserSettings=F,t.writeUserSettings=k,t.deleteUserSettings=T,t.deleteUserSettingsHandler=(0,a.defineHandler)(i.deleteHubsUserSettings,(e=>T(e.diContainer.get(w),e.messageArg.settingsKeys,e.messageArg.settingStore))),t.readUserSettingsHandler=(0,a.defineHandler)(i.readHubsUserSettings,(e=>F(e.diContainer.get(w),e.messageArg.settingsKeys,e.messageArg.settingStore))),t.writeUserSettingsHandler=(0,a.defineHandler)(i.writeHubsUserSettings,(e=>k(e.diContainer.get(w),e.messageArg.settings,e.messageArg.priority,e.messageArg.settingStore)));const D=[];D[1]="hideBrowseInfo",t.writeBrowserStorageSettingsHandler=(0,a.defineHandler)(r.BrowserStorageSettings.writeBrowserStorageSettingsEndpoint,(e=>{const t=e.messageArg;if(0!==t.storageType)return Q.reject("Access outside of local storage is denied.");let s=!1;return(0,l.forEachKey)(t.storageSettings,((e,t)=>{D[e]||(s=!0)})),s?Q.reject("Certain keys in the list are not allowed to be accessed."):((0,l.forEachKey)(t.storageSettings,((e,t)=>{"string"===MsPortalFx.getTypeOf(t)&&MsPortalImpl.localStorage.setItem(D[e],t)})),Q(null))})),t.readBrowserStorageSettingsHandler=(0,a.defineHandler)(r.BrowserStorageSettings.readBrowserStorageSettingsEndpoint,(e=>{const t=e.messageArg;if(0!==t.storageType)return Q.reject("Access outside of local storage is denied.");const s={};let i=!1;return t.storageKeys.forEach((e=>{D[e]||(i=!0),s[e]=MsPortalImpl.localStorage.getItem(D[e])})),i?Q.reject("Certain keys in the list are not allowed to be accessed."):Q(s)})),t.readExtUserSettingsHandler=(0,a.defineHandler)(FxImpl.Azure.ResourceManager.readUserSettingsEndPoint,(e=>e.diContainer.get(w).readSettingsRpc(e.messageArg,e.messageContext)))})),
define("MsPortalImpl/Services/Services.SettingsProcessor",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.create=t.SettingsProcessor=void 0;t.SettingsProcessor=class{constructor(e,t,s){this.value=e,this.flush=t||(()=>Q()),this.dispose=s||(()=>{})}},t.create=function(e,t,s,i,o){const n=new FxImpl.TriggerableLifetimeManager,r={},a=Object.keys(s);return a.forEach((e=>{r[e]=0,s[e].subscribe(n,(s=>{1!==r[e]&&(r[e]=3,void 0===s?t.deleteSettings({store:i,keys:[e]}):t.setSetting(i,e,s),o&&t.flushSettings())}))})),Q(t.queryStore(i)).then((e=>{e=e||{},a.forEach((t=>{const i=e[t];void 0!==i&&0===r[t]&&(r[t]=1,s[t](i),r[t]=2)}))})).then((()=>new e(s,(()=>Q(t.flushSettings())),(()=>n.dispose()))))}})),
define("MsPortalImpl/Services/Services.GeneralSettings",["require","exports","Fx/DependencyInjection","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.SettingsProcessor","FxHubs/HubsSettingsSchema","FxInternal/AsyncLoader"],(function(e,t,s,i,o,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setCurrentDeepLink=t.getCurrentDeepLink=t.writeBrowsePreviewOptInFlagHandler=t.GeneralSettings=t.GeneralSettingsManager=t.isFocusNavigationEnabled=t.isSideBarDocked=t.isLandingPageDashboard=void 0;t.isLandingPageDashboard=function(e){const t=e.get(FxImpl.Features),s=e.get(l).landingPage();return!t.isEnabled("azurehome")||2===s||4===s},t.isSideBarDocked=function(e){const t=e.get(FxImpl.Features),s=e.get(l).sideBarLayout();return!t.isEnabled("sidebarhamburgermode")||2===s||4===s},t.isFocusNavigationEnabled=function(e){const t=e.get(l).focusNavigationMode();return!MsPortalFx.isFeatureEnabled("reservehozscroll")||MsPortalFx.isFeatureEnabled("allowdisablehozscroll")&&(1===t||3===t)};class a extends o.SettingsProcessor{constructor(e,t,s){super(e,t,s)}static create(e,t){const s=new l;return t.registerObjectFactory(FxImpl.Constants.RpcMethods.getSettings,{allowedOrigin:null,allowRemoteChanges:!1,handler:()=>MsPortalFx.clone(s,!1)}),o.create(a,e,s,0)}}__decorate([__metadata("fx:diagnostics",[e,"GeneralSettingsManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[i.SettingsManager,FxImpl.Rpc.Client]),__metadata("design:returntype",Promise)],a,"create",null),t.GeneralSettingsManager=a;class l{constructor(){this.rawLocale=ko.observable(""),this["fxs-theme"]=ko.observable(),this.npsTimeMs=ko.observable(0),this.sideBarCollapsedKey=ko.observable(!1),this.notificationToastEnabledKey=ko.observable(!0),this.whatsNewEnabledKey=ko.observable(!0),this.sideBarBrowseDisplayModeKey=ko.observable(0),this.whatsNewVersion=ko.observable(0),this.userConsentForNpsContact=ko.observable(!1),this.highContrastKey=ko.observable(0),this.idleTimeoutMins=ko.observable(0),this.dblClickThemeEnabledKey=ko.observable(!0),this.searchHistory=ko.observable(""),this.landingPage=ko.observable(MsPortalFx.isFeatureEnabled("landalltohome")?3:4),this.devSatTimeMs=ko.observable(0),this.TestExtensions=ko.observable(),this.TestPatches=ko.observable(),this.sideBarLayout=ko.observable(MsPortalFx.isFeatureEnabled("sidebarhamburgermode")?3:4),this.focusNavigationMode=ko.observable(!MsPortalFx.isFeatureEnabled("reservehozscroll")||MsPortalFx.isFeatureEnabled("allowdisablehozscroll")?3:4)}static create(e){return e.value}}__decorate([__metadata("fx:diagnostics",[e,"GeneralSettings"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[a]),__metadata("design:returntype",l)],l,"create",null),t.GeneralSettings=l,t.writeBrowsePreviewOptInFlagHandler=(0,r.defineHandler)(n.writeBrowsePreviewOptInFlagEndpoint,(e=>{const s=e.messageArg;if((s.assetIds||[]).length){const o=e.diContainer.get(i.SettingsManager);o.querySetting(15,"argBrowsePreference").then((e=>{e=e||{},s.assetIds.forEach((t=>{e[t.toLowerCase()]=s.value})),o.setSetting(15,"argBrowsePreference",e);const i=(0,t.getCurrentDeepLink)().toLowerCase();if(!s.preventAutoBladeLaunch&&(i.startsWith("#blade/HubsExtension/BrowseResource/resourceType/".toLowerCase())||i.startsWith("#blade/HubsExtension/BrowseResourceBlade/resourceType/".toLowerCase())||i.startsWith("#view/HubsExtension/BrowseResource/resourceType/".toLowerCase())||i.startsWith("#view/HubsExtension/BrowseResourceBlade/resourceType/".toLowerCase()))){const e=encodeURIComponent(s.resourceType);let i=s.value?"#view/HubsExtension/BrowseResource/resourceType/"+e:"#view/HubsExtension/BrowseResourceBlade/resourceType/"+e;s.kind&&(i=i+"/kind/"+encodeURIComponent(s.kind)),(0,t.setCurrentDeepLink)(i)}}))}}));t.getCurrentDeepLink=()=>window.location.hash||"";t.setCurrentDeepLink=e=>{window.location.hash=e}})),
define("_generated/Less/MsPortalImpl/Themes/Themes.Reset.css",["module"],(function(e){"use strict";return{css:'.fxs-display-none{display:none !important}.fxs-hide-accessible-label{overflow:hidden;position:absolute;top:-1000px;left:-1000px;width:0;height:0}html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{font-size:100%;font-weight:inherit}html{-webkit-text-size-adjust:100%;text-size-adjust:100%}html,body{height:100%}body{font-family:az_ea_font,"Segoe UI",az_font,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;font-weight:400;margin:0;padding:0;overflow:hidden}button,input,select,textarea{font-family:az_ea_font,"Segoe UI",az_font,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;font-weight:400;border-radius:0}input::-ms-clear{display:none}button,[type="button"],[type="reset"],[type="submit"]{font-size:13px;line-height:1.385;background:none;color:inherit}img{overflow:hidden;max-height:100%;max-width:100%}textarea{overflow:auto}img,a img,:link img,:visited img{border:0}a[href]{-webkit-touch-callout:default}a[href]:not([tabindex="-1"]):focus,area[href]:not([tabindex="-1"]):focus,input:not([disabled]):not([tabindex="-1"]):focus,select:not([disabled]):not([tabindex="-1"]):focus,textarea:not([disabled]):not([tabindex="-1"]):focus,button:not([disabled]):not([tabindex="-1"]):focus,iframe:not([tabindex="-1"]):focus,[contentEditable="true"]:not([tabindex="-1"]):focus{outline-offset:-1px}[tabindex="0"]:focus{outline-offset:-1px}tbody tr[tabindex]:not([tabindex="-1"]):focus{box-shadow:none}a{text-decoration:none}b,strong{font-weight:700}pre,code{font-family:Consolas,"Courier New",monospace;font-size:13px}legend,fieldset{border:0;margin:0;padding:0}hr{border-width:0;border-top-width:1px;border-top-style:solid}[role="button"],[role="link"],.fxs-fxclick{cursor:pointer}a[href]:hover,[role="link"].fxs-fxclick:hover{text-decoration:underline}::placeholder{opacity:1}@supports (outline-offset:-1px){:focus{outline-width:1px;outline-style:solid}}@supports (-webkit-touch-callout:none){*{-webkit-touch-callout:none}}svg{overflow:hidden}',moduleId:e.id}})),
define("MsPortalImpl/Base/Themes",["require","exports","Fx/DependencyInjection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.GeneralSettings","FxInternal/Css","_generated/Less/MsPortalImpl/Themes/Themes.Reset.css"],(function(e,t,s,i,o,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThemeManager=void 0;const a=MsPortalFx.isFeatureEnabled("theme2");(0,n.injectCss)(r);var l=MsPortalFx.Base,d=l.Resources,c=l.Diagnostics.Telemetry.trace;const p=window,u="fxs-mode-standardcontrast ext-mode-standardcontrast",m="fxs-mode-highcontrast ext-mode-highcontrast",g="fxs-highcontrast-dark ext-highcontrast-dark",h="fxs-highcontrast-light ext-highcontrast-light",f=i.Themes.Names,x="_generated/Less/MsPortalImpl/Themes/Themes.{0}.css",b="_generated/Less/MsPortalImpl/Themes/Theme2.Colors.{0}.css",v=MsPortalFx.isFeatureEnabled("themehack2021"),y=window.fx.environment,M={name:"HighContrastMode",mode:1},I={name:"HighContrastMode",mode:0};function C(e,t,s,i,o,n){return{colorCode:e,imageUri:d.getContentUri("Content/Images/MsPortalImpl/Themes/"+t),svg:s,name:i,title:o,mode:n}}function P(e,t,s){c({source:e,action:t,data:s})}class w{constructor(e,t){this._lifetime=new FxImpl.TriggerableLifetimeManager;const s=t["fxs-theme"],i=t.highContrastKey,o=C("#f1f1f8","Theme_Light.png",l.Images.Themes.Light(),"light",f.light,0),n=C("#333","Theme_Dark.png",l.Images.Themes.Dark(),"dark",f.dark,1),r=this._themes=[C("#0078d4","Theme_Azure.png",l.Images.Themes.Azure(),"azure",f.azure,0),C("#215b7d","Theme_Blue.png",l.Images.Themes.Blue(),"blue",f.blue,0),o,n];let a,d=MsPortalFx.find(r,(e=>e.name===(s()||this.getDefaultTheme()).name));MsPortalFx.isNullOrUndefined(d)&&(d=r[1]),this.currentTheme=s,s(d),this.highContrastMode=i,ko.reactor(this._lifetime,[s,i],((t,s)=>{t=t||this._themes[0];const i=0!==s,r=2===s,l=1===s;i&&(t=r?n:o);const d=this._injectStyles(t),c=r?this._injectStyles(M):l?this._injectStyles(I):Q({});Q.all([c,d]).then((()=>{const s=t.mode?"fxs-mode-dark ext-mode-dark":"fxs-mode-light ext-mode-light";e.removeClass(a).addClass(a="fxs-theme-"+t.name+" "+s).toggleClass(u,!i).toggleClass(m,i).toggleClass(g,r).toggleClass(h,l)}))})),s.subscribe(this._lifetime,(()=>{P("Shell","SelectedTheme",s().name)})),i.subscribe(this._lifetime,(e=>{P("Shell","SelectedHighContrastMode",i())}));const c=p.matchMedia("(forced-colors: active) and (prefers-color-scheme: light)"),x=p.matchMedia("(forced-colors: active) and (prefers-color-scheme: dark)"),b=[c,x],v=()=>{c.matches?i(1):x.matches?i(2):i(0)};b.forEach((e=>e.addEventListener("change",v))),p.matchMedia("(forced-colors: active)").matches&&v(),this._lifetime.registerForDispose((()=>{e.removeClass(`${a} ${u} ${m} ${g} ${h}`),b.forEach((e=>e.removeEventListener("change",v)))}))}getThemes(){return this._themes}getDefaultTheme(){const e=y.chrome.defaultTheme;if(e){const t=this._themes.filter((t=>t.name===e));if(t&&t.length>0)return t[0]}return this._themes[1]}_injectStyles(t){const s=t.name,i=t.mode,o=s.charAt(0).toUpperCase()+s.slice(1),r=i?"DarkMode":"LightMode";let l;return a||v?(l="HighContrastMode"===o?["_generated/Less/MsPortalImpl/Themes/Theme2.{0}.css".format(o),b.format(o+"."+r)]:["_generated/Less/MsPortalImpl/Themes/Theme2.css",b.format(o)],v&&l.push("_generated/Less/MsPortalImpl/Themes/Theme2.Hack2021Demo.css")):l=[x.format(o),x.format(r)],Q.all(l.map((t=>MsPortalFx.require(t,e)))).then((e=>(0,n.injectCss)(...e)))}dispose(){this._lifetime.dispose()}}class _{static createManager(e){return new w($([window.document.body,window.document.head]),e)}}__decorate([__metadata("fx:diagnostics",[e,"ThemeManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[o.GeneralSettings]),__metadata("design:returntype",_)],_,"createManager",null),t.ThemeManager=_})),
define("MsPortalImpl/Base/Base.Events",["require","exports","Fx/DependencyInjection"],(function(e,t,s){"use strict";function i(e){return e._handle}Object.defineProperty(t,"__esModule",{value:!0}),t.PortalCustomEvents=t.CustomEvents=t.getOrCreateFxElement=t.unwrapFxElement=t.requestFullscreen=t.exitFullscreen=t.isFullscreen=t.fullscreen=t.fxpinmultipleparts=void 0,t.fxpinmultipleparts="fxpinmultipleparts",t.fullscreen="fullscreenchange MSFullscreenChange mozfullscreenchange webkitfullscreenchange",t.isFullscreen=function(){const e=document;return!!(e.fullscreenElement||e.webkitFullscreenElement||e.mozFullScreenElement||e.msFullscreenElement)},t.exitFullscreen=function(){const e=document,t=e.exitFullscreen||e.webkitExitFullscreen||e.mozCancelFullScreen||e.msExitFullscreen;t&&t.call(e)},t.requestFullscreen=function(){const e=document.documentElement,t=e.requestFullscreen||e.webkitRequestFullscreen||e.mozRequestFullScreen||e.msRequestFullscreen;t&&t.call(e)},t.unwrapFxElement=i,t.getOrCreateFxElement=function(e,t){let s=MsPortalFx.find(t(),(t=>i(t)===e));return s||(s={_handle:e},t.push(s)),s};class o{constructor(){this._events=new Map}setElement(e){this._element=e,this._events.forEach(((e,t)=>{e.forEach((e=>{this._setEvent(t,e)}))}))}_setEvent(e,t){if(t.ltm){if(t.ltm.isDisposed&&t.ltm.isDisposed())return;t.ltm.registerForDispose([this._element.setEvents([e,t.callback])])}else this._element.setEvents([e,t.callback])}trigger(e,t){if(!this._element)return;const s=$.Event(e);return s.type=e,s.target=this._element[0],this._element.trigger(s,t),s.isDefaultPrevented()}addHandler(e,t,s){this._events.has(t)||this._events.set(t,[]);const i={ltm:e,callback:s};this._events.get(t).push(i),this._element&&this._setEvent(t,i)}removeHandler(e,t){if(!this._events.has(e))return;const s=this._events.get(e);s.filter((e=>e.callback===t)).forEach((e=>{MsPortalFx.remove(s,e)}))}}t.CustomEvents=o;let n=class extends o{};n=__decorate([__metadata("fx:diagnostics",[e,"PortalCustomEvents"]),s.Class()],n),t.PortalCustomEvents=n})),
define("MsPortalImpl/Services/Clarity",["require","exports","MsPortalImpl/Base/Base.Events","Fx/DependencyInjection"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClarityManager=t.isClarityEnabled=void 0;const o=window,n=o.fx.environment;function r(){const e=MsPortalEarly.query.clientoptimizations||MsPortalEarly.query.trace||MsPortalEarly.query.healthCheck||MsPortalFx.isFeatureEnabled("canmodifyextensions")||MsPortalFx.isFeatureEnabled("canaddgallerypackages")||MsPortalFx.isFeatureEnabled("canmodifystamps")||MsPortalFx.isFeatureEnabled("disableextensions")||MsPortalFx.isFeatureEnabled("prefetch")||MsPortalFx.isFeatureEnabled("ci");return MsPortalFx.isFeatureEnabled("clarity")&&!e}t.isClarityEnabled=r;let a=class{constructor(e){this._lifetime=new FxImpl.TriggerableLifetimeManager,e.addHandler(this._lifetime,"fxdeeplinkchanged",(()=>{r()&&o.clarity&&(o.clarity("stop"),o.clarity("start"),l())}))}initialize(){var e;if(r()&&(null===(e=null==n?void 0:n.clarity)||void 0===e?void 0:e.projectId)){const e=document.createElement("script"),t=`(function(c,l,a,r,i,t,y){\n                                    c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};\n                                    t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;\n                                    y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);\n                                   })(window, document, "clarity", "script", "${n.clarity.projectId}");`;e.append(t),document.head.appendChild(e),l()}}};function l(){o.clarity("identify","azureportal",MsPortalFx.sessionId)}a=__decorate([__metadata("fx:diagnostics",[e,"ClarityManager"]),i.Class(),__metadata("design:paramtypes",[s.PortalCustomEvents])],a),t.ClarityManager=a})),
define("MsPortalImpl/Services/Services.ExtensionTokensManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Services/Services.SecurityTokens","FxInternal/ExtensionRuntime"],(function(e,t,s,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionTokensManager=void 0;var r=MsPortalFx.Base,a=r.Security,l=FxImpl.Security,d=r.Diagnostics.Telemetry;const c=r.Diagnostics.createLog(e),p=l.tokenErrors,u=p.accessDenied,m=p.sessionEnded;class g{constructor(e,t,s){this._shellTokenManager=e,this._extensions=t,this._postBootCache=s,this.createAuthTokenCache=MsPortalFx.memoize((e=>{var t;const s=256&((null===(t=this._extensions[e])||void 0===t?void 0:t.flags)||0),i=a.createAuthTokenCache((t=>this.getSecurityToken(Object.assign(Object.assign({},t),{extensionName:e,resourceName:t.resourceName||"",skipCache:t.skipCache}))));return{getToken:t=>{const o=t&&t.resourceName;return this._shellTokenManager.portalAuthHandlerPromise.then((r=>null===r||s?Q(i.getToken(t)):Q(this._postBootCache.get(e)).then((({extensionEnvironment:s})=>{try{s="string"==typeof s?JSON.parse(s):s}catch(e){c.warning("Unable to parse the extensionEnvironment configuration. Error: "+MsPortalFx.getLogFriendlyMessage(e)),s=null}let r="",a="";const l=null==s?void 0:s.authorization,d=n.getExtensionDefinedResourceAccessInfo({resourceName:o,extensionName:e,authorization:l});return d&&(r=d.resource,a=d.useInfrastructureTenant?FxImpl.internalEnv.fxAadInfrastructureTenantId:""),Q(i.getToken(Object.assign(Object.assign({},t),{audience:r,tenantId:a})))}))))}}}))}getSecurityToken(e){var t;const{extensionName:s,resourceName:i,skipCache:o,wwwAuthHeader:n}=e,r=null!==(t=this._extensions[s])&&void 0!==t?t:{},a=r.flags,l=this._shellTokenManager.shellTokenCache,c=!!(16&a);if(i&&c)return Q({error:u});if(this._shellTokenManager.isSessionEnded())return Q({error:m});const p=!i&&8&a,g="telemetrytoken"===i.toLowerCase(),h="noncaearm"===i.toLowerCase();if(l&&(p||g||h)&&!o&&!e.tenantId)return Q(l.getToken({resourceName:i,wwwAuthHeader:n,isThirdPartyExtension:c})).then((e=>({token:e})));const f=d.start({source:"ExtensionTokensManager",action:"GetToken",name:e.extensionName}),x=this._shellTokenManager.getToken(Object.assign(Object.assign({},e),{extensionIsSideloaded:r.isSideloaded,isThirdPartyExtension:c}));return x.then((e=>{d.endTrace(f,!!e.token,{resourceName:i})})),x}static create(e,t,s){return new g(e,FxImpl.mapValues(t.extensionsAsMap,(e=>({flags:e.flags,isSideloaded:e.isSideloaded}))),s)}}__decorate([__metadata("fx:diagnostics",[e,"ExtensionTokensManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[o.SecurityTokensManager,i.ExtensionManagerOptions,i.PostBootCache]),__metadata("design:returntype",g)],g,"create",null),t.ExtensionTokensManager=g})),
define("MsPortalImpl/Services/Services.BrowserSettings",["require","exports","Fx/DependencyInjection","Weave"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ServiceDependencyState=t.PrivateLinkState=t.temporaryExtensionCount=t.isZoomedInTooDeep=t.hideSmallModals=void 0;const o=window,n=o.screen||{},r=MsPortalFx.isFeatureEnabled("hidemodalsonsmallscreens");t.hideSmallModals=function(){return r&&n.width<480},t.isZoomedInTooDeep=function(){return r&&(o.innerHeight<400&&o.innerWidth<800||100*o.devicePixelRatio>300)};t.temporaryExtensionCount=new class{constructor(){this._extensionCountTable=new Object(null),this._intervalIds=[]}_getCurrentCount(e){var t;return null!==(t=this._extensionCountTable[e])&&void 0!==t?t:0}addIntervalId(e){this._intervalIds.push(e)}flush(){this._extensionCountTable=new Object(null)}flushIntervalIds(){this._intervalIds.filter((e=>clearInterval(e))),this._intervalIds.length=0}incrementCount(e){this._extensionCountTable[e]=this._getCurrentCount(e)+1}getExtensionCountsAsList(){const e=[];return Object.keys(this._extensionCountTable).forEach((t=>{e.push({extension:t,count:this._extensionCountTable[t]})})),e}};let a=class{constructor(){this.isPrivateLinked=(0,i.makeWritableComputation)(!1)}};a=__decorate([__metadata("fx:diagnostics",[e,"PrivateLinkState"]),s.Class()],a),t.PrivateLinkState=a;let l=class{constructor(){this.azureResourceGraphUnavailable=(0,i.makeWritableComputation)(!1)}};l=__decorate([__metadata("fx:diagnostics",[e,"ServiceDependencyState"]),s.Class()],l),t.ServiceDependencyState=l})),
define("MsPortalImpl/Services/SubscriptionAndLocationHelpers",["require","exports","MsPortalImpl/Resources/ImplScriptResources"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.compareSubscriptions=t.mergeSelectedSubscriptionsWithFirstPage=t.getSubscriptionsWithUniqueDisplayNames=void 0;var i=MsPortalFx.Base.Diagnostics.Telemetry;t.getSubscriptionsWithUniqueDisplayNames=function(e){const t=e.subsMap||{},o={},n=[];let r=0;const a=new Set;if(MsPortalFx.forEachKey(t,((e,{subscription:i,notInFirstPage:l})=>{const d=i.displayName,c=i.state,p=(i.subscriptionPolicies||{}).quotaId,{uniqueDisplayName:u}=i,m=__rest(i,["uniqueDisplayName"]);p&&a.size<10&&a.add(p);let g=c&&"disabled"===c.toLowerCase()?s.disabledSubscriptionLabelFormat.format(d):d;const h=o[d];if(h){if(g=s.subscriptionNameAndIdLabelFormat.format(g,e),!h.updated){const e=n[h.index];e.uniqueDisplayName=s.subscriptionNameAndIdLabelFormat.format(e.uniqueDisplayName,e.subscriptionId),h.updated=!0}}else o[d]={index:r,updated:!1};i=Object.assign(Object.assign({},m),{uniqueDisplayName:g}),t[e]={subscription:i,notInFirstPage:l},n.push(i),r++})),a.size){const t=[];a.forEach((e=>t.push(e))),i.trace({source:`${e.telemetrySource}.getSubscriptionsWithUniqueDisplayNames`,action:e.isPortalStartup?"quotaIdsOnPortalLoad":"additionalQuotaIdsOnAllSubscriptionsLoad",data:{quotaIds:t.join(",")}})}return n},t.mergeSelectedSubscriptionsWithFirstPage=function(e,t,s){const i=s?e.length+t.length:Math.min(1e3,e.length+t.length),o=new Map,n=new Array(i);let r=Math.min(e.length,i);for(let t=0;t<r;t++){const s=e[t];o.set(s.subscriptionId,s),n[t]=s}const a=Math.min(t.length,i);let l=0;for(;l<a&&r<n.length;){const e=t[l++];o.has(e.subscriptionId)||(o.set(e.subscriptionId,e),n[r++]=e)}return n.length=r,n},t.compareSubscriptions=function(e,t){const s="disabled",i=(e.state||"").toLowerCase(),o=(t.state||"").toLowerCase(),n=(e.displayName||"").toLowerCase(),r=(t.displayName||"").toLowerCase(),a=(e.subscriptionId||"").toLowerCase(),l=(t.subscriptionId||"").toLowerCase();if(i!==o){if(i===s)return 1;if(o===s)return-1}return MsPortalFx.compare(n,r)||MsPortalFx.compare(a,l)}})),
define("MsPortalImpl/Services/LazyUserData/LazyUserDataHelpers",["require","exports","Fx/Ajax","FxHubs/RpcEndPoints","MsPortalImpl/Services/Services.BrowserSettings","MsPortalImpl/Services/SubscriptionAndLocationHelpers","MsPortalImpl/Services/Services.SecurityTokens","MsPortalImpl/Services/Services.Settings"],(function(e,t,s,i,o,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEV=t.lazyUserDataMemo=t.useGlobalResourceFilters=t.countTypeMap=void 0;i.Subscriptions.CountTypeEnum;var l=MsPortalFx.Base,d=l.Diagnostics,c=d.Telemetry;const p=window,u=d.createLog(e);let m,g=!1;async function h(t){const s=await MsPortalFx.require(e.normalize("./LazyUserData.Deferred"));return await s.getLazyUserData({diContainer:t,useGlobalResourceFiltersPromise:x(t),fetchFirstPageAndSelectedSubscriptions:!0})}async function f(e){g&&u.error("getLazyUserData should only be called once per session");const i=await e.get(r.SecurityTokensManager).getToken({extensionName:"fx",resourceName:"",isBackground:!1,skipCache:!1})||{};g=!0;let a=p.fx.environment.applicationPath;"/"!==a[a.length-1]&&(a+="/");const d=e.get(FxImpl.Features),m=d.isEnabled("selftoken"),f=new l.UriBuilder(a+"api/Portal/GetLazyUserData"),x=c.startTrace({source:"LazyUserDataHelpers",action:"loadLazyUserData"}),b=i.token||{};let v,y="2019-10-01";d.isEnabled("policyforrestypes")&&d.isEnabled("fetchpolicyforrestypes")&&(y="2022-04-01");try{v=(await(0,s.ajaxExtended)({contentType:"application/json",headers:{accept:"application/json","x-ms-feature-flags":JSON.stringify({"feature.inmemorysettings":d.getValue("inmemorysettings"),"feature.globalresourcefilter":d.getValue("globalresourcefilter"),"feature.settingsportalinstance":d.getValue("settingsportalinstance")})},setAuthorizationHeader:!m||{resourceName:"self"},type:"POST",uri:f.toString(),data:JSON.stringify({version:y,armAuthorizationHeader:b.header})})).content}catch(t){u.warning(`Call to GetLazyUserData failed and will be retried on the client. Error details: ${MsPortalFx.getLogFriendlyMessage(t)}`);try{v=await h(e)}catch(e){u.warning(`Failed to load client-side lazyUserData. Error details: ${MsPortalFx.getLogFriendlyMessage(e)}`)}}v=v||{};let M=v.firstPageSubscriptions||{},I=v.serviceHealthAlerts;const C=["Failure_PrivateLink","Failure_CaePolicyValidation"].includes(M.resultCode),P=v.argServiceIsUnavailable||"Failure_ArgServiceUnavailable"===M.resultCode;if(P&&(e.get(o.ServiceDependencyState).azureResourceGraphUnavailable(!0),u.error("ServiceErrorFromArg received from LazyUserDataHelpers")),C&&e.get(o.PrivateLinkState).isPrivateLinked(!0),C||P){c.trace({source:"LazyUserDataHelpers",action:C?"ReceivedPrivateLinkCode":"ARGUnavailableFallback",data:{resultCode:M.resultCode}});try{const t=await h(e);M=t.firstPageSubscriptions||{},I=t.serviceHealthAlerts}catch(e){u.warning(`Failed to load client-side lazyUserData. Error details: ${MsPortalFx.getLogFriendlyMessage(e)}`)}}const w=M.valueMapById||{},_=M.count||{},S=(_.type||"").toLowerCase(),F=v.locations||{},k=v.recentResources||Object.create(null),T=k.recentResources||Object.create(null),D=v.policyForResourceTypes||{isIncomplete:!0};I=I||[];const E=(0,n.getSubscriptionsWithUniqueDisplayNames)({subsMap:w,isPortalStartup:!0,telemetrySource:"LazyUserDataHelpers"}),B=E.length;c.completeTrace(x,{firstPageSubscriptions:{armCount:M.count||{},hasErrors:M.hasErrors,nextLink:M.nextLink,resultCode:M.resultCode,subscriptionsReturned:B},locations:{armCount:F.count||{},hasErrors:F.hasErrors,locationsReturned:(F.value||[]).length,nextLink:F.nextLink},recentResources:{recentResourcesCount:Object.keys(k).length,status:k.status||"unknown",verifiedRecentResourcesCount:Object.keys(T).reduce(((e,t)=>("exists"===T[t].existenceState.toLowerCase()&&e++,e)),0)},serviceHealthAlerts:{returnedCount:I.length}}),M.hasErrors&&u.warning("Subscriptions in GetLazyUserData contained errors.");let A=_.value;return"total"!==S&&(A=B),{firstPageSubscriptions:{subscriptions:E,subscriptionsMap:w,countData:{value:A,type:t.countTypeMap[S]},nextLink:M.nextLink},locations:F,recentResources:"completedsuccess"===(k.status||"").toLowerCase()?T:void 0,serviceHealthAlerts:I,policyForResourceTypes:D}}async function x(e){if(m)return m;if(!e.get(FxImpl.Features).isEnabled("globalresourcefilter"))return m=Promise.resolve(!1);const t=await e.getAsync(a.SettingsManager);return m=t.querySetting(19,"optedIn").then((e=>!!e))}t.countTypeMap={total:1,partial:2,notabletocalculate:4},t.useGlobalResourceFilters=x;let b,v=0;async function y(e){try{return f(e)}catch(t){if(u.warning(`Failed to load lazyUserData. Error details: ${MsPortalFx.getLogFriendlyMessage(t)}`),v<1)return v++,y(e);throw t}}t.lazyUserDataMemo=function(e){return b||(b=y(e),b)}})),
define("MsPortalImpl/Services/Services.Subscriptions",["require","exports","Fx/Ajax","Fx/DependencyInjection","FxHubs/ArmHelpers/ArmApisStartup","FxHubs/HubsSettingsSchema","FxHubs/RpcEndPoints","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/LazyUserData/LazyUserDataHelpers","MsPortalImpl/Services/SubscriptionAndLocationHelpers","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.Tenants","FxInternal/ResourceManagement/Subscriptions","FxInternal/AsyncLoader","Weave","Fx"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEV=t.getInSessionDisplayedSubscriptionsHandler=t.getSubscriptionInfoHandler=t.getInSessionSelectedSubscriptionsObservableHandler=t.searchForSubscriptionsHandler=t.setInSessionSelectedSubscriptionsHandler=t.SubscriptionsUserContext=t.StartupSubscriptionsInfoProvider=t.ServicesSubscriptions=void 0;r.Subscriptions.CountTypeEnum;var x=MsPortalFx.Base.Diagnostics,b=x.Telemetry,v=MsPortalFx.Hubs.Notifications;const y=MsPortalFx.require,M=x.createLog(e),I=(0,f.isFeatureEnabled)("getselectedsubstelemetry"),C=n.Keys.subscriptionsSelected;let P=(0,f.isFeatureEnabled)("argsubscriptions")?parseInt((0,f.getFeatureValue)("maxselectedsubs")||"1000"):100;const w=(0,f.memoizePromise)((()=>Q(y("MsPortalImpl/Services/Services.SubscriptionsDeferred"))));let _=class{constructor(e,t,s,i){this._diContainer=e,this._authStateManager=s,this.globalSelectedSubscriptionsObservable=ko.observable([]),this.loadedSubscriptionsPromise=ko.observable(),this.startupSubscriptionsInfoMemo=(0,f.memoizePromise)((()=>{b.trace({source:"Services.Subscriptions",action:"startupSubscriptionsInfoMemo"});const e=Q(this._loadSubscriptions());return this.loadedSubscriptionsPromise(e),this.handleZeroSubsNotification=e.then((e=>{this.subscriptionsMap=e.subscriptionsMap;const t=4===e.countData.type,s=e.subscriptions.length,i=()=>{const e=1===s?a.subscriptionErrorSingleSubscription:a.subscriptionErrorPluralSubscription,t=a.subscriptionErrorDescription.format(s,e);v.ClientNotification.publish({title:a.subscriptionErrorTitle,description:t,status:v.NotificationStatus.Warning})};if(!s||!e.countData.value)return Q.spread([this._authStateManager.getUserInfo(),this._diContainer.get(u.TenantsService).getHomeTenantsCount()],((e,s)=>y("MsPortalImpl/Services/NoSubsChecks").then((o=>o.handleNoSubsInDirectory(this._diContainer,e,s,(0,l.useGlobalResourceFilters)(this._diContainer)).then((e=>{if(!e&&t)return i()}))))));t&&i()})),e})),this.allSubscriptionsInfoMemo=(0,f.memoizePromise)((()=>Q.spread([this.startupSubscriptionsInfoMemo(),(0,l.useGlobalResourceFilters)(this._diContainer)],((e,t)=>{let s;return b.trace({source:"Services.Subscriptions",action:"allSubscriptionsInfoMemo",data:{nextLink:e.nextLink,startupSubsInfoCountData:e.countData,startupSubscriptionsInfoSubsCount:e.subscriptions.length}}),e.nextLink&&!t?(s=Q(this._loadSubscriptions(e)),s.then((e=>{this.subscriptionsMap=e.subscriptionsMap}))):s=Q(Object.assign(Object.assign({},e),{countData:{type:1,value:e.subscriptions.length}})),this.loadedSubscriptionsPromise(s),s}))));const o="ServicesSubscriptionsConstructor",n=async()=>{if(i.isEnabled("mspfilter")){const e=await y("MsPortalImpl/Services/Services.ProjectedDirectories");return await this._diContainer.getAsync(e.ServicesProjectedDirectories)}return null},r=(0,l.useGlobalResourceFilters)(e),c=async()=>{if(await r)return;const e=await t.querySetting(6,C);return(null==e?void 0:e.split(";"))||[]},p=async e=>{let s;if(e){const e=await w(),t=Q(e.fetchSubscriptions(this._diContainer));this.loadedSubscriptionsPromise(t),this.startupSubscriptionsInfoMemo=(0,f.memoizePromise)((()=>t)),s=t}else s=this.startupSubscriptionsInfoMemo();try{const[e,l,p,u]=await Promise.all([s,c(),n(),r]);let m=l;if(u){if(0===e.countData.value)return[];m=e.subscriptions.map((e=>e.subscriptionId))}else b.trace({source:"Services.Subscriptions",action:o,data:{selectedSubscriptionsInSettingsCount:m.length}});const g=e.subscriptions,h=e.countData.value,f=e.countData.type,x=u?g:g.filter((e=>m.indexOf(e.subscriptionId)>=0));let M=!1,I=Promise.resolve(x);if(!u&&p){const e=await p.getSubscriptionsForSelectedDirectories(x);I=e.length?Promise.resolve(e):p.getSubscriptionsForSelectedDirectories(g)}else 0===x.length&&(b.trace({source:"Services.Subscriptions",action:"zeroValidSelectedSubscriptions"}),I=Promise.resolve(g.slice(0,P)),M=h>0&&2===f);const w=await I;if(!u&&w.length>=P&&(b.trace({source:"Services.Subscriptions",action:"cappedSelectedSubscriptions",data:{selectedSubscriptionsCount:w.length}}),w.length=P,M=h>P),M){const e=(e,t)=>{v.ClientNotification.publish({status:v.NotificationStatus.Information,title:e,description:t,uri:"#menu/directory"})},t=a.SubscriptionsNotification;1===f?e(t.totalCappedTitle.format(P,h),t.totalSubscriptionsCapped.format(P,h)):2===f&&e(t.partialCappedTitle.format(h),t.partialSubscriptionsCapped.format(P,h))}const _=(0,d.mergeSelectedSubscriptionsWithFirstPage)(w,g,i.isEnabled("removesubsdropdownlimit"));if(!u&&w){b.trace({source:"Services.Subscriptions",action:"saveSelectedSubscriptions"});const e=(w||[]).map((e=>e.subscriptionId)).join(";");t.setSetting(6,C,e)}if(i.isEnabled("subscreditcheck")){(await y("MsPortalImpl/Services/SubsCreditCheck")).checkRemainingCredit(w)}if(!i.isEnabled("ci")){const e=w.filter((e=>"pastdue"===e.state.toLowerCase()));if(b.trace({source:"Services.Subscriptions",action:"pastDueSubsCheck",data:{pastDueSubsCount:e.length}}),e.length){(await y("MsPortalImpl/Services/PastDueSubsCheck")).raiseWarningForPastDueSubs(this._diContainer,e)}}return this.globalSelectedSubscriptionsObservable(w),_}catch(e){b.trace({source:"Services.Subscriptions",action:o,data:{err:e}}),M.warning(MsPortalFx.getLogFriendlyMessage(e))}};let m=!1;this.displayedSubscriptionsPromise=ko.observable(p(!1).then((e=>(m=!0,e)))),r.then((e=>{e&&y("MsPortalImpl/Services/Services.GlobalResourceFilters").then((e=>this._diContainer.getAsync(e.ResourceFilterManager))).then((e=>{const t=new FxImpl.TriggerableLifetimeManager;(0,h.subscribe)(t,[e.currentFilter],(async()=>{var e;if(!m)return;const t=p(!0);if(this.displayedSubscriptionsPromise(t),!(null===(e=await t)||void 0===e?void 0:e.length)){const[e,t]=await Promise.all([this._authStateManager.getUserInfo(),this._diContainer.get(u.TenantsService).getHomeTenantsCount()]);(await y("MsPortalImpl/Services/NoSubsChecks")).handleNoSubsInDirectory(this._diContainer,e,t,Promise.resolve(!0))}}))}))}))}async _loadSubscriptions(e){let t;if((e=e||{}).nextLink){const s=await w();t=await s.loadAllSubscriptionsFromArm(e)}else try{const e=(await this._diContainer.get(S).getSubscriptionsInfo()).firstPageSubscriptions||{},{subscriptions:s}=e,i=__rest(e,["subscriptions"]);t=Object.assign(Object.assign({},i),{subscriptions:MsPortalFx.stableSort(s,d.compareSubscriptions)})}catch(e){return M.warning(`Error retrieving first page of subscriptions: \n${MsPortalFx.getLogFriendlyMessage(e)}`),{subscriptions:[],subscriptionsMap:{},countData:{type:0,value:0},nextLink:""}}return b.trace({source:"Services.Subscriptions",action:"_loadSubscriptions",data:{startupStubsNextLink:e.nextLink,subscriptionsCount:t.subscriptions.length,countData:t.countData,nextLink:t.nextLink}}),t}};_=__decorate([__metadata("fx:diagnostics",[e,"ServicesSubscriptions"]),(0,i.Class)(),__metadata("design:paramtypes",[i.Container,p.SettingsManager,c.AuthStateManager,FxImpl.Features])],_),t.ServicesSubscriptions=_;let S=class{constructor(e){this.getSubscriptionsInfo=()=>(0,l.lazyUserDataMemo)(e)}};S=__decorate([__metadata("fx:diagnostics",[e,"StartupSubscriptionsInfoProvider"]),(0,i.Class)(),__metadata("design:paramtypes",[i.Container])],S),t.StartupSubscriptionsInfoProvider=S;let F=class{constructor(e,t,s,i){this._diContainer=e,this._servicesSubscriptions=t,this._settingsManager=s,this._features=i;const o=new FxImpl.TriggerableLifetimeManager;t.displayedSubscriptionsPromise.subscribeAndRun(o,(e=>{this._inSessionDisplayedSubscriptionsPromise=this._globalDisplayedSubscriptionsPromise=e}));const n=this._globalSelectedSubscriptions=t.globalSelectedSubscriptionsObservable;this.inSessionSelectedSubscriptions=ko.observable(n()),t.loadedSubscriptionsPromise.subscribeAndRun(o,(e=>{this._loadedSubscriptionsPromise=e})),this.useGlobalResourceFiltersPromise=(0,l.useGlobalResourceFilters)(e),this._globalSelectedSubscriptions.subscribe(o,(e=>{this.inSessionSelectedSubscriptions(e)}))}getAllSubscriptionsCount(){return this._loadedSubscriptionsPromise.then((e=>e.countData))}getGlobalDisplayedSubscriptions(){return Q(this._globalDisplayedSubscriptionsPromise)}getInSessionDisplayedSubscriptions(){return Q.spread([this.getAllSubscriptionsCount(),this._inSessionDisplayedSubscriptionsPromise,this.getGlobalSelectedSubscriptions()],((e,t,s)=>this._features.isEnabled("removesubsdropdownlimit")||e.value<=1e3?{subscriptions:t,isPartialSet:!1}:{subscriptions:s(),isPartialSet:!0}))}getGlobalSelectedSubscriptions(){const e=I?b.start({source:"Services.Subscriptions",action:"GetSelectedSubscriptions"}):"";return Q(this._globalDisplayedSubscriptionsPromise).then((()=>(I&&b.completeTrace(e,{selectedSubscriptionsCount:this._globalSelectedSubscriptions().length}),this._globalSelectedSubscriptions)))}getInSessionSelectedSubscriptions(){return Q(this._globalDisplayedSubscriptionsPromise).then((()=>this.inSessionSelectedSubscriptions))}setGlobalSelectedSubscriptions(e){return Q(this.useGlobalResourceFiltersPromise).then((t=>t?Q.reject("Unable to set global selected subscriptions with feature.globalresourcefilter enabled"):this.processNewSelectedSubscriptions(MsPortalFx.convertArrayToMap(e,MsPortalFx.identity,(()=>!0))).then((e=>{b.trace({source:"Services.Subscriptions",action:"setGlobalSelectedSubscriptions",data:{areAllSubsSelected:e.areAllSubsSelected,displayedSubscriptionsCount:e.displayedSubscriptions.length,selectedSubscriptionsCount:e.selectedSubscriptions.length,first100SubscriptionIds:e.selectedSubscriptions.slice(0,100).map((e=>e.subscriptionId))}}),this._globalDisplayedSubscriptionsPromise=Q(e.displayedSubscriptions),this._inSessionDisplayedSubscriptionsPromise=Q(e.displayedSubscriptions);const t=e.selectedSubscriptions;this._globalSelectedSubscriptions([...t]);const s=t.length!==e.countData.value||this._features.isEnabled("argsubscriptions")?t.slice(0,P):[];this._settingsManager.setSetting(6,C,s.map((e=>e.subscriptionId)).join(";"))}))))}setInSessionSelectedSubscriptions(e){return this.processNewSelectedSubscriptions(MsPortalFx.convertArrayToMap(e,MsPortalFx.identity,(()=>!0))).then((e=>{b.trace({source:"Services.Subscriptions",action:"setInSessionSelectedSubscriptions",data:{areAllSubsSelected:e.areAllSubsSelected,displayedSubscriptionsCount:e.displayedSubscriptions.length,selectedSubscriptionsCount:e.selectedSubscriptions.length,first100SubscriptionIds:e.selectedSubscriptions.slice(0,100).map((e=>e.subscriptionId))}}),this._inSessionDisplayedSubscriptionsPromise=Q(e.displayedSubscriptions),this.inSessionSelectedSubscriptions(e.selectedSubscriptions)}))}getSubscriptionSearchResults(e){return w().then((t=>t.getSubscriptionSearchResults(e,this._servicesSubscriptions.allSubscriptionsInfoMemo())))}getAllSubscriptionIds(){return Q(this.useGlobalResourceFiltersPromise).then((e=>(e?this._loadedSubscriptionsPromise:this._servicesSubscriptions.allSubscriptionsInfoMemo()).then((e=>({subscriptionIds:e.subscriptions.map((e=>e.subscriptionId)),allSubscriptionsCountData:e.countData})))))}getSubscription(e){return e?this._loadedSubscriptionsPromise.then((t=>(this._subscriptionsNameMap||(this._subscriptionsNameMap=MsPortalFx.convertArrayToMap(t.subscriptions,(e=>e.uniqueDisplayName),(()=>!0))),(0,f.memoizePromise)((e=>Q(this._globalDisplayedSubscriptionsPromise).then((()=>{const t=this._servicesSubscriptions.subscriptionsMap;let i;if(t&&(i=(t[e]||{}).subscription),!i){const i=(0,o.getSubscriptionApi)(e);return(0,s.batch)({uri:i,type:"GET",setTelemetryHeader:"GetSubscription"}).then((e=>{const s=e.content,i=s.displayName;let o=s.state&&"disabled"===s.state.toLowerCase()?a.disabledSubscriptionLabelFormat.format(i):i;return this._subscriptionsNameMap[i]&&(o=a.subscriptionNameAndIdLabelFormat.format(o,s.subscriptionId)),s.uniqueDisplayName=o,t[s.subscriptionId]={subscription:s,notInFirstPage:!1},this._subscriptionsNameMap[o]=!0,s}))}return i})).catch((e=>{const t=(e=e||{}).content,s=e.httpStatusCode,i=MsPortalFx.Base.Diagnostics.createIgnoreUnhandledRejectionError(JSON.stringify({httpStatusCode:s,message:t||e}),(t||{}).stackTrace);throw i.httpStatusCode=s,[401,404,403].includes(s)&&(i.errorLevel=0),i}))))(e)))):Q.reject("Invalid subscription ID.")}processNewSelectedSubscriptions(e){return w().then((t=>{const s=this._servicesSubscriptions,i=this._features.isEnabled("removesubsdropdownlimit")?s.allSubscriptionsInfoMemo():s.startupSubscriptionsInfoMemo();return t.processSelectedSubscriptionChanges(this._diContainer,e,this._loadedSubscriptionsPromise,i,this.useGlobalResourceFiltersPromise)}))}};F=__decorate([__metadata("fx:diagnostics",[e,"SubscriptionsUserContext"]),(0,i.Class)(),__metadata("design:paramtypes",[i.Container,_,p.SettingsManager,FxImpl.Features])],F),t.SubscriptionsUserContext=F,t.setInSessionSelectedSubscriptionsHandler=(0,g.defineHandler)(FxImpl.Azure.setInSessionSelectedSubscriptionsEndPoint,(e=>e.diContainer.get(F).setInSessionSelectedSubscriptions(e.messageArg))),t.searchForSubscriptionsHandler=(0,g.defineHandler)(FxImpl.Azure.searchForSubscriptionsEndPoint,(e=>e.diContainer.get(F).getSubscriptionSearchResults(e.messageArg))),t.getInSessionSelectedSubscriptionsObservableHandler=(0,g.defineHandler)(m.getInSessionSelectedSubscriptionsObservableEndPoint,(e=>e.diContainer.get(F).getInSessionSelectedSubscriptions())),t.getSubscriptionInfoHandler=(0,g.defineHandler)(FxImpl.Azure.getSubscriptionInfoEndPoint,(e=>e.diContainer.get(F).getSubscription(e.messageArg).then((e=>Object.assign({},e))))),t.getInSessionDisplayedSubscriptionsHandler=(0,g.defineHandler)(r.Subscriptions.getInSessionDisplayedSubscriptionsEndPoint,(e=>e.diContainer.get(F).getInSessionDisplayedSubscriptions()))})),
define("MsPortalImpl/Widgets/ReactFrame.Prewarmer",["require","exports","MsPortalImpl/Services/Services.ExtensionStorageManager","MsPortalImpl/Services/Services.ExtensionTokensManager","Fx/DependencyInjection","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Base/Themes","MsPortalImpl/Services/Clarity","FxInternal/Experimentation","Fx/Experimentation","MsPortalImpl/Services/Services.Subscriptions","FxInternal/Lifetime","FxInternal/AsyncLoader","FxInternal/Errors","Fx","FxInternal/Composition/ViewModelComposer"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getShellClientOptimizations=t.getPrefetchableTokenNames=t.getModuleIdAndUrl=t.FramePool=t.reactOrigin=t.SESSION_STORAGE_DEVTOOLS_RECORD_CHANGE_DESCRIPTIONS_KEY=t.SESSION_STORAGE_DEVTOOLS_RELOAD_AND_PROFILE=void 0;var f=MsPortalFx.Base.Diagnostics,x=f.Telemetry;t.SESSION_STORAGE_DEVTOOLS_RELOAD_AND_PROFILE="React::DevTools::reloadAndProfile",t.SESSION_STORAGE_DEVTOOLS_RECORD_CHANGE_DESCRIPTIONS_KEY="React::DevTools::recordChangeDescriptions";const b=f.createLog(e),v=window;let y=MsPortalFx.isFeatureEnabled("reactorigin");const M=MsPortalFx.getFeatureValue("reactviewendpointindex")||"0";t.reactOrigin="*";const I="ReactViewPrewarmer",C=MsPortalFx.Errors.Error,P=MsPortalFx.isFeatureEnabled("verifytopleveldomains"),w={true:fx.environment.reactFrameContentHashes[0],false:fx.environment.reactFrameContentHashes[1],bundle:fx.environment.reactFrameContentHashes[2]},_=["@fluentui/react/lib/Fabric","@fluentui/react/lib/DetailsList","@uifabric/icons/lib","@microsoft/azureportal-reactview/ReactView","@microsoft/azureportal-reactview/Environment","@microsoft/azureportal-reactview/internal/Theming","@fluentui8/react/lib/Fabric","@fluentui8/react/lib/DetailsList","@fluentui8/react/lib/utilities/ThemeProvider","@fluentui8/font-icons-mdl2/lib","@fluentui8/azure-themes/lib/AzureCustomizations"],S=/[^/]*$/,F="Az",k=MsPortalFx.sessionId,T={l:FxImpl.Intl.effectiveLocale,preorderperf:MsPortalFx.getFeatureValue("preorderPerf"),trustedAuthority:FxImpl.trustedParentOrigin,contentHash:w[O()],reactIndex:M,sessionId:k},D=Object.keys(T).reduce(((e,t)=>{const s=T[t];return s?e+`&${t}=${s}`:e}),""),E=Math.floor(100*Math.random());let B=Promise.resolve(),A=1;function N(e){const t=y?fx.environment.reactViewSameOriginEndpoints:fx.environment.reactViewEndpoints,s=void 0===e?"":`&retryCount=${e}`;return`${t.length&&t[Number(M)]||FxImpl.trustedParentOrigin}${fx.environment.applicationPath}/React/Index?reactView=true${D}${s}#postParams/`.replace("{subdomain}",`sandbox-${E}-${A}`)}function O(){var e,t;return null!==(t=null===(e=/_clientoptimizations=(true|false|bundle)/.exec(window.location.search.toLowerCase()))||void 0===e?void 0:e[1])&&void 0!==t?t:fx.environment.clientOptimizations}y&&(B=fetch(N()).then((e=>{const t=String(e.status).substring(0,1);"2"!==t&&"3"!==t&&(y=!1)})).catch((()=>{y=!1})));let R=class{constructor(e){let o,f;this._diContainer=e,this._lifetime=new p.TriggerableLifetimeManager;let M=MsPortalFx.noop;const w=new Map,S=[],k={};this._diContainer.get(d.Experimentation).getAssignments().then((e=>{k.recycle=e.getBooleanValue("Recycle"),k.prewarmContextPanes=e.getBooleanValue("PrewarmContextPanes"),k.earlyDropdownData=e.getBooleanValue("EarlyDropdownData"),k.earlyEssentialsInfo=e.getBooleanValue("EarlyEssentialsInfo")}));const T={};let D=2e4;const E=(e,s,i,o)=>{const n=document.createElement("iframe"),r="_react_frame_"+A++;n.setAttribute("id",r),n.classList.add("fxs-part-frame"),n.classList.add("fxs-portal-bg-txt-br"),n.setAttribute("sandbox",y?"allow-scripts allow-popups allow-modals allow-forms allow-popups-to-escape-sandbox allow-downloads allow-same-origin":"allow-scripts allow-popups allow-modals allow-forms allow-popups-to-escape-sandbox allow-downloads"),n.setAttribute("allow","microphone *; encrypted-media *;clipboard-read;"),n.setAttribute("role","presentation"),n.setAttribute("allowfullscreen","true"),n.classList.add("fxs-extension-frame");const l=e=>{var t;return e.source===n.contentWindow&&(null===(t=e.data)||void 0===t?void 0:t.signature)===F};let d=0,c=!0;const p=[],u=(e,t)=>{p.push({event:e,value:t,timestamp:Date.now(),retryCount:d})};return u("Frame Location",o?"On Demand":"Frame Pool"),u("Frame ID",r),new Promise(((t,s)=>{let i,o;const a=()=>{"visible"===document.visibilityState&&(u("Document Visible"),v.removeEventListener("visibilitychange",a),setTimeout(h,5e3))},p=()=>{u("Network Online"),v.removeEventListener("online",p),setTimeout(h,5e3)},m=(e,t)=>{const s=setTimeout(e,t);return this._lifetime.createChildLifetime().registerForDispose((()=>clearTimeout(s)))},h=()=>{if("hidden"===document.visibilityState)return u("Document Hidden"),void v.addEventListener("visibilitychange",a);if(!v.navigator.onLine)return u("Network Offline"),void v.addEventListener("online",p);b.warning(new C({message:`Timeout occurred. FrameReady message not received within ${D} ms. Time elapsed: ${i()} seconds`,source:I,data:{frameId:r,url:n.src}})),y=!1,d++;const e=i();if(d<3){const t=N(d);b.warning(`${r} load failed. Retry attempt ${d} with ${t}`),n.src=t,D=Math.min(2e4,3*D),u("Retry",{newUri:t,frameTimeout:D,elapsedTime:e}),o=m(h,D)}else c=!1,u("Stop Time","Failure"),u("Elapsed Time",e),s(new C({message:"Failed to load ReactFrame in Prewarmer after 3 attempts.",source:I,data:{frameId:r,url:n.src}})),v.removeEventListener("message",f),v.removeEventListener("visibilitychange",a),v.removeEventListener("online",p)},f=e=>{const s=e.data;if(l(e)&&0===s.kind){const e=i();u("Stop Time","Success"),u("Elapsed Time",e),o.dispose(),D=Math.max(Math.min(D,2*e),2e3),t(),setTimeout((()=>v.removeEventListener("message",f)),1e3),v.removeEventListener("visibilitychange",a),v.removeEventListener("online",p)}else(e=>{var t;return e.source===n.contentWindow&&"ReactFrameRenderer"===(null===(t=e.data)||void 0===t?void 0:t.signature)})(e)&&u("Iframe Script Load",{message:s.message,isSuccess:s.isSuccess})};v.addEventListener("message",f),B.then((()=>{n.src=N(),o=m(h,D),i=(0,g.startTimer)(),u("Start Time"),u("IFrame Source",n.src),n.onload=()=>{u("Frame on load")},n.onerror=e=>{u("Frame on error",{error:MsPortalFx.getLogFriendlyMessage(e)})}})),e.appendChild(n)})).then((()=>Q.all([MsPortalFx.require("_generated/Less/MsPortalImpl/Base/Base.Images.css"),MsPortalFx.require("_generated/Less/MsPortalImpl/Widgets/Widgets.Portal.css")]).then((e=>{var o,d;if(this._lifetime.isDisposed())throw new m.FxDisposedCanceledError;const c=new MessageChannel;n.contentWindow.postMessage({signature:F,kind:3,data:{requireConfig:FxImpl.internalEnv.fxRequireConfig,initModules:_,css:e.map((e=>e.css)).join("\n"),isMenuBlade:!0,preload:MsPortalFx.isFeatureEnabled("preorderpreload"),profile:MsPortalFx.isFeatureEnabled("reactprofile"),portalUri:FxImpl.internalEnv.portalApplicationUri,type:"prewarm",frameType:i,clarityProjectId:(0,a.isClarityEnabled)()&&(null===(d=null===(o=fx.environment)||void 0===o?void 0:o.clarity)||void 0===d?void 0:d.projectId),shellClientOptimizations:H(),internalEnv:{blockUntrustedDomains:FxImpl.internalEnv.blockUntrustedDomains}}},t.reactOrigin,[c.port1]);const p=[];let u=(e,t,s)=>{p.push({kind:e,data:t,azHostId:s})};const g=e=>{if(l(e)){const t=e.data;u(t.kind,t.data,t.azHostId)}};v.addEventListener("message",g);return{id:r,element:n,port:c.port2,setMessageListener:(e,t)=>{T[t]=e,u=(e,t,s)=>{if(T[s])return T[s](e,t);p.push({kind:e,data:t,azHostId:s})},p.splice(0).forEach((({kind:e,data:t,azHostId:s})=>{u(e,t,s)}))},clearMessageListener:()=>{!s.recycle&&v.removeEventListener("message",g)},latestSet:!1,inUse:!1,frameClientOptimizations:O()}})))).finally((()=>{x.trace({source:`ReactViewPrewarmer-${r}`,action:"PrewarmEventHistory",data:p,actionModifier:c?"complete":"cancel"})}))},R=e=>((()=>{if(!f)throw new Error("No root element has been defined yet, cannot create any frames")})(),E(f,k,void 0,e)),U=e=>o||(o=R(e));this.setFrameRoot=e=>{f=e,U()};const W=new Map;function V({extensionName:e,bladeSequenceNumber:t}){const s=e+t;if(W.has(s))return W.get(s);w.has(e)||w.set(e,[]);const i=k.recycle&&MsPortalFx.find(w.get(e),(e=>!e.inUse)),n=t=>(e=>{const t=U(e);return o=null,t})(t).then((t=>(w.get(e).push(t),t))),r=i?Promise.resolve(i):n().catch((()=>n(!0)));return W.set(s,r),r}this.getFrame=(e,t,s,i)=>{const o=(2===e||3===e||1===e&&!k.prewarmContextPanes?E(t,k,e):V({extensionName:s,bladeSequenceNumber:i})).then((s=>{var i;null===(i=S[S.length-1])||void 0===i||i.classList.remove("fxs-reactview-frame-active");const o=s.element;return o.classList.add("fxs-reactview-frame-active"),o.classList.remove("fxs-display-none"),S.push(o),s.container=t,k.prewarmContextPanes&&o.classList.toggle("fxs-contextpane-floated-frame",1===e),s})),n=()=>{M===n&&(U(),M=MsPortalFx.noop)};M=n;return{frame:o,completed:n,dispose:()=>{o.then((e=>{var t,s;const i=e.element;i.classList.remove("fxs-reactview-frame-active");const o=S.findIndex((e=>e===i));-1!==o&&S.splice(o,1),!k.recycle&&i.remove(),null===(t=S[S.length-1])||void 0===t||t.classList.add("fxs-reactview-frame-active"),null===(s=e.onDisposed)||void 0===s||s.call(e)}))}}},this.setLatest=e=>{var a,d,m;const f=(0,g.defer)(),b=(0,g.defer)(),v=null!==(d=null===(a=e.frame)||void 0===a?void 0:a.traceKey)&&void 0!==d?d:x.startTrace({action:"ReactViewLoad",source:"Prewarmer",actionModifier:"mark",data:{extensionName:e.extensionName,viewName:e.viewName,frameId:null===(m=e.frame)||void 0===m?void 0:m.id}}),y=Date.now(),C=[{groupName:"ReactView boot",name:"setLatest",timeStamp:y}],{extensionName:w,viewName:_,parameters:S,frame:T,diContainer:D,inContextPane:E,inSideBar:B,bladeSequenceNumber:A}=e,N=D.get(FxImpl.Rpc.Client);if(N.acquireWindow(w,90),(E||B)&&!T)return;T||o||M();const O=function(e,t,s,i,o){const n=e.get(l.ExperimentationManager).getAssignments().then((e=>e?e._data:{flights:[],assignmentContext:null,variables:{}})),r=t.earlyDropdownData&&e.get(c.SubscriptionsUserContext).getInSessionDisplayedSubscriptions().then((e=>e.subscriptions)),a=t.earlyDropdownData&&r.then((e=>{var t;return null===(t=e[0])||void 0===t?void 0:t.subscriptionId})),d=t.earlyDropdownData&&(()=>{const t=e.getAsync(u.get("MsPortalImpl/Services/Services.ArmLocations","LocationsUserContext")).then((({getLocationsForCreate:e})=>e));return async e=>{const s=await a;return s?(await t)(s,e,null):Promise.resolve([])}})(),p=t.earlyDropdownData&&Promise.all([s,a,MsPortalFx.require("FxInternal/ResourceManagement/ResourceGroups").then((({getArmResourceGroups:e})=>e))]).then((([e,t,s])=>e&&t?s([t]):Promise.resolve([]))),m=t.earlyEssentialsInfo&&Promise.all([o,MsPortalFx.require("FxInternal/Controls/Essentials")]);return(e,l,c)=>{const u=async(t,s,...[i])=>{const o=async o=>{const n={[t]:Object.assign(Object.assign({},!o&&{result:await MsPortalFx.Base.Promises.cancelOnDispose(e,s.then((e=>({result:e})),(e=>({error:e})))),calleeEndTime:Date.now()}),i&&{options:i})};l.postMessage({signature:F,kind:3,data:{type:"shellstate",shellState:n}})};o(!0),o(!1)},g=(e,t)=>{FxImpl.TelemetryContext.usingState((()=>{x.trace({action:e+"Cache",actionModifier:"pushed",data:t,source:I})}),i)},h=t.earlyEssentialsInfo&&m.then((([t,{getEssentialsResourceInfo:s}])=>t&&s(e,t,!0)));u("shellAssignments",n),t.earlyDropdownData&&u("globalSubscriptions",r).then((()=>{g("globalSubscriptions")})),t.earlyDropdownData&&c&&a.then((e=>{if(e){const t=c.resourceTypes;u("locationsForCreate",d(t),{subscriptionId:e,resourceTypes:t}).then((()=>{g("locationsForCreate",{resourceTypes:t})})),s.then((t=>{t&&u("resourceGroups",p,{subscriptionIds:[e]}).then((()=>{g("resourceGroups")}))}))}})),t.earlyEssentialsInfo&&h&&o.then((e=>{e&&u("essentialsResourceInfo",h,{resourceId:e,includeTags:!0}).then((()=>{g("essentialsResourceInfo")}))}))}}(D,k,f.promise,(0,h.getEarlyViewModelTelemetryContext)(w+"/"+_,A),b.promise),R=sessionStorage.getItem(t.SESSION_STORAGE_DEVTOOLS_RELOAD_AND_PROFILE);return Promise.all([D.get(n.PostBootCache).get(w),MsPortalFx.require("MsPortalImpl/Parts/Parts.ReactFrame"),T?Promise.resolve(T):V({extensionName:w,bladeSequenceNumber:e.bladeSequenceNumber}),R?MsPortalFx.require("MsPortalImpl/Parts/ReactDevTools/ReactDevTools").then((async({initializeReactDevTools:e,toggleReactDevTools:t})=>(await e(),t))):Promise.resolve(null)]).then((async([o,n,a,l])=>{if(a.traceKey=v,a&&(a.inUse=!0),null==a?void 0:a.latestSet)return v;const d=D.get(s.ExtensionStorageManager).getStorageForExtension(w).serialize(),{port:c}=n.loadModel(N,w),u=ko.toJS(S),m=D.get(r.ThemeManager),g=o.requireConfig;g.blockedHosts=new Set(MsPortalEarly.blockedHosts);const{id:h,url:M}=_&&L(_,g),k=_&&`${_.substring(0,_.length-".ReactView".length)}.DataFetcher`,T=k&&L(k,g).id;let B=[];if(MsPortalFx.isFeatureEnabled("reacttokenfetch")&&h){const e=D.get(i.ExtensionTokensManager).createAuthTokenCache(w).getToken;e(),B=z(h,g),B.length&&(B.forEach((t=>e({resourceName:t}))),x.trace({source:I,action:"PrefetchCustomToken",name:_,extension:w,data:{resourceNames:B}}))}const A=new p.TriggerableLifetimeManager;if(a.onDisposed=()=>{a.onDisposed=null,A.dispose()},e.bladeSequenceNumber){const t={viewName:_,sequenceNumber:e.bladeSequenceNumber};FxImpl.Extension.onNewReactViewEndPoint.invoke(N,w,t),A.registerForDispose((()=>{FxImpl.Extension.onReactViewDisposed.invoke(N,w,t)}))}C.push({groupName:"ReactView boot",name:"setLatest",timeStamp:Date.now()},{groupName:"ReactView boot",name:"early",timeStamp:Date.now()}),R?(d.sessionStorage[t.SESSION_STORAGE_DEVTOOLS_RELOAD_AND_PROFILE]="true",d.sessionStorage[t.SESSION_STORAGE_DEVTOOLS_RECORD_CHANGE_DESCRIPTIONS_KEY]=localStorage.getItem(t.SESSION_STORAGE_DEVTOOLS_RECORD_CHANGE_DESCRIPTIONS_KEY),l(a.element)):delete d.sessionStorage[t.SESSION_STORAGE_DEVTOOLS_RELOAD_AND_PROFILE],a.element.name=_,a.port.postMessage({signature:F,kind:3,data:{requireConfig:!a.initialized&&_&&g,initModules:[h],parameters:u,type:"early",environment:!a.initialized&&o.extensionEnvironment,features:!a.initialized&&o.features,internalEnv:{blockUntrustedDomains:FxImpl.internalEnv.blockUntrustedDomains},fetcherId:T,serializedStorage:d,tokenResourceNames:B,isMenuBlade:e.isMenuBladeContent,perfLogEntries:C,renderStart:y,azHostId:e.bladeSequenceNumber,verifyLinks:P,theme:{mode:m.currentTheme().mode,highContrastMode:m.highContrastMode()},name:_,inContextPane:E,profileOnLoad:R}},[c]),setTimeout((()=>{!function(e,t,s,i,o,n,r){var a,l,d;let c,p=!1;null===(d=null===(l=null===(a=null==e?void 0:e.dependencyTree)||void 0===a?void 0:a[i])||void 0===l?void 0:l[t])||void 0===d||d.forEach((e=>{"@microsoft/azureportal-reactview/Provisioning"===e?(n.resolve(s.toLocaleLowerCase().split("/").pop().includes("create")),c=!0):"@microsoft/azureportal-reactview/Essentials"===e&&(r.resolve(o.resourceId||o.id),p=!0)})),!c&&n.resolve(!1),!p&&r.resolve(void 0)}(g,h,_,M,S,f,b)}),0);const H="storageaccountcreate.reactview"===_.toLowerCase()&&{resourceTypes:["Microsoft.Storage/storageAccounts"]}||"createexperience.reactview"===_.toLowerCase()&&{};return O(A,a.port,H),a.model=n.loadModelForView(N,g,w,_,u),a.latestSet=a.initialized=!0,v})).catch((e=>{var t;return x.trace({source:I,action:"SetLatestError",actionModifier:"cancel",data:{error:MsPortalFx.getLogFriendlyMessage(e),extensionName:w,viewName:_,frameId:null!==(t=null==T?void 0:T.id)&&void 0!==t?t:"No frame"}}),v}))}}dispose(){this._lifetime.dispose()}};function L(e,t,s=!1){e=e.toLowerCase();const i=s?t=>t.toLowerCase().startsWith(e):t=>{var s;return!t.includes("/_generated/")&&(null===(s=S.exec(t))||void 0===s?void 0:s[0].toLowerCase())===e},o=MsPortalFx.forEachKey(t.dependencyTree||{},((e,t,s)=>{s.id||MsPortalFx.find(Object.keys(t),(t=>{if(i(t))return s.id=t,s.url=e,!0}))}),{id:"",url:""});return o.id||MsPortalFx.forEachKey(t.paths,((e,s,o)=>{if(!o.id&&i(e))return o.id=e,o.url=t.paths[e][0],!0}),o),o}function z(e,t){const s=e.replace(".ReactView",".TokenFetcher."),i=s&&L(s,t,!0).id;return i?i.replace(s,"").split("!"):[]}function H(){return MsPortalEarly.query.clientoptimizations}R=__decorate([__metadata("fx:diagnostics",[e,"FramePool"]),o.Class(),__metadata("design:paramtypes",[o.Container])],R),t.FramePool=R,t.getModuleIdAndUrl=L,t.getPrefetchableTokenNames=z,t.getShellClientOptimizations=H})),
define("MsPortalImpl/Extension/ViewModelManager",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","FxInternal/Composition/ViewModelComposer","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Widgets/ReactFrame.Prewarmer","MsPortalImpl/Extension/ShellPart","MsPortalImpl/Extension/DefinitionCache","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Extension/Extension.Definition.Locator"],(function(e,t,s,i,o,n,r,a,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolve=t.registerWithDi=t.registerWithState=t.ViewModelManager=t.getViewModelOptions=t.getNextSequenceNumber=void 0;var p=FxImpl.TelemetryContext;const u=MsPortalFx.Base.Diagnostics.createLog(e);let m=1;function g(){return m++}function h(e,t,s){return{type:e,locator:"object"==typeof t?t:{name:t},createSelectable:s.createSelectable,telemetryContext:p.getState(),partSize:s.partSize,contentSize:s.contentSize,partLocation:s.partLocation,onInputsSetParameters:s.onInputsSetParameters,collapsed:s.collapsed,flags:s.flags,menuId:s.menuId}}t.getNextSequenceNumber=g,t.getViewModelOptions=h;let f=class{constructor(e,t,s,i,o){this._diContainer=e,this._rpcClient=t,this._extensionManagerOptions=s,this._definitionCache=i,this._extensionLoader=o,this._proxiedObjects=new Map,this._prefetchedResults=[],this._bladeSequenceNumbers=[]}getViewModel(e,t,s,i){return this._getViewModel(e,s,t,i,o.getViewModelEndPoint,!1)}getPartViewModel(e,t,s,n){if(this._useAzViewModelManager(e,t,!!(64&s)))return Q(this._diContainer.getAsync(i.get("MsPortalImpl/AzFramework/AzExtensionCore","AzViewModelManager"))).then((i=>i.getPartViewModel(e,t,s,n)));{const i=this._getViewModel(e,s,t,n,o.getPartViewModelEndPoint,!0),r=(null==n?void 0:n.bladeName)&&64&s,a=r&&this._getBladeRedirector();return i.then((i=>{i||u.error("ViewModelComposer returned null/undefined for the view model",0,[{extensionName:e,type:s,name:t,options:n}]);const o=r&&(null==n?void 0:n.onInputsSetParameters)&&{extensionName:e,bladeName:n.bladeName,parameters:n.onInputsSetParameters.inputs||{}};this._onPartViewModelAcquired(i,a,o)})),i}}getWeaveShellPort(e){const t=this._proxiedObjects.get(e);return t&&t.isPartViewModel&&t.managedValue}_useAzViewModelManager(e,t,s){return!!(256&this._extensionManagerOptions.getNormalizedMetadata(e,!0).flags)||"string"==typeof t&&(s?t.toLowerCase().endsWith(".ReactView".toLowerCase())||t.toLowerCase().endsWith("_dx"):t.toLowerCase().endsWith(".ReactTile".toLowerCase()))}_getViewModel(e,t,s,i,o,n){const r=h(t,s,i=i||{}),a=I(this._diContainer,e,r,i.onViewModelAcquired);return a||o.acquireChannel(this._rpcClient,e,r).then((e=>{const t=e.value;return this._proxiedObjects.set(t,{isPartViewModel:n,managedValue:e}),i.onViewModelAcquired&&i.onViewModelAcquired(t),t}))}releaseViewModel(e,t){const s=this._proxiedObjects.get(e);if(s){const{managedValue:i}=s;t||MsPortalFx.disposeViewModelProperties(e),MsPortalFx.disposeDisposable(e),i.dispose(),this._proxiedObjects.delete(e)}}getBladeSequenceNumber(e,t){var s;const i=`${e},${t}`;return null===(s=MsPortalFx.find(this._bladeSequenceNumbers,(e=>i===e.key)))||void 0===s?void 0:s.sequenceNumber}tryEarlyGetViewModel(e,t,s,n){let a;try{a=this._extensionManagerOptions.getNormalizedMetadata(e,!0),e=a.name}catch(e){return Q.reject(e)}const d=(e,t)=>{for(;t.length>2;)t.pop();t.push(e)},c=`${e},${t}`,{isPrefetch:p}=n,u=this.getBladeSequenceNumber(e,t),m=n.sequenceNumber||u||g();p&&!u&&d({key:c,sequenceNumber:m},this._bladeSequenceNumbers);const h=this._useAzViewModelManager(e,t,!0);let f=null;if(h){const o=this._diContainer.get(r.FramePool),l={isMenuBladeContent:n.isMenuBladeContent,inContextPane:n.inContextPane,inSideBar:n.inSideBar,diContainer:this._diContainer,bladeSequenceNumber:m};t.toLowerCase().endsWith(".ReactView".toLowerCase())?o.setLatest(Object.assign({extensionName:e,viewName:t,parameters:s},l)):t.toLowerCase().endsWith("_dx")&&(f=i.get("MsPortalImpl/Extension/DxDefinitionCache","getRuntimeBlade").then((e=>e(this._diContainer,a,t).then((e=>{var t;(null===(t=null==e?void 0:e.bladeName)||void 0===t?void 0:t.toLowerCase().endsWith(".ReactView".toLowerCase()))&&o.setLatest(Object.assign({extensionName:e.extensionName,viewName:e.bladeName,parameters:null},l))})))))}let x=!(h||(y=t,y in v||y in b||y.startsWith("Shell.InferredBladePinPart")));var y;if(x){const i=this._getCachedBladeDefinition(e,t);(i&&!(0,o.canGetViewModelEarly)(i,s)||C(s=ko.toJS(s||{})))&&(x=!1)}const M=MsPortalFx.find(this._prefetchedResults,(e=>c===e.key));if(!p){M&&MsPortalFx.remove(this._prefetchedResults,M);const e=MsPortalFx.find(this._bladeSequenceNumbers,(e=>c===e.key));e&&MsPortalFx.remove(this._bladeSequenceNumbers,e)}let I;x?M?I=M.result:(this._extensionLoader.setRequestedBlade(e,t),I=o.tryEarlyGetViewModelEndPoint.acquireChannel(this._rpcClient,e,{timestamp:Date.now(),bladeName:t,parameters:s,options:{menuId:n.menuId,partialFlags:(n.inContextPane?1:0)|(n.isMenuBladeContent?4:0)|(n.menuContentOverride?8:0),sequenceNumber:m}}).then((i=>{const o=i.value;return o.viewModel?(this._proxiedObjects.set(o.viewModel,{isPartViewModel:!0,managedValue:i}),this._onPartViewModelAcquired(o.viewModel,P,{extensionName:e,bladeName:t,parameters:s})):i.dispose(),this._diContainer.get(l.DefinitionCache).setBladeDefinition(e,t,Q(o.definition)).then((e=>({definition:e,rpcDurationMs:o.rpcDurationMs,viewModel:o.viewModel,viewModelLoadIndex:o.viewModelLoadIndex})))})),p&&d({key:c,result:I},this._prefetchedResults)):I=(null==M?void 0:M.result)||this._definitionCache.getBladeDefinition(e,t).then((e=>({definition:e,rpcDurationMs:-1,viewModel:null,viewModelLoadIndex:-1})));const P=this._getBladeRedirector();return p&&this._prefetchMenuBladeContent(n.menuContentOverride,P,{extensionName:e,bladeName:t,parameters:s}),f?Q.all([I,f]).then((([e])=>e)):I}_onPartViewModelAcquired(e,t,s){this._tryPrefetchMenuBladeContent(null==e?void 0:e.internal.initialMenuHeaderBlade,t,s),this._tryPrefetchMenuBladeContent(null==e?void 0:e.internal.initialMenuContentBlade,t,s)}_tryPrefetchMenuBladeContent(e,t,s){e&&MsPortalFx.tryImmediateResolve(Q(e),(e=>{this._prefetchMenuBladeContent(e,t,s)}))}_prefetchMenuBladeContent(e,t,s){if(e){const{extensionName:i,bladeName:o,parameters:n}=e;if(i&&o){const e=s&&this._getCachedBladeDefinition(s.extensionName,s.bladeName),r=t.valueOf();if(e&&r){const t=r.applyRedirects(c.Locator.forExtension(i).withBlade(o),n||{},{bladeDefinition:e,locator:c.Locator.forExtension(s.extensionName).withBlade(s.bladeName),model:s.parameters});t&&this.tryEarlyGetViewModel(t.getExtensionName(),t.name,n||{},{isPrefetch:!0,isMenuBladeContent:!0})}}}}_getCachedBladeDefinition(e,t){const s=Q(this._definitionCache.getBladeDefinition(e,t,!0));return s&&s.valueOf()}_getBladeRedirector(){return Q(this._diContainer.getAsync(i.get("MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener.Helpers","BladeRedirector")))}};f=__decorate([__metadata("fx:diagnostics",[e,"ViewModelManagerImpl"]),s.Class(),__metadata("design:paramtypes",[s.Container,FxImpl.Rpc.Client,n.ExtensionManagerOptions,l.DefinitionCache,d.ExtensionLoader])],f);class x{static create(e){return e}}__decorate([__metadata("fx:diagnostics",[e,"ViewModelManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[f]),__metadata("design:returntype",x)],x,"create",null),t.ViewModelManager=x;const b={},v={};let y=class extends o.ViewModelProvider{constructor(e){super(null,null,e.get(FxImpl.Rpc.Client))}};function M(e,t,s){v[e]={name:t,modulePath:s}}function I(e,t,s,i){let o=null,n=null;const r=s.locator.name;if(r in v){const t=e.get(y);return s.locator={name:r,module:v[r].modulePath,export:v[r].name},t.getObservable(e.createChildContainer("viewModel"),null,s,i)}if(r in b?(o=b[r].modulePath,n=e=>b[r].factoryWithState(e)):r.startsWith("Shell.InferredBladePinPart")&&(o="MsPortalImpl/Extension/PinBladeInferred",n=s=>s.createViewModel(r,e.get(x),e.get(l.DefinitionCache),t)),o)return Q(MsPortalFx.require(o)).then((e=>n(e))).then((e=>(i&&i(e),"number"==typeof s.partSize&&e&&e.content&&ko.isObservable(e.content.size)&&e.content.size(s.partSize),s.onInputsSetParameters&&e&&e.updatePartInputValues&&(e.onInputsSetPromise=Q(e.updatePartInputValues(s.onInputsSetParameters.inputs,s.onInputsSetParameters.settings,s.onInputsSetParameters.traceOptions))),e)))}function C(e){const t=MsPortalFx.isPlainObject(e)&&Object.keys(e).map((t=>e[t]))||Array.isArray(e)&&e;return t&&t.some((e=>"function"==typeof e||C(e)))}y=__decorate([__metadata("fx:diagnostics",[e,"ShellViewModelProvider"]),s.Class(),__metadata("design:paramtypes",[s.Container])],y),t.registerWithState=function(e,t,s){b[e]={name:e,modulePath:t,factoryWithState:s}},t.registerWithDi=M,t.resolve=I,MsPortalFx.forEachKey(a.shellParts,((e,t)=>M(t.viewModelName,e,t.shellModule)))})),
define("MsPortalImpl/AzFramework/AzExtensionCore",["require","exports","Fx/DependencyInjection","MsPortalImpl/AzFramework/AzBladeViewModel","MsPortalImpl/Base/Base.ImplUtils","FxInternal/Composition/ViewModelComposer","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Extension/Extension.Manifest","FxInternal/Composition/Part"],(function(e,t,s,i,o,n,r,a,l){"use strict";function d(e,t,s,i,o,n){const r=s===MsPortalFx.Parts.PartKind._Internal_React,a=u(e,t,s,!0),l={name:e,initialDisplayState:2,locked:!0,pinnable:!0,azBlade:s===MsPortalFx.Parts.PartKind._Internal_Az?{}:null,reactView:r?{}:null,style:8,lenses:[{name:"AzBladeVirtualLens",partInstances:[{name:e,inline:a}]}],effectiveInputs:a.bindings,toolbar:s===MsPortalFx.Parts.PartKind._Internal_Az&&{source:{valuesFrom:[{referenceType:0,part:e,property:"content.commandBar"}]}},hasOnPinMethod:!0,attributes:1|(s===MsPortalFx.Parts.PartKind._Internal_Az?8:0)|(s===MsPortalFx.Parts.PartKind._Internal_React?16:0),contextPaneWidth:r?1:o?3:null};return i&&(l.width=3),(n||r)&&(l.reflowReady=!0),l}Object.defineProperty(t,"__esModule",{value:!0}),t.AzViewModelManager=t.AzDefinitionCache=t.createAzBladeDefinition=t.isValidUri=void 0,t.isValidUri=function(e){return(0,o.validateAbsoluteHttpUri)(e)||MsPortalFx.startsWith(e,"//")&&(0,o.validateAbsoluteHttpUri)(`http:${e}`)},t.createAzBladeDefinition=d;let c=class{constructor(e){this._manifestCache=e}getBladeDefinition(e,t,s,i){const o=t.toLowerCase(),n=e.bladeMap[o];return i===MsPortalFx.Parts.PartKind._Internal_Az?n?Q(n):this._manifestCache.getManifestAsync(e.name,"assetTypes").then((n=>{const r=n&&n.azMetadata&&n.azMetadata.blades&&n.azMetadata.blades[t]||{};return e.bladeMap[o]=d(t,s,i,r.useXLargeMinWidth,r.contextPaneXLargeWidth,r.reflowReady)})):Q(n||(e.bladeMap[o]=d(t,s,i)))}getPartDefinition(e,t,s,i){const o=t.toLowerCase(),n=e.partTypeMap[o];return Q(n||(e.partTypeMap[o]=u(t,s,i)))}};c=__decorate([__metadata("fx:diagnostics",[e,"AzDefinitionCache"]),s.Class(),__metadata("design:paramtypes",[a.ManifestCache])],c),t.AzDefinitionCache=c;let p=class{getPartViewModel(e,t,s,o){"object"==typeof t&&(t=t.name);const a=(0,l.composePartViewModel)((e=>64&s?new i.BladeViewModel(e):new i.TileViewModel(e)),{createSelectable:o&&o.createSelectable,location:o&&o.partLocation,logArea:`Extension/${e}/PartType/${t}`,flags:o&&o.flags,type:s});return a.internal.reactViewInitializeEnd=ko.observable(),o&&((0,n.tryApplyEarlyOnInputsSet)(a,(0,r.getViewModelOptions)(s,t,o)),o.onViewModelAcquired&&o.onViewModelAcquired(a)),Q(a)}};function u(e,t,s,i=!1){const o="parameters";return Object.assign({isBlade:i,bladeOrPartName:e,extensionName:t,partKind:s,viewModel:e,inputs:[o]},i?{bindings:[{property:o,optional:!1,isIdentityInput:!1,valuesFrom:[{referenceType:999,property:o}]}],initialSize:9,shareVmWithParentBlade:!0}:{inputDefinitions:[{name:o}]})}p=__decorate([__metadata("fx:diagnostics",[e,"AzViewModelManager"]),s.Class()],p),t.AzViewModelManager=p})),
define("MsPortalImpl/RpcEndPoints",["require","exports","FxInternal/AsyncLoader","FxHubs/HubsSettingsSchema","FxHubs/RpcEndPoints","FxInternal/DirectoryManagement","FxInternal/RpcEndPoints","FxHubs/ProvisioningRpc","FxInternal/Redirect","FxInternal/ResourceManagement/Subscriptions","FxInternal/ResourceManagement/GlobalResourceFilters","FxInternal/Dashboard/DashboardEndpoints","FxInternal/RpcEndPointsCore","FxInternal/ReactView/DataCacheEndpoints","ShellWorker/AuthorizationState"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerRpc=t.extensionsAllowedToForceSignIn=void 0;var h=FxImpl.Data,f=FxImpl.Extension;t.extensionsAllowedToForceSignIn=["Microsoft_AAD_IAM","Microsoft_Azure_PIM","Microsoft_Azure_PIMCommon","Microsoft_Intune_DeviceSettings","Microsoft_Intune_MTM","Microsoft_AAD_Connect_Provisioning","Microsoft_AAD_RegisteredApps","Microsoft_AAD_ConditionalAccess","Microsoft_Azure_Capacity"],t.registerRpc=function(e){(0,s.registerRpc)(e,{"FxHubs/MarketplaceRpc":{marketplaceOverrideHandler:(0,s.makeRegistration)(o.Provisioning.marketplaceOverrideEndpoint)},"MsPortalImpl/Base/Base.Selectable2.Provisioning":{getProvisioningContextHandler:(0,s.makeRegistration)(a.provisioningContextEndpoint)},"MsPortalImpl/Extension/ExtensionRpc.Manifest":{getManifestHandler:(0,s.makeRegistration)(f.getManifestEndPoint),getManifestEnvironmentHandler:(0,s.makeRegistration)(f.CreateUiDef.getExtensionConfigurationEndPoint,"Microsoft_Azure_CreateUIDef")},"MsPortalImpl/Extension/ExtensionManagerOptions":{registerTestExtensions:(0,s.makeRegistration)(f.CreateUiDef.registerTestExtensionsEndPoint,"Microsoft_Azure_CreateUIDef"),unregisterTestExtensions:(0,s.makeRegistration)(f.CreateUiDef.unregisterTestExtensionsEndPoint,"Microsoft_Azure_CreateUIDef"),listTestExtensions:(0,s.makeRegistration)(f.CreateUiDef.listTestExtensionsEndPoint,"Microsoft_Azure_CreateUIDef"),getCatalogApiCacheContent:(0,s.makeRegistration)(f.getCatalogApiCacheContentEndPoint),getExtensionRegistration:(0,s.makeRegistration)(f.getExtensionRegistrationEndPoint),postBoot:(0,s.makeRegistration)(FxImpl.Extension.postBootEndPoint)},"MsPortalImpl/UI/Hubs/UI.ResourceMapManager":{mapAssetIdToResourceId:(0,s.makeRegistration)(f.mapAssetIdToResourceIdEndPoint),mapResourceIdToAssetId:(0,s.makeRegistration)(f.mapResourceIdToAssetIdEndPoint),mapResourceIdToDynamicSelectionAndIcon:(0,s.makeRegistration)(f.mapResourceIdToDynamicSelectionAndIconEndPoint),getResourceAssetInformation:(0,s.makeRegistration)(f.getResourceAssetInformationEndPoint),getResourceAssetInformationForHubs:(0,s.makeRegistration)(o.AssetTypes.getResourceAssetInformationEndPoint),getResource:(0,s.makeRegistration)(f.getResourceEndPoint)},"MsPortalImpl/UI/UI.JourneyManager":{getLastResourceIdInJourney:(0,s.makeRegistration)(f.getLastResourceIdInJourneyEndPoint,null)},"MsPortalImpl/UI/UI.ConfirmationDialog":{invokeAmeConfirmationDialogHandler:(0,s.makeRegistration)(f.invokeAmeConfirmationDialogEndPoint,null)},"MsPortalImpl/Services/Services.FavoritesSettings":{getUserDirectorySettingsHandler:(0,s.makeRegistration)(n.getUserDirectorySettingsEndPoint,"Microsoft_AAD_IAM"),saveUserDirectorySettingsHandler:(0,s.makeRegistration)(n.saveUserDirectorySettingsEndPoint,"Microsoft_AAD_IAM")},"MsPortalImpl/Services/Services.Subscriptions":{getInSessionSelectedSubscriptionsObservableHandler:(0,s.makeProxyRegistration)(d.getInSessionSelectedSubscriptionsObservableEndPoint),getSubscriptionInfoHandler:(0,s.makeRegistration)(FxImpl.Azure.getSubscriptionInfoEndPoint),getInSessionDisplayedSubscriptionsHandler:(0,s.makeRegistration)(o.Subscriptions.getInSessionDisplayedSubscriptionsEndPoint),searchForSubscriptionsHandler:(0,s.makeRegistration)(FxImpl.Azure.searchForSubscriptionsEndPoint),setInSessionSelectedSubscriptionsHandler:(0,s.makeRegistration)(FxImpl.Azure.setInSessionSelectedSubscriptionsEndPoint,"HubsExtension")},"MsPortalImpl/Services/Services.GlobalResourceFilters":{getGlobalResourceFilterObservableHandler:(0,s.makeProxyRegistration)(c.getGlobalResourceFilterObservableEndPoint)},"MsPortalImpl/Services/Services.Tenants":{getHomeTenantsCountHandler:(0,s.makeRegistration)(o.Directories.getHomeTenantsCountEndPoint)},"MsPortalImpl/Services/Services.ProjectedDirectories":{getSubscriptionsForSelectedDirectoriesHandler:(0,s.makeRegistration)(o.Directories.getSubscriptionsForSelectedDirectoriesEndPoint),getDirectoriesMapHandler:(0,s.makeRegistration)(o.Directories.getDirectoriesMapEndPoint)},"MsPortalImpl/Services/Services.AssetManagement":{notifyAssetDeletedHandler:(0,s.makeRegistration)(o.Events.notifyAssetDeletedDefinition)},"MsPortalImpl/Services/Services.AzureStorage":{sasEndPointHandler:(0,s.makeRegistration)(FxImpl.InternalAzure.getSasUriForQueueEndPoint,"Microsoft_Azure_Scheduler")},"MsPortalImpl/Services/Services.EditScopeManagement":{loadSerializedEditScope:(0,s.makeRegistration)(h.loadSerializedEditScopeEndPoint),saveSerializedEditScope:(0,s.makeRegistration)(h.saveSerializedEditScopeEndPoint),updateEditScopeIsSavingState:(0,s.makeRegistration)(h.updateEditScopeIsSavingStateEndPoint)},"MsPortalImpl/UI/UI.AuthStateManager":{getCurrentUserEndPointHandler:(0,s.makeRegistration)(o.Auth.getCurrentUserEndPoint,"HubsExtension")},"MsPortalImpl/Auth/RpcHandlers":{getAuthorizationTokenEndPoint:(0,s.makeRegistration)(f.getAuthorizationTokenEndPoint),getPopTokenEndPoint:(0,s.makeRegistration)(f.getPopTokenEndPoint),getNewTokenHandler:(0,s.makeRegistration)(g.getAuthorizationTokenForShellWorkerEndPoint,"fxw")},"MsPortalImpl/Services/Services.GalleryEndpoints":{getLocalGalleryPackages:(0,s.makeRegistration)(f.getLocalGalleryPackagesEndpointsDefinition)},"MsPortalImpl/Services/Services.Permissions":{hasPermissionsToShell:(0,s.makeRegistration)(f.hasPermissionsToShell)},"MsPortalImpl/Services/Services.SharedSettings":{getSharedSettings:(0,s.makeRegistration)(f.getSharedSettingsEndPoint)},"MsPortalImpl/Extension/Extension.Definition.Locator":{getBladeDefinitionLocator:(0,s.makeRegistration)(o.Provisioning.getBladeDefinitionLocatorEndPoint,["HubsExtension","Microsoft_Azure_Resources"])},"MsPortalImpl/Extension/DefinitionCache":{doesBladeDefinitionExist:(0,s.makeRegistration)(o.Provisioning.doesBladeDefinitionExistEndPoint,"HubsExtension")},"MsPortalImpl/UI/UI.DesktopManagerImpl":{getDashboardDeepLinkHandler:(0,s.makeRegistration)(o.DashboardEndpoints.getDashboardDeepLink,"HubsExtension"),getDashboardFiltersHandler:(0,s.makeRegistration)(o.PartFilterEndpoints.getFilters,"HubsExtension"),getFilterValuesHandler:(0,s.makeRegistration)(o.PartFilterEndpoints.getFilterValues,"HubsExtension"),getFilterValueDisplayTextHandler:(0,s.makeRegistration)(o.PartFilterEndpoints.getFilterValueDisplayText,"HubsExtension"),getFilterWarningHandler:(0,s.makeRegistration)(o.PartFilterEndpoints.getFilterWarning,"HubsExtension")},"MsPortalImpl/Services/Services.BrowseQueryManifest":{getBrowseManifestsHandler:(0,s.makeRegistration)(o.ArtBrowse.getBrowseManifestsEndpoint,"fxw")},"MsPortalImpl/Services/Services.BrowseCuration":{getResourceTypesCategorizationEndPoint:(0,s.makeRegistration)(o.Curation.getResourceTypesCategorizationEndPoint,"HubsExtension")},"MsPortalImpl/Services/Services.AssetMenuManifest":{getAssetMenuPrereqsHandler:(0,s.makeRegistration)(o.AssetMenu.getAssetMenuPrereqsEndpoint,"HubsExtension"),getResourceMenuPrereqsHandler:(0,s.makeRegistration)(o.AssetMenu.getResourceMenuPrereqsEndpoint,"HubsExtension")},"MsPortalImpl/Notifications/PortalNotifications":{irisTelemetryHandler:(0,s.makeRegistration)(o.Impl.irisTelemetryEndpoint,"HubsExtension")},"MsPortalImpl/Notifications/IrisNotificationsClient":{getIrisContentHandler:(0,s.makeRegistration)(f.IrisNotifications.getIrisContentEndPoint,null),sendIrisSignalHandler:(0,s.makeRegistration)(f.IrisNotifications.sendIrisSignalEndPoint,null)},"MsPortalImpl/Services/Services.DeploymentManager":{pollDeploymentHandler:(0,s.makeRegistration)(o.ResourceManager.pollDeploymentEndPoint,null),getMarketplaceUserSettingsHandler:(0,s.makeRegistration)(o.Marketplace.getMarketplaceUserSettingsEndPoint,["Microsoft_Azure_Marketplace","HubsExtension"]),internalDeploymentHelperHandler:(0,s.makeRegistration)(o.ResourceManager.internalDeploymentHelper,["VMCP","Citrix_XenApp_Essentials","Citrix_XenDesktop_Essentials","CloudSimpleExtension","SendGrid_EmailService","SamplesExtension","InternalSamplesExtension"]),notifyDeploymentHandler:(0,s.makeRegistration)(o.ResourceManager.notifyDeploymentEndPoint,null),writeLastUsedUserSettingsHandler:(0,s.makeRegistration)(i.writeHubsLastUsedUserSettings,"HubsExtension")},"MsPortalImpl/Notifications/NotifyResourcesCreated":{notifyResourcesCreatedHandler:(0,s.makeRegistration)(o.NotifyResourceCreated.notifyResourcesCreatedEndpoint,["Microsoft_Azure_Billing","Microsoft_Health_Admin"])},"MsPortalImpl/Services/Services.GeneralSettings":{writeBrowsePreviewOptInFlagHandler:(0,s.makeRegistration)(i.writeBrowsePreviewOptInFlagEndpoint,"HubsExtension")},"MsPortalImpl/Services/Services.Settings":{deleteUserSettingsHandler:(0,s.makeRegistration)(i.deleteHubsUserSettings,"HubsExtension"),readUserSettingsHandler:(0,s.makeRegistration)(i.readHubsUserSettings,"HubsExtension"),writeUserSettingsHandler:(0,s.makeRegistration)(i.writeHubsUserSettings,"HubsExtension"),readBrowserStorageSettingsHandler:(0,s.makeRegistration)(o.BrowserStorageSettings.readBrowserStorageSettingsEndpoint,"HubsExtension"),writeBrowserStorageSettingsHandler:(0,s.makeRegistration)(o.BrowserStorageSettings.writeBrowserStorageSettingsEndpoint,"HubsExtension"),readExtUserSettingsHandler:(0,s.makeRegistration)(FxImpl.Azure.ResourceManager.readUserSettingsEndPoint)},"MsPortalImpl/Services/Services.ArmEvents":{createResourceDeletedEventHandler:(0,s.makeRegistration)(o.Events.createResourceDeletedEventDefinition),matchEventsHandler:(0,s.makeRegistration)(o.Events.matchEventsDefinition),removeArmEventSubscriptionHandler:(0,s.makeRegistration)(o.Events.removeArmEventSubscriptionDefinition),subscribeToArmEventHandler:(0,s.makeProxyRegistration)(o.Events.subscribeToArmEventDefinition,"HubsExtension",!1)},"MsPortalImpl/Services/Services.ArmLocations":{getLocationsForCreateHandler:(0,s.makeRegistration)(FxImpl.Azure.getLocationsForCreateEndPoint,null),getLocationsHandler:(0,s.makeRegistration)(FxImpl.Azure.getLocationsEndPoint,["HubsExtension","InternalSamplesExtension"])},"MsPortalImpl/Services/PastDueSubsCheck":{raiseWarningForPastDueSubsHandler:(0,s.makeRegistration)(o.Subscriptions.pastDueSubsWarningEndpoint,"HubsExtension")},"MsPortalImpl/UI/Dashboard/DashboardManager":{createDashboardHandler:(0,s.makeRegistration)(p.PortalDashboard.createDashboard,"Microsoft_Azure_PortalDashboard"),deleteDashboardsHandler:(0,s.makeRegistration)(p.PortalDashboard.deleteDashboards,"Microsoft_Azure_PortalDashboard"),getArmDashboardJsonHandler:(0,s.makeRegistration)(p.PortalDashboard.getArmDashboardJson,"Microsoft_Azure_PortalDashboard"),getPrivateDashboardsHandler:(0,s.makeRegistration)(p.PortalDashboard.getPrivateDashboards,"Microsoft_Azure_PortalDashboard"),getRecentDashboardsHandler:(0,s.makeRegistration)(p.PortalDashboard.getRecentDashboards,"Microsoft_Azure_PortalDashboard")},"MsPortalImpl/UI/Hubs/UI.NotificationManager":{addClientNotificationDefinition:(0,s.makeRegistration)(FxImpl.Hubs.Notifications.addClientNotificationDefinition,null),addClientNotificationsDefinition:(0,s.makeRegistration)(FxImpl.Hubs.Notifications.addClientNotificationsDefinition,null),addFxNotificationsDefinition:(0,s.makeRegistration)(r.addFxNotificationsDefinition,null),showModalNotificationHandler:(0,s.makeRegistration)(FxImpl.Hubs.Notifications.showModalNotification,"HubsExtension"),updateNotificationHandler:(0,s.makeRegistration)(FxImpl.NotificationManager.updateNotificationEndPoint,null),addNotification2Handler:(0,s.makeRegistration)(FxImpl.NotificationManager.addNotification2EndPoint,null),addNotificationHandler:(0,s.makeRegistration)(FxImpl.NotificationManager.addNotificationsEndPoint,null)},"MsPortalImpl/UI/UI.NavigationManager":{forceSignInHandler:(0,s.makeRegistration)(l.forceSignInEndPoint,t.extensionsAllowedToForceSignIn)},"MsPortalImpl/Services/Services.PersistentStorage":{writeSettingHandler:(0,s.makeRegistration)(u.writeSettingEndPoint),readSettingsHandler:(0,s.makeRegistration)(u.readSettingsEndPoint),removeSettingsHandler:(0,s.makeRegistration)(u.removeSettingsEndPoint),clearHandler:(0,s.makeRegistration)(u.clearEndPoint),getAllKeysHandler:(0,s.makeRegistration)(u.getAllKeysEndPoint)},"MsPortalImpl/Services/Services.ReactViewDataCache":{dataCacheAddHandler:(0,s.makeRegistration)(m.dataCacheAddEndPoint),dataCacheGetHandler:(0,s.makeRegistration)(m.dataCacheGetEndPoint),dataCacheClearHandler:(0,s.makeRegistration)(m.dataCacheClearEndPoint),dataCacheClearAllHandler:(0,s.makeRegistration)(m.dataCacheClearAllEndPoint)}})}})),
define("MsPortalImpl/Services/Kusto/KustoHelper",["require","exports","Fx/Ajax"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPrimaryData=t.QueryType=void 0;const i=MsPortalFx.Base.Diagnostics.Telemetry,o={};!function(e){e[e.BladeSummary=0]="BladeSummary",e[e.Tabs=1]="Tabs",e[e.MenuSummary=2]="MenuSummary",e[e.CommandSummary=3]="CommandSummary",e[e.InBlade=4]="InBlade",e[e.LoadLighthousePerfProfiles=5]="LoadLighthousePerfProfiles",e[e.LoadLighthousePerfProfile=6]="LoadLighthousePerfProfile",e[e.LoadLighthousePerfProfilesMetadata=7]="LoadLighthousePerfProfilesMetadata",e[e.LighthouseTimelineSummary=8]="LighthouseTimelineSummary",e[e.LighthouseScoreSummary=9]="LighthouseScoreSummary",e[e.Comments=10]="Comments",e[e.PerformanceChart=11]="PerformanceChart"}(t.QueryType||(t.QueryType={})),t.getPrimaryData=function(e,t,n){const r=JSON.stringify({type:e,parameters:t})||"";if(n&&(o[r]=null),o[r])return i.trace({source:"KustoHelper",action:"ReturnCachedData",data:{query:{type:e,parameters:t}}}),o[r];const a=i.startTrace({source:"KustoHelper",action:"FetchTelemetry",data:{query:{type:e,parameters:t}}});let l=!1;const d=(0,s.ajax)({uri:"/api/TelemetryInsights/Telemetry",type:"POST",setAuthorizationHeader:{resourceName:"portalkusto"},contentType:"application/json",data:r}).then((e=>{l=!0;const t=(e.data.content||[]).filter((e=>"PrimaryResult"===e.TableKind))[0],s=[];return t.Rows.forEach(((e,i)=>{s[i]=Object.create(null),e.forEach(((e,o)=>{s[i][t.Columns[o].ColumnName]=e}))})),{data:s,query:e.query}})).finally((()=>{i.endTrace(a,l)}));return o[r]=d,d}})),
define("MsPortalImpl/Services/Services.ArmEvents",["require","exports","Fx/ResourceManagement","FxHubs/ArmHelpers/ArmIds","FxHubs/RpcEndPoints","FxInternal/AsyncLoader","Fx/DependencyInjection"],(function(e,t,s,i,o,n,r){"use strict";function a(e,t){return!e==!t&&e.toLowerCase()===t.toLowerCase()}Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToArmEventHandler=t.removeArmEventSubscriptionHandler=t.matchEventsHandler=t.createResourceDeletedEventHandler=t.ArmEvents=void 0;let l=class{constructor(){this.instanceHandlers=[]}subscribeToArmEvent(e,t,s){if(!(e.operationNameRegex||e.source||e.status||e.subStatus))throw new Error("At least one criteria must be specified.");const i=MsPortalFx.getUniqueId();return this.instanceHandlers.push({cookie:i,criteria:e,callback:t,eventLimit:s}),i}removeArmEventSubscription(e){this.instanceHandlers=this.instanceHandlers.filter((t=>t.cookie!==e))}matchEvent(e,t){const s=t.operationNameRegex;if(s){if(!new RegExp(s,"gi").test(e.operationName))return!1}const i=t.source,o=t.status,n=t.subStatus;return!(i&&!a(e.source,i)||o&&!a(e.status,o)||!MsPortalFx.isNullOrUndefined(n)&&!a(e.subStatus,n))}matchEvents(e){this.instanceHandlers.slice().forEach((t=>{const s=[];e.forEach((e=>{this.matchEvent(e,t.criteria)&&s.push(e)})),t.callback(s.slice(0,t.eventLimit||s.length))}))}createResourceDeletedEvent(e){const t="microsoft.resources",o="/delete",n=(e,s)=>{this.matchEvents([{operationName:s,status:"succeeded",source:t,correlationId:null,timestamp:new Date,assetId:e,isLocalEvent:!0}])};e.forEach((e=>{const t=s.ArmId.parse(e.assetId,!0);4===t.kind?n(e.assetId,"microsoft.resources/subscriptions/resourcegroups/delete"):i.ResourceArmIdKindMap[t.kind]&&n(e.assetId,o)}))}};l=__decorate([__metadata("fx:diagnostics",[e,"ArmEvents"]),r.Class()],l),t.ArmEvents=l;const{createResourceDeletedEventDefinition:d,matchEventsDefinition:c,removeArmEventSubscriptionDefinition:p,subscribeToArmEventDefinition:u}=o.Events;t.createResourceDeletedEventHandler=(0,n.defineHandler)(d,(e=>e.diContainer.get(l).createResourceDeletedEvent(MsPortalFx.makeArray(e.messageArg)))),t.matchEventsHandler=(0,n.defineHandler)(c,(e=>e.diContainer.get(l).matchEvents(e.messageArg.events))),t.removeArmEventSubscriptionHandler=(0,n.defineHandler)(p,(e=>e.diContainer.get(l).removeArmEventSubscription(e.messageArg.cookie))),t.subscribeToArmEventHandler=(0,n.defineHandler)(u,(e=>{const t=e.messageArg,s=ko.observableArray();return{cookie:e.diContainer.get(l).subscribeToArmEvent(t.eventCriteria,s,t.eventLimit),events:s}}))})),
define("MsPortalImpl/Base/Base.ArmIdHelpers",["require","exports","Fx/ResourceManagement","FxHubs/ArmHelpers/ArmIds"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sanitizeId=t.isResourceAtAnyLevel=void 0,t.isResourceAtAnyLevel=function(e){return i.ResourceArmIdKindMap[e.kind]},t.sanitizeId=function(e){return 0!==s.ArmId.parse(e,!0).kind?MsPortalFx.sanitizeMessage(e):"_REDACTED_"}})),
define("MsPortalImpl/Base/Base.HistoryManager",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.replaceState=t.pushState=void 0;const s=MsPortalFx.Base.Diagnostics.createLog(e),i=n(history,history.pushState),o=n(history,history.replaceState);function n(e,t){return function(){try{t.apply(e,arguments)}catch(e){let t=!0;e instanceof DOMException&&(e.code!==DOMException.SECURITY_ERR&&"SecurityError"!==e.name||(t=!1)),t&&s.error(e,0)}}}t.pushState=function(e){i(e.data,"",e.url)},t.replaceState=function(e){o(e.data,"",e.url)}})),
define("MsPortalImpl/Base/Base.DeepLink",["require","exports","Fx/ResourceManagement","MsPortalImpl/Base/Base.ArmIdHelpers","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/Base/Base.HistoryManager"],(function(e,t,s,i,o,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateDashboardUri=t.getDashboardIdFromUri=t.getDashboardTypeFromUri=t.isDashboardRoute=t.prependTenantToResourceDeepLink=t.rpcGetDashboardDeepLink=t.getAllServicesDeeplink=t.getDefaultDashboardDeeplink=t.getHomeDeeplink=t.getDashboardDeepLink=t.getGalleryDeepLink=t.getAssetDeepLink=t.replaceMenuIdFromDeepLink=t.getMenuIdFromDeepLink=t.parseBladeInputs=t.safeJSONParse=t.getBladeDeepLink=t.getCurrentUri=t.originalHref=t.dashboardRouteName=void 0;const a=window,l=encodeURIComponent,d=decodeURIComponent;function c(){return new o.Uri(location.href)}function p(){return c().hashQueryString}function u(e){try{return JSON.parse(e)}catch(t){return e}}function m(e){const t=e.length>=4&&e.length%2==0&&"#blade"===e[0]&&!MsPortalFx.isNullOrWhiteSpace(e[3]),s=e.length>=5&&"#view"===e[0]&&"~"===e[3]&&!MsPortalFx.isNullOrWhiteSpace(e[4]);return t||s}function g(e){return e.length%2==1&&!MsPortalFx.isNullOrWhiteSpace(e[e.length-1])}function h(e,t){return`${f(e)}dashboard/${t}`.toLowerCase()+p()}function f(e){const t=e.get(n.AuthStateManager).getSignedInUserTenant();return t?"@"+t+"/":""}function x(e){return!MsPortalFx.localeCompareIgnoreCase(e.getHashParts().category,t.dashboardRouteName)}t.dashboardRouteName="dashboard",t.originalHref=a.location.href,t.getCurrentUri=c,t.getBladeDeepLink=function(e,t,s={},i={}){const n=i.setDeepLinkContext||$.noop,r=new o.Uri(i.baseUri||"");let a="";i.selectedMenuItemId&&(a=(i.v2DeepLink?"/~/":"/")+i.selectedMenuItemId);let d,c,u="";return MsPortalFx.forEachKey(s,((e,t)=>{if("editScopeId"===e)return;let s=ko.unwrap(t);if(i.v2DeepLink){if("~"===e.slice(-1))return d="UnableToSerializeInputKey",void(c=e);let t,i;const o=MsPortalFx.getTypeOf(s);switch(MsPortalFx.getTypeOf(s)){case"string":i="",t=s;break;case"null":case"number":case"boolean":case"array":case"object":i="~";try{t=JSON.stringify(s)}catch(e){d="UnableToSerializeInputJSONStringifyFailed",c=JSON.stringify(e.message)}break;case"undefined":break;case"date":d="UnableToSerializeInputTypeDate",c="The input model contains a Date object which cannot be serialized in a roundtrippable way from Fx. A future upgrade will JSON stringify this input and the resulting deep link may not be navigable reliably. If using Date object to navigate to content, serialize the Date as part of the input model using the `toISOString()` method and parse this value on the initialization phase of the content.";break;default:d="UnableToSerializeInputTypeOther",c=o}void 0!==t&&void 0!==i&&(u+=`/${l(e)}${i}/${l(t)}`)}else s&&"object"==typeof s&&(s=JSON.stringify(s)),void 0!==s&&(0===s&&(s="0"),u+=`/${l(e)}/${l(s||"")}`)})),MsPortalFx.isNullOrUndefined(d)?(a+=u,r.setHash(`#${i.v2DeepLink?"view":"blade"}/${e}/${t}${a}`).setHashQueryString(p()),r.href.length>1e6?(n(r.toString(),!1,"InputsExceedURILength"),""):(n(r.toString(),!0),r.toString())):(n(r.toString(),!1,d,c),"")},t.safeJSONParse=u,t.parseBladeInputs=function(e,t,s){s=s||{};const i={};try{for(let t=0;t<e.length;){let o=d(e[t++]);if(!o)throw new Error("invalid decodeKey:"+o);let n=d(e[t++]);s.v2DeepLink?"~"===o.slice(-1)&&(n=u(n),o=o.slice(0,-1)):s.parseJSON&&n&&/^\s*\{.*\}\s*$/.test(n)&&(n=u(n)),i[o]=n}}catch(e){throw new MsPortalFx.Errors.Error({message:`Deep link ${t} has illegal inputs`,innerErrors:e})}return i},t.getMenuIdFromDeepLink=function(e){const t=new o.Uri(e),s=t.getHashParts();switch(s.category){case"blade":case"view":{const e=t.hash.split("/");return m(e)?"view"===s.category?e[4]:e[3]:""}case"resource":{const e=s.rest.split("/");return g(e)?e[e.length-1]:""}}return""},t.replaceMenuIdFromDeepLink=function(e,t){const s=new o.Uri(e),i=s.getHashParts(),n=s.hash.split("/");switch(i.category){case"blade":case"view":if(m(n))return"view"===i.category?n[4]=t:n[3]=t,s.setHash(n.join("/")),s.toString();break;case"resource":if(g(i.rest.split("/")))return n[n.length-1]=t,s.setHash(n.join("/")),s.toString();break}return e||""},t.getAssetDeepLink=function(e,t,i={}){let n=t.assetId;const r=n&&"string"==typeof n&&s.ArmId.parse(n,!0);return r&&0!==r.kind&&(n=n.substring(1)),new o.Uri(i.baseUri||"").setHash("#{0}{1}/{2}/{3}/{4}".format(f(e),"asset",t.extensionName,t.assetType,n)).setHashQueryString(p()).toString()},t.getGalleryDeepLink=function(e,t={}){let s="#{0}/{1}";const i=t.model;return i&&(ko.unwrap(i.additionalConfig)||{}).preview&&(s+="/preview"),new o.Uri(t.baseUri||"").setHash(s.format("create",e)).setHashQueryString(p()).toString()},t.getDashboardDeepLink=h,t.getHomeDeeplink=function(){return"#home"+p()},t.getDefaultDashboardDeeplink=function(){return"#dashboard"+p()},t.getAllServicesDeeplink=function(e){return"#allservices/category/All"+(e?"/filter/"+e:"")+p()},t.rpcGetDashboardDeepLink=function(e,t){let o=t=MsPortalFx.trimStart(t,"/");if(!t.startsWith("dashboard/arm")&&!t.startsWith("dashboard/private")){const e=s.ArmId.parse(MsPortalFx.ensurePrefix(t,"/"),!0);o=(0,i.isResourceAtAnyLevel)(e)?MsPortalFx.ensurePrefix(t,"dashboard/arm/"):MsPortalFx.ensurePrefix(t,"dashboard/private/")}const n=window.location,r=c(),a=f(e),l=n.port;return[n.protocol,"//",r.host,l?":"+l:"",n.pathname,r.queryString,"#",a,o,p()].join("")},t.prependTenantToResourceDeepLink=function(e,t){return t&&t.startsWith("#resource/")?`#${f(e)}${t.substring(1)}`:t},t.isDashboardRoute=x,t.getDashboardTypeFromUri=function(){const e=c();return x(e)?e.getHashParts().rest.split("/")[0]:""},t.getDashboardIdFromUri=function(e=c()){return x(e)?e.getHashParts().rest:""},t.updateDashboardUri=function(e,t,s,i){const o=h(e,t);if((i=i||c()).hash.toLowerCase()!==`#${o}`){i.setHash(o);(s?r.replaceState:r.pushState)({data:{},url:i.href})}}})),
define("MsPortalImpl/Base/Base.ItemCache",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rotFind=t.rotAdd=t.ItemArrayCache=t.BaseItemCache=void 0;const s=MsPortalFx.remove,i=MsPortalFx.find,o=MsPortalFx.findIndex,n=Date.now;function r(e){return t=>e(t.item)}function a(e){return n()-e}function l(e,t){let s;return e&&(t&&(e.age=n()),s=e.item),s}t.BaseItemCache=class{constructor(e=12e4,t){this._map=t,this._maxAge=e,setTimeout((()=>this._reduceCache()),1e3)}dispose(){this.flush()}hasEntry(e){return e in this._map}getEntry(e){return l(this._map[e],!0)}peekEntry(e){return l(this._map[e])}removeEntry(e){e in this._map&&this._delete(e)}_removeEach(e){for(const t in this._map)e.call(this,t)&&this._delete(t)}removeEach(e){this._removeEach(e)}flush(){this._removeEach()}_delete(e){delete this._map[e]}_isExpired(e){return a(this._map[e].age)>this._maxAge}_reduceCache(){this._removeEach(this._isExpired)}};t.ItemArrayCache=class{constructor(e=12e4){this._cache=[],this._maxAge=e,setTimeout((()=>this._reduceCache()),1e3)}dispose(){this.clear()}first(e,t){return l(i(this._cache,r(e)),!t)}peekFirst(e){return this.first(e,!0)}pushEntry(e){this._cache.push(function(e){return{age:n(),item:e}}(e))}removeEntry(e){this.removeFirst((t=>MsPortalFx.deepEquals(t,e)))}removeFirst(e){const t=o(this._cache,r(e));t>=0&&this._cache.splice(t,1)}removeEach(e){s(this._cache,r(e))}clear(){this._cache=[]}_isEntryExpired(e){return a(e.age)>this._maxAge}_reduceCache(){s(this._cache,(e=>this._isEntryExpired(e)))}};const d=new Map;let c=1;t.rotAdd=function(e,t){const s=(c++).toString();return d.set(s,t),e.registerForDispose((()=>{d.delete(s)})),s},t.rotFind=function(e){return d.get(e)}})),
define("MsPortalImpl/Services/Services.BrowseCuration",["require","exports","FxHubs/RpcEndPoints","MsPortalImpl/Resources/ImplScriptResources","FxInternal/AsyncLoaderCore","FxHubs/RpcEndPoints","Fx"],(function(e,t,s,i,o,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resetMapResourceTypeToCategoryResourceName=t.getResourceTypesCategorizationForTest=t.initializeRpc=t.getResourceTypesCategorizationEndPoint=t.mapCategoryIdToName=t.testReset=t.getSharedCuration=t.getBrowseCuration=t.handleInvalidCurationFileError=t.getAllServicesAdditionalData=t.getMergedAssetType=t.browseCurationFile=void 0;var a=MsPortalFx.Base,l=FxImpl.Rpc,d=MsPortalFx.Hubs.Notifications;const c=window.fx.environment,p=a.Diagnostics.createLog(e),u=/^[a-z_][\w\-]*$/i,m=i.BrowseCuration,g=i.BrowseCategories,h=MsPortalFx.lowerCaseAllStrings;function f(e){if(!e||u.test(e))return e;p.warning(`Invalid curation file name: <${e}>, skipping this curation file.`)}function x(e){let s=`Failed to get the browse curation file <${t.browseCurationFile}>`;e&&e.statusText?s+=`: ${e.status||""} (${e.statusText})`:e&&e.message&&(s+=`: ${e.message}`),p.warning(s),d.ClientNotification.publish({title:m.noCurationTitle,description:m.noCuration,status:d.NotificationStatus.Warning})}t.browseCurationFile=f((0,r.getFeatureValue)("browsecuration"))||f(c.browseCuration)||"default",t.getMergedAssetType=function(e,t,s){return{base:e,associated:Array.isArray(t)?t:[t],infoTextOverride:s}},t.getAllServicesAdditionalData=(0,r.memoizePromise)((()=>Q(MsPortalFx.require("MsPortalImpl/Services/BrowseCuration/AllServicesCardData")).then((e=>e.getAdditionalAssetTypeAndCategoryData())).catch((e=>{let t="Failed to get the additional data file";return e&&e.statusText?t+=`: ${e.status||""} (${e.statusText})`:e&&e.message&&(t+=`: ${e.message}`),p.warning(t),{}})))),t.handleInvalidCurationFileError=x,t.getBrowseCuration=(0,r.memoizePromise)((e=>Q(MsPortalFx.require(`MsPortalImpl/Services/BrowseCuration/${t.browseCurationFile}`)).then((t=>t.getCuration(e))).catch((e=>(x(e),{}))))),t.getSharedCuration=(0,r.memoizePromise)((()=>(0,t.getBrowseCuration)().then((e=>({mergedAssetTypes:h(e&&e.mergedAssetTypes)}))))),t.testReset=MsPortalFx.noop;const b={},v={};const y=/(^|[^A-Za-z0-9]*)([A-Za-z0-9]+)/g;function M(e){return g[(t=e,t.replace(y,((e,t,s)=>s&&(s||"").toLowerCase())))]||e;var t}t.mapCategoryIdToName=M,t.getResourceTypesCategorizationEndPoint=(0,o.defineHandler)(s.Curation.getResourceTypesCategorizationEndPoint,(e=>async function(){if(MsPortalFx.isEmptyObject(v)){const e=await n.AssetTypes.getAssetTypesInformationEndPoint.invoke(l.client,"fxw",void 0);(await(0,t.getBrowseCuration)(!1)).categories.forEach((e=>e.items.forEach((t=>{b[t.assetType.toLowerCase()]={categoryId:e.id||"uncurated",categoryDisplayName:M(e.id)}})))),e.forEach((e=>{var t,s;const i=b[e.lowerCaseAssetType],o=(null===(t=e.compositeDisplayName)||void 0===t?void 0:t.service)||(null===(s=e.compositeDisplayName)||void 0===s?void 0:s.plural);o&&(v[e.lowerCaseResourceType]={categoryId:(null==i?void 0:i.categoryId)||"uncurated",categoryDisplayName:(null==i?void 0:i.categoryDisplayName)||g.uncurated,assetDisplayName:o,lowerCaseResourceType:e.lowerCaseResourceType,assetTypeIcon:e.icon,assetTypeKeywords:e.keywords})}))}return v}())),t.initializeRpc=function(){s.Curation.getSharedCurationEndpoint.register(l.client,"HubsExtension",(()=>(0,t.getSharedCuration)()))}})),
define("MsPortalImpl/Resources/PortalNotificationsTelemetry",["require","exports"],(function(e,t){"use strict";var s,i,o;Object.defineProperty(t,"__esModule",{value:!0}),t.DEV=t.ActionModifier=t.ActionModifierInternal=t.Action=t.ActionInternal=t.Source=void 0,function(e){e.HatsHelper="HatsHelper",e.HaTSurvey="HaTSurvey",e.NotificationHub="NotificationHub",e.PortalNotifications="PortalNotifications",e.ToastTray="ToastTray",e.UpdateContactabilityDialog="UpdateContactabilityDialog"}(s||(s={})),t.Source=s,function(e){e.AdvisorNotificationShown="AdvisorNotificationShown",e.DeprecatedNotificationApiCalled="DeprecatedNotificationApiCalled",e.DevSATDismissed="DevSATDismissed",e.DevSATLaunched="DevSATLaunched",e.DevSATNotShown="DevSATNotShown",e.DevSATShown="DevSATShown",e.ExtensionDisposed="ExtensionDisposed",e.ExtensionExtended="ExtensionExtended",e.FeedbackClicked="FeedbackClicked",e.FetchHatsExtensionTasks="FetchHatsExtensionTasks",e.HatsFailedToSetLastTimeShownSetting="HatsFailedToSetLastTimeShownSetting",e.HatsPaneDismissed="HatsPaneDismissed",e.HatsPaneOpened="HatsPaneOpened",e.LaunchingHatsFromNPS="LaunchingHatsFromNPS",e.InProgressNotification="InProgressNotification",e.InvokeHatsModal="InvokeHatsModal",e.IrisNotification="IrisNotification",e.IrisAdvisor="IrisAdvisor",e.ModalDialogDismissed="ModalDialogDismissed",e.ModalDialogOpened="ModalDialogOpened",e.NotificationClicked="NotificationClicked",e.NotificationDismissAllClicked="NotificationDismissAllClicked",e.NotificationDismissedFromPane="NotificationDismissedFromPane",e.NotificationHasMiscProperties="NotificationHasMiscProperties",e.NotificationMenuClosed="NotificationMenuClosed",e.NotificationMenuOpen="NotificationMenuOpen",e.NotificationMoreEventsLinkClicked="NotificationMoreEventsLinkClicked",e.NPSDismissed="NPSDismissed",e.NPSNotShown="NPSNotShown",e.NPSScoreClicked="NPSScoreClicked",e.NPSShown="NPSShown",e.NPSSubmitFailed="NPSSubmitFailed",e.NPSSubmitted="NPSSubmitted",e.PollingNotification="PollingNotification",e.PrivacyPolicyClick="PrivacyPolicyClick",e.RecommendationAdded="RecommendationAdded",e.RecommendationClicked="RecommendationClicked",e.RecommendationSurfaced="RecommendationSurfaced",e.SatisfactionAreaClicked="SatisfactionAreaClicked",e.SatisfactionOverallClicked="SatisfactionOverallClicked",e.ServerEventMappedToNotification="ServerEventMappedToNotification",e.ServiceHealthAlertNotification="ServiceHealthAlertNotification",e.ToastAdded="ToastAdded",e.ToastClicked="ToastClicked",e.ToastDismissed="ToastDismissed",e.UpdateContactabilityCountryInfo="UpdateContactabilityCountryInfo",e.UpdateContactabilityCheckboxChanged="UpdateContactabilityCheckboxChanged",e.UpdateContactabilityUpdateEmailClick="UpdateContactabilityUpdateEmailClick"}(i=t.ActionInternal||(t.ActionInternal={})),t.Action=i,function(e){e.ActionsBeaconCall="ActionsBeaconCall",e.ActionsBeaconCallFailed="ActionsBeaconCallFailed",e.ActionsBeaconCallSuccess="ActionsBeaconCallSuccess",e.AdvisorNotificationReceived="AdvisorNotificationReceived",e.Cancelled="Cancelled",e.Completed="Completed",e.ContactabilityNotificationReceived="ContactabilityNotificationReceived",e.ControlNotificationReceived="ControlNotificationReceived",e.ExtensionMissingTasks="ExtensionMissingTasks",e.FailedToFetchNotificationsToStorage="FailedToFetchNotificationsToStorage",e.FailedToWriteNotificationsToStorage="FailedToWriteNotificationsToStorage",e.FeedbackDislike="FeedbackDislike",e.FeedbackLike="FeedbackLike",e.HatsNotificationReceived="HatsNotificationReceived",e.HiddenInIE11="HiddenInIE11",e.HatsPaneFailed="HatsPaneFailed",e.HatsPaneLaunched="HatsPaneLaunched",e.ImpressionsBeaconCall="ImpressionsBeaconCall",e.ImpressionsBeaconCallFailed="ImpressionsBeaconCallFailed",e.ImpressionsBeaconCallSuccess="ImpressionsBeaconCallSuccess",e.InProgressFinished="InProgressFinished",e.InProgressStarted="InProgressStarted",e.InvalidIrisTelemetryUri="InvalidIrisTelemetryUri",e.LargeModalsHidden="LargeModalsHidden",e.Mark="Mark",e.MissingResponseValues="MissingResponseValues",e.ModalsHiddenWhenZoomed="ModalsHiddenWhenZoomed",e.NoExtensionTaskMatches="NoExtensionTaskMatches",e.NotificationNotShown_InvalidBatchFormat="NotificationNotShown_InvalidBatchFormat",e.NotificationNotShown_InvalidContent="NotificationNotShown_InvalidContent",e.NotificationNotShown_NoNotificationsOrCultureMismatch="NotificationNotShown_NoNotificationsOrCultureMismatch",e.NotificationNotShown_NoSchema="NotificationNotShown_NoSchema",e.NotificationNotShown_NoTitleOrDescription="NotificationNotShown_NoTitleOrDescription",e.NotificationNotShown_InValidNotificationType="NotificationNotShown_InValidNotificationType",e.NotificationDismissed="NotificationDismissed",e.NotificationShown="NotificationShown",e.NotStarted="NotStarted",e.NPSScoreInvalid="NPSScoreInvalid",e.NPSScoreValid="NPSScoreValid",e.PollingComplete="PollingComplete",e.PollingError="PollingError",e.PollingFailed="PollingFailed",e.PollingFinished="PollingFinished",e.PollingNotificationNotFound="PollingNotificationNotFound",e.PollingRegistered="PollingRegistered",e.PollingStarted="PollingStarted",e.PollingTimedOut="PollingTimedOut",e.PublishIrisNotification="PublishIrisNotification",e.SATScoreInvalid="SATScoreInvalid",e.SATScoreValid="SATScoreValid",e.SmallModalsHidden="SmallModalsHidden",e.TriggeringModal="TriggeringModal",e.UpdateEmailFailed="UpdateEmailFailed",e.UpdateEmailSucceeded="UpdateEmailSucceeded"}(o=t.ActionModifierInternal||(t.ActionModifierInternal={})),t.ActionModifier=o})),
define("MsPortalImpl/UI/Commands/Base.PortalFunctions",["require","exports","Fx/DependencyInjection"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShowWelcomeSequence=t.ShowTelemetryInsights=t.ShowDebugTools=t.DownloadDiagnosticsJson=t.ToggleCloudShell=t.CreateJourneyForAssetFunc=t.CreateJourneyForBladeFunc=t.ReloadPartPortalFunc=t.ReplacePartPortalFunc=t.DeleteDashboardWithConfimationPortalFunc=t.PinBladePortalFunc=t.PinTilePortalFunc=t.PinTileWithOptionsPortalFunc=t.PinTilesPortalFunc=t.RoutePortalFunc=t.GetCurrentDashboardPropertiesPortalFunc=t.IsCurrentDashboarSharedPortalFunc=t.GetUserPermissionsForDashboardPortalFunc=t.UnshareDashboardToSessionPortalFunc=t.ShareDashboardToSessionPortalFunc=t.ShareCurrentDashboardPortalFunc=t.AssignTagsToDashboardPortalFunc=t.ClonePartPortalFunc=t.UpdateDashboardPortalFunc=t.CloneDashboardPortalFunc=t.ResetDashboardPortalFunc=t.SwitchDashboardPortalFunc=t.ReadDashboardPortalFunc=t.ImportDashboardPortalFunc=t.ExportDashboardPortalFunc=t.StartNewDashboardPortalFunc=t.RefreshDashboardPortalFunc=t.PortalFunction=void 0;class i{constructor(){this._eventHandlers=[]}setRegistration(e){this._handler=e}addPreInvocationEvent(e){this._eventHandlers.push(e)}invoke(e,t){if(!this._handler)throw new Error("Must register portal function before calling it.");return this._eventHandlers.forEach((e=>e(t))),this._handler(e,t)}}t.PortalFunction=i;let o=class extends i{};o=__decorate([__metadata("fx:diagnostics",[e,"RefreshDashboardPortalFunc"]),s.Class()],o),t.RefreshDashboardPortalFunc=o;let n=class extends i{};n=__decorate([__metadata("fx:diagnostics",[e,"StartNewDashboardPortalFunc"]),s.Class()],n),t.StartNewDashboardPortalFunc=n;let r=class extends i{};r=__decorate([__metadata("fx:diagnostics",[e,"ExportDashboardPortalFunc"]),s.Class()],r),t.ExportDashboardPortalFunc=r;let a=class extends i{};a=__decorate([__metadata("fx:diagnostics",[e,"ImportDashboardPortalFunc"]),s.Class()],a),t.ImportDashboardPortalFunc=a;let l=class extends i{};l=__decorate([__metadata("fx:diagnostics",[e,"ReadDashboardPortalFunc"]),s.Class()],l),t.ReadDashboardPortalFunc=l;let d=class extends i{};d=__decorate([__metadata("fx:diagnostics",[e,"SwitchDashboardPortalFunc"]),s.Class()],d),t.SwitchDashboardPortalFunc=d;let c=class extends i{};c=__decorate([__metadata("fx:diagnostics",[e,"ResetDashboardPortalFunc"]),s.Class()],c),t.ResetDashboardPortalFunc=c;let p=class extends i{};p=__decorate([__metadata("fx:diagnostics",[e,"CloneDashboardPortalFunc"]),s.Class()],p),t.CloneDashboardPortalFunc=p;let u=class extends i{};u=__decorate([__metadata("fx:diagnostics",[e,"UpdateDashboardPortalFunc"]),s.Class()],u),t.UpdateDashboardPortalFunc=u;let m=class extends i{};m=__decorate([__metadata("fx:diagnostics",[e,"ClonePartPortalFunc"]),s.Class()],m),t.ClonePartPortalFunc=m;let g=class extends i{};g=__decorate([__metadata("fx:diagnostics",[e,"AssignTagsToDashboardPortalFunc"]),s.Class()],g),t.AssignTagsToDashboardPortalFunc=g;let h=class extends i{};h=__decorate([__metadata("fx:diagnostics",[e,"ShareCurrentDashboardPortalFunc"]),s.Class()],h),t.ShareCurrentDashboardPortalFunc=h;let f=class extends i{};f=__decorate([__metadata("fx:diagnostics",[e,"ShareDashboardToSessionPortalFunc"]),s.Class()],f),t.ShareDashboardToSessionPortalFunc=f;let x=class extends i{};x=__decorate([__metadata("fx:diagnostics",[e,"UnshareDashboardToSessionPortalFunc"]),s.Class()],x),t.UnshareDashboardToSessionPortalFunc=x;let b=class extends i{};b=__decorate([__metadata("fx:diagnostics",[e,"GetUserPermissionsForDashboardPortalFunc"]),s.Class()],b),t.GetUserPermissionsForDashboardPortalFunc=b;let v=class extends i{};v=__decorate([__metadata("fx:diagnostics",[e,"IsCurrentDashboarSharedPortalFunc"]),s.Class()],v),t.IsCurrentDashboarSharedPortalFunc=v;let y=class extends i{};y=__decorate([__metadata("fx:diagnostics",[e,"GetCurrentDashboardPropertiesPortalFunc"]),s.Class()],y),t.GetCurrentDashboardPropertiesPortalFunc=y;let M=class extends i{};M=__decorate([__metadata("fx:diagnostics",[e,"RoutePortalFunc"]),s.Class()],M),t.RoutePortalFunc=M;let I=class extends i{};I=__decorate([__metadata("fx:diagnostics",[e,"PinTilesPortalFunc"]),s.Class()],I),t.PinTilesPortalFunc=I;let C=class extends i{};C=__decorate([__metadata("fx:diagnostics",[e,"PinTileWithOptionsPortalFunc"]),s.Class()],C),t.PinTileWithOptionsPortalFunc=C;let P=class extends i{};P=__decorate([__metadata("fx:diagnostics",[e,"PinTilePortalFunc"]),s.Class()],P),t.PinTilePortalFunc=P;let w=class extends i{};w=__decorate([__metadata("fx:diagnostics",[e,"PinBladePortalFunc"]),s.Class()],w),t.PinBladePortalFunc=w;let _=class extends i{};_=__decorate([__metadata("fx:diagnostics",[e,"DeleteDashboardWithConfimationPortalFunc"]),s.Class()],_),t.DeleteDashboardWithConfimationPortalFunc=_;let S=class extends i{};S=__decorate([__metadata("fx:diagnostics",[e,"ReplacePartPortalFunc"]),s.Class()],S),t.ReplacePartPortalFunc=S;let F=class extends i{};F=__decorate([__metadata("fx:diagnostics",[e,"ReloadPartPortalFunc"]),s.Class()],F),t.ReloadPartPortalFunc=F;let k=class extends i{};k=__decorate([__metadata("fx:diagnostics",[e,"CreateJourneyForBladeFunc"]),s.Class()],k),t.CreateJourneyForBladeFunc=k;let T=class extends i{};T=__decorate([__metadata("fx:diagnostics",[e,"CreateJourneyForAssetFunc"]),s.Class()],T),t.CreateJourneyForAssetFunc=T;let D=class extends i{};D=__decorate([__metadata("fx:diagnostics",[e,"ToggleCloudShell"]),s.Class()],D),t.ToggleCloudShell=D;let E=class extends i{};E=__decorate([__metadata("fx:diagnostics",[e,"DownloadDiagnosticsJson"]),s.Class()],E),t.DownloadDiagnosticsJson=E;let B=class extends i{};B=__decorate([__metadata("fx:diagnostics",[e,"ShowDebugTools"]),s.Class()],B),t.ShowDebugTools=B;let A=class extends i{};A=__decorate([__metadata("fx:diagnostics",[e,"ShowTelemetryInsights"]),s.Class()],A),t.ShowTelemetryInsights=A;let N=class extends i{};N=__decorate([__metadata("fx:diagnostics",[e,"ShowWelcomeSequence"]),s.Class()],N),t.ShowWelcomeSequence=N})),
define("MsPortalImpl/UI/UI.BladeOpener",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BladeOpener=void 0;const o=i.getFactory("MsPortalImpl/UI/UI.BladeOpenerImpl","BladeOpener");let n=class{constructor(e){this._diContainer=e}openBlade(e,t={}){return this._diContainer.getAsync(o()).then((s=>s.openBlade(e,t)))}};n=__decorate([__metadata("fx:diagnostics",[e,"BladeOpener"]),s.Class(),__metadata("design:paramtypes",[s.Container])],n),t.BladeOpener=n})),
define("MsPortalImpl/Base/Base.SvgHelper",["require","exports","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.Sanitization"],(function(e,t,s,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSvgReferenceOrFallBackToData=t.SvgsPalettes=t.SvgBadgeClass=t.SvgPlaceholderClass=void 0;MsPortalFx.Base.Diagnostics;var n=MsPortalFx.encodeAttribute,r=MsPortalFx.encodeHtml;const a=window,l="http://www.w3.org/2000/svg",d=a.document;let c;function p(e,t){const s=e.getAttribute("class");e.setAttribute("class",(s?s+" ":"")+t)}function u(e,t){e.setAttribute("class",(e.getAttribute("class")||"").split(" ").filter((e=>e&&e!==t)).join(" "))}function m(e,t){for(let s=0,i=e.length;s<i;++s)t(e[s])}function g(e,s){if(s.customClass&&r(s.customClass).split(" ").filter((e=>e.startsWith("ext-")||e.startsWith("msportalfx")||e.startsWith("fxt-"))).forEach((s=>m(e.getElementsByClassName(t.SvgPlaceholderClass),(e=>p(e,s))))),s.description){const t=d.createElementNS(l,"desc");t.textContent=s.description;const i=e.getElementsByTagName("title")[0];i&&i.parentNode.insertBefore(t,i.nextSibling)}if(s.title)m(e.getElementsByTagName("title"),(e=>{e.textContent||(e.textContent=s.title)}));else{const t=[];m(e.getElementsByTagName("title"),(e=>e&&!e.textContent&&t.push(e))),t.forEach((e=>e.remove()))}return s._badgeWidth||(m(e.getElementsByClassName(t.SvgPlaceholderClass),(e=>u(e,t.SvgPlaceholderClass))),m(e.querySelectorAll("[class='']"),(e=>e.removeAttribute("class")))),c(e.firstElementChild||y.cloneNode(),e.innerHTML)}t.SvgPlaceholderClass="msportalfx-svg-placeholder",t.SvgBadgeClass="msportalfx-svg-badge",t.SvgsPalettes=[],t.SvgsPalettes[0]="",t.SvgsPalettes[2]="msportalfx-svg-palette-black",t.SvgsPalettes[3]="msportalfx-svg-palette-blue",t.SvgsPalettes[1]="msportalfx-svg-palette-white",t.SvgsPalettes[4]="msportalfx-svg-palette-green",t.SvgsPalettes[5]="msportalfx-svg-palette-gray",t.SvgsPalettes[99]="msportalfx-svg-palette-inherit",t.SvgsPalettes[100]="msportalfx-svg-disabled",c=a.SVGElement&&"outerHTML"in SVGElement.prototype?e=>e:(e,t)=>(e.outerHTML=t,e);const h=FxImpl.createElement("div",{id:"FxSymbolContainer","aria-hidden":"true",role:"presentation",style:"width: 0; height: 0; overflow: hidden"});d.body.appendChild(h);const f=MsPortalFx.getIdGenerator("FxSymbol"),x=new Map,b=d.implementation.createHTMLDocument("").body,v=Object.create(null),y=d.createElementNS(l,"svg"),M=(()=>{const e=FxImpl.createElement("div");return e.appendChild(y),e.innerHTML})(),I=d.createElementNS(l,"defs"),C=d.createElementNS(l,"svg");C.setAttribute("aria-hidden","true"),C.setAttribute("width","0"),C.setAttribute("height","0"),C.setAttribute("role","presentation"),C.setAttribute("focusable","false"),C.appendChild(I);const P=FxImpl.createElement("div",{id:"DefsContainer","aria-hidden":"true",role:"presentation",style:"width: 0; height: 0; overflow: hidden"});P.appendChild(C),d.body.appendChild(P);const w=["aria-hidden","aria-labelledby","class","clip-path","clip-rule","cx","cy","d","data-islogo","enable-background","fill","fill-opacity","fill-rule","filter","focusable","gradientTransform","gradientUnits","height","id","mask","offset","opacity","points","r","role","rx","ry","spreadMethod","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-anchor","transform","viewBox","width","x","x1","x2","xml:space","xmlns","xmlns:svg","xmlns:xlink","y","y1","y2","xlink:href"].reduce(((e,t)=>(t&&(e[t]=!0,e[t.toUpperCase()]=!0),e)),a.Object.create(null)),_="*:not("+["circle","clipPath","defs","ellipse","g","image","line","linearGradient","mask","path","polygon","polyline","radialGradient","rect","stop","svg","symbol","text","title","use"].join("):not(")+")";function S(e,s){const i=f(),o=y.cloneNode(),n=FxImpl.createElement("div");p(o,t.SvgPlaceholderClass),o.setAttribute("height","100%"),o.setAttribute("width","100%"),o.appendChild(d.createElementNS(l,"title")),n.appendChild(o);const r=y.cloneNode(),a=d.createElementNS(l,"defs"),c=d.createElementNS(l,"symbol"),m=d.createElementNS(l,"use");m.setAttribute("href","#"+i),o.appendChild(m);const g=s.getElementsByTagName("svg")[0]||s;for(let e=0,t=g.attributes.length;e<t;++e){const t=g.attributes[e];c.setAttribute(t.name,t.value)}for(;g.hasChildNodes();)c.appendChild(g.firstChild);c.setAttribute("id",i),c.setAttribute("data-type",e+""),u(c,t.SvgPlaceholderClass),a.appendChild(c),r.appendChild(a);const h=d.createElement("div");return h.appendChild(r),{reference:n,symbol:r,symbolContainer:h}}const F=MsPortalFx.isFeatureEnabled("fulldiagnostics"),k=!MsPortalFx.isFeatureEnabled("allowshadowdominsafari")&&s.isSafari,T=MsPortalFx.isFeatureEnabled("forcesvgshadowdom"),D=/msportalfx-svg-c0(?:5|7)|-animated[\s'"]|[\s'"]ext-|fxs-svg-number/;t.getSvgReferenceOrFallBackToData=function(s,a,l,d,u){a=a||s.options||{};const f=s&&s.type,C=s&&s.data;if(0===f||!C)return c(y.cloneNode(),M);if(2===f){if(o.sanitizeUri(C,null,{diContainer:u,localRequire:e,windowContext:l})){const e=r(a.title||""),t=FxImpl.createElement("img");return e?t.setAttribute("alt",e):t.setAttribute("aria-hidden","true"),t.setAttribute("src",n(C)),t}return i.logToExtension(e,l,2,"Image has failed to load as an invalid uri was passed in : "+C),c(y.cloneNode(),M)}const P=function(t,s,o){let n=v[t];if(!n||o){n=b,n.innerHTML=t;const r=[];m(n.querySelectorAll(_),(o=>{i.logToExtension(e,s,2,"Svg contains illegal element: "+o.tagName,{contextData:{svg:t}}),r.push(o)})),r.forEach((e=>e.remove())),m(n.querySelectorAll("*"),(o=>{const n=o.attributes,r=[];for(let o=0,a=n.length;o<a;++o){const a=n[o].name;w[a]||(i.logToExtension(e,s,2,"Svg contains illegal attribute: "+a,{contextData:{svg:t}}),r.push(a))}r.forEach((e=>o.removeAttribute(e)))})),MsPortalFx.isFeatureEnabled("preservegradients")||m(n.querySelectorAll("linearGradient,radialGradient,clipPath"),(e=>{const t=e.getAttribute("id");if(t){const s=MsPortalFx.getUniqueId();e.setAttribute("id",s),["fill","clip-path"].forEach((e=>{m(n.querySelectorAll(`[${e}='url("#${t}")'],[${e}="url('#${t}')"],[${e}="url(#${t})"]`),(t=>{t.setAttribute(e,`url(#${s})`)}))}))}})),o||(m(n.querySelectorAll("linearGradient,radialGradient,clipPath"),(e=>I.appendChild(e))),v[t]=n.cloneNode(!0))}return n.cloneNode(!0)}(C,l,d);if(!P.hasChildNodes())return i.logToExtension(e,l,2,"Svg has failed to load, imageData: "+C),c(y.cloneNode(),M);const E=t.SvgsPalettes[a.palette];if(a.palette&&m(P.getElementsByClassName(t.SvgPlaceholderClass),(e=>p(e,E))),a.symbol)return g(S(f,P).symbolContainer,a);if(!T&&(k||F||!MsPortalFx.isNullOrWhiteSpace(a.customClass)||D.test(P.outerHTML))){return g(P,a)}const B=P.outerHTML;let A=x.get(B);if(A)A=A.cloneNode(!0);else{const e=S(f,P);A=e.reference,h.appendChild(e.symbol),x.set(B,A.cloneNode(!0))}return g(A,a)}})),
define("MsPortalImpl/Dialogs/MessageBoxInternal",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageBoxExtended=void 0;var s=MsPortalFx.ViewModels.Dialogs;class i extends s.MessageBox{}t.MessageBoxExtended=i})),
define("MsPortalImpl/Services/Services.PortalIdleState",["require","exports","Fx/DependencyInjection"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PortalIdleStateService=void 0;class i{constructor(e,t){if(this._win=e,this._defaultPollMS=t,this._state=0,this._handleId=1,this._iteration=0,this._actions=new Map,this._frameInFocus=!1,this._win.addEventListener("blur",this._blurFunc=()=>{document.activeElement instanceof HTMLIFrameElement||this._signalIdle(this._defaultPollMS)}),this._win.addEventListener("focus",this._focusFunc=()=>{this._blurStartTime=null,this.signalBusy()}),MsPortalFx.isFeatureEnabled("displayidlestateindom")){const e=document.getElementById("web-container");e.dataset.frameinfocus=String(this._frameInFocus),e.dataset.idlestate=String(this._state)}}dispose(){const e=this._win;return!!e&&(this._win=null,e.removeEventListener("blur",this._blurFunc),e.removeEventListener("focus",this._focusFunc),this._setIdleState(0),!0)}addCallbacks(e){const t=this._handleId++;return this._actions.set(t,e),t}removeCallbacks(e){return this._actions.delete(e)}signalBusy(e=0,t){if(this._setFrameInFocus(1===e),1===e){const e=document.getElementsByClassName("fxs-topbar-sidebar-collapse-button")[0];(null==e?void 0:e.offsetWidth)>0&&(null==e?void 0:e.offsetHeight)>0&&3!==t&&$(e).trigger("fxtogglesidebar",{collapse:!0})}1===this._state&&(this._setIdleState(2),this._processCallbacks(5e3))}signalIdle(e=0){(0===e||this._frameInFocus)&&this._signalIdle(0)}static create(){return new i(window,6e4)}_setFrameInFocus(e){this._frameInFocus=e,MsPortalFx.isFeatureEnabled("displayidlestateindom")&&(document.getElementById("web-container").dataset.frameinfocus=String(this._frameInFocus))}_setIdleState(e){this._state=e,MsPortalFx.isFeatureEnabled("displayidlestateindom")&&(document.getElementById("web-container").dataset.idlestate=String(this._state))}_signalIdle(e){this._blurStartTime||(this._blurStartTime=Date.now()),this._setIdleState(1),this._processCallbacks(e)}_processCallbacks(e){if(!this._win)return;const t=()=>{let e;switch(this._state){case 2:this._setIdleState(0),e=e=>e.onBusy&&e.onBusy(new Date);break;case 1:this._setIdleState(1),e=e=>e.onIdle(Math.floor((Date.now()-this._blurStartTime)/6e4));break;default:return}const t=(t,s)=>{const i=t[s],o=this._actions.get(i);o&&e(o)},s=Array.from(this._actions.keys()),i=this._actions.size,o=this._iteration%i;this._iteration++;for(let e=o;e<i+o;e++)t(s,e%i)},s=this._timeoutHandle;s&&this._win.clearTimeout(s),this._timeoutHandle=this._win.setTimeout((()=>{this._timeoutHandle=null;try{t()}finally{0!==this._state&&this._processCallbacks(this._defaultPollMS)}}),e)}}__decorate([__metadata("fx:diagnostics",[e,"PortalIdleStateService"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",i)],i,"create",null),t.PortalIdleStateService=i})),
define("MsPortalImpl/TsxStringMode/Tsx",["require","exports"],(function(e,t){"use strict";function s(e,t,...i){const o="string"==typeof e?e:e(),n=s.elementStringFactories[o];let r=n.createOpenTag(t);return r+=i.join(""),r+=n.createClosingTag(),r}return function(e){function t(e){const t=[];return e&&Object.keys(e).forEach((s=>{switch(s){case"data-bind":e["data-bind"]&&t.push(function(e){const t=[],s=e=>{MsPortalFx.forEachKey(e,((e,i)=>{t.push(`"${e}":`),"string"==typeof i?t.push(i):(t.push("{"),s(i),t.push("}")),t.push(",")})),t.pop()};return t.push("data-bind='"),s(e),t.push("'"),t.join("")}(e["data-bind"]));break;case"class":e.class&&t.push(`class='${"string"==typeof(i=e.class)?i:i.join(" ")}'`);break;default:!MsPortalFx.isNullOrUndefined(e[s])&&t.push(`${s}='${e[s]}'`)}var i})),t}e.Root=function(){return"Root"},e.KoIf=function(e){return"KoIf"},e.KoIfNot=function(e){return"KoIfNot"},e.KoForEach=function(e){return"KoForEach"},e.KoTemplate=function(e){return"KoTemplate"},e.KoContext=function(e){return"KoContext"},e.KoWith=function(e){return"KoWith"},e.elementStringFactories={Root:{createOpenTag:()=>"",createClosingTag:()=>""},a:{createOpenTag:e=>`<a ${t(e).join(" ")}>`,createClosingTag:()=>"</a>"},article:{createOpenTag:e=>`<article ${t(e).join(" ")}>`,createClosingTag:()=>"</article>"},aside:{createOpenTag:e=>`<aside ${t(e).join(" ")}>`,createClosingTag:()=>"</aside>"},b:{createOpenTag:e=>`<b ${t(e).join(" ")}>`,createClosingTag:()=>"</b>"},br:{createOpenTag:e=>`<br ${t(e).join(" ")}/>`,createClosingTag:()=>""},button:{createOpenTag:e=>`<button ${t(e).join(" ")}>`,createClosingTag:()=>"</button>"},canvas:{createOpenTag:e=>`<canvas ${t(e).join(" ")}>`,createClosingTag:()=>"</canvas>"},div:{createOpenTag:e=>`<div ${t(e).join(" ")}>`,createClosingTag:()=>"</div>"},fieldset:{createOpenTag:e=>`<fieldset ${t(e).join(" ")}>`,createClosingTag:()=>"</fieldset>"},"fxs-progress":{createOpenTag:e=>`<fxs-progress ${t(e).join(" ")}>`,createClosingTag:()=>"</fxs-progress>"},h1:{createOpenTag:e=>`<h1 ${t(e).join(" ")}>`,createClosingTag:()=>"</h1>"},h2:{createOpenTag:e=>`<h2 ${t(e).join(" ")}>`,createClosingTag:()=>"</h2>"},h3:{createOpenTag:e=>`<h3 ${t(e).join(" ")}>`,createClosingTag:()=>"</h3>"},h4:{createOpenTag:e=>`<h4 ${t(e).join(" ")}>`,createClosingTag:()=>"</h4>"},h5:{createOpenTag:e=>`<h5 ${t(e).join(" ")}>`,createClosingTag:()=>"</h5>"},hr:{createOpenTag:e=>`<hr ${t(e).join(" ")}>`,createClosingTag:()=>"</hr>"},header:{createOpenTag:e=>`<header ${t(e).join(" ")}>`,createClosingTag:()=>"</header>"},i:{createOpenTag:e=>`<i ${t(e).join(" ")}>`,createClosingTag:()=>"</i>"},iframe:{createOpenTag:e=>`<iframe ${t(e).join(" ")}>`,createClosingTag:()=>"</iframe>"},img:{createOpenTag:e=>`<img ${t(e).join(" ")}/>`,createClosingTag:()=>""},input:{createOpenTag:e=>`<input ${t(e).join(" ")}/>`,createClosingTag:()=>""},label:{createOpenTag:e=>`<label ${t(e).join(" ")}>`,createClosingTag:()=>"</label>"},legend:{createOpenTag:e=>`<legend ${t(e).join(" ")}>`,createClosingTag:()=>"</legend>"},li:{createOpenTag:e=>`<li ${t(e).join(" ")}>`,createClosingTag:()=>"</li>"},main:{createOpenTag:e=>`<main ${t(e).join(" ")}>`,createClosingTag:()=>"</main>"},nav:{createOpenTag:e=>`<nav ${t(e).join(" ")}>`,createClosingTag:()=>"</nav>"},p:{createOpenTag:e=>`<p ${t(e).join(" ")}>`,createClosingTag:()=>"</p>"},span:{createOpenTag:e=>`<span ${t(e).join(" ")}>`,createClosingTag:()=>"</span>"},table:{createOpenTag:e=>`<table ${t(e).join(" ")}>`,createClosingTag:()=>"</table>"},tbody:{createOpenTag:e=>`<tbody ${t(e).join(" ")}>`,createClosingTag:()=>"</tbody>"},td:{createOpenTag:e=>`<td ${t(e).join(" ")}>`,createClosingTag:()=>"</td>"},textarea:{createOpenTag:e=>`<textarea ${t(e).join(" ")}>`,createClosingTag:()=>"</textarea>"},th:{createOpenTag:e=>`<th ${t(e).join(" ")}>`,createClosingTag:()=>"</th>"},thead:{createOpenTag:e=>`<thead ${t(e).join(" ")}>`,createClosingTag:()=>"</thead>"},time:{createOpenTag:e=>`<time ${t(e).join(" ")}>`,createClosingTag:()=>"</time>"},tr:{createOpenTag:e=>`<tr ${t(e).join(" ")}>`,createClosingTag:()=>"</tr>"},ul:{createOpenTag:e=>`<ul ${t(e).join(" ")}>`,createClosingTag:()=>"</ul>"},video:{createOpenTag:e=>`<video ${t(e).join(" ")}>`,createClosingTag:()=>"</video>"},KoIf:{createOpenTag:e=>`\x3c!-- ko if: ${e.condition} --\x3e`,createClosingTag:()=>"\x3c!-- /ko --\x3e"},KoIfNot:{createOpenTag:e=>`\x3c!-- ko ifnot: ${e.condition} --\x3e`,createClosingTag:()=>"\x3c!-- /ko --\x3e"},KoForEach:{createOpenTag:e=>`\x3c!-- ko foreach: ${e.items} --\x3e`,createClosingTag:()=>"\x3c!-- /ko --\x3e"},KoTemplate:{createOpenTag:e=>{let t;return e.templateKey?t=`'${e.templateKey}'`:e.options&&(t=e.options),`\x3c!-- ko template: ${t} --\x3e`},createClosingTag:()=>"\x3c!-- /ko --\x3e"},KoContext:{createOpenTag:e=>`\x3c!-- ko context: ${e.context} --\x3e`,createClosingTag:()=>"\x3c!-- /ko --\x3e"},KoWith:{createOpenTag:e=>`\x3c!-- ko with: ${e.data} --\x3e`,createClosingTag:()=>"\x3c!-- /ko --\x3e"}}}(s||(s={})),s})),
define("MsPortalImpl/Interactions/Interactions.DismissHandler",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validatePreviousFocusedElement=t.dismissByLogName=t.unregister=t.register=t.dispose=t.initialize=void 0;const s=document,i=MsPortalFx.Base.Diagnostics.createLog(e);let o=!1;const n=[];function r(e){const t=e&&"function"==typeof e.dismissFn&&function(e){const t="function";let s=!!e;return e.shouldDismissOnFocusOutFn&&(s=s&&typeof e.shouldDismissOnFocusOutFn===t),e.restoreFocus&&(s=s&&typeof e.restoreFocus===t),e.shouldDismissOnMouseDownFn&&(s=s&&typeof e.shouldDismissOnMouseDownFn===t),e.shouldDismissOnMouseWheelFn&&(s=s&&typeof e.shouldDismissOnMouseWheelFn===t),s}(e);return t||i.error("The dismiss handle object is null or malformed."),t}function a(e){if(!n.length)return;const t=n[n.length-1];try{const s=e(t);0!==s&&(t.dismissFn(),2===s&&t.restoreFocus&&t.restoreFocus())}catch(e){!function(e,t){i.error("An error occurred on dismiss. Unregister might have been forgotten on cleanup of the dismissable element. DismissHandle log name: {0}".format(t&&t.logName||"unknown"),0,e)}(e,t)}}function l(e){a((t=>t.shouldDismissOnFocusOutFn&&r(t)?t.shouldDismissOnFocusOutFn(e.target):0))}function d(e){27===e.keyCode&&a((e=>r(e)?2:0))}function c(e){a((t=>t.shouldDismissOnMouseDownFn&&r(t)?t.shouldDismissOnMouseDownFn(e.target,e):0))}function p(e){o||(o=!0,setTimeout((()=>{o=!1}),250),a((t=>t.shouldDismissOnMouseWheelFn&&r(t)?t.shouldDismissOnMouseWheelFn(e.target):0)))}function u(e){a((t=>t.shouldDismissOnMouseWheelFn&&t.shouldDismissOnScroll&&r(t)&&!$(e.target).hasClass("azc-resize")?t.shouldDismissOnMouseWheelFn(e.target):0))}let m=!1;try{window.addEventListener("test",null,{passive:!0}),window.removeEventListener("test",null),m=!0}catch(e){m=!1}function g(){return!m||{capture:!0}}function h(){return!m||{capture:!0,passive:!0}}t.initialize=function(){const e=s.body;e.addEventListener("focus",l,g()),e.addEventListener("keydown",d,g()),e.addEventListener("mousedown",c,g()),e.addEventListener("touchstart",c,h()),e.addEventListener("wheel",p,h()),e.addEventListener("scroll",u,g())},t.dispose=function(){const e=s.body;e.removeEventListener("focus",l,g()),e.removeEventListener("keydown",d,g()),e.removeEventListener("mousedown",c,g()),e.removeEventListener("touchstart",c,g()),e.removeEventListener("wheel",p,g()),e.removeEventListener("scroll",u,g()),n.length=0},t.register=function(e){if(!r(e))throw new Error("The dismiss handle object is null or malformed.");n.some((t=>t===e))||n.push(e)},t.unregister=function(e){MsPortalFx.remove(n,e)},t.dismissByLogName=function(e){n.length&&n.filter((t=>t.logName===e)).forEach((t=>{t.dismissFn(e)}))},t.validatePreviousFocusedElement=function(e,t){const s=`DismissHandle for '${e.logName}': previouslyFocusedElement`;return t?"function"==typeof t.focus||(i.error(FxImpl.createError(`${s} focus member is not a function. _previouslyFocusedElement.focus: ${t.focus}`,{data:{previous:MsPortalFx.getObjectDescriptor(t)}})),!1):(i.warning(`${s} was not defined.`),!1)}})),
define("MsPortalImpl/Base/Base.KeyboardHelper",["require","exports","MsPortalImpl/Base/Base.BrowserDetection"],(function(e,t,s){"use strict";var i,o;Object.defineProperty(t,"__esModule",{value:!0}),t.setCtrlOrCommandModifier=t.isCtrlOrCommandOnly=t.isCtrlOrCommand=t.mapKeyCodeToString=t.getModifierKeys=t.isNonWrittenCharacter=t.VariableKeyCode=void 0,function(e){e[e.Equals=s.isFirefox?61:187]="Equals",e[e.Minus=s.isFirefox?173:189]="Minus"}(i=t.VariableKeyCode||(t.VariableKeyCode={})),function(e){e[e.Alt=18]="Alt",e[e.Backslash=220]="Backslash",e[e.Backspace=8]="Backspace",e[e.Comma=188]="Comma",e[e.Control=17]="Control",e[e.Delete=46]="Delete",e[e.Down=40]="Down",e[e.End=35]="End",e[e.Enter=13]="Enter",e[e.Equals=i.Equals]="Equals",e[e.Escape=27]="Escape",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F10=121]="F10",e[e.Home=36]="Home",e[e.Left=37]="Left",e[e.Menu=93]="Menu",e[e.Minus=i.Minus]="Minus",e[e.PageDown=34]="PageDown",e[e.PageUp=33]="PageUp",e[e.Period=190]="Period",e[e.Right=39]="Right",e[e.Shift=16]="Shift",e[e.Slash=191]="Slash",e[e.Space=32]="Space",e[e.Tab=9]="Tab",e[e.Up=38]="Up",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.Num0=48]="Num0",e[e.Num1=49]="Num1",e[e.Num2=50]="Num2",e[e.Num3=51]="Num3",e[e.Num4=52]="Num4",e[e.Num5=53]="Num5",e[e.Num6=54]="Num6",e[e.Num7=55]="Num7",e[e.Num8=56]="Num8",e[e.Num9=57]="Num9",e[e.NumPad0=96]="NumPad0",e[e.NumPad1=97]="NumPad1",e[e.NumPad2=98]="NumPad2",e[e.NumPad3=99]="NumPad3",e[e.NumPad4=100]="NumPad4",e[e.NumPad5=101]="NumPad5",e[e.NumPad6=102]="NumPad6",e[e.NumPad7=103]="NumPad7",e[e.NumPad8=104]="NumPad8",e[e.NumPad9=105]="NumPad9",e[e.SingleQuote=222]="SingleQuote"}(o||(o={})),t.isNonWrittenCharacter=function(e){switch(e){case 18:case 17:case 40:case 35:case 27:case 36:case 37:case 34:case 33:case 39:case 16:case 9:case 38:return!0;default:return!1}},t.getModifierKeys=function(e){return(e.altKey&&1)|(e.metaKey&&2)|(e.shiftKey&&4)|(e.ctrlKey&&8)};const n=[];n[192]="~",n[219]="{",n[221]="}",n[220]="|",n[59]=":",n[188]="<",n[i.Equals]="+",n[i.Minus]="_",n[49]="!",n[50]="@",n[51]="#",n[52]="$",n[53]="%",n[54]="^",n[55]="&",n[56]="*",n[57]="(",n[48]=")",n[190]=">",n[191]="?",n[222]='"',n[32]="SHIFT+SPACE",n[40]="SHIFT+Down",n[38]="SHIFT+Up";const r=[];function a(e){return e.ctrlKey&&!e.metaKey||s.isMac&&e.metaKey&&!e.ctrlKey}r[220]="\\",r[188]=",",r[i.Minus]="-",r[49]="1",r[50]="2",r[51]="3",r[52]="4",r[53]="5",r[54]="6",r[55]="7",r[56]="8",r[57]="9",r[48]="0",r[190]=".",r[32]="SPACE",r[191]="/",t.mapKeyCodeToString=function(e,t){return(e?n:r)[t]||o[t]},t.isCtrlOrCommand=a,t.isCtrlOrCommandOnly=function(e){return!e.shiftKey&&!e.altKey&&a(e)},t.setCtrlOrCommandModifier=function(e){e.ctrlKey=!s.isMac,e.metaKey=s.isMac}})),
define("MsPortalImpl/Interactions/Interactions.KeyboardNavigation",["require","exports","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Base/JQueryHelper"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KeyboardNavigation=void 0;t.KeyboardNavigation=class{constructor(e,t){if(this._element=t.element,this._tabTriggers=t.tabTriggers||6,this._itemSelector=t.itemSelector||":tabbable",this._arrowsOnly=!(2&this._tabTriggers),this._internalLifetime=e.createChildLifetime(),this._parentTabIndexContextObservable=t.parentTabIndexContextObservable,this._setTabIndex=t.setTabIndex||((e,t)=>{e.attr("tabindex",""+t)}),this._setRootTabIndex(),this._internalLifetime.registerForDispose(this._element.setEvents(["focus",e=>{const t=this._element.find(this._itemSelector).first();this._arrowsOnly&&this._manageTabIndices(t),t.focus()}],["keydown",e=>{this._handleMenuKeyDown(e)}])),this._arrowsOnly){const e=this._element.find(this._itemSelector);this._setTabIndex(e,-1),this._internalLifetime.registerForDispose(this._element.setEvents(["focus",this._itemSelector,e=>{this._manageTabIndices($(e.target))}]))}}correctState(e){(e||this._lastTarget&&this._lastTarget.length&&this._element.find(this._itemSelector).toArray().indexOf(this._lastTarget[0])<0)&&(this._setRootTabIndex(),this._lastTarget&&(this._setTabIndex(this._lastTarget,-1),this._lastTarget=null))}dispose(){this._internalLifetime.dispose()}_handleMenuKeyDown(e){const t=s.getModifierKeys(e);let i=!1;const o=2&this._tabTriggers,n=4&this._tabTriggers,r=8&this._tabTriggers,a=0===t;o&&9===e.keyCode&&a||n&&40===e.keyCode&&a||r&&39===e.keyCode&&a?i=this._moveFocusToItem(1,e.target):(o&&9===e.keyCode&&4===t||n&&38===e.keyCode&&a||r&&37===e.keyCode&&a)&&(i=this._moveFocusToItem(-1,e.target)),i&&e.preventDefault()}_moveFocusToItem(e,t){let s=!1;const o=this._element.find(this._itemSelector),n=$(o.filter(((e,t)=>i.isElementVisible(t)))),r=n.index(t);return-1!==r&&($(n[(r+e+n.length)%n.length]).focus(),s=!0),s}_manageTabIndices(e){if(e&&e.length&&(!this._lastTarget||this._lastTarget[0]!==e[0])){const t=this._element.find(this._itemSelector);this._itemFocusLifetime&&this._itemFocusLifetime.dispose(),this._itemFocusLifetime=this._internalLifetime.createChildLifetime(),this._lastTarget=e,t.index(this._lastTarget[0])>=0&&(this._parentTabIndexContextObservable?this._parentTabIndexContextObservable.subscribeAndRun(this._itemFocusLifetime,(e=>{this._setTabIndex(t,-1);const s=this._lastTarget||this._element.find(this._itemSelector).first();s&&this._setTabIndex(s,e)})):(this._setTabIndex(t,-1),this._setTabIndex(this._lastTarget,0))),this._clearRootTabIndex();const s=e=>{this._setRootTabIndex()},i=this._lastTarget[0];ko.utils.domNodeDisposal.addDisposeCallback(i,s),this._itemFocusLifetime.registerForDispose((()=>{ko.utils.domNodeDisposal.removeDisposeCallback(i,s)}))}}_setRootTabIndex(){this._parentTabIndexContextObservable?(this._rootFocusLifetime&&this._rootFocusLifetime.dispose(),this._rootFocusLifetime=this._internalLifetime.createChildLifetime(),this._parentTabIndexContextObservable.subscribeAndRun(this._rootFocusLifetime,(e=>{this._setTabIndex(this._element,e)}))):this._setTabIndex(this._element,0)}_clearRootTabIndex(){this._rootFocusLifetime&&this._rootFocusLifetime.dispose(),this._setTabIndex(this._element,-1)}}})),
define("MsPortalImpl/Base/Base.ImageHelper",["require","exports","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/Base/Base.SvgHelper"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GetImageData=void 0;var o=MsPortalFx.encodeAttribute,n=s.sanitizeHTML;function r(e){return"svg"===e.tagName.toLowerCase()?e:e.getElementsByTagName("svg")[0]}function a(e,t){e&&MsPortalFx.forEachKey(t,((t,s)=>e.setAttribute(t,s)))}t.GetImageData=function t(s,l){l=l||{};const{context:d,bypassCache:c,svgAttributes:p}=l,u=s&&s.type,m=s&&s.options||{};let g;if(0===u||1===u||2===u||u>=899&&u<999){const e=i.getSvgReferenceOrFallBackToData(s,m,d,c);"img"===e.tagName.toLowerCase()||e.hasChildNodes()?(a(r(e),p),g=Q([e])):g=Q([]),g=Q(e.hasChildNodes()||"img"===e.tagName.toLowerCase()?[e]:[])}else{g=(s&&s.data&&Q({[u]:s})||Q(MsPortalFx.require("MsPortalImpl/Base/Base.ImageLibrary"))).then((t=>{if(u>=999){const s=m.title?n(m.title,e,d).sanitizedMarkup:"",i=FxImpl.createElement("img");return i.setAttribute("alt",s),i.setAttribute("aria-hidden",(!m.title).toString()),i.setAttribute("src",o(t[u]&&t[u].data)),[i]}{const e=i.getSvgReferenceOrFallBackToData(t[u],m,d,c),s=r(e),o=m._badgeWidth;if(o){const t=s&&s.getAttribute("class").indexOf(i.SvgPlaceholderClass)>-1&&s||e.querySelector("svg."+i.SvgPlaceholderClass);t&&(t.setAttribute("class",t.getAttribute("class").replace(i.SvgPlaceholderClass,i.SvgBadgeClass)),"number"==typeof o&&t.setAttribute("style","width:"+o+"%; height:"+o+"%"))}return a(s,p),e.childElementCount?[e]:[]}}))}if(m.badge){let e=m.badge.width;e&&"number"==typeof e||(e=40);const s=MsPortalFx.extend2(m.badge.image,{options:MsPortalFx.extend2(m.badge.image.options||{},{_badgeWidth:e})});g=Q.all([g,t(s,{context:d})]).then((e=>[].concat(...e||[])))}return g}})),
define("MsPortalImpl/Base/Base.KnockoutExtensions.Image",["require","exports","MsPortalImpl/Base/Base.ImageHelper"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderImage=void 0;const i={"aria-hidden":"true",role:"presentation",focusable:"false"},o=!MsPortalFx.isFeatureEnabled("nokosvgcaching")&&new Map,n={controlsDescendantBindings:!0};function r(e,t){if(t){let n,r;o&&(n=JSON.stringify(t),r=o.get(n)),r||(r=s.GetImageData(t,{context:e,svgAttributes:i}).then((e=>{const t=document.createDocumentFragment();let s,i;for(s=0,i=e.length;s<i;s++)t.appendChild(e[s].cloneNode(!0));return t})),o&&o.set(n,r));const a=e.firstChild;return MsPortalFx.tryImmediateResolve(r,(t=>{a===e.firstChild&&(e.innerHTML="",e.appendChild(t.cloneNode(!0)))}))}return e.innerHTML="",Promise.resolve()}t.renderImage=r,ko.bindingHandlers.image={init:()=>n,update:function(e,t){r(e,ko.unwrap(t()))}}})),
define("MsPortalImpl/Base/Base.Timers",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.debounce=t.throttle=t.throttleByAnimationFrame=t.setupTimers=t.cancelAnimationFrame=t.requestAnimationFrame=void 0;const s=window;function i(e){if(!e&&s.requestAnimationFrame&&s.cancelAnimationFrame)t.requestAnimationFrame=e=>s.requestAnimationFrame(e),t.cancelAnimationFrame=e=>s.cancelAnimationFrame(e);else{let e=0;t.requestAnimationFrame=function(t){const s=Date.now(),i=Math.max(0,16-(s-e)),o=setTimeout((function(){t(s+i)}),i);return e=s+i,o},t.cancelAnimationFrame=function(e){clearTimeout(e)}}}t.setupTimers=i,i(!1),t.throttleByAnimationFrame=function(e){let s,i;return(...o)=>{if(s=o,!i){const o=Q.defer(),n=i=o.promise;i.timeout(2e3,"requestAnimationFrameQ timout after 2 seconds: callback:"+e).catch((()=>{n===i&&(i=null)})),(0,t.requestAnimationFrame)((()=>{try{Q(e(...s)).then(o.resolve,o.reject)}catch(e){o.reject(e)}i=null}))}return i}};const o="function",n=MsPortalFx.memoize,r=MsPortalFx.uncurryThis(Array.prototype.slice),a=MsPortalFx.Errors,l={noDebugCheck:!0};function d(e,t,s){return new a.CanceledError({message:e,data:t&&t+"",innerErrors:s})}t.throttle=function(e,t,s){let i,a,c,p;typeof t!==o&&(s=t,t=e,e=null);const u=n((()=>{const e=c||(c=Q.defer());return(s>0?Q.delay(s):Q()).then((()=>e.promise.isPending()&&a())).then(e.resolve,e.reject),e.promise}),l);a=()=>(u.clear(),c=null,t.apply(null,i));const m=function(){return i=arguments.length?r(arguments):void 0,u()},g=e=>{c&&c.promise.isPending()&&c.reject(e||d("canceled",t)),c=null,p||u.clear()};return m.cancel=g,m.dispose=()=>{p=!0;const e=d("disposed",t);g(e);const s=Q.reject(e);s.catch(MsPortalFx.noop),u.map().set(void 0,s)},e&&e.registerForDispose(m),m},t.debounce=function(e,t,s=0){let i;typeof t!==o&&(s=t,t=e,e=null);let a,c,p,u,m=0;const g=n((()=>{const e=p||(p=Q.defer()),t=Date.now(),i=m+s-t;return i>0?Q.delay(i).then((()=>e.promise.isPending()&&c())):Q.fcall((()=>e.promise.isPending()&&a())).then(e.resolve,e.reject),e.promise}),l);c=()=>(g.clear(),g()),a=()=>(g.clear(),p=null,t.apply(null,i));const h=function(...e){return m=Date.now(),i=arguments.length?r(arguments):void 0,g()};function f(e){p&&p.promise.isPending()&&p.reject(e||d("canceled",t)),p=null,u||g.clear()}return h.cancel=f,h.dispose=()=>{u=!0;const e=d("disposed",t);f(e);const s=Q.reject(e);s.catch(MsPortalFx.noop),g.map().set(void 0,s)},e&&e.registerForDispose(h),h},ko.extenders.rateLimit.tasks.debounce=t.debounce,ko.extenders.rateLimit.tasks.throttle=t.throttle})),
define("MsPortalImpl/Base/Base.KnockoutExtensions.FxClick",["require","exports"],(function(e,t){"use strict";function s(e,t,s,i){let o=!1;i&&i.registerForDispose((()=>o=!0)),MsPortalFx.require("MsPortalImpl/UI/Compositions/UI.Composition.Selectable2Registrar",(n=>{o||n.attachFxClickHandler(e,s,t,i)}))}Object.defineProperty(t,"__esModule",{value:!0}),t.applyFxClick=void 0,ko.bindingHandlers.fxclick={init:(e,t,i,o,n)=>{s(e,t(),n,null)}},t.applyFxClick=s})),
define("MsPortalImpl/Weave/InternalUtil",["require","exports","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/Base/Base.KnockoutExtensions.FxClick","MsPortalImpl/Base/Base.Sanitization"],(function(e,t,s,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.matchKeyCode=t.sanitizeSrc=t.sanitizeHref=t.applyFxClickToElement=t.makeHtmlDataHandler=void 0,t.makeHtmlDataHandler=function(t,i,o){return n=>n?n.skipSanitization&&o?n.content:i.get(s.KODeniedTemplateSanitizer).sanitize({contextData:{moduleName:n.moduleName},diContainer:i,localRequire:e,value:n.content,windowContext:t}).sanitizedMarkup:""},t.applyFxClickToElement=function(e,t,s,o){(0,i.applyFxClick)(e,s,{$dicontainer:o.diContainer,$disabled:o.disabled,$tabIndex:o.tabIndex},t)},t.sanitizeHref=function(e,t){const s=(0,o.sanitizeLinkUri)(e,t);return!1===s?{valid:!1}:{valid:!0,value:s}},t.sanitizeSrc=function(e){return(0,o.validateUriOrBlank)(e)||(0,o.validateDataImage)(e)?{valid:!0,value:e}:{valid:!1}},t.matchKeyCode=function(e,t){return!0===e||Array.isArray(e)&&e.indexOf(t)>=0}})),
define("MsPortalImpl/Weave/SandboxDomAgents/EntryPoint",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.attachSandboxDomAgent=void 0,t.attachSandboxDomAgent=function(e,t,s,o){MsPortalFx.tryImmediateResolve(i[o.type](),(i=>{t.isDisposed()||i.attachDomAgent(e,t,s,o.options)}))};const s=e=>Q(MsPortalFx.require(e)),i={tab:()=>s("MsPortalImpl/Weave/SandboxDomAgents/Tab"),splitter:()=>s("MsPortalImpl/Weave/SandboxDomAgents/Splitter"),button:()=>s("MsPortalImpl/Weave/SandboxDomAgents/Button")}})),
define("MsPortalImpl/Weave/Util",["require","exports","Weave/DirectMode","Weave","Weave/Core/Computation","FxInternal/Weave/Util","FxInternal/Weave","Weave/Core/InternalUtil","FxInternal/WeaveControls/Common"],(function(e,t,s,i,o,n,r,a,l){"use strict";function d(e,t,s){return(e.koContext?e.koContext.createChildContext(s):new ko.bindingContext(s)).extend({$disabled:(0,r.toObservable)(t,e.disabled),$tabIndex:(0,r.toObservable)(t,e.tabIndex),$index:(0,r.toObservable)(t,e.indexInLoop),$dicontainer:e.diContainer,$partName:e.partName,$extensionName:e.extensionName})}Object.defineProperty(t,"__esModule",{value:!0}),t.createFragment=t.weaveContextToKoContext=t.createControlLazyComponentForKO=t.createControlLazyComponent=t.aggregateContext=t.createControlComponentForKO=t.createControlComponentNoUIState=t.createControlComponent=t.wrapFnWaitForChangePropagation=t.isTsxElemId=t.mapWhiteSpaceToUndefined=t.tryFocusAfterChangePropagation=void 0,t.tryFocusAfterChangePropagation=function(e){const t=document.activeElement;t!==e&&(0,o.invokeAfterChangePropagation)((()=>{t!==document.activeElement&&document.activeElement!==document.body||e.focus()}))},t.mapWhiteSpaceToUndefined=function(e){return(e||"").trim()||void 0},t.isTsxElemId=function(e){return 0===(e||"").indexOf("_weave_e_")},t.wrapFnWaitForChangePropagation=function(e,t){let s=!1;return()=>{s&&t||(s=!0,(0,o.invokeAfterChangePropagation)((()=>{s=!1,e()})))}},t.createControlComponent=function(e){return t=>s(i.GetContext,{fn:o=>((0,l.patchFieldControlVM)(o,t.vm),(0,l.tryWrapAggregationSourceForFieldControlVM)(t.vm,s(i.LifetimeManagerScoped,{fn:()=>{const s=new e.widgetUIStateCtor({diContainer:o.diContainer,vm:t.vm}),i=e.innerComponent({vm:t.vm,state:s}),r=t.afterMount;return(0,n.isWeaveNodeWithParentRenderInfo)(i)?(0,a.WeaveTsx)(t.tagName||"div",Object.assign(Object.assign({},t),{afterMount:l,className:[i.parentClassName,t.className],vm:void 0,tagName:void 0}),i.weaveNode):(0,a.WeaveTsx)(t.tagName||"div",Object.assign(Object.assign({},t),{afterMount:l,vm:void 0,tagName:void 0}),i);function l(i,n){n.registerForDispose(new e.widgetCtor($(i),t.vm,{weaveContext:o,diContainer:o.diContainer},s)),r&&r(i,n)}}})))})},t.createControlComponentNoUIState=function(e){return t=>s(i.GetContext,{fn:s=>{(0,l.patchFieldControlVM)(s,t.vm);const i=t.afterMount;return(0,l.tryWrapAggregationSourceForFieldControlVM)(t.vm,(0,a.WeaveTsx)(t.tagName||"div",Object.assign(Object.assign({},t),{afterMount:(o,n)=>{n.registerForDispose(new e.widgetCtor($(o),t.vm,{weaveContext:s,diContainer:s.diContainer})),i&&i(o,n)},vm:void 0,tagName:void 0}),e.innerComponent({vm:t.vm})))}})},t.createControlComponentForKO=function(e){return t=>s(i.GetContext,{fn:s=>{(0,l.patchFieldControlVM)(s,t.vm);const i=t.afterMount;return(0,l.tryWrapAggregationSourceForFieldControlVM)(t.vm,(0,a.WeaveTsx)(t.tagName||"div",Object.assign(Object.assign({},t),{afterMount:(o,n)=>{n.registerForDispose(new e.widgetCtor($(o),t.vm,{bindingContext:d(s,n,{}),diContainer:s.diContainer})),i&&i(o,n)},vm:void 0,tagName:void 0})))}})},t.aggregateContext=function(e,t,s){const i=(0,r.toComputation)(t.disabled);return{disabled:(0,n.aggregateDisabled)([e.disabled,s&&(0,r.toComputation)(s.disabled),i]),tabIndex:(0,n.aggregateTabindex)([e.tabIndex,s&&(0,r.toComputation)(s.tabIndex)],i)}},t.createControlLazyComponent=function(e){return t=>s(i.GetContext,{fn:o=>{(0,l.patchFieldControlVM)(o,t.vm);const r=MsPortalFx.tryImmediateResolve(e(),(e=>s(i.LifetimeManagerScoped,{fn:()=>{const s=new e.WidgetUIState({diContainer:o.diContainer,vm:t.vm}),i=e.InnerTsxComponent({vm:t.vm,state:s}),r=t.afterMount;return(0,n.isWeaveNodeWithParentRenderInfo)(i)?(0,a.WeaveTsx)(t.tagName||"div",Object.assign(Object.assign({},t),{afterMount:l,className:[i.parentClassName,t.className],vm:void 0,tagName:void 0}),i.weaveNode):(0,a.WeaveTsx)(t.tagName||"div",Object.assign(Object.assign({},t),{afterMount:l,vm:void 0,tagName:void 0}),i);function l(i,n){n.registerForDispose(new e.Widget($(i),t.vm,{weaveContext:o,diContainer:o.diContainer},s)),r&&r(i,n)}}})));return(0,l.tryWrapAggregationSourceForFieldControlVM)(t.vm,s(i.PromiseFragment,{promise:r}))}})},t.createControlLazyComponentForKO=function(e){return t=>s(i.GetContext,{fn:o=>{const n=MsPortalFx.tryImmediateResolve(e(),(e=>{const s=t.afterMount,i=t.vm,n="function"==typeof i?i(e):i;(0,l.patchFieldControlVM)(o,n);return(0,l.tryWrapAggregationSourceForFieldControlVM)(n,(0,a.WeaveTsx)(t.tagName||"div",Object.assign(Object.assign({},t),{afterMount:(t,i)=>{i.registerForDispose(new e.Widget($(t),n,{bindingContext:d(o,i,{}),diContainer:o.diContainer})),s&&s(t,i)},vm:void 0,tagName:void 0})))}));return s(i.PromiseFragment,{"data-odebug":"p2",promise:n})}})},t.weaveContextToKoContext=d,t.createFragment=function(e){return s(i.Fragment,null,e)}})),
define("Viva.Controls/Util/Viva.Resize",["require","exports","MsPortalImpl/Base/Base.Timers"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.track=void 0;const i=MsPortalFx.Base.Diagnostics.createLog(e),o="fxs-vivaresize",n=new Map,r=(null===window||void 0===window?void 0:window.ResizeObserver)?new window.ResizeObserver(((e,t)=>{for(const t of e){const e=t.target,s=n.get(e);if(s){const{lifetime:e,handler:i,ignoreInitialState:o,inited:n}=s;if(i&&!e.isDisposed())if(o&&!n)s.inited=!0;else{const e=t.contentRect,i=Math.round(e.width),o=Math.round(e.height);s.handler(i,o)}}}})):null;function a(e){let t;return e&&e.endsWith("px")&&(t=parseFloat(e)),t||0}function l(e){const t=function(e){const t=getComputedStyle($(e)[0],null),s="border-box"===t.boxSizing;let i=a(t.width);i&&s&&(i-=a(t.paddingLeft),i-=a(t.paddingRight));let o=a(t.height);return o&&s&&(o-=a(t.paddingTop),o-=a(t.paddingBottom)),{width:i,height:o}}(e);return{width:Math.round(t.width),height:Math.round(t.height)}}window&&!r&&i.error("ResizeObserver not supported by browser. UI will not be responsive to resizing in some cases."),t.track=function(e,t,i,a){if(e&&!e.isDisposed()&&r){if(1!==t.length)throw new Error(`Viva.Resize.track can only take a element with length of 1. Current element.length: ${t.length}`);const d=t[0];if(n.has(d))throw new Error("Viva.Resize.track already registered for this element.");t.addClass(o),e.registerForDispose((()=>{t.removeClass(o)}));let c=0,p=0;const u=(t,s)=>{e.isDisposed()||!s&&!t||s===c&&t===p||(c=s,p=t,i(t,s))},m=s.debounce(e,((e,t)=>{s.requestAnimationFrame((()=>{u(e,t)}))}),100),g=a&&a.ignoreInitialState,h={lifetime:e,handler:m,ignoreInitialState:g};n.set(d,h),r.observe(d),e.registerForDispose((()=>{r.unobserve(d),n.delete(d)}));if(a&&a.notifyInitialSize){const{width:e,height:t}=l(d);u(e,t)}}}})),
define("WeaveDOM/Core/InternalUtil",["require","exports"],(function(e,t){"use strict";function s(e){return document.createRange().createContextualFragment(e)}function i(e){for(var t,s=[],i=20;i>0&&e;i--)8===e.nodeType?s.push(e.nodeValue||""):s.push((null===(t=e.classList)||void 0===t?void 0:t.value)||""),e=e.parentNode;return s.join(":")}function o(e,t){return e.nodeType===t}function n(e,t){o(e,1)&&o(t,1)?e.insertAdjacentElement("beforebegin",t):e.before?e.before(t):e.parentNode.insertBefore(t,e)}function r(e,t){return e.getElementById?e.getElementById(t):e.querySelector("#"+t)}function a(e,t){for(var s=e.childNodes,i=0;i<s.length;++i){var n=s[i];o(n,8)&&t.set(n.textContent,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.isCommentEndId=t.isCommentStartId=t.getUniqueCommentIdPair=t.wrapFunc=t.removeAllChildren=t.performanceNow=t.attachEventListener=t.ensureNoContent=t.collectCommentNodes=t.getElementByIdInDocumentFragment=t.insertNodeBeforeNode=t.insertHtmlBeforeNode=t.isNodeType=t.removeNodesBetween=t.removeNode=t.toggleClass=t.documentFragmentFromHtml=void 0,t.documentFragmentFromHtml=s,t.toggleClass=function(e,t,s){for(var i=0,o=(t||"").split(" ");i<o.length;i++){var n=o[i];n&&(s?e.classList.add(n):e.classList.remove(n))}},t.removeNode=function(e){e.remove?e.remove():e.parentNode.removeChild(e)},t.removeNodesBetween=function(e,t,s){if(void 0===s&&(s=""),!(e&&t&&e!==t&&e.parentNode===t.parentNode&&e.nextSibling&&t.previousSibling))throw new Error("removeNodesBetween argument error. "+'odebug="'.concat(s,'" ')+'startClasses="'.concat(i(e),'" endClasses="').concat(i(t),'" ')+'!start="'.concat(!e,'" !end="').concat(!t,'" (start===end)="').concat(e===t,'" ')+'!start?.parentNode="'.concat(!(null==e?void 0:e.parentNode),'" ')+'(start?.parentNode!==end?.parentNode)="'.concat((null==e?void 0:e.parentNode)!==(null==t?void 0:t.parentNode),'" ')+'(!start?.nextSibling)="'.concat(!(null==e?void 0:e.nextSibling),'" (!end?.previousSibling)="').concat(!(null==t?void 0:t.previousSibling),'"'));var o=document.createRange();o.setStartAfter(e),o.setEndBefore(t),o.deleteContents()},t.isNodeType=o,t.insertHtmlBeforeNode=function(e,t){o(e,1)?e.insertAdjacentHTML("beforebegin",t):n(e,s(t))},t.insertNodeBeforeNode=n,t.getElementByIdInDocumentFragment=r,t.collectCommentNodes=function(e,t){for(var s=new Map,i=0,o=e;i<o.length;i++){a(r(t,o[i]),s)}return a(t,s),s},t.ensureNoContent=function(e,t,s,i){if(!s&&t.commentStart.nextSibling!==t.commentEnd)throw new Error("Node is not empty, operation invalid.");e.ensureContentDisposed(t,i)},t.attachEventListener=function(e,t,s,i){e.addEventListener(s,i),t.registerForDispose((function(){return e.removeEventListener(s,i)}))},t.performanceNow=function(){return window.performance.now()},t.removeAllChildren=function(e){for(;e.lastChild;)e.removeChild(e.lastChild)},t.wrapFunc=function(e,t,s){return function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];for(var n=0,r=t;n<r.length;n++){var a=r[n];a.call(this)}var l=e.apply(this,i);if(s)for(var d=0,c=s;d<c.length;d++){var p=c[d];p.call(this)}return l}};var l=0;function d(e,t){return e.startsWith?e.startsWith(t):0===e.indexOf(t)}t.getUniqueCommentIdPair=function(){var e=""+l++;return{commentStartId:"_weave_cstart_"+e,commentEndId:"_weave_cend_"+e}},t.isCommentStartId=function(e){return d(e,"_weave_cstart_")},t.isCommentEndId=function(e){return d(e,"_weave_cend_")}})),
define("WeaveDOM/Core/DefaultInputBindings",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultInputBindings=void 0;t.defaultInputBindings=[{name:"textInput",metadata:{eventsToListen:["input","change"],writeValueToElement:function(e,t){var s=e;t=""+(t||""),s.value!==t&&(s.value=t)},collectDataFromEvent:function(e){return{value:e.target.value}}}},{name:"checkboxInput",metadata:{eventsToListen:["change"],writeValueToElement:function(e,t){var s=e;t=!!t,s.checked!==t&&(s.checked=t)},collectDataFromEvent:function(e){return{checked:e.target.checked}}}}]})),
define("WeaveDOM/Core/Sanitization",["require","exports"],(function(e,t){"use strict";function s(e){for(var t=new Set,s=0,i=e;s<i.length;s++){var o=i[s];t.add(o)}return t}Object.defineProperty(t,"__esModule",{value:!0}),t.sanitizeAttributeValue=t.ensureAllowedAttribute=t.ensureNotClass=t.validateTagNameInDirectMode=t.validateTagNameInSandboxMode=t.isSelfCloseTag=t.arrayToSet=void 0,t.arrayToSet=s,t.isSelfCloseTag=function(e){return"img"===e||"input"===e||"area"===e||"br"===e||"col"===e||"hr"===e||"source"===e||"track"===e||"wbr"===e},t.validateTagNameInSandboxMode=function(e){return n.has(e)},t.validateTagNameInDirectMode=function(e){return r.has(e)},t.ensureNotClass=function(e){if("class"===e)throw new Error("class attribute not supported.")},t.ensureAllowedAttribute=function(e,t){if(!function(e,t){switch(e){case"a":return p.has(t);case"area":return u.has(t);case"audio":return g.has(t);case"button":return h.has(t);case"blockquote":return f.has(t);case"canvas":return x.has(t);case"col":case"colgroup":return b.has(t);case"del":return v.has(t);case"details":case"dialog":return I.has(t);case"embed":return y.has(t);case"form":return M.has(t);case"input":return d.has(t);case"img":return P.has(t);case"ins":return w.has(t);case"iframe":return C.has(t);case"label":return _.has(t);case"map":return S.has(t);case"meter":return F.has(t);case"ol":return k.has(t);case"optgroup":return T.has(t);case"option":return D.has(t);case"output":return E.has(t);case"progress":return B.has(t);case"q":return A.has(t);case"source":return N.has(t);case"td":return O.has(t);case"textarea":return R.has(t);case"th":return L.has(t);case"time":return z.has(t);case"track":return H.has(t);case"video":return U.has(t);default:return l.has(t)}}(e,t))throw new Error("Attribute ".concat(t," is not allowed for tag ").concat(e,"."))},t.sanitizeAttributeValue=function(e,t,s){if(s)switch(e){case"src":if(s.src)return s.src(t);break;case"href":if(s.href)return s.href(t)}return{valid:!0,value:t}};var i=["a","abbr","address","area","article","aside","audio","b","bdi","bdo","blockquote","br","button","canvas","caption","cite","code","col","colgroup","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","header","hgroup","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","label","legend","li","main","map","mark","meter","nav","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","source","small","span","strong","sub","summary","sup","table","tbody","textarea","td","tfoot","th","thead","time","tr","track","u","ul","var","video","wbr"],o=i.concat(["iframe","svg","template"]),n=s(i),r=s(o),a=["aria-atomic","aria-autocomplete","aria-checked","aria-controls","aria-current","aria-describedby","aria-disabled","aria-expanded","aria-grabbed","aria-haspopup","aria-hidden","aria-invalid","aria-label","aria-labelledby","aria-level","aria-live","aria-multiline","aria-owns","aria-orientation","aria-posinset","aria-pressed","aria-readonly","aria-required","aria-selected","aria-setsize","aria-valuemin","aria-valuemax","aria-valuenow","class","data-click-telemetry","datetime","dir","draggable","focusable","hidden","id","lang","spellcheck","role","style","tabindex","title","translate"],l=s(a),d=s(a.concat(["accept","autocomplete","autofocus","capture","disabled","form","list","max","maxlength","min","minlength","multiple","name","pattern","placeholder","readonly","required","size","step","type","value"])),c=a.concat(["download","href","hreflang","media","rel","target","type"]),p=s(c),u=s(c.concat("alt","coords","shape")),m=a.concat(["autoplay","controls","crossorigin","loop","muted","preload","src"]),g=s(m),h=s(a.concat("autofocus","disabled","form","formaction","formenctype","formmethod","formnovalidate","formtarget","name","type")),f=s(a.concat("cite")),x=s(a.concat("width","height")),b=s(a.concat("span")),v=s(a.concat("cite","datetime")),y=s(a.concat("height","src","width","type")),M=s(a.concat("accept-charset","action","autocomplete","enctype","method","name","novalidate","target")),I=s(a.concat("open")),C=s(a.concat("height","name","sandbox","scrolling","seamless","src","srcdoc","width")),P=s(a.concat("alt","crossorigin","height","ismap","src","width")),w=s(a.concat("cite","datetime")),_=s(a.concat("for","form")),S=s(a.concat("name")),F=s(a.concat("form","high","low","max","min","optimum","value")),k=s(a.concat("reversed","type","start")),T=s(a.concat("label","disabled")),D=s(a.concat("disabled","label","selected","value")),E=s(a.concat("for","form","name")),B=s(a.concat("max","value")),A=s(a.concat("cite")),N=s(a.concat("src","media","type")),O=s(a.concat("colspan","headers","rowspan")),R=s(a.concat("autofocus","cols","disabled","form","maxlength","minlength","name","placeholder","readonly","required","rows","wrap")),L=s(a.concat("abbr","colspan","headers","rowspan","scope")),z=s(a.concat("datetime")),H=s(a.concat("default","kind","label","src","srclang")),U=s(m.concat("height","poster","width"))})),
define("WeaveDOM/Core/DomOperatorBase",["require","exports","WeaveDOM/Core/InternalUtil","WeaveDOM/Core/Sanitization","Weave/Core/InputBindings","Weave/Core/InternalUtil","WeaveDOM/Core/DefaultInputBindings"],(function(e,t,s,i,o,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DirectDomAgent=void 0;var a=document.createElement("style");a.textContent=".".concat("weave-display-none1",",.").concat("weave-display-none2","{display:none !important}"),document.head.appendChild(a);var l=function(){function e(){this.inputBindingsMgr=new o.InputBindingsManager,this._textHiddenContentMap=new WeakMap,this._dynamicNodeDisplayStateMap=new WeakMap,this._inputBindingDefMap=(0,n.makeMap)(r.defaultInputBindings,(function(e){return e.name}),(function(e){return e.metadata}))}return e.prototype.prepareInitInputBinding=function(e,t){return this.inputBindingsMgr.ensureNoInputBindingExists(e,t),this.ensureInputBindingMetadata(t)},e.prototype.ensureInputBindingMetadata=function(e){var t=this._inputBindingDefMap.get(e);if(!t)throw new Error('Input binding "'.concat(e,'" is not defined.'));return t},e.prototype.setAttribute=function(e,t,s,o,n){var r=e.getAndEnsureElementNode(s).element;if(0!==o.indexOf("data-")){(0,i.ensureAllowedAttribute)(r.tagName.toLowerCase(),o);var a=(0,i.sanitizeAttributeValue)(o,n,t);if(!a.valid)throw new Error("Invalid attribute value for ".concat(o,": ").concat(n));n=a.value,(0,i.ensureNotClass)(o)}r.setAttribute(o,n)},e.prototype.removeAttribute=function(e,t,s){var o=e.getAndEnsureElementNode(t).element;0!==s.indexOf("data-")&&((0,i.ensureAllowedAttribute)(o.tagName.toLowerCase(),s),(0,i.ensureNotClass)(s)),o.removeAttribute(s)},e.prototype.toggleClass=function(e,t,i,o){var n=e.getAndEnsureElementNode(t).element;(0,s.toggleClass)(n,i,o)},e.prototype.setStyle=function(e,t,s,i){e.getAndEnsureElementNode(t).element.style[s]=i||""},e.prototype.clear=function(e,t){(0,s.removeNodesBetween)(e.commentStart,e.commentEnd,t)},e.prototype.remove=function(e,t){this.clear(e,t),(0,s.removeNode)(e.commentStart),(0,s.removeNode)(e.commentEnd)},e.prototype.toggleDisplay=function(e,t,s){var i=e.getAndEnsureDynamicNode(t);if("if"!==i.type)throw new Error('Only If node supports "toggleDisplay", '.concat(t,", ").concat(i.type));s=!!s;var o=this._getOrCreateDynamicNodeDisplayState(i.commentStart,!1);if(o.visible!==s){o.visible=s;var n=s?-1:1;this._applyDisplayState(n,d(o,n),i.commentStart.nextSibling,i.commentEnd)}},e.prototype.setDisplayState=function(e,t){var s=this._dynamicNodeDisplayStateMap.get(e);s&&0!==s.hideCount&&this._applyDisplayState(s.hideCount,3,t.firstChild,null)},e.prototype._applyDisplayState=function(e,t,i,o){if(null!==i)for(var n=[t],r=0,a=i;a!==o;){if((0,s.isNodeType)(a,8))(0,s.isCommentStartId)(a.textContent)?n[++r]=d(this._getOrCreateDynamicNodeDisplayState(a,e<0),e):(0,s.isCommentEndId)(a.textContent)&&r--;else if((0,s.isNodeType)(a,1)){1!==(l=n[r])&&(0,s.toggleClass)(a,"weave-display-none2",3===l)}else if((0,s.isNodeType)(a,3)){var l;2===(l=n[r])?a.textContent=this._textHiddenContentMap.get(a):3===l&&(this._textHiddenContentMap.set(a,a.textContent),a.textContent="")}a=a.nextSibling}},e.prototype._getOrCreateDynamicNodeDisplayState=function(e,t){var s=this._dynamicNodeDisplayStateMap.get(e);if(!s){if(t)throw new Error("DynamicNodeDisplayState doesn't exist, ".concat(e.textContent));this._dynamicNodeDisplayStateMap.set(e,s={visible:!0,hideCount:0})}return s},e}();function d(e,t){e.hideCount+=t;var s=t>0;return s||0!==e.hideCount?s&&e.hideCount===t?3:1:2}t.DirectDomAgent=l})),
define("WeaveDOM/DirectRender/AttributeHandler",["require","exports","Weave/Core/InternalUtil"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onChangeHandler=t.onWheelHandler=t.onTouchStartHandler=t.onTouchMoveHandler=t.onTouchEndHandler=t.onTouchCancelHandler=t.onSelectHandler=t.onScrollHandler=t.onMouseUpHandler=t.onMouseOverHandler=t.onMouseOutHandler=t.onMouseMoveHandler=t.onMouseDownHandler=t.onFocusHandler=t.onDropHandler=t.onDragStartHandler=t.onDragOverHandler=t.onDragLeaveHandler=t.onDragExitHandler=t.onDragEnterHandler=t.onDragEndHandler=t.onDragHandler=t.onDoubleClickHandler=t.onBlurHandler=t.afterMountHandler=void 0,t.afterMountHandler=function(e,t){(0,s.isNotNullNorUndefined)(t)&&e.addDeferredBinding({handler:o,value:t})},t.onBlurHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("blur")),t.onDoubleClickHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("dblclick")),t.onDragHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("drag")),t.onDragEndHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("dragend")),t.onDragEnterHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("dragenter")),t.onDragExitHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("dragexit")),t.onDragLeaveHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("dragleave")),t.onDragOverHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("dragover")),t.onDragStartHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("dragstart")),t.onDropHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("drop")),t.onFocusHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("focus")),t.onMouseDownHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("mousedown")),t.onMouseMoveHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("mousemove")),t.onMouseOutHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("mouseout")),t.onMouseOverHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("mouseover")),t.onMouseUpHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("mouseup")),t.onScrollHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("scroll")),t.onSelectHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("select")),t.onTouchCancelHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("touchcancel")),t.onTouchEndHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("touchend")),t.onTouchMoveHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("touchmove")),t.onTouchStartHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("touchstart")),t.onWheelHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("wheel")),t.onChangeHandler=function(e,t,s,o,n,r){var a=n.type;"input"===r&&"file"===a&&e.addBinding({handler:i,value:t})};var i=(0,s.makeEventHandler)("change");function o(e,t,s){var i=e.getElementMetadata(t);s(i.element,i.ltm.innerLtmRoot)}})),
define("WeaveDOM/DirectRender/Common",["require","exports","WeaveDOM/Core/InternalUtil","Weave/Core/InternalUtil"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createHTMLNode=t.createTextNode=t.markParentActive=t.markInactive=t.markAttributeSealed=t.markSealed=t.ensureActive=t.ensureNotAttributeSealed=t.ensureNotSealed=void 0;t.createTextNode=function(e){return this.collectors.htmlCollector.push((0,i.encodeHtml)(e)),this};t.createHTMLNode=function(e){return this.collectors.htmlCollector.push(this.getHtmlString(e)),this}})),
define("WeaveDOM/DirectRender/DataAttribute",["require","exports","Weave/Core/InternalUtil"],(function(e,t,s){"use strict";function i(e){return o.get(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.dataHandler=t.getElementData=void 0,t.getElementData=i,t.dataHandler=(0,s.generateBindOnlyAttributeHandler)((function(e,t,s){o.set(e.getElementMetadata(t).element,s)}));var o=new WeakMap;(window.weaveDebug||(window.weaveDebug={})).getElementData=i})),
define("WeaveDOM/DirectRender/ForEachNodeOperations",["require","exports","WeaveDOM/Core/InternalUtil"],(function(e,t,s){"use strict";function i(e,t,o,n,r,a,l,d){if(o>=0){var c=r[o];return a(c)?function(e,t,s,o,n,r,a,l){var d=s;for(;s>=0&&r(n[s]);)--s;if(s!==d){for(var c=d-s,p=t(n.slice(s+1,d+1),o),u=0;u<c;++u)a[u+s+1]=p[u];l.created+=c}return i(e,t,s,o,n,r,a,l)}(e,t,o,n,r,a,l,d):e(c).commentEnd===n?function(e,t,s,o,n,r,a,l){var d=s;for(;s>=0;){var c=n[s];if(!r(c)){var p=e(c);if(p.commentEnd===o){o=p.commentStart.previousSibling,--s;continue}}break}return l.skipped+=d-s,i(e,t,s,o,n,r,a,l)}(e,t,o,n,r,a,l,d):function(e,t,o,n,r,a,l,d){var c=o;for(;o>=0&&!a(r[o])&&e(r[o]).commentEnd!==n;)--o;if(o!==c){for(var p=document.createDocumentFragment(),u=o+1;u<=c;++u)for(var m=e(r[u]),g=m.commentStart,h=m.commentEnd.nextSibling;g!==h;){var f=g.nextSibling;p.appendChild(g),g=f}(0,s.insertNodeBeforeNode)(n.nextSibling,p),d.moved+=c-o}return i(e,t,o,n,r,a,l,d)}(e,t,o,n,r,a,l,d)}return n.nextSibling}Object.defineProperty(t,"__esModule",{value:!0}),t.processForEachItems=void 0,t.processForEachItems=function(e,t,o,n,r,a,l){var d=n.map((function(e){return r(e)?null:a(e)})),c=document.activeElement,p=i(e,t,n.length-1,o.commentEnd.previousSibling,n,r,d,l);return(0,s.removeNodesBetween)(o.commentStart,p),document.activeElement!==c&&c.focus(),d}})),
define("WeaveDOM/DirectRender/NodeEditors",["require","exports","WeaveDOM/DirectRender/Common","WeaveDOM/Core/InternalUtil","WeaveDOM/Core/Sanitization","Weave/Core/InternalUtil","Weave/Core/WeaveUtil"],(function(e,t,s,i,o,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createChildElementNode=t.createChildDynamicNode=t.ignoreDebugInfo=void 0;var a=function(e){this.state|=8;var t=(0,n.getUniqueDynamicNodeId)(),o=(0,i.getUniqueCommentIdPair)(),c=o.commentStartId,p=o.commentEndId,u=(0,n.createDynamicNodeLtms)(e.type,this.ltm),m=u.selfLtm,g=u.contentLtm;return this.collectors.dynamicBindingCollector.push({commentStartId:c,commentEndId:p,dynamicNodeId:t,initContentLtm:g,metadata:e,selfLtm:m}),this.collectors.htmlCollector.push("\x3c!--",c,"--\x3e"),{attributeSanitizer:this.attributeSanitizer,collectors:this.collectors,commentEndId:p,getHtmlString:this.getHtmlString,ltm:g||m,nodeId:t,nodeType:e.type,parentEditor:this,state:1,createChildDynamicNode:a,createChildElementNode:l,createChildVirtualNode:r.returnThis,createHTMLNode:s.createHTMLNode,createTextNode:s.createTextNode,seal:d}};t.createChildDynamicNode=a;var l=function(e){return this.collectors.htmlCollector.push("<",e),{attributeSanitizer:this.attributeSanitizer,collectors:this.collectors,elementBinders:void 0,elementDeferredBinders:void 0,elementId:"",debugInfo:void 0,getHtmlString:this.getHtmlString,idAttrPlaceHolderIndex:-1,ltm:this.ltm,parentEditor:this,state:1,tagName:e,addAttribute:h,addBinding:f,addDebugInfo:b,addDeferredBinding:x,seal:g,sealAttributes:c}};t.createChildElementNode=l;var d=function(){this.collectors.htmlCollector.push("\x3c!--",this.commentEndId,"--\x3e")},c=function(){var e=this.collectors.htmlCollector;if(this.elementBinders||this.elementDeferredBinders){var t=this.elementId;t||(this.elementId=t=(0,n.getUniqueElementId)(),e.push(' id="',t,'"')),this.collectors.elementBindingCollector.push({elementId:t,binders:this.elementBinders,deferredBinders:this.elementDeferredBinders,ltm:this.ltm})}else this.elementId||(this.idAttrPlaceHolderIndex=e.length,e.push(""));return(0,o.isSelfCloseTag)(this.tagName)?(e.push("/>"),{attributeSanitizer:void 0,collectors:void 0,commentEndId:void 0,getHtmlString:void 0,ltm:void 0,nodeId:void 0,nodeType:void 0,parentEditor:this,state:1,createChildDynamicNode:p,createChildElementNode:p,createChildVirtualNode:r.returnThis,createHTMLNode:p,createTextNode:p,seal:u}):(e.push(">"),{attributeSanitizer:this.attributeSanitizer,collectors:this.collectors,commentEndId:void 0,getHtmlString:this.getHtmlString,ltm:this.ltm,nodeId:void 0,nodeType:void 0,parentEditor:this,state:1,createChildDynamicNode:a,createChildElementNode:l,createChildVirtualNode:r.returnThis,createHTMLNode:s.createHTMLNode,createTextNode:s.createTextNode,seal:m})};function p(){throw new Error("Operation is not supported for self-close element.")}var u=r.noop,m=function(){if(8&this.state){var e=this.parentEditor,t=e.elementId;t||(t=e.elementId=(0,n.getUniqueElementId)(),this.collectors.htmlCollector[e.idAttrPlaceHolderIndex]=' id="'.concat(t,'"')),this.collectors.commentContainerCollector.push(t)}},g=function(){(0,o.isSelfCloseTag)(this.tagName)||this.collectors.htmlCollector.push("</",this.tagName,">")},h=function(e,t){var s=(0,o.sanitizeAttributeValue)(e,t,this.attributeSanitizer);return s.valid?this.collectors.htmlCollector.push(" ",e,'="',(0,n.encodeHtml)(s.value),'"'):console.warn("Invalid attribute value will be ignored: ".concat(e,", ").concat(t)),this},f=function(e){return this.elementBinders?this.elementBinders.push(e):this.elementBinders=[e],this},x=function(e){return this.elementDeferredBinders?this.elementDeferredBinders.push(e):this.elementDeferredBinders=[e],this},b=function(e){throw new Error("addDebugInfo not supported in prod mode.")}})),
define("WeaveDOM/DirectRender/RenderAgent",["require","exports","Weave/Core/RenderAgentBase","WeaveDOM/Core/InternalUtil","WeaveDOM/DirectRender/Common","WeaveDOM/DirectRender/NodeEditors","Weave/Core/ApplyBindings","WeaveDOM/DirectRender/ForEachNodeOperations","WeaveDOM/Core/Sanitization","Weave/Core/CollectRenderInfo","WeaveDOM/DirectRender/AttributeHandler","Weave/Core/InternalUtil","Weave/Core/WeaveUtil","WeaveDOM/Core/DomOperatorBase","WeaveDOM/DirectRender/DataAttribute","Weave/Core/AttributeHandler","Weave/Core/InternalUtil"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DirectModeRenderEngine=void 0;var x=u.noop;var b=function(e){function t(t){var s,o,n,r=this;(r=e.call(this,(o=t,n=(0,f.makeMap)(w.concat(o.customAttributeHandlers||[]),(function(e){return e.name}),(function(e){return e.handler}),!1),function(e,t,s,i,o,r,a){var l=n.get(t);l?l(e,s,i,o,r,a):(0,h.htmlAttributeHandler)(e,t,s,0)}),void 0,t.customEventDataProvider)||this)._options=t,r._domAgent=new m.DirectDomAgent,r._attributeSanitizer=r._options.attributeSanitizer,r._getHtmlString=r._options.htmlElementDataSerializer,r.thisInstance=r;var a,l=(null===(s=null==t?void 0:t.weaveNode)||void 0===s?void 0:s["data-odebug"])||"";return r.render(r._memoryManager.outerLtmRoot,void 0,t.weaveNode,(0,d.createInternalWeaveContext)(__assign({},t.weaveContext)),new p.AggregationRelay(t.aggregators,{}),t.afterMount,(function(e){var t=e.containerDoc;r.applyCssChanges();var s=r._options.rootElement;if("replace"===r._options.renderKind)(0,i.removeAllChildren)(s),s.appendChild(t),a=function(){return(0,i.removeAllChildren)(s)};else{var o=_++,n=document.createComment("tsx_vroot_".concat(o,"_start")),d=document.createComment("tsx_vroot_".concat(o,"_end"));s.appendChild(n),s.appendChild(d),(0,i.insertNodeBeforeNode)(d,t),a=function(){(0,i.removeNodesBetween)(n,d,l),(0,i.removeNode)(n),(0,i.removeNode)(d)}}})),r._cleanup=a,r}return __extends(t,e),t.prototype.buildNodeLookup=function(e){for(var t=e.elementBindings,s=e.dynamicBindings,o=e.containerDoc,n=e.commentLookup,r=0,a=t;r<a.length;r++){var l=a[r];this._memoryManager.setElementNode({nodeId:l.elementId,ltm:l.ltm,element:(0,i.getElementByIdInDocumentFragment)(o,l.elementId)})}for(var d=0,c=s;d<c.length;d++){var p=c[d],u=p.metadata;this._memoryManager.setDynamicNode({nodeId:p.dynamicNodeId,type:u.type,commentStart:n.get(p.commentStartId),commentEnd:n.get(p.commentEndId),contentLtm:p.initContentLtm,selfLtm:p.selfLtm,itemNodesId:"forEach"===u.type?u.initRenderDomInfo.map(y):void 0})}},t.prototype.applyCssChanges=function(){var e=[],t=[];this._cssMetadataMap.forEach((function(s,i){0===s.oldRefCount&&s.newRefCount>0?e.push(i):s.oldRefCount>0&&0===s.oldRefCount&&t.push(i),s.oldRefCount=s.newRefCount})),(e.length||t.length)&&this._options.cssLoader(e,t)},t.prototype.clearVisualState=function(e,t){this._domAgent.clear(e,t)},t.prototype.createCollector=function(e,t){return{attributeSanitizer:this._attributeSanitizer,collectors:{commentContainerCollector:[],dynamicBindingCollector:[],dynamicDebugInfoCollector:undefined,elementBindingCollector:[],elementDebugInfoCollector:undefined,htmlCollector:[]},commentEndId:void 0,getHtmlString:this._getHtmlString,ltm:e,nodeId:void 0,nodeType:void 0,parentEditor:void 0,state:1,createChildDynamicNode:n.createChildDynamicNode,createChildElementNode:n.createChildElementNode,createChildVirtualNode:u.returnThis,createHTMLNode:o.createHTMLNode,createTextNode:o.createTextNode,seal:x}},t.prototype.clearLogicalState=function(e,t,s){(0,i.ensureNoContent)(this._memoryManager,e,s,this._ltmRemovalCallback)},t.prototype.removeVisualState=function(e,t){this._domAgent.remove(e,t)},t.prototype.sealCollector=function(e){e.seal();var t=e.collectors,s=t.htmlCollector.join(""),o=(0,i.documentFragmentFromHtml)(s);return{commentLookup:(0,i.collectCommentNodes)(t.commentContainerCollector,o),containerDoc:o,dynamicBindings:t.dynamicBindingCollector,dynamicDebugInfos:t.dynamicDebugInfoCollector,elementBindings:t.elementBindingCollector,elementDebugInfos:t.elementDebugInfoCollector,ltm:e.ltm}},t.prototype.setContent=function(e,t,s){var o=s.commentStart,n=s.commentEnd;if(o.nextSibling!==n)throw new Error("The next sibling of start node is not end node.");this._domAgent.setDisplayState(o,e.containerDoc),(0,i.insertNodeBeforeNode)(n,e.containerDoc)},t.prototype.setAttribute=function(e,t,s){this._domAgent.setAttribute(this._memoryManager,this._attributeSanitizer,e,t,s)},t.prototype.removeAttribute=function(e,t){this._domAgent.removeAttribute(this._memoryManager,e,t)},t.prototype.toggleClass=function(e,t,s){this._domAgent.toggleClass(this._memoryManager,e,t,s)},t.prototype.setStyle=function(e,t,s){this._domAgent.setStyle(this._memoryManager,e,t,s)},t.prototype.toggleDisplay=function(e,t){this._domAgent.toggleDisplay(this._memoryManager,e.dynamicNodeId,t)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._cleanup()},t.prototype.addEventListener=function(e,t){var s=this,o=t.eventName,n=t.eventHandler;if("input"===o)throw new Error("".concat(o," is not allowed through this API: addEventListener"));var r=this._memoryManager.getAndEnsureElementNode(e),a=r.ltm.innerLtmRoot;(0,i.attachEventListener)(r.element,a,o,(function(e){n(s._makeFullEventData(e,o,a,(0,p.getEventData)(e,o)))}))},t.prototype.setItems=function(e,t,s,i,o){var n=this,r=this._memoryManager.getAndEnsureDynamicNode(e);(0,p.ensureDynamicNodeOperation)(r.type,8);for(var c=r.itemNodesId,u=(0,l.arrayToSet)(c),m=0,g=s;m<g.length;m++){var h=g[m];if("exist"===h.type){var f=h.metadata.itemId;if(!u.delete(f))throw new Error("The ForEachItem node ".concat(f," doesn't exists, state tracking is lost."))}}u.forEach((function(e){n.removeLogicalState(e,t)}));var x={created:0,deleted:0,skipped:0,moved:0},b=(0,a.processForEachItems)((function(e){return n.getDynamicNodeMetadata(e.metadata.itemId)}),(function(e,s){var a=n.createCollector(r.selfLtm,t),l=(0,d.collectForEachItemsRenderInfo)({aggregators:o.aggregators,attributesHandler:n._handleAttribute,cssMetadataMap:n._cssMetadataMap,hooksState:void 0},t,a,e.map(M),i,o),c=n.sealCollector(a);return n.applyCssChanges(),n._domAgent.setDisplayState(r.commentStart,c.containerDoc),n._renderBetweenNodes(c,s,s.nextSibling),l}),r,s,I,C,x);return x.deleted=c.length-(b.length-x.created),r.itemNodesId=b.map(P),b},t.prototype.getDynamicNodeMetadata=function(e){return this._memoryManager.getAndEnsureDynamicNode(e)},t.prototype.focus=function(e,t){var s=this._options.rootElement.getElementsByClassName(v(e))[t];s&&document.activeElement!==s&&s.focus()},t.prototype.setLocatorClass=function(e,t){this._domAgent.toggleClass(this._memoryManager,e,v(t),!0)},t.prototype.initTwoWayInputBinding=function(e,t,s){var o=this,n=this._memoryManager.getAndEnsureElementNode(e),r=this._domAgent.prepareInitInputBinding(n,t);this._domAgent.inputBindingsMgr.createInputBinding(n,{type:"twoWay",name:t});for(var a=n.element,l=n.ltm.innerLtmRoot,d=0,c=r.eventsToListen;d<c.length;d++){var p=c[d];(0,i.attachEventListener)(a,l,p,(function(e){r.writeValueToElement(a,s(o._makeFullEventData(e,t,l,r.collectDataFromEvent(e))))}))}},t.prototype.initValuePushInputBinding=function(e,t){var s=this._memoryManager.getAndEnsureElementNode(e),o=this._domAgent.prepareInitInputBinding(s,t),n={type:"valuePush",name:t,lastReceivedValue:void 0};this._domAgent.inputBindingsMgr.createInputBinding(s,n);for(var r=s.element,a=s.ltm.innerLtmRoot,l=0,d=o.eventsToListen;l<d.length;l++){var c=d[l];(0,i.attachEventListener)(r,a,c,(function(){o.writeValueToElement(r,n.lastReceivedValue)}))}},t.prototype.initValueSubscribeInputBinding=function(e,t,s){var o=this,n=this._memoryManager.getAndEnsureElementNode(e),r=this._domAgent.prepareInitInputBinding(n,t);this._domAgent.inputBindingsMgr.createInputBinding(n,{type:"valueSubscribe",name:t});for(var a=n.element,l=n.ltm.innerLtmRoot,d=0,c=r.eventsToListen;d<c.length;d++){var p=c[d];(0,i.attachEventListener)(a,l,p,(function(e){s(o._makeFullEventData(e,t,l,r.collectDataFromEvent(e)))}))}},t.prototype.pushInputValue=function(e,t,s){var i=this._memoryManager.getAndEnsureElementNode(e),o=this._domAgent.inputBindingsMgr.resolveInputBinding(i,t,["twoWay","valuePush"]),n=this._domAgent.ensureInputBindingMetadata(t);"valuePush"===o.type&&(o.lastReceivedValue=s),n.writeValueToElement(i.element,s)},t.prototype._makeFullEventData=function(e,t,s,i){return __assign(__assign(__assign({},i),{event:e,ltm:s}),this._customEventDataProvider(t))},t.prototype._renderBetweenNodes=function(e,t,s){var o=e.containerDoc;if(this.buildNodeLookup(e),t.nextSibling!==s)throw new Error("The next sibling of start node is not end node.");(0,i.insertNodeBeforeNode)(s,o),(0,r.applyBindings)(this,e.elementBindings,e.dynamicBindings)},t}(s.RenderAgentBase);function v(e){return"_wv_locator_".concat(e)}function y(e){return e.itemId}function M(e){return e.weaveNode}function I(e){return"new"===e.type}function C(e){return e.metadata}function P(e){return e.itemId}t.DirectModeRenderEngine=b;var w=[{name:"afterMount",handler:c.afterMountHandler},{name:"autoplay",handler:h.autoplayHandler},{name:"checked",handler:h.checkedHandler},{name:"className",handler:h.classNameHandler},{name:"controls",handler:h.controlsHandler},{name:"coords",handler:h.coordsHandler},{name:"data",handler:g.dataHandler},{name:"disabled",handler:h.disabledHandler},{name:"id",handler:h.idHandler},{name:"loop",handler:h.loopHandler},{name:"muted",handler:h.mutedHandler},{name:"autofocus",handler:h.autofocusHandler},{name:"formnovalidate",handler:h.formnovalidateHandler},{name:"hidden",handler:h.hiddenHandler},{name:"open",handler:h.openHandler},{name:"novalidate",handler:h.novalidateHandler},{name:"seamless",handler:h.seamlessHandler},{name:"ismap",handler:h.ismapHandler},{name:"required",handler:h.requiredHandler},{name:"onBlur",handler:c.onBlurHandler},{name:"onChange",handler:c.onChangeHandler},{name:"onValueChange",handler:h.onValueChangeHandler},{name:"onCheckedChange",handler:h.onCheckedChangeHandler},{name:"onClick",handler:h.onClickHandler},{name:"onDoubleClick",handler:c.onDoubleClickHandler},{name:"onDrag",handler:c.onDragHandler},{name:"onDragEnd",handler:c.onDragEndHandler},{name:"onDragEnter",handler:c.onDragEnterHandler},{name:"onDragExit",handler:c.onDragExitHandler},{name:"onDragLeave",handler:c.onDragLeaveHandler},{name:"onDragOver",handler:c.onDragOverHandler},{name:"onDragStart",handler:c.onDragStartHandler},{name:"onDrop",handler:c.onDropHandler},{name:"onFocus",handler:c.onFocusHandler},{name:"onFocusIn",handler:h.onFocusInHandler},{name:"onFocusOut",handler:h.onFocusOutHandler},{name:"onKeyDown",handler:h.onKeyDownHandler},{name:"onKeyPress",handler:h.onKeyPressHandler},{name:"onKeyUp",handler:h.onKeyUpHandler},{name:"onMouseDown",handler:c.onMouseDownHandler},{name:"onMouseEnter",handler:h.onMouseEnterHandler},{name:"onMouseLeave",handler:h.onMouseLeaveHandler},{name:"onMouseMove",handler:c.onMouseMoveHandler},{name:"onMouseOut",handler:c.onMouseOutHandler},{name:"onMouseOver",handler:c.onMouseOverHandler},{name:"onMouseUp",handler:c.onMouseUpHandler},{name:"onScroll",handler:c.onScrollHandler},{name:"onSelect",handler:c.onSelectHandler},{name:"onTouchCancel",handler:c.onTouchCancelHandler},{name:"onTouchEnd",handler:c.onTouchEndHandler},{name:"onTouchMove",handler:c.onTouchMoveHandler},{name:"onTouchStart",handler:c.onTouchStartHandler},{name:"onWheel",handler:c.onWheelHandler},{name:"readonly",handler:h.readonlyHandler},{name:"ref",handler:h.refHandler},{name:"style",handler:h.styleHandler},{name:"value",handler:h.valueHandler},{name:"visible",handler:h.visibleHandler},{name:"reversed",handler:h.reversedHandler},{name:"default",handler:h.defaultHandler},{name:"multiple",handler:h.multipleHandler}],_=0})),
define("MsPortalImpl/Weave/DirectRender",["require","exports","MsPortalImpl/Weave/Util","MsPortalImpl/Weave/InternalUtil","WeaveDOM/DirectRender/RenderAgent","MsPortalImpl/Base/Base.KnockoutExtensions.Image","Viva.Controls/Util/Viva.Resize","MsPortalImpl/Weave/SandboxDomAgents/EntryPoint","Weave/Core/InternalUtil","FxInternal/Weave/Util","FxInternal/Weave","FxInternal/Weave/Aggregators","FxInternal/Css","MsPortalImpl/Base/Base.Timers","Weave/Core/ClassNameProcessor","WeaveDOM/Core/InternalUtil"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g,h){"use strict";function f(t,s){const{weaveContext:n,element:r,ltm:d}=t,c=new o.DirectModeRenderEngine({afterMount:t.afterMount,aggregators:p.aggregators,attributeSanitizer:{href:t=>(0,i.sanitizeHref)(t,{diContainer:n.diContainer,windowContext:r,localRequire:e}),src:i.sanitizeSrc},cssLoader:t.cssLoader||(e=>(0,u.injectCss)(...e||[])),customAttributeHandlers:[{name:"fxclick",handler:b},{name:"image",handler:x},{name:"onResize",handler:y},{name:"domAgent",handler:(0,l.generateDeferredBindOnlyAttributeHandler)((function(e,t,s){const{element:i,ltm:o}=e.getElementMetadata(t);(0,a.attachSandboxDomAgent)(i,o.innerLtmRoot,n.diContainer,s)}))},{name:"pcControl",handler:I},{name:"onClick",handler:P},w("onKeyDown","keydown"),w("onKeyPress","keypress"),w("onKeyUp","keyup")],customEventDataProvider:()=>({requestConfirm:M}),htmlElementDataSerializer:(0,i.makeHtmlDataHandler)(r,n.diContainer,!0),renderKind:s,rootElement:r,weaveNode:t.weaveNode,weaveContext:n});d.registerForDispose(c)}Object.defineProperty(t,"__esModule",{value:!0}),t.appendToElement=t.applyToElement=void 0,t.applyToElement=function(e){let t=e.weaveNode;return(0,d.isWeaveNodeWithParentRenderInfo)(t)&&(!function(e,t,s){if(!t.isDisposed()&&s.parentClassName){const i=(0,g.processClassName)(s.parentClassName,t);(0,h.toggleClass)(e,i.initClass,!0);const o=(0,g.applyClassBindingMetadata)(i,t,((t,s)=>(0,h.toggleClass)(e,t,s)));t.registerForDispose((()=>{for(const t of o())(0,h.toggleClass)(e,t,!1)}))}}(e.element,e.ltm,t),t=t.weaveNode),f(Object.assign(Object.assign({},e),{weaveNode:t}),"replace")},t.appendToElement=function(e){return f(e,"append")};const x=(0,l.generateDeferredBindOnlyAttributeHandler)((function(e,t,s){const i=e.getElementMetadata(t).element;(0,l.activateAndRun)(e,t,s,(e=>{(0,n.renderImage)(i,e)}))}));function b(e,t,s){MsPortalFx.isNullOrUndefined(t)||e.addBinding({handler:v,value:{data:t,context:s}})}function v(e,t,s){const o=e.getElementMetadata(t),n=o.ltm.innerLtmRoot;(0,i.applyFxClickToElement)(o.element,n,(0,d.valueOrComputationToValueOrObservable)(n,s.data),{diContainer:s.context.diContainer,disabled:(0,c.toObservable)(n,s.context.disabled),tabIndex:(0,c.toObservable)(n,s.context.tabIndex)})}const y=(0,l.generateDeferredBindOnlyAttributeHandler)((function(e,t,s){const i=e.getElementMetadata(t),o=e.getElementNodeLtm(t);(0,m.requestAnimationFrame)((()=>{o.isDisposed()||(0,r.track)(o.createChildLifetime(),$(i.element),((e,t)=>s({ltm:o,height:t,width:e})),{notifyInitialSize:!0})}))}));function M(e){return new Promise((t=>{t(window.confirm(e)?"ok":"cancel")}))}function I(e,t,s){MsPortalFx.isNullOrUndefined(t)||(e.addAttribute("data-bind","pcControl: __control_vm__"),e.addDeferredBinding({handler:C,value:{vm:t,context:s}}))}function C(e,t,i){const{element:o,ltm:n}=e.getElementMetadata(t),{vm:r,context:a}=i,l=(0,s.weaveContextToKoContext)(a,n.innerLtmRoot,{__control_vm__:r});ko.applyBindings(l,o),n.innerLtmRoot.registerForDispose((()=>ko.cleanNode(o)))}const P=(0,l.generateBindOnlyAttributeHandler)((function(e,t,s){const{eventHandler:i,stopPropagation:o,preventDefault:n}="function"==typeof s?{eventHandler:s,stopPropagation:!1,preventDefault:!1}:{eventHandler:s.handler,stopPropagation:s.stopPropagation,preventDefault:s.preventDefault};e.addEventListener(t,{eventName:"click",eventHandler:e=>{o&&e.event.stopPropagation(),n&&e.event.preventDefault(),i(e)}})}));function w(e,t){return{name:e,handler:(0,l.generateBindOnlyAttributeHandler)(((e,s,o)=>{const{eventHandler:n,stopPropagation:r,preventDefault:a}="function"==typeof o?{eventHandler:o,stopPropagation:void 0,preventDefault:void 0}:{eventHandler:o.handler,stopPropagation:o.stopPropagation,preventDefault:o.preventDefault};e.addEventListener(s,{eventName:t,eventHandler:e=>{(0,i.matchKeyCode)(r,e.keyCode)&&e.event.stopPropagation(),(0,i.matchKeyCode)(a,e.keyCode)&&e.event.preventDefault(),n(e)}})}))}}})),
define("_generated/MsPortalImpl/Svg/Startup/Warning.svg",["require","exports"],(function(e,t){"use strict";return{type:9,data:"<svg viewBox='0 0 9 9' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path fill='#db7500' d='M8.267 8H.733c-.6 0-.916-.623-.62-1.129L2.014 3.53 3.896.384c.302-.507.903-.514 1.197-.008L7.001 3.65l1.882 3.229C9.183 7.383 8.881 8 8.267 8z'/><circle cx='4.5' cy='6.178' r='.615' class='msportalfx-svg-c01'/><path d='M4.623 2.428H3.98l.164 2.85h.774l.165-2.85z' class='msportalfx-svg-c01'/></g></svg>"}})),
define("MsPortalImpl/Widgets/Widgets.Common",["require","exports","Fx/DependencyInjection","MsPortalImpl.Controls/Controls/Base/Base","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.SvgHelper","_generated/MsPortalImpl/Svg/Startup/Warning.svg","MsPortalImpl/Weave/DirectRender","FxInternal/Weave","FxInternal/Utils/Promise"],(function(e,t,s,i,o,n,r,a,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCssScope=t.getStringFromHtmlContent=t.isLink=t.isHtmlContent=t.getAsyncBindingHandler=t.cancelBindings=t.waitForBindings=t.registerKoTemplate=t.isElementFullyInViewport=void 0;var c=MsPortalFx.Base.Diagnostics,p=MsPortalFx.Errors;const u=window,m=u.document.implementation.createHTMLDocument(""),g=FxImpl.features.isNativePerf,h="<span class='fxs-portal-controlloadfailed'>"+n.getSvgReferenceOrFallBackToData(r).outerHTML+MsPortalFx.encodeHtml(o.PartError.title)+"</span>",f=c.createLog(e),x=[],b=new Map,v=[];function y(e){const t=MsPortalFx.find(v,(function(t){const s=t.element;return e===s||$.contains(e,s)}));if(t)return t.promise;const s=b.get(e)||MsPortalFx.find(x,(t=>$.contains(e,t.element)));return s?s.promise.then((()=>y(e))):Q()}function M(e){return e&&e.hasOwnProperty("htmlTemplate")}t.isElementFullyInViewport=function(e,t=0,s=!1){const i=e.getBoundingClientRect(),o=document.documentElement;let n=!0;if(!s){const e=u.innerWidth||o.clientWidth;n=i.left>=0&&i.right<=e}const r=u.innerHeight||o.clientHeight;return{elementRect:i,fullyVisible:i.top+t>=0&&i.bottom+t<=r&&n}},t.registerKoTemplate=function(e,t){if(!e||!t)return void f.error(`Cannot register a template with an undefined ${e?"content":"name"}.`);if(!/^[a-z][a-z0-9]*$/i.test(e))return void f.error(`Name '${e}' is invalid. Name must start with a letter and can only contain letters and numbers.`);const s=$(u.document.body);if(s.find("#"+e).length)return void f.error(`A template with name '${e}' was already registered.`);const i=$(FxImpl.createElement("script",{id:e,type:"text/html"})).text(t);s.append(i)},t.waitForBindings=function(e){return e?$.contains(u.document.documentElement,e)?y(e):Q.reject(new MsPortalFx.Errors.CanceledError("container is not in documentElement")):(0,d.QReject)("container is "+e)},t.cancelBindings=function(e){e&&$.contains(u.document.documentElement,e)&&x.filter((t=>{const s=t.element;return e===s||$.contains(e,s)})).forEach((e=>{MsPortalFx.remove(x,e),e&&e.dispose()}))},t.getAsyncBindingHandler=function(e,t){return t=t||{controlsDescendantBindings:!0},{init:function(e,s,i,o,n){return t},update:function(t,o,n,r,d){const c=ko.unwrap(o());ko.ignoreDependencies((()=>{let o;const n=Q(MsPortalFx.tryImmediateResolve(MsPortalFx.require(e),(n=>{if(!o)return function(e,t,o,n,r){const d=$(o),c=i.getWidget(d);if(null!==c&&c.dispose(),n){let i;g&&(i=MsPortalFx.getUniqueId(),u.performance.mark(`${i}_start`));const c=e.$dicontainer||s.container,p=t.WidgetUIState&&new t.WidgetUIState({diContainer:c,vm:n,sanitizationContext:o});let m,h;if(t.InnerTsxComponent||t.tryWeaveInnerContent){let s;t.InnerTsxComponent?(m=new FxImpl.TriggerableLifetimeManager,s=t.InnerTsxComponent({state:p,vm:n})):(s=t.tryWeaveInnerContent({state:p,vm:n}),void 0!==s&&(m=new FxImpl.TriggerableLifetimeManager));const i=(0,l.toComputation)(e.$disabled),u=(0,l.toComputation)(e.$enabledTabIndex),g=(0,l.toComputation)(e.$tabIndex);m&&(0,a.applyToElement)({element:o,ltm:m,weaveNode:s,weaveContext:{disabled:i,tabIndex:g,diContainer:c,partName:e.$partName,extensionName:e.$extensionName,koContext:e},opName:`control_${r}`,afterMount:t.Widget?()=>{h=new t.Widget(d,n,{weaveContext:{disabled:i,enabledTabIndex:u,tabIndex:g,diContainer:c},diContainer:c},p),h.ltm.registerForDispose(m)}:void 0})}if(!h&&t.Widget&&(h=new t.Widget(d,n,{bindingContext:e,diContainer:c},p)),g&&(u.performance.mark(`${i}_end`),u.performance.measure(r,`${i}_start`,`${i}_end`)),h){const e=h;if(e.awaitContentRevealed)return e.awaitContentRevealed()}}}(d,n,t,c,e)}),(s=>{if(!o&&!MsPortalFx.Errors.isInstanceOfErrorType(s,p.CanceledError))return function(e,t,s){if(p.isInstanceOfErrorType(e,p.CanceledError))return;let i,o;e&&(i=e.message||MsPortalFx.getLogFriendlyMessage(e),o=e.stack);let n=`Failed to load the control module '${s}'.`;i&&(n+=`\r\n Error: ${i}`),f.error(n,1);const r=$(t);r.html(h),Q.nextTick((()=>{r.trigger("fxportalcontrolloadfailed",new MsPortalFx.Errors.Error({message:n,stack:o,innerErrors:e,data:e&&e.data}))}))}(s,t,e),Q.reject(s)})));if(!Q.isFulfilled(n)){const e=()=>{MsPortalFx.remove(x,i,-1),b.delete(t),o&&MsPortalFx.remove(v,i,-1)},s=()=>{o=!0,e()};ko.utils.domNodeDisposal.addDisposeCallback(t,s);const i={element:t,promise:n,dispose:s};Q.isPending(n)&&(x.push(i),b.set(t,i)),i.promise=n.catch((e=>(v.push(i),Q.reject(e)))).finally(e)}}))}}},t.isHtmlContent=M,t.isLink=function(e){return!!e&&e.hasOwnProperty("uri")},t.getStringFromHtmlContent=function(e,t,s){let i,o="";return M(t)?i=t.htmlTemplate:o=t,i&&(o=$($.parseHTML(i,m)).text()),o},t.getCssScope=function(e){const t=e.closest(".fxs-part-content");return t[0]?t[0].className.split(" ").filter((e=>e&&e.startsWith("css-scope-"))).join(" "):""}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.AvatarMenu.css",["module"],(function(e){"use strict";return{css:'.fxs-avatarmenu{flex:0 0 auto;box-sizing:border-box}.fxs-avatarmenu-header{position:relative;display:flex;align-items:center;height:40px}.fxs-avatarmenu-username{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:14px;line-height:normal;max-width:160px}.fxs-avatarmenu-tenant{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-weight:600;font-size:10px;line-height:normal;text-transform:uppercase;max-width:160px}.fxs-avatarmenu-tenant-container{text-align:right;flex:1 1 auto;padding-left:20px}.fxs-avatarmenu-imageonly .fxs-dropmenu-button .fxs-avatarmenu-tenant-container{display:none}.fxs-avatarmenu-dropdown{width:220px;max-height:calc(100vh - 40px);overflow-x:hidden;overflow-y:auto}.fxs-avatarmenu-tenant-image-container{height:28px;width:28px;flex:0 0 auto;padding-left:6px;padding-right:6px;box-sizing:content-box}.fxs-avatarmenu-tenant-image{height:28px;width:28px;border:0;border-radius:28px}.fxs-avatarmenu-tenant-image-overlay{height:18px;width:18px;position:absolute;right:0;bottom:0}.fxs-avatarmenu-dropdown-item{display:flex}.fxs-avatarmenu-scrollviewer{max-height:505px;overflow:auto}html[lang^="ja"] .fxs-avatarmenu .fxs-avatarmenu-header .fxs-avatarmenu-tenant,html[lang^="ko"] .fxs-avatarmenu .fxs-avatarmenu-header .fxs-avatarmenu-tenant,html[lang^="zh"] .fxs-avatarmenu .fxs-avatarmenu-header .fxs-avatarmenu-tenant{font-size:11px}',moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.ContextMenu.css",["module"],(function(e){"use strict";return{css:".fxs-contextMenu{display:none;position:fixed;width:192px;z-index:200;max-height:100vh;overflow-x:hidden;overflow-y:auto;border-style:solid;border-width:1px}.fxs-contextMenu:focus{outline:none}.fxs-contextMenu.fxs-contextMenu-active{display:block}.fxs-contextMenu-item{display:flex;align-items:center;padding:8px;box-sizing:border-box;font-size:13px;line-height:normal;cursor:pointer}.fxs-contextMenu-text{flex:1 1 auto;margin-left:8px;overflow:hidden;text-overflow:ellipsis}.fxs-contextMenu-icon{flex:0 0 auto;height:16px;width:16px;display:flex;justify-content:center;align-items:center;align-self:flex-start;margin-top:1px}.fxs-contextMenu-icon>svg{height:16px;width:16px}.fxs-contextMenu-itemList{list-style-type:none;margin:0;padding:0}.fxs-contextMenu-extensioncommand .fxs-contextMenu-icon{display:none}.fxs-contextMenu-extensioncommand.fxs-contextMenu-itemDisabled{display:block}.fxs-contextMenu-itemDisabled{cursor:text}.fxs-contextMenu-form{padding:8px 20px;display:none}.fxs-contextMenu-form.fxs-contextMenu-active{display:block}.fxs-dialogballoon.azc-balloon{opacity:1;width:auto;max-width:550px}.fxs-dialogballoon.azc-balloon>.azc-balloon-content{margin:0;overflow:unset;height:unset}.fxs-dialogballoon.azc-balloon .azc-balloon-text,.fxs-dialogballoon.azc-balloon .fxs-messagebox,.fxs-dialogballoon.azc-balloon>.azc-balloon-content{height:100%}.fxs-dialogballoon.azc-balloon .fxs-messagebox{overflow:auto}.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-mini,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-small,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-normal,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-tall,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-large,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-wide,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-herowide,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-herotall,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-hero{height:20px;width:20px}.msportalfx-contextmenu-grid rect{display:none}.msportalfx-contextmenu-grid-mini .msportalfx-grid-rect-mini,.msportalfx-contextmenu-grid-small .msportalfx-grid-rect-small,.msportalfx-contextmenu-grid-normal .msportalfx-grid-rect-normal,.msportalfx-contextmenu-grid-wide .msportalfx-grid-rect-wide,.msportalfx-contextmenu-grid-tall .msportalfx-grid-rect-tall,.msportalfx-contextmenu-grid-large .msportalfx-grid-rect-large,.msportalfx-contextmenu-grid-herowide .msportalfx-grid-rect-herowide,.msportalfx-contextmenu-grid-herotall .msportalfx-grid-rect-herotall,.msportalfx-contextmenu-grid-hero .msportalfx-grid-rect-hero{display:block}.fxs-contextMenuTouchHint{position:fixed;z-index:500;border:2px solid #808080;box-sizing:border-box;background-color:rgba(255,255,255,.2);pointer-events:none}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.ContextPane.css",["module"],(function(e){"use strict";return{css:".fxs-contextpane{display:none;height:100%;position:relative;z-index:2;overflow:auto}.fxs-contextpane-content{box-sizing:border-box;height:auto;overflow:auto}.fxs-contextpane-loadindicator{display:none;position:absolute;top:0;bottom:0;right:0;left:0;background:inherit}.fxs-contextpane-loading .fxs-contextpane-loadindicator{display:block}.fxs-contextpane-visible{display:block}.fxs-contextpane-title{font-weight:600;font-size:18px;line-height:50px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin:0}.fxs-portal-contextpane-right{position:absolute;right:0;max-width:100%;height:100%}.fxs-portal-contextpane-right .fxs-blade{box-shadow:none}.fxs-blade.fxs-contextpane-content{min-width:300px}.fxs-isEdge.fxs-portal-contextpane-right{overflow:auto}.fxs-portal-contextpane-right.fxs-contextpane-loading{min-width:355px}@media(min-width:640px){.fxs-portal-contextpane-right{height:100%;max-width:calc(100% - 48px)}.fxs-sidebar-hamburger-mode .fxs-portal-contextpane-right{max-width:100%}}@media(min-width:1024px){.fxs-portal-contextpane-right{max-width:calc(100% - 225px)}.fxs-sidebar-is-collapsed~.fxs-portal-contextpane-right{max-width:calc(100% - 48px)}}@media(min-height:500px){.fxs-contextpane-visible{display:flex;flex-flow:column nowrap}.fxs-contextpane{overflow:initial}.fxs-contextpane-content{height:100%}}@media(max-height:499.99999px){.fxs-contextpane .fxc-gc-vscroll{max-height:calc(100vh - 45px)}}.fxs-react-contextpane.fxs-react-contextpane.fxs-react-contextpane,.fxs-react-contextpane.fxs-react-contextpane .fxs-blade{background:none;pointer-events:none}.fxs-react-contextpane .fxs-header{pointer-events:auto}.fxs-react-contextpane .fxs-blade-content-container{display:none}.fxs-contextpane-floated-frame.fxs-contextpane-floated-frame{right:0;top:calc(64px - 20px - 8px);height:calc(100% - (64px - 20px - 8px));z-index:203;pointer-events:all;max-width:100%}.fxs-journey-breadcrumb.fxs-display-none+.fxs-journey-layout .fxs-contextpane-floated-frame{top:64px}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Control.css",["module"],(function(e){"use strict";return{css:".fxc-base .fxs-tile-progress{background-color:inherit}.fxc-base .fxs-tile-progress .fxs-tile-progress-transparent{height:100%;width:100%;left:auto;top:auto}.fxc-base .fxs-tile-progress .fxs-tile-progress-transparent>div{margin:0;left:0;vertical-align:baseline}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.DropMenu.css",["module"],(function(e){"use strict";return{css:".fxs-dropmenu{position:relative;flex:0 0 auto;box-sizing:border-box;z-index:200}.fxs-dropmenu-button{border:none;padding:0;margin:0;background:none;cursor:pointer;display:flex;position:relative;height:100%;align-items:center;justify-content:center}.fx-dropmenu-dropdown .fxs-dropmenu-list-system a{display:flex}.fxs-dropmenu-content:not(.azc-toolbarButton-overflowPopup){position:absolute}.fxs-dropmenu-content:not(.azc-toolbarButton-overflowPopup) ol,.fxs-dropmenu-content:not(.azc-toolbarButton-overflowPopup) ul{list-style:none outside none;padding:0;margin:0}.fxs-dropmenu-content:not(.azc-toolbarButton-overflowPopup) li{white-space:nowrap}.fxs-dropmenu-content:not(.azc-toolbarButton-overflowPopup) li a{align-items:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding:10px 20px}.fxs-dropmenu-list-content{flex:1 1 auto;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-dropmenu-image{flex:0 0 auto;height:16px;width:16px}.fxs-dropmenu-image img,.fxs-dropmenu-image svg{height:13px;width:13px}.fxs-dropmenu-line-separator{border-top-width:1px;border-top-style:solid}.fxs-dropmenu-content li a:hover{text-decoration:none}.fxs-dropmenu-left{right:0}.fxs-dropmenu-right{left:0}.fxs-dropmenu-hidden{display:none}.fxs-dropmenu-invisible{visibility:hidden}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.FlowLayout.css",["module"],(function(e){"use strict";return{css:'.fxs-flowlayout{position:relative}.fxs-flowlayout>.fxs-flowlayout-childcontainer{position:relative;transition:height .25s linear,width .25s linear 0s}.fxs-flowlayout>.fxs-flowlayout-childcontainer>.fxs-flowlayout-element{position:absolute}.fxs-flowlayout>.fxs-flowlayout-childcontainer>.fxs-flowlayout-drop-placeholder{position:absolute;background:rgba(0,0,0,.2)}.fxs-flowlayout-childcontainer>.fxs-tile{transition:height 125ms linear 125ms,width 125ms linear 0s,top 175ms ease-out,left 175ms ease-out,right 175ms ease-out}.fxs-flowlayout-resolutionguide{position:absolute;top:0;left:0;box-sizing:border-box;color:#fff;border-color:#fff;opacity:.7;border-width:1px;border-right-style:dashed;border-bottom-style:dashed;pointer-events:none;font-size:13px;line-height:normal}.fxs-flowlayout-resolutionguide::after{position:absolute;right:8px;bottom:5px}.fxs-flowlayout-resolutionguide-1024x768{height:768px;width:1024px}.fxs-flowlayout-resolutionguide-1024x768::after{content:"1024 x 768"}.fxs-flowlayout-resolutionguide-1366x768{height:768px;width:1366px}.fxs-flowlayout-resolutionguide-1366x768::after{content:"1366 x 768"}.fxs-flowlayout-resolutionguide-1440x900{height:900px;width:1440px}.fxs-flowlayout-resolutionguide-1440x900::after{content:"1440 x 900"}.fxs-flowlayout-resolutionguide-1920x1080{height:1080px;width:1920px}.fxs-flowlayout-resolutionguide-1920x1080::after{content:"1920 x 1080"}.fxs-flowlayout-resolutionguide-3840x2160{height:2160px;width:3840px}.fxs-flowlayout-resolutionguide-3840x2160::after{content:"3840 x 2160"}.fxs-drag-surface{position:fixed;margin:0;padding:0;top:0;left:0;right:0;bottom:0;overflow:hidden;background-color:transparent;pointer-events:none;z-index:199}.fxs-drag-disableTouchAction{touch-action:none}.fxs-flowlayout-resizehandle{display:inline-block;padding:0 4px 4px 0;bottom:0;right:0}.fxs-flowlayout-resizehandle>div{height:12px;width:12px;border:2px solid rgba(125,125,125,.5);border-left-width:0;border-top-width:0}.fxs-flowlayout-resizehandle,.fxs-flowlayout-livepreview{position:absolute;cursor:se-resize;z-index:1}.fxs-flowlayout-livepreview{min-width:85px;min-height:85px;max-width:2245px;max-height:2245px;overflow:hidden}',moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css",["module"],(function(e){"use strict";return{css:"@keyframes fxs-search-indicator-animatedEllipses{0%{transform:scale(1);opacity:.3}36.1%{transform:scale(1.06);opacity:1}50%{transform:scale(1.06);opacity:1}86.1%{transform:scale(1);opacity:.3}}.fxs-search-menu{position:absolute;top:30px;left:0;width:100%;display:none;box-sizing:border-box;max-height:calc(100vh - 40px);overflow-x:hidden;overflow-y:auto}.fxs-asyncsearch-menu{position:absolute;top:30px;left:0;display:none;width:100%;box-sizing:border-box;max-height:calc(100vh - 40px);overflow-x:hidden;overflow-y:auto}.fxs-search-text{white-space:normal;overflow:hidden;text-overflow:ellipsis}.fxs-search-wrapper{display:flex;align-items:center;width:100%;border-radius:2px}.fxs-search{position:relative;display:flex}.fxs-search-icon-mini{padding:0 2px 0 8px;box-sizing:border-box;height:26px;width:22px;display:flex;align-items:center}.fxs-search-icon-mini svg{height:12px;width:12px}.fxs-search-clear{height:26px;width:24px;cursor:pointer;fill:#484644;box-sizing:border-box;display:flex;align-items:center;justify-content:center}.fxs-search-clear svg{height:12px;width:12px}.fxs-search-box{height:26px;flex:1 1 auto}.fxs-search-box .azc-input{border:0;font-size:13px;height:26px;background-color:transparent;box-sizing:border-box;outline:0;padding:2px 8px 4px;width:100%}.fxs-search-indicator{display:none;align-items:center;height:26px;box-sizing:border-box}.fxs-search-indicator>div{height:7px;width:7px;animation:fxs-search-indicator-animatedEllipses 1.5s infinite;background:#aab3bd;margin:0 2.5px}.fxs-search-indicator>div:nth-child(1){animation-delay:0s}.fxs-search-indicator>div:nth-child(2){animation-delay:.2s}.fxs-search-indicator>div:nth-child(3){animation-delay:.4s}.fxs-searching .fxs-search-indicator{display:flex}.fxs-search .fxs-search-icon{display:none}.fxs-search-showmenu .fxs-search-menu{display:block}.fxs-search-showmenu .fxs-asyncsearch-menu{display:block}.fxs-topbar-state-searchcollapsed .fxs-search-icon{display:flex}.fxs-topbar-state-searchcollapsed .fxs-search-wrapper{display:none}.fxs-topbar-state-searchcollapsed .fxs-search-activated .fxs-search-icon{display:none}.fxs-topbar-state-searchcollapsed .fxs-search-activated .fxs-search-wrapper{display:flex}.fxs-topbar-state-searchcollapsed .fxs-search-activated.fxs-search-showmenu .fxs-search-menu{display:block}.fxs-topbar-state-searchcollapsed .fxs-search-showmenu .fxs-search-menu{display:none}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.SideBar.css",["module"],(function(e){"use strict";return{css:".fxs-sidebar{z-index:6;height:100%;font-size:13px;box-sizing:border-box;position:fixed;top:0}.fxs-sidebar-list{padding:0;margin:0;list-style:none}.fxs-sidebar-button{cursor:pointer}.fxs-sidebar-favorites{padding-bottom:20px}.fxs-sidebar-bar{width:225px;display:flex;flex-direction:column;height:100%;overflow:hidden}.fxs-sidebar-top{flex:0 0 auto}.fxs-sidebar-top>.fxs-sidebar-button{width:100%;border:none;padding:0;text-align:left}.fxs-sidebar-middle{flex:1 1 auto;overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch}.fxs-sidebar-favorites-section{height:32px;display:flex;align-items:center;flex:0 0 auto}.fxs-sidebar-myfavorites{text-transform:uppercase;font-weight:700;font-size:10px;word-break:keep-all;margin-left:10px}.fxs-sidebar-divider,.fxs-sidebar-divider2{border-bottom-width:1px;border-bottom-style:solid;height:0;flex:1 1 0}.fxs-sidebar-divider:first-of-type{margin-right:5px;max-width:13px}.fxs-sidebar-divider:last-of-type{margin-left:5px}.fxs-sidebar-item-link{display:flex;align-items:center;flex:1 1 auto;min-height:32px;-webkit-user-drag:none;color:inherit;box-sizing:border-box;padding:7px 0}a.fxs-sidebar-item-link:hover{text-decoration:none;color:inherit}.fxs-sidebar-icon{flex:0 0 18px;height:18px;padding-left:15px;align-self:flex-start}.fxs-sidebar-icon svg,.fxs-sidebar-icon img{height:18px;width:18px}.fxs-sidebar-hamburger .fxs-sidebar-icon{height:16px;padding-left:15px;align-self:center}.fxs-sidebar-hamburger .fxs-sidebar-icon svg{height:16px;width:16px}.fxs-sidebar-label{flex:1 1 auto;overflow:hidden;text-overflow:ellipsis;margin-left:6px}.fxs-sidebar-create,.fxs-sidebar-browse{font-size:inherit}.fxs-sidebar-create .fxs-sidebar-label,.fxs-sidebar-browse .fxs-sidebar-label{margin-right:15px}.fxs-sidebar-collapse-button{display:flex;align-items:center;height:28px}.fxs-sidebar-collapse-button svg{height:8px;width:8px;transform:rotate(-90deg);margin-left:auto;margin-right:10px}.fxs-sidebar-fav-icon svg{height:12px;width:12px;fill:#0078d4}.fxs-theme-blue .fxs-sidebar-fav-icon svg,.fxs-mode-dark .fxs-sidebar-fav-icon svg{fill:#f2f2f2}.fxs-sidebar-external{flex:0 0 12px;margin:0 10px;padding-top:3px;width:12px;fill:#bbb}.fxs-sidebar-external svg{height:12px;width:12px}.fxs-sidebar-handle{flex:0 0 20px;cursor:move;fill:#bbb}.fxs-sidebar-handle svg{display:none;height:16px;width:16px;transform:rotate(90deg)}.fxs-sidebar-item:hover .fxs-sidebar-handle svg{display:block}.fxs-extension-sidebar .fxs-sidebar-bar{background:none;width:280px;transition-property:width;transition-duration:.2s}.fxs-extension-sidebar.fxs-sidebar-is-collapsed .fxs-sidebar-bar{transition-duration:0s}.fxs-extension-sidebar .fxs-sidebar-shadow{width:0}.fxs-sidebar-is-collapsed .fxs-sidebar-bar{width:48px}.fxs-sidebar-is-collapsed .fxs-sidebar-myfavorites,.fxs-sidebar-is-collapsed .fxs-sidebar-external{display:none}.fxs-sidebar-is-collapsed .fxs-sidebar-top>.fxs-sidebar-item-link .fxs-sidebar-label,.fxs-sidebar-is-collapsed .fxs-sidebar-middle .fxs-sidebar-label{display:none}.fxs-sidebar-is-collapsed .fxs-sidebar-top>.fxs-sidebar-item-link .fxs-sidebar-favorites,.fxs-sidebar-is-collapsed .fxs-sidebar-middle .fxs-sidebar-favorites{width:48px}.fxs-sidebar-is-collapsed .fxs-sidebar-collapse-button svg{transform:rotate(90deg)}.fxs-sidebar-is-collapsed .fxs-sidebar-middle{width:68px}.fxs-sidebar-shadow{pointer-events:none;position:absolute;right:0;top:0;bottom:0}.fxs-sidebar-menu-toggle-link,.fxs-sidebar-divider2,.fxs-sidebar .fxs-sidebar-collapse-button,.fxs-sidebar.fxs-sidebar-is-collapsed,.fxs-sidebar-menu-container{display:none}.fxs-sidebar-item-link.fxs-sidebar-hamburger{display:flex;border:none;padding:0;width:100%;height:40px}.fxs-sidebar-is-collapsed .fxs-sidebar-bar.msportalfx-shadow-level3{box-shadow:none}.fxs-sidebar .fxs-sidebar-shadow{display:none}.fxs-sidebar-menu .fxs-sidebar-menu-toggle-link{display:flex;align-items:center;height:32px}.fxs-sidebar-menu .fxs-sidebar-menu-toggle-link .fxs-sidebar-menu-icon{height:16px;align-self:center}.fxs-sidebar-menu .fxs-sidebar-menu-toggle-link .fxs-sidebar-menu-icon svg{height:16px;width:16px}.fxs-sidebar-menu .fxs-sidebar-divider2{display:flex;margin-top:12px;margin-bottom:8px}.fxs-sidebar-menu-activated .fxs-sidebar-menu-activated-hidden{display:none}.fxs-sidebar-menu-activated .fxs-sidebar-menu-container{display:flex;min-height:0;flex-direction:column}.fxs-sidebar-menu-activated .fxs-sidebar-menu-toggle-link svg{transform:rotate(180deg)}.fxs-sidebar .fxs-part-frame.fxs-blade-floated-frame{top:0;height:100%}.fxs-sidebar-content{height:100%;position:relative}.fxs-sidebar-menu-activated .fxs-sidebar-content{display:none}@media(min-width:640px) and (min-height:500px){.fxs-sidebar-hamburger-mode .fxs-sidebar.fxs-sidebar-is-collapsed,.fxs-sidebar-hamburger-mode .fxs-sidebar .fxs-sidebar-collapse-button{display:none}.fxs-sidebar-hamburger-mode .fxs-sidebar-item-link.fxs-sidebar-hamburger{display:flex}.fxs-sidebar-hamburger-mode .fxs-sidebar{position:fixed}.fxs-sidebar-hamburger-mode .fxs-sidebar .fxs-sidebar-shadow{display:none}.fxs-sidebar-docked-mode .fxs-sidebar{z-index:4;position:relative;max-width:48px}.fxs-sidebar-docked-mode .fxs-sidebar .fxs-sidebar-collapse-button{display:flex}.fxs-sidebar-docked-mode .fxs-sidebar-item-link.fxs-sidebar-hamburger{display:none}.fxs-sidebar-docked-mode .fxs-sidebar.fxs-sidebar-is-collapsed{position:relative;display:flex}.fxs-sidebar-docked-mode .fxs-sidebar.fxs-sidebar-is-collapsed .fxs-sidebar-shadow{display:flex}.fxs-sidebar-menu .fxs-sidebar-menu-toggle-link,.fxs-sidebar-menu .fxs-sidebar-divider2{display:none}}@media(min-width:1024px) and (min-height:500px){.fxs-sidebar-hamburger-mode .fxs-sidebar .fxs-sidebar-shadow{display:none}.fxs-sidebar-hamburger-mode .fxs-sidebar{position:fixed}.fxs-sidebar-docked-mode .fxs-sidebar-bar.msportalfx-shadow-level3{box-shadow:none}.fxs-sidebar-docked-mode .fxs-sidebar{position:relative;max-width:initial}.fxs-sidebar-docked-mode .fxs-sidebar .fxs-sidebar-shadow{display:flex}}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.StackLayout.css",["module"],(function(e){"use strict";return{css:".fxs-stacklayout{display:flex}.fxs-stacklayout-vertical{flex-direction:column}.fxs-stacklayout-horizontal{flex-direction:row}.fxs-stacklayout-child{flex:0 0 auto}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.StartBoard.css",["module"],(function(e){"use strict";return{css:'.fxs-startboard{display:flex;flex-flow:column nowrap;overflow:auto;width:100%}.fxs-startboard .fxs-startboard-message-container{display:none}.fxs-startboard.fxs-startboard-notfound>.fxs-startboard-layout{display:none}.fxs-startboard.fxs-startboard-notfound .fxs-startboard-message-container{display:block}.fxs-startboard-header{display:flex;align-items:center;flex:0 0 auto;width:100%;height:45px;padding:0 25px 0 40px;margin-top:20px;box-sizing:border-box}.fxs-startboard-header .fxs-startboard-title-next{display:block}.fxs-startboard-header .fxs-startboard-title-content{display:flex}.fxs-startboard-header .fxs-startboard-button-text{font-size:13px}.fxs-startboard-header .fxs-startboard-button-icon{height:12px;width:12px;align-items:center;justify-content:center;flex:0 0 12px}.fxs-startboard-header .fxs-startboard-dropdown .fxs-startboard-button-icon,.fxs-startboard-header .fxs-startboard-title-next .fxs-startboard-button-icon{height:16px;width:16px;margin:4px 8px;flex:0 0 auto}.fxs-startboard-header .fxs-startboard-dropdown .fxs-startboard-button-icon>svg,.fxs-startboard-header .fxs-startboard-title-next .fxs-startboard-button-icon>svg{flex:0 0 16px}.fxs-startboard-header .fxs-startboard-title{max-width:300px;font-weight:600}.fxs-startboard-header .fxs-startboard-title-edit{padding:0 5px 2px;margin:0 -6px -2px;border-width:1px;border-style:solid;color:inherit;background-color:transparent;width:300px;transition:border .12s}.fxs-startboard-header .fxs-startboard-title-edit:active,.fxs-startboard-header .fxs-startboard-title-edit:hover{border-color:inherit}.fxs-startboard-header .fxs-startboard-button{position:relative}.fxs-startboard-header .fxs-startboard-title,.fxs-startboard-header .fxs-startboard-button{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:left}.fxs-startboard-header .fxs-startboard-dropdown,.fxs-startboard-header .fxs-startboard-button{font-size:13px;line-height:20px}.fxs-startboard-header .fxs-startboard-title,.fxs-startboard-header .fxs-startboard-title-edit{font-size:18px;line-height:24px}.fxs-startboard-header .fxs-startboard-subtitle{text-align:initial;font-size:12px;line-height:14px}.fxs-startboard-header .fxs-startboard-subtitle.fxs-startboard-subtitle-shared{margin-left:32px}.fxs-startboard-header .fxs-startboard-migration{height:40px;align-items:center;display:flex;flex:0 0 auto}.fxs-startboard-customize-header{min-height:70px}.fxs-startboard-commandBar,.fxs-startboard-customize-header,.fxs-startboard-warning,.fxs-startboard-error{padding:0 25px 0 40px}.fxs-startboard-commandBar-fullScreen{display:none;margin-left:10px}.fxs-startboard-actions{margin-left:30px}.fxs-startboard-actions .fxs-startboard-actions-preview,.fxs-startboard-actions .fxs-startboard-actions-save{margin-right:10px}.fxs-startboard-warning,.fxs-startboard-error{margin:0}.fxs-startboard-layout{padding:16px 40px;flex:1 1 auto}.fxs-startboard-layout .fxs-flowlayout-childcontainer{padding-bottom:25px;padding-right:25px}.fxs-startboard-dropdown{display:none;flex:0 1 auto;max-width:560px;padding:2px 0}.fxs-startboard-button{flex:0 0 auto;border:0;margin:0 5px;padding:4px 5px;height:20px;background-color:transparent;box-sizing:content-box}.fxs-startboard-button:not([aria-disabled]):hover{cursor:pointer}.fxs-startboard-button .fxs-startboard-button-text{margin-left:5px}.fxs-startboard-button .fxs-startboard-button-icon{height:16px;width:16px}.fxs-startboard-button{display:flex;align-items:center;min-width:0}.fxs-startboard-button-browse{padding:0 !important}.fxs-startboard-dropdown>.fxs-dropmenu{width:100%}.fxs-startboard-dropdown>.fxs-dropmenu .fxs-dropmenu-button{width:100%}.fxs-startboard-dropdown .fxs-dropmenu-content{overflow-x:hidden;overflow-y:auto;min-width:400px;max-width:560px;min-height:35px}.fxs-startboard-dropdown .fx-dropmenu-dropdown{max-height:calc(100vh - 120px)}.fxs-startboard-item-container{display:flex;align-items:center;min-width:0}.fxs-startboard-dropdown .fxs-dropmenu-list-system .fxs-startboard-dropdown-item{padding:7px 25px 8px}.fxs-startboard-dropdown-item+.fxs-startboard-dropdown-item::before{content:"";position:absolute;top:0;width:calc(100% - 50px);border-top-width:1px;border-top-style:solid;border-color:rgba(125,125,125,.5)}.fxs-startboard-item-title{flex:1 1 auto;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-startboard-item-icon{flex:0 0 auto;height:14px;width:14px;padding-right:5px}.fxs-startboard-dropdown-button{display:flex;flex-flow:column nowrap}.fxs-startboard-title-container{display:flex}.fxs-startboard-dropdown-item{position:relative;height:35px;box-sizing:border-box;cursor:pointer}.fxs-startboard-dropdown-item.fxs-startboard-dropdown-browseall{height:auto;cursor:default}.fxs-startboard-dropdown-subscriptions{white-space:normal}.fxs-startboard-migration,.fxs-startboard-dropdown{display:none}.fxs-startboard-header:not(.fxs-startboard-header-normal) .fxs-startboard-title-edit{display:none}.fxs-startboard-header-normal .fxs-startboard-dropdown{display:block}.fxs-startboard-header-normal .fxs-startboard-migration{display:none}.fxs-startboard-header-normal .fxs-startboard-title-next{display:none}.fxs-startboard-header-migration .fxs-startboard-dropdown{display:none}.fxs-startboard-header-migration .fxs-startboard-migration{display:flex}.fxs-startboard-header-migration .fxs-startboard-title-next{display:block}.fxs-startboard-message-container{padding:55px 40px}.fxs-startboard-message-title{font-size:32px;margin-bottom:20px}.fxs-startboard-message-body{font-size:17px}.fxs-startboard-notfound .fxs-startboard-button{display:none}.fxs-portal:not(.fxs-desktop-organize) .fxs-topbar-dashboard-changed .fxs-startboard-header-item{display:none}.fxs-portal:not(.fxs-desktop-organize) .fxs-topbar-dashboard-changed .fxs-startboard-title-next{display:block}.fxs-startboard-loadanimation{display:none;align-items:center;justify-content:center;position:absolute;height:100%;width:100%}.fxs-startboard-loading .fxs-startboard-loadanimation{display:flex}.fxs-startboard-loading .fxs-startboard-layout,.fxs-startboard-loading .fxs-startboard-message-container{visibility:hidden}.fxs-startboard-loading .fxs-startboard-header-item{display:none}.fxs-startboard-loading .fxs-startboard-title-next{display:block}.fxs-startboard-loading .fxs-startboard-layout .fxs-tile .fxs-part-content{display:none}@media(min-height:500px){.fxs-startboard{overflow:hidden}.fxs-startboard-layout{overflow:auto}}',moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Tile.css",["module"],(function(e){"use strict";return{css:".fxs-tile-progress-transparent{height:12px;position:absolute;top:0;left:0;z-index:195;overflow:hidden}.fxs-tile-progress-transparent>div{margin-left:6px}.fxs-tile-progress-transparent>div::after{height:4px;width:4px;background:#000}.fxs-startboard .fxs-tile{border-radius:2px}.fxs-startboard .fxs-tile>.fxs-part{border-radius:2px}.fxs-tile{height:175px;width:175px;position:relative;box-shadow:none}.fxs-tilesize-mini{height:85px;width:85px}.fxs-tilesize-small{height:85px;width:175px}.fxs-tilesize-tall{height:355px;width:175px}.fxs-tilesize-wide{height:175px;width:355px}.fxs-tilesize-normal{height:175px;width:175px}.fxs-tilesize-large{height:355px;width:355px}.fxs-tilesize-herotall{height:535px;width:355px}.fxs-tilesize-herowide{height:355px;width:535px}.fxs-tilesize-hero{height:535px;width:535px}.fxs-tilesize-herowidefitheight{height:auto;width:535px}.fxs-tilesize-fullwidthfitheight{height:auto;width:100%}.fxs-tilesize-fullwidthfitheight .fxs-part{height:auto}.fxs-tilesize-fullwidthfitheight .fxs-part-content{height:auto}.fxs-tilesize-herowidefitheight,.fxs-tilesize-fullwidthfitheight{margin-bottom:5px}.fxs-tilesize-herowidefitheight:last-child,.fxs-tilesize-fullwidthfitheight:last-child{margin-bottom:0}.fxs-tilesize-fittocontainer{height:100%;width:100%}.fxs-tilesize-fittocontainer>.fxs-part{overflow:visible}.fxs-tile-actionbar{z-index:196}.fxs-tile-container{width:100%;height:100%}div.fxs-tile-overlay:not(.fxs-progress){display:none;position:absolute;width:100%;top:0;bottom:0;cursor:pointer}.fxs-bladestyle-create .fxs-tile .fxs-part,.fxs-bladestyle-context .fxs-tile .fxs-part,.fxs-bladestyle-contextaction .fxs-tile .fxs-part,.fxs-bladestyle-help .fxs-tile .fxs-part{box-shadow:none}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.TileActionBar.css",["module"],(function(e){"use strict";return{css:".fxs-tile-actionbar-actionlist{display:flex;flex-flow:row nowrap;border-radius:0 2px 0 0}.fxs-tile-actionbar-actionlist:empty{height:25px;visibility:hidden}.fxs-tile-actionbar-actionlist .fxs-tile-actionbar-action:last-of-type{border-radius:0 2px 0 0}.fxs-tile-actionbar-action{flex:0 0 auto;display:flex;align-items:center;justify-content:center;box-sizing:border-box;height:25px;width:25px;padding:6px;background-color:transparent;cursor:pointer;border:0;transition:background .1s ease-out}.fxs-tile-actionbar-action>svg{height:13px;width:13px}.fxs-tile .fxs-tile-actions{position:absolute;right:0;cursor:default}.fxs-tile-actionbar-command-unpinfromstartboard{display:none}.fxs-desktop-organize .fxs-tile-actionbar-command-unpinfromstartboard{display:flex}.fxs-tile-transparent{opacity:0}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Toast.css",["module"],(function(e){"use strict";return{css:".fxs-toast{position:fixed;right:5px;width:355px;max-width:100%;box-sizing:border-box;list-style-type:none;margin:0;padding:0;padding-left:10px}.fxs-topbar-toast{position:relative;top:25px}.fxs-toast-wrapper,.fxs-toast-content{flex:1 1 auto;width:100%;padding:10px;box-sizing:border-box}.fxs-toast-item{display:flex;margin-bottom:5px;position:relative}.fxs-toast-header{display:flex;padding-top:5px;margin-bottom:5px}.fxs-toast-icon{margin-right:4px}.fxs-toast-icon svg{height:15px;width:15px;vertical-align:middle}.fxs-toast-title{flex:1 1 auto;margin:0 4px;max-width:254px;font-weight:600;display:block;display:-webkit-box;line-height:19px;max-height:38px;overflow:hidden;text-overflow:ellipsis;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow-wrap:break-word}.fxs-toast-title.fxs-toast-link:hover{text-decoration:underline}.fxs-toast-time{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:60px;flex:0 0 auto}.fxs-toast-close{position:absolute;top:0;right:0;background:none;border:none;cursor:pointer;margin-left:4px;padding:0;margin-top:16px;margin-right:12px}.fxs-toast-close svg{height:12px;width:12px}.fxs-toast-description{font-size:13px;line-height:normal;max-width:100%;overflow:hidden;position:relative;text-overflow:ellipsis;white-space:pre-wrap;width:335px}.fxs-toast-progressbar{margin-top:10px;max-height:5px}.fxs-nps .fxs-nps-title,.fxs-nps .fxs-sat-title{font-weight:600;margin-bottom:7px;width:calc(100% - 15px)}.fxs-nps .fxs-sat-title{margin-top:28px}.fxs-nps .fxs-red-star{color:#f00;font-size:14px;line-height:20px}.fxs-nps .fxs-nps-score,.fxs-nps .fxs-sat-score{display:flex}.fxs-nps .fxs-nps-score span,.fxs-nps .fxs-sat-score span{flex:1 1 auto;border:1px solid #c5cbd1;text-align:center;height:23px;line-height:23px;margin-right:6px;display:inline-block;cursor:pointer}.fxs-nps .fxs-nps-score span:hover,.fxs-nps .fxs-nps-score span.fxs-nps-score-selected,.fxs-nps .fxs-sat-score span:hover,.fxs-nps .fxs-sat-score span.fxs-sat-score-selected{background:#00bcf2;border-color:#00bcf2}.fxs-nps .fxs-nps-score span:last-child,.fxs-nps .fxs-sat-score span:last-child{margin-right:0}.fxs-nps .fxs-nps-help{display:flex;margin-bottom:10px}.fxs-nps .fxs-nps-help span:last-child{margin-left:auto}.fxs-nps .fxs-sat-label{font-size:13px}.fxs-nps .fxs-sat-label-left{max-width:30%;width:30%}.fxs-nps .fxs-sat-label-center{max-width:40%;text-align:center;width:40%}.fxs-nps .fxs-sat-label-right{max-width:30%;text-align:right;width:30%}.fxs-nps .fxs-nps-comments{margin-bottom:18px;margin-top:22px;width:100%;box-sizing:border-box}.fxs-nps .fxs-nps-checkbox{margin:5px 5px 0 0}.fxs-nps .fxs-nps-checkbox-contact{margin-right:3px}.fxs-nps .fxs-nps-contact-link{margin-left:25px}.fxs-nps .fxs-nps-button-holder{border-top:1px solid #dcdfe2}.fxs-nps .fxs-nps-submit{margin:15px 10px 5px 0}.fxs-nps .fxs-nps-start-hats{margin-right:6px}.fxs-nps .fxs-nps-link-survey{text-decoration:underline}.fxs-sat .fxs-sat-title{font-weight:600;margin-bottom:7px}.fxs-sat .fxs-sat-submit{margin:15px 10px 5px 0;border:0}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.TopBar.css",["module"],(function(e){"use strict";return{css:".fxs-topbar{height:40px;position:relative;z-index:5;flex:0 0 auto;font-size:13px}.fxs-topbar-preview,.fxs-topbar-brand{flex:0 1 auto;margin:0;padding:0;height:100%;min-width:0}.fxs-topbar .fxs-topbar-journey-icon{border:none}.fxs-topbar .fxs-topbar-journey-icon svg{height:16px;width:16px;margin-top:4px}.fxs-topbar-content{width:100%;height:100%;position:absolute;top:0;-webkit-app-region:drag;display:flex;align-content:center;align-items:center}.fxs-search-box,.fxs-topbar-button,.fxs-topbar-avatarmenu,.fxs-topbar-reportbug,.fxs-topbar-upgradebutton{-webkit-app-region:no-drag}.fxs-topbar-internal{min-width:85px;box-sizing:border-box;text-align:center;flex:0 0 auto}.fxs-topbar-exitdevmode,.fxs-topbar-reportbug,.fxs-topbar-upgradebutton{display:flex;height:40px;width:auto;flex:0 0 auto;align-items:center;justify-content:center;padding:0 5px;color:#000}.fxs-topbar-preview .fxs-topbar-home .fxs-topbar-internal,.fxs-topbar-brand .fxs-topbar-home{display:inline-block;font-size:15px;padding:0 20px;height:40px;line-height:40px;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;width:100%;box-sizing:border-box}.fxs-topbar-preview .fxs-topbar-home{display:inline-block;width:100%;height:100%}.fxs-topbar-devmode .fxs-topbar-home{color:#000}a.fxs-topbar-home:hover{text-decoration:none}.fxs-topbar-button{display:flex;height:40px;width:40px;flex:0 0 auto;align-items:center;justify-content:center}.fxs-topbar-button svg{height:16px;width:16px}.fxs-topbar-button.fxs-topbar-close:hover{background-color:#ba141a}.fxs-desktop-organize .fxs-topbar-exit-customize{visibility:visible;top:0}.fxs-topbar-exit-customize-message,.fxs-topbar-dashboard-message{font-size:14px}.fxs-topbar-exit-customize-button,.fxs-topbar-dashboard .fxs-button{flex:0 0 auto;margin-left:10px}.fxs-show-startboard .fxs-topbar-dashboard-view{display:none}.fxs-portal:not(.fxs-show-startboard) .fxs-topbar-dashboard-save,.fxs-portal:not(.fxs-show-startboard) .fxs-topbar-dashboard-discard{display:none}.fxs-topbar-exit-customize,.fxs-topbar-dashboard{display:flex;align-items:center;justify-content:center;flex:1 1 auto;position:absolute;top:-40px;z-index:5;visibility:hidden;width:100%;height:100%;transition:top .3s ease .0001s}.fxs-topbar-dashboard-changed .fxs-topbar-dashboard{top:0;visibility:visible}.fxs-topbar-dashboard-changed .fxs-topbar-content{visibility:hidden}.fxs-topbar-dashboard-changed .fxs-topbar-exit-customize{display:none}.fxs-topbar-notifications{position:relative}.fxs-topbar-helpmenu{position:relative}.fxs-topbar-placeholder{flex:1 1 auto}.fxs-topbar-buttons-container{display:flex;flex:0 0 auto}.fxs-topbar-back{transform:scale(-1,1)}.fxs-topbar-search{margin-left:7px;width:800px;min-width:280px;flex:0 10000 auto}.fxs-search-back-icon{display:none}.fxs-topbar-reportbug,.fxs-topbar-upgradebutton{margin-left:7px;height:26px;border-radius:2px;font-weight:600}.fxs-topbar-reportbug .fxs-topbar-reportbug-icon,.fxs-topbar-upgradebutton .fxs-topbar-reportbug-icon{width:16px;height:16px}.fxs-topbar-reportbug .fxs-topbar-upgradebutton-icon,.fxs-topbar-upgradebutton .fxs-topbar-upgradebutton-icon{width:14px;height:14px}.fxs-topbar-reportbug .fxs-topbar-reportbug-text,.fxs-topbar-upgradebutton .fxs-topbar-reportbug-text,.fxs-topbar-reportbug .fxs-topbar-upgradebutton-text,.fxs-topbar-upgradebutton .fxs-topbar-upgradebutton-text{margin-left:7px;margin-bottom:2px}.fxs-topbar-reportbug .fxs-topbar-upgradebutton-text,.fxs-topbar-upgradebutton .fxs-topbar-upgradebutton-text{margin-top:1px}.fxs-topbar-state-searchcollapsed .fxs-topbar-search{width:40px;min-width:40px;flex:0 0 auto}.fxs-topbar-state-searchcollapsed.fxs-topbar-search-activated .fxs-topbar-search{width:calc(100% - 40px - 7px*2);margin-left:7px}.fxs-topbar-state-searchcollapsed.fxs-topbar-search-activated .fxs-search-back-icon{display:flex}.fxs-topbar-state-searchcollapsed.fxs-topbar-search-activated .fxs-topbar-search-activated-hidden{opacity:0;position:absolute;height:0 !important;width:0 !important;overflow:hidden !important}.fxs-topbar-sidebar-collapse-button{display:flex;width:48px}@media(max-width:700px){.fxs-topbar-exit-customize-message,.fxs-topbar-dashboard-message{display:none}}@media(min-width:640px) and (min-height:500px){.fxs-topbar-sidebar-collapse-button{display:none}.fxs-sidebar-hamburger-mode .fxs-topbar-sidebar-collapse-button{display:flex}}@media(min-width:494px){.fxs-topbar-search-activated .fxs-search-back-icon{position:absolute}.fxs-topbar-state-searchcollapsed.fxs-topbar-search-activated .fxs-topbar-search{margin:auto}}",moduleId:e.id}})),
define("MsPortalImpl/Widgets/Widgets.WidgetBase",["require","exports","MsPortalImpl/Base/Base.ElementWidgetMap","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.AvatarMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextPane.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Control.css","_generated/Less/MsPortalImpl/Widgets/Widgets.DropMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.FlowLayout.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css","_generated/Less/MsPortalImpl/Widgets/Widgets.SideBar.css","_generated/Less/MsPortalImpl/Widgets/Widgets.StackLayout.css","_generated/Less/MsPortalImpl/Widgets/Widgets.StartBoard.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Tile.css","_generated/Less/MsPortalImpl/Widgets/Widgets.TileActionBar.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Toast.css","_generated/Less/MsPortalImpl/Widgets/Widgets.TopBar.css"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g,h,f,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.ViewModel=void 0,(0,i.injectCss)(o,n,r,a,l,d,c,p,u,m,g,h,f,x);t.ViewModel=class{constructor(){this.disabled=ko.observable(!1)}};class b{constructor(e,t,i=!1){if(!e||0===e.length)throw new Error("You must specify an element to associate a widget to it. Your element is either null or an empty collection.");this.options=t,this._ltm=new FxImpl.TriggerableLifetimeManager,this.element=$(e[0]),i||this._ltm.registerForDispose(e.setEvents([b.widgetRemoveEvent,t=>{t.target!==e[0]||this._disposeTriggered||(this._disposeTriggered=!0,this.dispose())}])),s.set(e[0],this)}setFocus(){}dispose(){this._ltm.dispose(),s.remove(this.element[0],this)}get ltm(){return this._ltm}static getWidget(e,t){const s=b.getWidgets(e,t);return s&&s[0]||null}static getWidgets(e,t){return(t?s.getAllMatch(e[0],t):s.getAll(e[0]))||[]}trigger(e,t){const s=this.options[e],i=this.element;t=t||{};const o=$.Event(e);return o.type=e,o.target=i[0],i.trigger(o,t),!($.isFunction(s)&&!1===s.apply(i[0],[o].concat(t))||o.isDefaultPrevented())}getTelemetrySource(){return null}_bindDescendants(e){const t={data:this.options,func:this},s=e?$.extend(null,t,e):t;ko.applyBindingsToDescendants(s,this.element[0])}_cleanDescendants(){ko.utils.cleanDescendantNodes(this.element)}_cleanElement(...e){this._cleanDescendants(),this._cleanElementClasses(e),this.element.empty()}_cleanElementClasses(e){e.length>0&&this.element.removeClass(e.join(" "))}_isRtl(){return"rtl"===$.querySelectorAll("html").first().attr("dir")}}t.Widget=b,b.widgetRemoveEvent="remove.fxWidget"})),
define("_generated/Less/MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox.css",["module"],(function(e){"use strict";return{css:".fxs-messagebox{font-size:14px;box-sizing:border-box;border-width:1px;border-style:solid;line-height:normal;position:relative;overflow:hidden}.fxs-progressbox{color:#fff}.fxs-messagebox-title{padding:12px 20px 7px;margin:0;border-bottom:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-progressbox-text,.fxs-modal-template,.fxs-messagebox-template,.fxs-messagebox-text{padding:0 20px 8px;word-wrap:break-word}.fxs-messagebox-title.fxs-display-none+.fxs-modal-template,.fxs-messagebox-title.fxs-display-none+.fxs-messagebox-template,.fxs-messagebox-title.fxs-display-none+.fxs-messagebox-text{padding-top:12px}.fxs-messagebox-buttons{padding:8px 20px 16px}.fxs-messagebox-buttons .fxs-button{margin-right:8px}.fxs-progressbox-progressbar{padding:7px 20px 24px}.azc-balloon-dialog .fxs-messagebox{box-shadow:unset;border:0}.fxs-messagebox-confirmation{padding:10px 20px 0;display:block}.fxs-formdialog-description{padding:0 0 15px}.fxs-formdialog-form{max-width:458px}",moduleId:e.id}})),
define("MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Common","Fx/Controls/Button","Fx/Controls/CheckBox","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox.css","MsPortalImpl.Controls/Controls/SimpleButton"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createMessageBoxWithCallback2=t.createMessageBoxWithCallback=t.Widget=t.ViewModel=t.setFocusOnMessageBox=void 0,(0,u.injectCss)(m);const g=MsPortalFx.Base.Diagnostics.createLog(e),h=MsPortalFx.getIdGenerator("messagebox"),f=n.Dialogs.ButtonText,x=[];x[0]=f.abort,x[1]=f.cancel,x[2]=f.ignore,x[3]=f.no,x[4]=f.ok,x[5]=f.retry,x[6]=f.yes;const b="fxs-portal-bg-txt-br",v="msportalfx-shadow-level2",y="fxs-popup",M="fxs-messagebox",I="fxs-messagebox-text",C=s("div",null,s("h2",{"data-bind":{text:"data.title",visible:"!data.hideTitle"},class:"fxs-messagebox-title az-text-header1 msportalfx-tooltip-overflow"}),s(i.KoIf,{condition:"data.trustedTemplate"},s(i.KoIfNot,{condition:"data.template"},s("div",{"data-bind":{sanitizedHtml:"data.text"},class:I})),s(i.KoIf,{condition:"data.template"},s("div",{class:"fxs-modal-template","data-bind":{trustedHtml:{html:"data.template",data:"data.templateViewModel",isolated:"true"}}}))),s(i.KoIfNot,{condition:"data.trustedTemplate"},s(i.KoIfNot,{condition:"data.template"},s("div",{"data-bind":{text:"data.text"},class:I})),s(i.KoIf,{condition:"data.template"},s("div",{class:"fxs-messagebox-template","data-bind":{untrustedHtml:{html:"data.template",data:"data.templateViewModel",isolated:"true"},keyedCss:{scopingClasses:"data.scopeClass"}}}))),s(i.KoIf,{condition:"data.confirmationRequired"},s("div",{"data-bind":{pcControl:"func.checkboxVm"},class:"fxs-messagebox-confirmation"})),s("div",{class:"msportalfx-form fxs-messagebox-buttons","data-bind":{foreach:"func.buttonVms",visible:"func.buttonVms().length >= 1"}},s("div",{"data-bind":{pcControl:"$data.vm",attr:{"data-result":"$data.result"}}})));let P=document.activeElement;function w(e,t){const s=e.closest(".fxs-messagebox");s.length>0&&d.waitForBindings(s[0]).then((()=>{setTimeout((()=>{const e=l.Widget.getWidget(s,S);let t=s.findFirstTabbable();0!==t.length||MsPortalFx.isNullOrUndefined(e)||(t=e.element),t.closest(".fxs-messagebox-buttons").length>0?(e.element.find(".fxs-portal-button-primary")&&e.element.find(".fxs-portal-button-primary").focus(),e.element.find(".fxs-portal-button-danger")&&e.element.find(".fxs-portal-button-danger").focus()):t.focus()}),10)})).catch($.noop);let i=t||document.activeElement;for(;i&&"function"!=typeof i.focus;)i=$(i).closest("[tabindex]")[0];P=i}t.setFocusOnMessageBox=w;class _ extends l.ViewModel{constructor(){super(...arguments),this.title=ko.observable(),this.text=ko.observable(),this.template=ko.observable(),this.templateViewModel=ko.observable(),this.trustedTemplate=!1,this.modal=!1,this.buttons=1,this.confirmationRequired=!1,this.hideTitle=!1,this.scopeClass=""}get onButtonClick(){return this._buttonClick}set onButtonClick(e){if(this._buttonClick)throw new Error("The onButtonClick callback has already been set.");this._buttonClick=e}}t.ViewModel=_;class S extends l.Widget{constructor(e,t){super(e,t),this.buttonVms=ko.observableArray([]),e.html(C).addClass(M).addClass(y).addClass(b).addClass(v),e.closest(".azc-balloon-dialog").attr("role",null);const s=this.ltm,i=e=>{const t=this.element[0],s=$(e).closest(".azc-dockedballoon-balloon").attr("id");return!(this.options.modal||t===e||$.contains(t,e)||s&&(this.element.find(`.azc-dockedballoon-anchor[aria-owns='${s}']`).length||this.element.find(`.azc-dockedballoon-anchor[aria-controls='${s}']`).length))?2:0};this._dismissHandle={dismissFn:()=>{this.cancelBtn?ko.unwrap(this.cancelBtn.onClick)():"function"==typeof this.options.onButtonClick&&this.options.onButtonClick(1)},shouldDismissOnMouseDownFn:i,shouldDismissOnMouseWheelFn:i,restoreFocus:()=>{const e=this.element[0],t=document.activeElement;($.contains(e,t)||t===e)&&r.validatePreviousFocusedElement(this._dismissHandle,P)&&P.focus()},logName:"messagebox"},t.confirmationRequired&&(this.checkboxVm=p.create(s,{label:t.confirmationMessage,labelOnRight:!0})),this._getButtonHtml(t.buttons,s),this._bindDescendants(),this._setAria();let o=document.activeElement;t.sourceTarget&&(this.element[0]===t.sourceTarget||t.sourceTarget.contains(document.activeElement)||(o=t.sourceTarget)),new a.KeyboardNavigation(this.ltm,{element:e,tabTriggers:2}),w(e,o),r.register(this._dismissHandle),s.registerForDispose((()=>{this._dismissHandle.restoreFocus(),r.unregister(this._dismissHandle)})),t.confirmationRequired&&(this.checkboxVm.value(!1),ko.reactor(s,(()=>{this.defaultBtn.disabled(!this.checkboxVm.value())})))}dispose(){this._cleanElement(M,y,b,v),super.dispose()}generateBtns(e,t){if(0===t.length)return;const s=this.buttonVms,i=(e,t,s)=>c.create(e,{text:s.text,style:t,disabled:s.disabled,onClick:()=>{"function"==typeof this.options.onButtonClick&&this.options.onButtonClick(s.result),this._dismissHandle.restoreFocus()}});s().forEach((e=>{e.vm.dispose()})),s().length=0,s([]),this.defaultBtn=null,this.cancelBtn=null,this.extraBtn=null,t.forEach(((t,o)=>{switch(0===o&&1!==t.kind&&4!==t.kind&&g.error("The first button should be the default button for this dialog."),!this.defaultBtn||1!==t.kind&&4!==t.kind||g.error("Only one default button should be defined."),this.cancelBtn&&2===t.kind&&g.error("Only one cancel button should be defined."),t.kind){case 1:s.push({vm:i(e,0,t),result:t.result}),this.defaultBtn=MsPortalFx.last(s()).vm;break;case 2:s.push({vm:i(e,1,t),result:t.result}),this.cancelBtn=MsPortalFx.last(s()).vm;break;case 4:s.push({vm:i(e,2,t),result:t.result}),this.defaultBtn=MsPortalFx.last(s()).vm;break;default:s.push({vm:i(e,1,t),result:t.result}),this.extraBtn=MsPortalFx.last(s()).vm}})),1===t.length&&(this.cancelBtn=this.defaultBtn),MsPortalFx.isNullOrUndefined(this.cancelBtn)&&g.error("Cancel button should be defined.")}_getButtonHtml(e,t){const s=this.options;if(s.customBtns)this.generateBtns(t,s.customBtns);else{switch(e){case 0:this.generateBtns(t,[{kind:1,text:f.retry,result:5},{kind:2,text:f.abort,result:0},{kind:3,text:f.ignore,result:2}]);break;case 1:this.generateBtns(t,[{kind:1,text:f.ok,result:4}]);break;case 2:this.generateBtns(t,[{kind:1,text:f.ok,result:4},{kind:2,text:f.cancel,result:1}]);break;case 3:this.generateBtns(t,[{kind:1,text:f.retry,result:5},{kind:2,text:f.cancel,result:1}]);break;case 4:this.generateBtns(t,[{kind:1,text:f.yes,result:6},{kind:2,text:f.no,result:3}]);break;case 5:this.generateBtns(t,[{kind:1,text:f.yes,result:6},{kind:3,text:f.no,result:3},{kind:2,text:f.cancel,result:1}]);break;case 6:this.generateBtns(t,[{kind:4,text:f.delete,result:7},{kind:2,text:f.cancel,result:1}]);break;case 7:this.generateBtns(t,[{kind:4,text:f.delete,result:7},{kind:2,text:f.goBack,result:8}]);break;default:throw new Error("Could not locate message box button of type {0}.".format(e))}this.defaultBtn&&s.defaultButtonText&&this.defaultBtn.text(s.defaultButtonText),this.cancelBtn&&s.cancelButtonText&&this.cancelBtn.text(s.cancelButtonText),this.extraBtn&&s.extraButtonText&&this.extraBtn.text(s.extraButtonText)}}_setAria(){const e=this.element,t=e.findByClassName(I),s=h(),i=h();e.attr({role:"dialog","aria-labelledby":i,"aria-describedby":t.length?s:null}),e.find("h2").attr("id",i),t.attr("id",s),this.ltm.registerForDispose((()=>{e.removeAttr("role aria-labelledby aria-describedby tabindex")}))}}t.Widget=S,t.createMessageBoxWithCallback=function(e,t,s,i){const o=new _;return o.title(s.title),s.templateViewModel?(o.template(s.text),o.templateViewModel(s.templateViewModel)):o.text(s.text),o.buttons=s.buttons,o.onButtonClick=e=>{t(e)},o.modal=i.modal,o.trustedTemplate=i.trustedTemplate,o.defaultButtonText=s.defaultButtonText,o.cancelButtonText=s.cancelButtonText,o.extraButtonText=s.extraButtonText,o.confirmationRequired=s.confirmationRequired,o.confirmationMessage=s.confirmationMessage,o.hideTitle=s.hideTitle,o.scopeClass=i.scopeClass,o.sourceTarget=i.sourceTarget,new S(e,o)},t.createMessageBoxWithCallback2=function(e,t,s,i){s.positionHint=s.positionHint||3;const n=new _;n.title(s.title),"object"==typeof s.content?(n.template(s.content.htmlTemplate),n.templateViewModel(s.content.viewModel)):"string"==typeof s.content&&n.text(s.content),Array.isArray(s.buttons)?(n.customBtns=[],s.buttons.forEach((e=>{const t=e.displayText||x[e.button];n.customBtns.push({kind:3,text:t,result:e.button,disabled:e.disabled})})),n.customBtns.length&&(n.customBtns[0].kind=1,n.customBtns.length>1&&(MsPortalFx.last(n.customBtns).kind=2))):n.buttons=s.buttons,n.modal=i.modal,n.trustedTemplate=i.trustedTemplate,n.hideTitle=s.hideTitle,n.scopeClass=i.scopeClass;const r=new S(e,n),a=r.buttonVms()[0],l=a&&a.result;return n.onButtonClick=s=>{l===s?o.ensureFormFieldValidation(e,!0).then((i=>{i?t(s):o.focusOnFirstInvalidField(e)})).catch($.noop):t(s)},r}})),
define("MsPortalImpl/Widgets/Dialogs/Widgets.FormDialog",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox","FxInternal/Controls/Section","Fx/Controls/Section","MsPortalImpl/Resources/ImplScriptResources","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox.css"],(function(e,t,s,i,o,n,r,a,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createFormDialogWithCallback=t.Widget=t.ViewModel=void 0,(0,d.injectCss)(c);const p="fxs-formdialog",u=s(i.Root,null,s("div",{class:"fxs-formdialog-description fxs-messagebox-text","data-bind":{text:"description"}}),s("div",{class:"fxs-formdialog-form msportalfx-form","data-bind":{pcControl:"formSection"}}));class m extends n.ViewModel{constructor(e,t){if(super(),this.diContainer=t,this.lifetime=new FxImpl.TriggerableLifetimeManager,MsPortalFx.isNullOrUndefined(e))throw new Error("dialogOptions must be specified for rendering a form dialog.");const s=[[e.row1column1,e.row1column2],[e.row2column1,e.row2column2]],i=this.lifetime,o=s.map((e=>{const t=e.filter(MsPortalFx.identity).map((e=>r.create(i,{style:0,children:[e]})));if(t.length)return r.create(i,{style:3,children:t})})).filter(MsPortalFx.identity),n=a.create(i,{children:o});this.title(e.title),this.customBtns=[{kind:1,result:4,text:l.Dialogs.okButtonText,disabled:ko.computed(i,(()=>!n.valid()))},{kind:2,result:1,text:l.Dialogs.cancelButtonText}],this.template(u),this.templateViewModel({description:e.description,formSection:n}),this.trustedTemplate=!0}dispose(){this.lifetime.dispose()}}t.ViewModel=m;class g extends n.Widget{constructor(e,t){super(e,t),e.addClass(p)}dispose(){this.options.dispose(),this._cleanElement(p),super.dispose()}}t.Widget=g,t.createFormDialogWithCallback=function(e,t,s){const i=new m(s);return i.onButtonClick=s=>{4===s?o.ensureFormFieldValidation(e,!0).then((i=>{i?t(s):o.focusOnFirstInvalidField(e)})):t(s)},new g(e,i)}})),
define("_generated/Less/MsPortalImpl/Widgets/Dialogs/Widgets.ListPopup.css",["module"],(function(e){"use strict";return{css:".fxs-listpopup{display:inline-block;cursor:default;position:absolute;left:0;width:200px;max-height:300px;z-index:200;overflow-y:auto;box-sizing:border-box}.fxs-listpopup-list{list-style-type:none;padding:0;max-height:300px}.fxs-listpopup-item{font-size:13px;line-height:normal;display:flex;align-items:center;flex:0 0 auto;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;position:relative;box-sizing:border-box;padding:0 10px;border:0;overflow:visible;text-align:left;height:35px;cursor:pointer}",moduleId:e.id}})),
define("MsPortalImpl/Widgets/Dialogs/Widgets.ListPopup",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Widgets/Widgets.WidgetBase","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Dialogs/Widgets.ListPopup.css"],(function(e,t,s,i,o,n,r,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createListPopupWithCallback=t.Widget=t.ViewModel=void 0,(0,a.injectCss)(l);var d=MsPortalFx.Base.Diagnostics;const c=".fxs-commandBar-item",p=".azc-toolbarButton-container:first",u="fxs-listpopup",m=d.createLog(e),g="fxs-portal-bg-txt-br",h="msportalfx-shadow-level2",f="fxs-popup",x="fxs-listpopup-list",b="fxs-listpopup-item",v=`.${b}`,y=s("ul",{class:x,"data-bind":{foreach:"func._items"},role:"menu"},s("li",{role:"menuitemradio",class:[b,"fxs-portal-hover"],tabindex:"-1","data-bind":{text:"text",css:{"fxs-listpopup-item-selected fxs-portal-selected fxs-portal-activated fxs-br-primary":"text === $root.data.dialogOptions.selectedItem()"},event:{click:"onClick",keydown:"onKeyDown"},attr:{title:"text","aria-setsize":"$parent.func._items().length","aria-posinset":"$index() + 1","aria-checked":'text === $root.data.dialogOptions.selectedItem() ? "true" : "false"'}}}));class M extends r.ViewModel{}t.ViewModel=M;class I extends r.Widget{constructor(e,t){super(e,t),t.dialogOptions||m.error("dialogOptions must be specified for rendering a list popup.");const s=document.activeElement,r=t=>t===s||$.contains(s,t)||e[0]===t||$.contains(e[0],t)?0:2,a=this._dismissHandle={dismissFn:()=>{const e=t.onLostFocus;e&&e()},shouldDismissOnFocusOutFn:r,shouldDismissOnMouseDownFn:r,shouldDismissOnMouseWheelFn:r,restoreFocus:()=>{i.validatePreviousFocusedElement(a,s)&&s.focus()},logName:"listpopup"};this._items=ko.computed(this.ltm,(()=>{const e=e=>{"function"==typeof t.onItemSelected&&(t.dialogOptions.selectedItem(e),t.onItemSelected(),a.restoreFocus())};return t.dialogOptions.listItems().map((t=>({text:t,onClick:(s,i)=>{i.stopPropagation(),e(t)},onKeyDown:(s,i)=>{if(13!==i.keyCode&&32!==i.keyCode||0!==o.getModifierKeys(i))return!0;i.stopPropagation(),e(t)}})))})),e.addClass(`${u} fxs-popup ${g} ${h}`).html(y),new n.KeyboardNavigation(this.ltm,{element:e.find(`.${x}`),tabTriggers:12,itemSelector:v}),e.closest(c).find(p).attr("aria-expanded","true"),this._bindDescendants(),Q.nextTick((()=>{this.setFocus()})),i.register(a)}dispose(){i.unregister(this._dismissHandle),this._cleanElement(u,f,g,h),this.element.removeAttr("tabindex").closest(c).find(p).attr("aria-expanded","false"),super.dispose()}setFocus(){this.element.find(v).first().focus()}}t.Widget=I,t.createListPopupWithCallback=function(e,t,s,i){const o=new M;return o.dialogOptions=i,o.onItemSelected=()=>{s(4)},o.onLostFocus=e,new I(t,o)}})),
define("MsPortalImpl/Widgets/Dialogs/Widgets.ProgressBox",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox.css"],(function(e,t,s,i,o,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createProgressBox=t.Widget=t.ViewModel=void 0,(0,r.injectCss)(a);const l=o.Dialogs.ProgressBar,d="fxs-progressbox",c=s(i.Root,null,s("div",{"data-bind":{text:"data.text"},class:"fxs-progressbox-text fxs-messagebox-text"}),s("div",{"data-bind":{text:"data.completionText"},class:"fxs-progressbox-progressbar"}));class p extends n.ViewModel{constructor(e,t){super(),this.text=ko.observable(),this.completionPercentage=ko.observable(-1),ko.isObservable(e)&&(this.text=e),ko.isObservable(t)&&(this.completionPercentage=t),this.completionText=ko.pureComputed((()=>{const e=this.completionPercentage();return e<0||e>100?"":l.percentComplete.format(e)})),this.template(c),this.templateViewModel({data:{text:this.text,completionText:this.completionText}}),this.trustedTemplate=!0}}t.ViewModel=p;class u extends n.Widget{constructor(e,t){super(e,t),e.addClass(d)}dispose(){this._cleanElement(d),super.dispose()}}t.Widget=u,t.createProgressBox=function(e,t){const s=new p(t.text,t.completionPercentage);return s.title(t.title),s.customBtns=[],new u(e,s)}})),
define("_generated/MsPortalImpl/Svg/Startup/Error.svg",["require","exports"],(function(e,t){"use strict";return{type:77,data:"<svg viewBox='0 0 2048 2048' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M960 0q133 0 255 34t230 96 194 150 150 195 97 229 34 256q0 133-34 255t-96 230-150 194-195 150-229 97-256 34q-133 0-255-34t-230-96-194-150-150-195-97-229T0 960q0-133 34-255t96-230 150-194 195-150 229-97T960 0zm0 1792q114 0 220-30t199-84 169-130 130-168 84-199 30-221q0-114-30-220t-84-199-130-169-168-130-199-84-221-30q-115 0-221 30t-198 84-169 130-130 168-84 199-30 221q0 114 30 220t84 199 130 169 168 130 199 84 221 30zM896 512h128v640H896V512zm0 768h128v128H896v-128z'/></g></svg>"}})),
define("MsPortalImpl/UI/UI.DialogManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Dialogs/MessageBoxInternal","MsPortalImpl/Base/Themes","MsPortalImpl/Widgets/Dialogs/Widgets.FormDialog","MsPortalImpl/Widgets/Dialogs/Widgets.ListPopup","MsPortalImpl/Services/Services.PortalIdleState","MsPortalImpl/Widgets/Dialogs/Widgets.ProgressBox","_generated/MsPortalImpl/Svg/Startup/Error.svg","_generated/MsPortalImpl/Svg/Startup/Warning.svg","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox","MsPortalImpl/Base/Base.SvgHelper","FxInternal/Composition/ContainerViewModel"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DialogManager=t.MessageBox=void 0;var f=MsPortalFx.Base,x=f.Diagnostics,b=x.Telemetry;const v=$(window.document.body),y=x.createLog(e);function M(e){return"The {0} used to render the dialog was not specified.".format(e)}t.MessageBox=i.MessageBoxExtended;class I{constructor(e,t){this._portalIdleService=e,this._diContainer=t}get hasOpenDialog(){return!!this._dismissOpenDialog}dismissOpenDialog(e){this._dismissOpenDialog&&(this._dismissOpenDialog(e),this._dismissOpenDialog=null)}showModalDialog(e){const s=$(FxImpl.createElement("div",{class:"fxs-portal-shield-icon"})),i=$(FxImpl.createElement("div")),o=$(FxImpl.createElement("div",{class:"fxs-portal-shield-modaldialog"}));o.append(s,i);const n=$(FxImpl.createElement("div",{class:"fxs-portal-shield-middle"})),r=$(FxImpl.createElement("div",{class:"fxs-portal-shield"}));let a,l;n.append(o),r.append(n),v.append(r),e.showErrorIcon?(a=g.getSvgReferenceOrFallBackToData(MsPortalFx.extend2(d,{data:P(d.data,"msportalfx-svg-c22")})),l="fxs-portal-shield-icon-error"):(a=g.getSvgReferenceOrFallBackToData(MsPortalFx.extend2(c,{data:P(c.data,"msportalfx-svg-c10")})),l="fxs-portal-shield-icon-warning"),s.empty().addClass(l).append(a),this._currentCancelToken&&(this._currentCancelToken.cancel(),this._currentCancelToken=null);const p=new t.MessageBox(e.title,e.description,e.buttons);return p.defaultButtonText=e.defaultButtonText,p.cancelButtonText=e.cancelButtonText,p.templateViewModel=e.templateViewModel,this._showDialog(i,p,{modal:!0,trustedTemplate:!0,locator:null}).then((t=>{const i=e.uiShield&&e.uiShield.hidePromise;return i?(this._currentCancelToken=new f.Promises.CancelationToken,f.Promises.makeCancelable(i,this._currentCancelToken).then((()=>{r.remove()}))):r.remove(),s.removeClass(l),t})).finally((()=>{this._portalIdleService.signalBusy()}))}showDialog(e,t,s,i){if(!e)throw new Error(M("dialogOptions"));if(!t)throw new Error(M("formTarget"));if(!s)throw new Error(M("sourceTarget"));(i=i||{}).modal=!1,i.sourceTarget=s,this.dismissOpenDialog();const o=$(S(t.getForm())),n=this._showDialog(o,e,i,t);return t.showForm(s,{modal:!1,positionHint:e.positionHint||6}),n}showShellDialog(e,t,s,i){if(!e)return Q.reject(M("dialogOptions"));if(!t)return Q.reject(M("formTarget"));if(!s)return Q.reject(M("sourceTarget"));const o=Q.defer();i=i||{},this.dismissOpenDialog();const{element:n,ltm:r}=function(e){if(e)return e instanceof Element?{element:e,ltm:(ko.dataFor(e).func||ko.contextFor(e).$ctl).ltm}:e}(t.getForm()),a=$(n),l=this._showDialog(a,e,i,t);return t.showForm(s,{modal:i.modal||!1,positionHint:e.positionHint||6}),r.registerForDispose([a.setEvents(["closed",()=>{o.resolve(1)}])]),l.then(o.resolve).catch(o.reject),o.promise}_showDialog(e,t,s,i){return Q(MsPortalFx.tryImmediateResolve(this._diContainer.getAsync(o.ThemeManager),(()=>{const o=Q.defer(),a=e=>{s.syncCallback&&s.syncCallback(e),o.resolve(e)},d=()=>{i&&i.hideForm()},c=t.telemetryName;let g=s.locator;g||s.modal||(g=function(e,t){const s=e.closest(".fxs-tile").data(p.CompositionInstanceDataName);let i;s&&(0,p.isPartComposition)(s)?i=s.locator:t||y.error("Unable to determine the extension that opened the dialog. "+MsPortalFx.getCurrentCallStack(!0));return i}(e,s.sideload)),4!==t.type&&(e=function(e){const t=e.closest(".fxs-bladecontent"),s=u.Widget.getWidgets(t);if(s&&s.length){const t=s[0];e=$(S(t.getForm()))}return e}(e));const f=function(e,t,s,i,o){let a;switch(s.type){case 1:a=m.createMessageBoxWithCallback(t,o,s,i);break;case 2:a=l.createProgressBox(t,s);break;case 4:a=r.createListPopupWithCallback((()=>{e.dismissOpenDialog()}),t,o,s);break;case 3:a=n.createFormDialogWithCallback(t,o,s);break;case h.Dlg2:a=m.createMessageBoxWithCallback2(t,o,s,i)}return a}(this,e,t,s,a);return function(e,t){_("DialogOpened",e,t)}(g,c),f?(this._dismissOpenDialog=e=>{f.dispose(),d(),MsPortalFx.isNullOrUndefined(e)?(w(g,"Dismissed",c),o.reject()):(a(e),w(g,e,c))},o.promise.then((e=>(f.dispose(),this._dismissOpenDialog=null,d(),w(g,e,c),e)))):(d(),w(g,"InvalidDialogType",c),o.reject("Invalid type specified in dialogOptions.")),o.promise})))}}class C{static create(e,t){return new I(e,t)}}function P(e,t){const s=MsPortalFx.getUniqueId();return MsPortalFx.replaceAll(MsPortalFx.replaceAll(MsPortalFx.replaceAll(e,t,s),"msportalfx-svg-c01",t),s,"msportalfx-svg-c01")}function w(e,t,s){_("DialogClosed",e,s,t+"")}function _(e,t,s,i){s=s?"/"+s:"fxDefault";const o=`${t&&t.toFriendlyString()}/${s}`;b.trace({source:"Shell",name:o,action:e,extension:t&&t.getExtensionName(),data:i})}function S(e){return e&&(e instanceof Element?e:e.element)}__decorate([__metadata("fx:diagnostics",[e,"DialogManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[a.PortalIdleStateService,s.Container]),__metadata("design:returntype",C)],C,"create",null),t.DialogManager=C})),
define("MsPortalImpl/UI/Hubs/UI.NotificationManager",["require","exports","Fx/Ajax","Fx/DependencyInjection","Fx/Composition/Selectable","FxInternal/Notifications","FxInternal/RpcEndPoints","Fx/ResourceManagement","FxInternal/AsyncLoader","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Resources/PortalNotificationsTelemetry","MsPortalImpl/UI/UI.BladeOpener","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/UI/Commands/Base.PortalFunctions","Weave"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g,h,f,x,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEV=t.addNotificationHandler=t.addNotification2Handler=t.updateNotificationHandler=t.showModalNotificationHandler=t.addFxNotificationsDefinition=t.addClientNotificationsDefinition=t.addClientNotificationDefinition=t.NotificationHandler=t.NotificationManager=t.getNotificationManager=t.createNotificationManager=t.getNotificationData=t.NotificationsToPollList=void 0;var v=MsPortalFx.Base,y=v.Constants.AssetNames,M=v.Diagnostics,I=M.Telemetry,C=i.Container,P=MsPortalFx.Hubs.Notifications,w=P.ClientNotification,_=P.NotificationStatus,S=FxImpl.Hubs.Notifications,F=S.ClientNotificationUriAction,k=FxImpl.NotificationManager,T=MsPortalFx.extend;const D=window;M.createLog(e);let E;const B=m.Source.NotificationHub,A=F.OpenInNewTab,N=MsPortalFx.getLogFriendlyMessage,O=Object.entries,R=Object.keys,L=new RegExp(/\bhttps:\/\/[a-z0-9][^\s"]*/,"gi");t.NotificationsToPollList="NotificationsToPollList";const z=new WeakMap;function H(e){let t;return e&&(t=z.get(e),t||z.set(e,t={extensionName:void 0,userVote:(0,b.makeWritableComputation)()})),t}function U(e,t,s){Y(B,m.Action.PollingNotification,m.ActionModifier.MissingResponseValues,{createdAt:new Date(e.createdTime),descriptionFormatFailure:!t,errorReason:null==s?void 0:s.message,extensionName:e.extensionName,failedAt:new Date,notificationId:e.originalNotification.id,titleFormatFailure:t,uri:e.uri})}function W(e,t,s,i){var o,r;let a={};n.CnpProps.forEach((s=>{a=T(a,s in t?{[s]:t[s]}:{[s]:e[s]})})),a=T(a,{id:e.id}),e.isInternal&&(a=T(a,{toastDuration:null!==(r=null!==(o=t.toastDuration)&&void 0!==o?o:e.toastDuration)&&void 0!==r?r:0}));const l=t.title;if(l.indexOf("{{$")>-1&&-1<l.indexOf("}}"))try{const e=V(s,l);a=T(a,{title:e})}catch(e){return U(i,!0,e),null}const d="object"==typeof t.description?t.description.htmlTemplate:t.description;if(d.indexOf("{{$")>-1&&-1<d.indexOf("}}"))try{const e=V(s,d);a="string"==typeof a.description?T(a,{description:e}):T(a,{description:T(a.description,{htmlTemplate:e})})}catch(e){return U(i,!1,e),null}return a}function V(e,t){const s=null==e?void 0:e.content,i=t.split("{{$").length-1,o=t.split("}}").length-1;if(!s)throw new Error("The was no response.content to use for formatting. stringToBeFormatted: "+t);if(i>o)throw new Error("Not enough closing }} format bounds to match the number of {{$ bounds present in string. stringToBeFormatted: "+t);const r=t.match(n.titleAndDescriptionRegex);if(i!==r.length)throw new Error(`Found ${i<r.length?"more ":"less "} matches than there should have been.`);const a=r.map((e=>e.replace("{{","").replace("}}",""))).map((e=>{if("$"===e)return JSON.stringify(s);const t=e.split(".");if(t.length<=1)throw new Error("Invalid format of the dot delimited search string. "+e);t.shift();let i=s;for(let e=0;e<t.length;e++){if("object"!=typeof i)throw new Error(`There was neither an object, nor an array after applying ${t[e-1]} to use the following key value on ${t[e]}. Instead, ${i} was found.`);const s=t[e];if(Array.isArray(i)&&isNaN(Number(s)))throw new Error(`Searching the response content using inline format keys found an array type [${i.join(", ")}], but the following key "${s}" was not a numeric index.`);if(!Array.isArray(i)&&!Object.keys(i).some((e=>e===s)))throw new Error(`Searching the response content using inline format keys found an object {} type ${JSON.stringify(i)}, but the following key "${s}" was not found`);try{i=i[s]}catch(e){throw new Error("Unexpected error encountered while drilling into response content to retrieve desired format value."+MsPortalFx.getLogFriendlyMessage(e))}}return i}));let l=t;return r.forEach(((e,t)=>{l=l.replace(e,a[t])})),l}function j(e,t){const s=(0,p.getBladeDeepLink)(t.extension,t.detailBlade,t.detailBladeInputs),i={deepLink:s,openedBy:6};e.get(x.RoutePortalFunc).invoke({uri:s,openedByContext:i},B)}function q(e){return e&&e.trim()}function $(e){if(e.additionalProperties||(e.additionalProperties={}),!e.additionalProperties.subscriptionId){const t=e.asset,s=t&&t.assetId,i=a.ArmId.parse(s,!0).subscription;e.additionalProperties.subscriptionId=i}}function G(e){return $(e),FxImpl.ViewModels.getBladeSelection("Microsoft_Azure_ActivityLog","ActivityLogBlade",{queryInputs:{correlatedEvents:{correlationId:e.correlationIds[0],duration:e.timestamp.getMinutes(),subscriptionId:(e.additionalProperties||{}).subscriptionId||null}}})}function K(e){switch(e){case 0:return _.Error;case 1:return _.Warning;case 2:return _.Success;case 3:return _.InProgress;case 4:return _.Information}}t.getNotificationData=H,t.createNotificationManager=function(e){return E=e.get(oe)},t.getNotificationManager=function(){return E};const J=e=>(t,s)=>{const i=s.srcWindowId;if(i){MsPortalFx.merge(t).forEach((t=>{const s=i+"#";t.notificationId.startsWith(s)||(t.notificationId=s+t.notificationId),e._addOrUpdateNotification(t,i)}))}};class X{constructor(e,t){this.extensionWindowId=e,this.notificationDefinition=t}}function Y(e,t,s,i){I.trace({source:e,action:t,actionModifier:s,data:null!=i?i:Object.create(null)})}function Z(e,t){var s;const i=e.additionalProperties||{},o=e.correlationIds,n=e.asset||{};T(i,{status:_[e.status],correlationId:o&&o.join(","),asset:n,notificationId:null!==(s=e.notificationId)&&void 0!==s?s:e.id}),Y(B,t,null,i)}function ee(e,t){Y(B,m.Action.DeprecatedNotificationApiCalled,null,{extensionName:e,handlerCalled:t})}function te(e,t){if(e&&t)return`${e}.${t}`}class se{constructor(){this.notificationTable=Object.create(null)}_encode(e){return e.join("~")}add(e){const t=this._encode(e);this.notificationTable[t]||(this.notificationTable[t]=Date.now(),Y(B,m.Action.InProgressNotification,m.ActionModifier.InProgressStarted,{createdAt:this.notificationTable[t],ids:t}))}report(e,t){const s=this._encode(e),i=this.notificationTable[s];i&&(Y(B,m.Action.InProgressNotification,m.ActionModifier.InProgressFinished,{createdAt:i,duration:Date.now()-i,ids:s,status:t}),this.notificationTable[s]=0)}}class ie{constructor(){this._notificationTable=Object.create(null);try{const e=JSON.parse(MsPortalImpl.sessionStorage.getItem(t.NotificationsToPollList)||Object.create(null));let s=Object.create(null);R(this._notificationTable).length&&(s=this._notificationTable),this._notificationTable=e,O(s).forEach((e=>{this._notificationTable[e[0]]=e[1]}))}catch(e){Y(B,m.Action.PollingNotification,m.ActionModifier.FailedToFetchNotificationsToStorage,{error:N(e),failedAt:new Date})}setTimeout((()=>{setInterval((()=>{const e=(new Date).getTime();this._cleanOutOldNotifications(e);const t=this._findNotificationsForPolling(e);t.length&&this._pollNotifications(t)}),5e3)}),6e4)}_cleanOutOldNotifications(e){let s=!1;if(R(this._notificationTable).filter((t=>{var s,i,o,n,r,a;const l=null===(s=this._notificationTable[t])||void 0===s?void 0:s.createdTime,d=null!==(a=null===(r=null===(n=null===(o=null===(i=this._notificationTable[t])||void 0===i?void 0:i.originalNotification)||void 0===o?void 0:o.pollingDetails)||void 0===n?void 0:n.pollingTimeout)||void 0===r?void 0:r.timeoutInMs)&&void 0!==a?a:864e5;return e-l>=864e5||e-l>=d})).forEach((e=>{const t=this._notificationTable[e];Y(B,m.Action.PollingNotification,m.ActionModifier.PollingTimedOut,{createdAt:new Date(null==t?void 0:t.createdTime),extensionName:null==t?void 0:t.extensionName,failedAt:new Date,notificationId:e,uri:null==t?void 0:t.uri}),this._handleFailedPollingAttempt(t,!0),this._notificationTable[e]=null,delete this._notificationTable[e],s=!0})),s)try{MsPortalImpl.sessionStorage.setItem(t.NotificationsToPollList,JSON.stringify(this._notificationTable))}catch(e){Y(B,m.Action.PollingNotification,m.ActionModifier.FailedToWriteNotificationsToStorage,{error:N(e)})}}_findNotificationsForPolling(e){const t=[];return R(this._notificationTable).filter((e=>!!this._notificationTable[e]&&!this._notificationTable[e].isPolling)).forEach((s=>{var i,o;const n=this._notificationTable[s];(function(e,t,s,i){const o=s-t,n=s-e;let r=6e4;return o<=12e4?r=5e3:o<=36e4?r=15e3:o<=66e4&&(r=3e4),(i=isNaN(i)?0:Number(i))>r?n>=i:n>=r})(null==n?void 0:n.lastTimePolled,null==n?void 0:n.createdTime,e,null===(o=null===(i=null==n?void 0:n.originalNotification)||void 0===i?void 0:i.pollingDetails)||void 0===o?void 0:o.customDelayInMs)&&(n.isPolling=!0,t.push(n))})),t}_handleFailedPollingAttempt(t,s){var i,o;const n=MsPortalFx.clone((null==t?void 0:t.originalNotification)||Object.create(null),!0,!0),r=(null==n?void 0:n.pollingDetails)||Object.create(null);let a=s&&null!==(o=null===(i=r.pollingTimeout)||void 0===i?void 0:i.failureNotification)&&void 0!==o?o:r.defaultFailureNotification;if(a){a=T(a,{status:2});const t=W(n,a);MsPortalFx.require(e.normalize("FxInternal/Notifications")).then((e=>{e.publishNotification(t)}))}}_pollNotifications(i){const o=i.map((e=>{const t={setTelemetryHeader:"PollingNotificationAPI_Polling",type:"GET",uri:e.uri};return(0,s.batch)(t)}));Q.allSettled(o).then((e=>{const t=[];return e.forEach((e=>{var s;(null===(s=e.reason)||void 0===s?void 0:s.content)&&t.push(e.reason),e.value&&t.push(e.value)})),t})).then((s=>{const o=[];s.forEach(((t,s)=>{var r,a;const l=t.httpStatusCode,d=t.content,c=null===(a=null===(r=i[s])||void 0===r?void 0:r.originalNotification)||void 0===a?void 0:a.id,p=this._notificationTable[c];if(!p){const e=i[s]||Object.create(null);return void Y(B,m.Action.PollingNotification,m.ActionModifier.PollingNotificationNotFound,{code:l,createdAt:new Date(e.createdTime),extensionName:e.extensionName,notificationId:c,uri:e.uri})}p.lastTimePolled=(new Date).getTime();const u=p.originalNotification,g=u.pollingDetails;if(((null==g?void 0:g.keepPollingCodes)||[]).includes(l))return void(p.isPolling=!1);const h=n.fetchNotificationPollingResponseDetails(null==g?void 0:g.responseNotificationByStatusCode,l);if(h){let s=h.notification;const i=h.requiredResponseValue;let n,r=!0;if(i){r=function(e,t){try{let s=t;return e.location.forEach((e=>s=s[e])),s===e.value}catch(e){return!1}}(i,d);const e=i.failureNotification;if(!r&&!e)return void(p.isPolling=!1);let t;e&&(t=T(e,{status:2})),s=!r&&t?t:s}if(n=r?W(u,s,t,p):W(u,s),n)return o.push(c),void MsPortalFx.require(e.normalize("FxInternal/Notifications")).then((e=>{e.publishNotification(n)}));const a=T(g.defaultFailureNotification,{status:2});return n=W(u,a),o.push(c),void MsPortalFx.require(e.normalize("FxInternal/Notifications")).then((e=>{e.publishNotification(n)}))}o.push(c),this._handleFailedPollingAttempt(this._notificationTable[c],!1),Y(B,m.Action.PollingNotification,m.ActionModifier.PollingFailed,{code:l,createdAt:new Date(p.createdTime),error:N((t.headers||Object.create(null))["x-ms-failure-cause"]),extensionName:p.extensionName,notificationId:c,uri:p.uri})})),o.forEach((e=>{this._notificationTable[e]=null,delete this._notificationTable[e]}));try{MsPortalImpl.sessionStorage.setItem(t.NotificationsToPollList,JSON.stringify(this._notificationTable))}catch(e){Y(B,m.Action.PollingNotification,m.ActionModifier.FailedToWriteNotificationsToStorage,{error:N(e)})}})).catch((e=>{Y(B,m.Action.PollingNotification,m.ActionModifier.PollingError,{error:N(e),extensionNames:i.map((e=>e.extensionName)),notificationIds:i.map((e=>{var t;return null===(t=e.originalNotification)||void 0===t?void 0:t.id})),uris:i.map((e=>e.uri))})}))}add(e,s){var i;const o=e.id;if(this._notificationTable[o])return;const n=null===(i=null==e?void 0:e.pollingDetails)||void 0===i?void 0:i.uri;this._notificationTable[o]={createdTime:(null==e?void 0:e.timestamp.getTime())||(new Date).getTime(),extensionName:s,isPolling:!1,lastTimePolled:(new Date).getTime(),originalNotification:e,uri:n},Y(B,m.Action.PollingNotification,m.ActionModifier.PollingRegistered,{createdAt:null==e?void 0:e.timestamp,extensionName:s,notificationId:o,registeredTime:this._notificationTable[o].lastTimePolled,uri:n});try{MsPortalImpl.sessionStorage.setItem(t.NotificationsToPollList,JSON.stringify(this._notificationTable))}catch(e){Y(B,m.Action.PollingNotification,m.ActionModifier.FailedToWriteNotificationsToStorage,{error:N(e)})}}}let oe=class{constructor(e,t){this._rpcClient=e,this._diContainer=t,this.notifications=ko.observableArray(),this._notificationDefinitions={},this._extensionNotifications={},this._serverEventToNotificationMap={},this._extensionsHeldByCorrelationId={},this._inProgressLookupTable=new se,this._pollingNotificationLookupTable=new ie,this.addNotifications=(e,t)=>{const s=t;s&&this.itemsPromise.finally((()=>{let t=e.notifications.map((e=>this._mapFxNotificationV1ToClientNotification(e)));t=t.filter((e=>!!e)),t.forEach((e=>this._addOrUpdateNotification(e,s)))}))},this.addNotification2=(e,t)=>{const s=t;s&&this.itemsPromise.finally((()=>{const t=this._mapNotificationV2ToClientNotification(s,e.id,e.name,e.status,e.subStatus,e.assetId,e.properties);this._addOrUpdateNotification(t,s)}))},this.updateNotification=e=>{this.itemsPromise.finally((()=>{const t=MsPortalFx.find(this.notifications(),(t=>(t.correlationIds||[]).some((t=>t.toLowerCase()===e.id))));if(t){const s=e.propertyName.toLowerCase(),i=e.propertyValue;let o=t.correlationIds;"correlationid"===s?(o||(t.correlationIds=o=[]),o.push(i),this._addOrUpdateNotification(t)):"percentcomplete"===s&&(t.percentComplete=i,this._addOrUpdateNotification(t))}}))},this.showModalNotification=(e,t)=>{const s=t.notification;return this.addClientNotification(s),e.getAsync(f.DialogManager).then((e=>(this.addClientNotification(s),e.showModalDialog({title:s.title,description:s.description,buttons:2,defaultButtonText:t.primaryButtonText,cancelButtonText:t.secondaryButtonText,showErrorIcon:!0})))).then((i=>{let o;return 4===i?o=t.primaryButtonClickAction:1===i&&(o=t.secondaryButtonClickAction),1===o?this.handleNotificationClick(s):2===o&&e.get(h.WindowManager).redirect({uri:"/",reason:"ModalNotificationClickAction_RefreshPortal"}),i}))},this.addServerEvents=e=>{e.forEach((e=>{e&&this.itemsPromise.finally((()=>{this._addServerEvent(e)}))}))},this._rpcClient=t.get(FxImpl.Rpc.Client),this.itemsPromise=t.get(d.ManifestCache).getManifests("assetTypes",((e,t)=>this._collectNotificationDefinitions(e,t)))}registerCustomNotificationsProvider(e){if(this._diContainer.get(FxImpl.Features).isEnabled("enablecustomnotificationsprovider")){const t=new FxImpl.TriggerableLifetimeManager;this.notifications.subscribeAndRun(t,(t=>{e.notifications(t)}))}}addClientNotification(e){$(e),this._addOrUpdateNotification(e)}showNotificationDetails(e){j(this._diContainer,G(e))}handleNotificationClick(e,t){!function(e,t,s){var i,n,r,a,l;Z(t,t.isRecommendation?m.Action.RecommendationClicked:m.Action.NotificationClicked);const d=t.asset||{},u=d.assetType;if(u){const t=u.toLowerCase(),i=d.extensionName.toLowerCase(),o=e.get(c.ExtensionManager);if(s||!o.getExtension("Microsoft_Azure_Monitoring")||i==="Microsoft_Azure_Billing".toLowerCase()&&t===y.SubscriptionDetail.toLowerCase()||i==="HubsExtension".toLowerCase()&&t===y.Deployments.toLowerCase()){const t={deepLink:(0,p.getAssetDeepLink)(e,d),openedBy:6};return void e.get(x.RoutePortalFunc).invoke({uri:t.deepLink,openedByContext:t},B)}}const f=t.uri;if(f){const s=t.uriAction||v.Resources.isUriAbsolute(f)&&A||F.NavigatePortal;if(s===A)e.get(h.WindowManager).openWindow(f);else if(s===F.OpenInCurrentTab)D.location.href=f;else{const t={deepLink:f,openedBy:6};e.get(x.RoutePortalFunc).invoke({uri:f,openedByContext:t},B)}return}const b=t.linkTo;if(b){if("string"==typeof b){const t={deepLink:b,openedBy:6};return void("#"===b.charAt(0)?e.get(x.RoutePortalFunc).invoke({uri:b,openedByContext:t},B):e.get(h.WindowManager).openWindow(b))}if((null===(i=b.parameters)||void 0===i?void 0:i.blade)&&(null===(n=b.parameters)||void 0===n?void 0:n.extension)){const t=(null===(r=b.parameters)||void 0===r?void 0:r.openInContextPane)?1:8,s=new o.PdlBladeReference(b.parameters.blade,b.parameters.extension,{parameters:null===(a=b.parameters)||void 0===a?void 0:a.parameters});return void e.get(g.BladeOpener).openBlade(s,{flags:t,telemetryName:"NotificationManager.linkTo",context:{openedBy:6}})}if(b.parameters){const t=(null===(l=b.parameters)||void 0===l?void 0:l.openInContextPane)?1:8;return void e.get(g.BladeOpener).openBlade(b,{flags:t,telemetryName:"NotificationManager.linkTo",context:{openedBy:6}})}}let M=t.linkedBlade;M||s||(M=G(t)),M&&j(e,M)}(this._diContainer,e,t)}definitionCount(){return R(this._notificationDefinitions).length}newDefinitionCount(){return R(this._extensionNotifications).length}serverEventsCount(){return R(this._serverEventToNotificationMap).length}removeNotification(e){const t=MsPortalFx.find(this.notifications(),(t=>(t.correlationIds||[]).some((t=>t===e))));t&&this.notifications.remove(t)}_addOrUpdateNotification(t,s){if(t&&q(t.title)&&q("string"==typeof(i=t.description)?i:null==i?void 0:i.htmlTemplate)){const i=()=>{var e;if(t.clickable=!!(t.asset||t.linkedBlade||t.uri||t.linkTo),function(e){e.id||e.notificationId||(e.notificationId=w.generateClientNotificationId())}(t),((null===(e=t.inlineForm)||void 0===e?void 0:e.buttons)||t.actions||[]).forEach(((e,t)=>{e.id=e.id||t.toString()})),t.timeSinceNotified||(t.timeSinceNotified=(0,b.makeWritableComputation)(u.NotificationManager.aFewSecondsAgo)),t=function(e,t){var s;if("object"==typeof e.description&&e.description.htmlTemplate)return e;if(null!==e.descriptionAsHtml&&void 0!==e.descriptionAsHtml)return e;const i=e.description,o=i.match(L);if(o&&(null==o?void 0:o.length)>0){let n="",r=0;return o.map((e=>e.trim())).filter((e=>!!e)).forEach((e=>{const t=i.indexOf(e,r);n+=i.substring(r,t),n+=`<a target="_blank" class="msportalfx-ext-link" href="${encodeURI(e)}">${e}</a>`,r=t+e.length})),n=`<div>${n}${i.substring(r)}</div>`,Y(B,"ConvertedLinksInNotificationDescription",null,{correlationIds:e.correlationIds,extensionName:t,id:null!==(s=e.notificationId)&&void 0!==s?s:e.id}),Object.assign(Object.assign({},e),{descriptionAsHtml:!0,description:{htmlTemplate:n}})}return e}(t,s),t.descriptionAsHtml||(t.descriptionAsHtml=!1),t.id||(t.correlationIds||[]).length||(t.correlationIds=[w.generateClientNotificationId()]),!t.correlationIds&&t.id&&(t.correlationIds=[t.id]),t.pollingDetails){if(3!==t.status)return;this._pollingNotificationLookupTable.add(t,s)}3===t.status?this._inProgressLookupTable.add(t.correlationIds):this._inProgressLookupTable.report(t.correlationIds,t.status);let i=this.notifications();const o=MsPortalFx.find(i,(e=>(e.correlationIds||[]).filter((e=>-1!==t.correlationIds.indexOf(e))).length>0));if(o){if(!(o.timestamp.getTime()<t.timestamp.getTime()||3===o.status))return;MsPortalFx.remove(i,o)}else!function(e,t){const s=null==e?void 0:e.additionalProperties,i=(null==e?void 0:e.percentComplete)>-1/0,o=void 0!==(null==e?void 0:e.descriptionAsHtml);(s||i||o)&&Y(B,m.Action.NotificationHasMiscProperties,null,{additionalProperties:s,hasPercentComplete:i,hasSetDescriptionAsHtml:o,extensionName:t})}(t,s);i.unshift(t),3!==t.status&&(i=MsPortalFx.stableSort(i,((e,t)=>3===e.status?3===t.status?0:-1:3===t.status?1:t.timestamp.getTime()-e.timestamp.getTime()))),i.length>100&&i.pop(),this.notifications(i),t.isRecommendation&&Z(t,m.Action.RecommendationAdded),s&&(H(t).extensionName=s,this._holdOntoExtension(s,t))};t.inlineForm||t.actions?MsPortalFx.require(e.normalize("./UI.ActionableNotifications")).then((e=>{e.makeActionable(t,this._diContainer),i()})):(t.formSection=void 0,i())}var i}_addServerEvent(e){if(e.source&&e.operationName){const t=this._serverEventToNotificationMap[te(e.source,e.operationName)];if(t){const s=this._mapNotificationV2ToClientNotification(t.extensionWindowId,e.correlationId,t.notificationName,e.status,e.subStatus,e.assetId,e.properties,e.timestamp,!0);s&&this.addClientNotification(s)}}}_collectNotificationDefinitions(e,t){const s=t.notifications;s&&s.forEach((t=>{const s=te(t.eventSource,t.eventType);this._notificationDefinitions[s]||(this._notificationDefinitions[s]=new X(e,t))}));const i=t.notifications2;i&&i.forEach((t=>{const s=t.name,i=te(e,s);this._extensionNotifications[i]=t;const o=t.serverEvent;if(o&&o.operation&&o.source){const t=te(o.source,o.operation);this._serverEventToNotificationMap[t]={extensionWindowId:e,notificationName:s}}}))}_holdOntoExtension(e,t){const s=t.correlationIds;if(s)if(3===t.status){if(!s.some((e=>!!this._extensionsHeldByCorrelationId[e]))){const t=this._diContainer.get(c.ExtensionManager).getExtension(e);if(t){const i=this._rpcClient.acquireWindow(t.name,6e5);Y(B,m.Action.ExtensionExtended,null,{acquireResult:null==i?void 0:i.getValue(),extensionAcquireDurationInMs:6e5,extensionName:e}),s.forEach((t=>{this._extensionsHeldByCorrelationId[t]=i,i.onDispose((()=>{this._extensionsHeldByCorrelationId[t]&&(delete this._extensionsHeldByCorrelationId[t],Y(B,m.Action.ExtensionDisposed,null,{acquireResult:null==i?void 0:i.getValue(),extensionAcquireDurationInMs:6e5,extensionName:e}))}))}))}}}else s.forEach((e=>{const t=this._extensionsHeldByCorrelationId[e];t&&t.dispose()}))}_mapNotificationV2ToClientNotification(e,t,s,i,o,n,r,a,l=!1){var d,c;const p=this._extensionNotifications[te(e,s)];if(p){let u;const g=p.messages.filter((e=>e.status.toLowerCase()===i.toLowerCase()));if(o?u=MsPortalFx.find(g,(e=>e.subStatus&&e.subStatus.toLowerCase()===o.toLowerCase())):1===g.length&&(u=g[0]),u){let g=u.message;r&&(g=g.format(r));const h={title:u.title,description:g,timestamp:a||new Date,isRecommendation:!1,status:K(u.type),correlationIds:[t],additionalProperties:[],isServerEvent:l};if((u.assetType||p.assetType)&&n){const t=u.assetType||p.assetType;h.asset={extensionName:e,assetType:t,assetId:n}}return Y(B,m.Action.ServerEventMappedToNotification,null,{extensionName:e,operationName:null!==(c=(null!==(d=null==s?void 0:s.split("."))&&void 0!==d?d:[])[1])&&void 0!==c?c:s,status:i,subStatus:o,isServerEvent:l}),h}}return null}_mapFxNotificationV1ToClientNotification(e){const t=this._formatNotificationV1FromExtensionManifest(e);if(t){const e={title:t.label,description:t.description,timestamp:t.timestamp,isRecommendation:!1,percentComplete:t.percentOperationComplete,status:t.state,correlationIds:[],additionalProperties:{}},s=t.clientDetails;return t.assetId&&s&&(e.asset={extensionName:s.assetOwner,assetType:s.assetType,assetId:t.assetId}),t.correlationId&&e.correlationIds.push(t.correlationId),t.operationId&&e.correlationIds.push(t.operationId),t.subscriptionId&&(e.additionalProperties.subscriptionId=t.subscriptionId),e}return null}_formatNotificationV1FromExtensionManifest(e){const t=e.eventType,s=e.source;if(s&&t){const i=this._notificationDefinitions[te(s,t)];let o;i?(o=i.notificationDefinition,e.label=o.label,e.description=o.message.format(e.descriptionArgs),o.assetType?e.clientDetails={assetOwner:i.extensionWindowId,assetType:o.assetType}:e.clientDetails=null):(e.label=e.label||t,e.description=e.description||t,e.assetId||(e.clientDetails=null))}return q(e.label)&&q(e.description)?e:null}};oe=__decorate([__metadata("fx:diagnostics",[e,"NotificationManager"]),i.Class(),__metadata("design:paramtypes",[FxImpl.Rpc.Client,C])],oe),t.NotificationManager=oe;let ne=class{notificationCallback(e){var t;const s=e.diContainer.get(oe);return ee(null===(t=null==e?void 0:e.messageContext)||void 0===t?void 0:t.srcWindowId,"notificationCallback"),J(s)(e.messageArg,e.messageContext)}notificationsCallback(e){var t;const s=e.diContainer.get(oe);return ee(null===(t=null==e?void 0:e.messageContext)||void 0===t?void 0:t.srcWindowId,"notificationsCallback"),J(s)(e.messageArg,e.messageContext)}fxNotificationsCallback(e){var t;const s=e.diContainer.get(oe);return ee(null===(t=null==e?void 0:e.messageContext)||void 0===t?void 0:t.srcWindowId,"fxNotificationsCallback"),(e=>(t,s)=>{const i=s.srcWindowId;i&&MsPortalFx.merge(t).forEach((t=>{let s=i;const o=i+"#",n=t.id.indexOf("#");n<0?t.id=o+t.id:s=t.id.slice(0,n),e._addOrUpdateNotification(t,s)}))})(s)(e.messageArg,e.messageContext)}showModalNotification(e){var t;const s=e.diContainer.get(oe);return ee(null===(t=null==e?void 0:e.messageContext)||void 0===t?void 0:t.srcWindowId,"showModalNotification"),s.showModalNotification(e.diContainer,e.messageArg)}updateNotification(e){var t;const s=e.diContainer.get(oe);return ee(null===(t=null==e?void 0:e.messageContext)||void 0===t?void 0:t.srcWindowId,"updateNotification"),s.updateNotification(e.messageArg)}addNotification2(e){var t;const s=e.diContainer.get(oe);return ee(null===(t=null==e?void 0:e.messageContext)||void 0===t?void 0:t.srcWindowId,"addNotification2"),s.addNotification2(e.messageArg,e.messageContext.srcWindowId)}addNotifications(e){var t;const s=e.diContainer.get(oe);return ee(null===(t=null==e?void 0:e.messageContext)||void 0===t?void 0:t.srcWindowId,"addNotifications"),s.addNotifications(e.messageArg,e.messageContext.srcWindowId)}};ne=__decorate([__metadata("fx:diagnostics",[e,"NotificationHandler"]),i.Class()],ne),t.NotificationHandler=ne,t.addClientNotificationDefinition=l.defineHandler(S.addClientNotificationDefinition,(e=>{e.diContainer.get(ne).notificationCallback(e)})),t.addClientNotificationsDefinition=l.defineHandler(S.addClientNotificationsDefinition,(e=>{e.diContainer.get(ne).notificationsCallback(e)})),t.addFxNotificationsDefinition=l.defineHandler(r.addFxNotificationsDefinition,(e=>{e.diContainer.get(ne).fxNotificationsCallback(e)})),t.showModalNotificationHandler=l.defineHandler(S.showModalNotification,(e=>e.diContainer.get(ne).showModalNotification(e))),t.updateNotificationHandler=l.defineHandler(k.updateNotificationEndPoint,(e=>e.diContainer.get(ne).updateNotification(e))),t.addNotification2Handler=l.defineHandler(k.addNotification2EndPoint,(e=>e.diContainer.get(ne).addNotification2(e))),t.addNotificationHandler=l.defineHandler(k.addNotificationsEndPoint,(e=>e.diContainer.get(ne).addNotifications(e)))})),
define("MsPortalImpl/Services/Services.AssetTypes",["require","exports","Fx/DependencyInjection","Fx/Ajax","Fx/ResourceManagement","FxInternal/Assets/AssetTypes","FxHubs/RpcEndPointsCore","FxHubs/ResourceManagement","FxHubs/ArmClient","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.ArmIdHelpers","MsPortalImpl/Base/Base.ItemCache","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/Extension/Extension.Manifest","FxHubs/ArtHelpers/ArgBrowseHelpers","MsPortalImpl/Services/Services.Settings","FxInternal/ResourceManagement/BrowseBladeCore","FxInternal/Features","ShellWorker/AssetTypeRequirements","MsPortalImpl/Services/LazyUserData/LazyUserDataHelpers","MsPortalImpl/UI/Hubs/UI.NotificationManager","Fx","MsPortalImpl/Notifications/NotificationsClientStrings","MsPortalImpl/Services/Services.BrowseCuration"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g,h,f,x,b,v,y,M,I,C,P,w,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AssetTypeService=t.getBrowseBladeReference=t.getBrowseBladeUri=t.getBrowseAllDeeplink=t.lowerCaseResourcesWithTagType=t.lowerCaseResourceGroupsType=t.lowerCaseResourceGroupsId=t.lowerCaseAllResourcesType=t.lowerCaseAllResourcesId=t.Internal=t.featureCardsMemo=t.assetTypesMemo=t.setupAssetTypeServiceRpc=t.createViewModelDisposedError=t.assetTypeMeetsRequirements=t.provideSubCategoryName=t.provideCategoryName=t.compareAssetId=t.registerStringProvider=t.failedToFindAssetTypePrefix=void 0;var S=FxImpl.Extension,F=MsPortalFx.Base,k=F.Constants,T=k.AssetNames,D=T.NonAssetResource,E=k.ResourceTypes,B=k.BladeNames.Hubs,A=B.ResourceMenuBlade,N=B.UnavailableAssetBlade,O=MsPortalFx.Extension,R=(O.BrowseType,F.Images),L=FxImpl.Assets,z=O.ResourceRoutingType,H=MsPortalFx.Errors,U=MsPortalFx.Helpers,W=MsPortalFx.tryImmediateResolve,V=MsPortalFx.Hubs.Notifications.NotificationStatus;const j=window.fx.environment,q=F.Diagnostics.createLog(e),$=R.Polychromatic.ResourceDefault(),G={image:R.Polychromatic.Preview(),width:40},K={icon:$,previewIcon:$,bladeName:A,bladeExtension:"HubsExtension"},J="RecentResources.ReactView";let X=e=>q.warning(e);const Y="Timeout trying to load extension manifest",Z=MsPortalFx.remove,ee=F.Diagnostics.createIgnoreUnhandledRejectionError,te=L.getAssetTypeOrResourceTypeId,se=F.Images.Polychromatic.ResourceDefault();t.failedToFindAssetTypePrefix="Could not find the asset type";const ie=[];function oe(e){ie.push(e)}function ne(e){return(e||"").toLowerCase()}function re(e,t){return e===t||ne(e)===ne(t)}t.registerStringProvider=oe,t.compareAssetId=function(e,t){const s=o.ArmId.parse(e,!0),i=o.ArmId.parse(t,!0);return 0!==s.kind&&0!==i.kind&&re(e,t),MsPortalFx.deepEquals(e,t)};const ae=/(^|[^A-Za-z0-9]*)([A-Za-z0-9]+)/g;function le(e){return e.replace(ae,((e,t,s)=>s&&ne(s)))}const de=/^https?:\/\//i;function ce(e){const t=e.text||e.name,s=e.pluralDisplayName||t;return{plural:s,singular:e.singularDisplayName||t,lowerPlural:e.lowerPluralDisplayName||t,lowerSingular:e.lowerSingularDisplayName||t,service:e.serviceDisplayName||s}}function pe(e,t,s){let i;return ie.some((o=>(i=o.provideAssetTypeKeywords(e,t,s),!!i))),i}function ue(e){const t=e.resourceType;return t&&ne(t.resourceTypeName)}function me(e,t,s=null,i=null,o=null){if(!e)return{icon:F.Images.Polychromatic.ResourceDefault(),selection:FxImpl.ViewModels.getBladeSelection("HubsExtension",A,{id:t})};const n=e.assetTypeManifest;i=i||n.bladeExtensionName||e.extension,(s=s||n.bladeName)||(s=n.resourceType?A:N,i="HubsExtension");return{icon:o||e.icon,selection:FxImpl.ViewModels.getBladeSelection(i,s,{id:t}),isPreview:e.isPreview}}function ge(e,t){var s;const i=e.assetTypeManifest;return(0,M.assetTypeMeetsRequirements)({browseType:null==i?void 0:i.browseType,browseLinkUri:null==i?void 0:i.browseLinkUri,resourceType:null===(s=null==i?void 0:i.resourceType)||void 0===s?void 0:s.resourceTypeName},t)}function he(e,t,s){return ee(`Asset type does not specify a resource type. Extension <${t}> : AssetType <${s}> : ${e}`)}function fe(e){return ee(`Resource ID <${(0,c.sanitizeId)(e)}> is not a subscription ID, resource group ID or resource ID.`)}function xe(e,t,s){return new Error(`The ${e} view model was already disposed. Extension <${t}> : ViewModel <${"string"==typeof s?s:s.name}>`)}function be(e,t,s){const i=MsPortalFx.makeArray(t);if(i.length){const t=e.length+i.length-s;t>0&&e.splice(0,t),e.push(...i)}}function ve(e,t){return MsPortalFx.find(e,t,-1)}function ye(e){let t=3;return(e.privateBrowse||(0,a.supportsAnyOption)(e.options,3))&&(t-=2),(e.isPreview||e.isDisabled)&&(t-=1),t}function Me(){return(0,P.isFeatureEnabled)("artbrowse")?"#blade/HubsExtension/BrowseAll":"#blade/HubsExtension/BrowseAllResourcesBlade/resourceType/Microsoft.Resources%2Fresources"}oe({provideCategoryName:e=>(0,_.mapCategoryIdToName)(e),provideSubCategoryName:e=>d.BrowseSubCategories[le(e)]||e,provideAssetTypeKeywords:(e,t,s)=>{const i=d.AssetTypeKeywords[function(e,t,s){return le(e+" "+t+s||(s?" "+s:""))}(e,t,s)];return i?i.split(","):[]}}),t.provideCategoryName=function(e){let t;return ie.some((s=>(t=s.provideCategoryName(e),!!t))),t||e},t.provideSubCategoryName=function(e){let t;return ie.some((s=>(t=s.provideSubCategoryName(e),!!t))),t||e},t.assetTypeMeetsRequirements=ge,t.createViewModelDisposedError=xe,t.setupAssetTypeServiceRpc=function(e){!function(e,s){n.getAllAssetTypesEndPoint.register(e,null,(i=>(null==i?void 0:i.includeBrowseManifest)?(0,t.assetTypesMemo)(s).then((t=>{const s=[];return null==t||t.forEach((e=>e.resourceType&&s.push(e.lowerCaseResourceType))),r.Browse.getBrowseManifestsForResourceTypesEndpoint.invoke(e,"fxw",s).then((e=>t.map((t=>{const s=Object.assign({},t);return s.resourceType&&(s.browseManifest=e[t.lowerCaseResourceType]),s}))))})):(0,t.assetTypesMemo)(s).then((e=>null==e?void 0:e.slice())))),S.getAssetTypeInformationEndPoint.register(e,null,(e=>s.getAssetTypeInformation(e.extensionName,e.assetType))),S.getResourceTypeAssetTypeInformationEndPoint.register(e,null,(e=>s.getResourceTypeAssetTypeInformation(e))),S.mapAssetIdToDynamicSelectionAndIconEndPoint.register(e,null,((e,t)=>s.mapAssetIdToDynamicSelectionAndIcon(e.assetId,"mapAssetIdToDynamicSelectionAndIcon"))),v.getBrowseBladeReferenceEndPoint.register(e,null,((e,t)=>s.getBrowseBladeReference(e)))}(e.get(FxImpl.Rpc.Client),e.get(_e))},t.assetTypesMemo=(0,P.memoizePromise)((e=>e.assetTypesComplete.then((()=>Q(e.assetTypes.map((t=>e.mapAssetTypeToResourceTypeAssetTypeInformation(t)))))))),t.featureCardsMemo=(0,P.memoizePromise)((e=>e.assetTypesComplete.then((()=>Q(e.featureCardMap))))),t.Internal={},t.lowerCaseAllResourcesId="hubsextension_browseallresources",t.lowerCaseAllResourcesType="microsoft.resources/resources",t.lowerCaseResourceGroupsId="hubsextension_resourcegroups",t.lowerCaseResourceGroupsType="microsoft.resources/subscriptions/resourcegroups",t.lowerCaseResourcesWithTagType="microsoft.resources/resourceswithtag",t.getBrowseAllDeeplink=Me;const Ie={};function Ce(e,s,i,o,n,r,l){if(s===t.lowerCaseAllResourcesId)return Q(Me());if(s===t.lowerCaseResourceGroupsId)return Q((0,P.isFeatureEnabled)("artbrowse")?"#blade/HubsExtension/BrowseResourceGroups":"#blade/HubsExtension/BrowseResourceGroupBlade/resourceType/Microsoft.Resources%2Fsubscriptions%2FresourceGroups");const d=o&&o.assetTypeManifest;if(d&&d.resourceType){if(!l&&d.browseDeepLink)return Q(d.browseDeepLink);const o=(0,a.supportsContract)(d.contracts,16384),c=!(0,a.supportsContract)(d.contracts,2)&&(d.resourceType.routingType||z.Default)===z.Default,p=!!d.argBrowseOption;if((o||c||p)&&(0,P.isFeatureEnabled)("artbrowse")&&4!==d.argBrowseOption){let a=i;const l=()=>{if(s===t.lowerCaseResourceGroupsId){a=`#blade/HubsExtension/${r?"ARGBrowseResourceGroupsInMenu":"BrowseResourceGroups"}`}else{a=`#blade/HubsExtension/${r?"ARGBrowseResourcesInMenu":"BrowseResource"}/resourceType/${encodeURIComponent(d.resourceType.resourceTypeName)}`,n&&(a=a+"/kind/"+encodeURIComponent(n))}};if(3===d.argBrowseOption)return l(),Q(a);if(x.canOptIn(d.argBrowseOption,{resourceType:d.resourceType&&d.resourceType.resourceTypeName,contracts:d.contracts,browseType:d.browseType})){const t=e.get(b.SettingsManager);return Q(t.querySetting(15,"argBrowsePreference").then((e=>{const t=(e||{})[s],i=!o&&c&&void 0===d.argBrowseOption?3:d.argBrowseOption;return(!0===t||void 0===t&&[2,3].includes(i))&&(l(),Ie[s]!==t&&(Ie[s]=t,F.Diagnostics.Telemetry.trace({source:"Shell",action:"ArgBrowseOption",name:s,data:{setting:t,argBrowseOption:i}}))),a})))}}}return Q(i)}async function Pe(e,s){const{resourceType:i,kind:o,inMenu:n,ignoreDeepLink:r}=s,a=(i||"").toLowerCase();if(a===t.lowerCaseAllResourcesType)return Promise.resolve(function(e){return e?(0,P.isFeatureEnabled)("artbrowse")?{blade:"ARGBrowseAllInMenu",extension:"HubsExtension"}:{blade:"BrowseAllInMenu",extension:"HubsExtension",parameters:{resourceType:t.lowerCaseAllResourcesType}}:(0,P.isFeatureEnabled)("artbrowse")?{blade:"BrowseAll",extension:"HubsExtension"}:{blade:"BrowseAllResourcesBlade",extension:"HubsExtension",parameters:{resourceType:t.lowerCaseAllResourcesType}}}(n));if(a===t.lowerCaseResourceGroupsType)return Promise.resolve(function(e){return e?(0,P.isFeatureEnabled)("artbrowse")?{blade:"ARGBrowseResourceGroupsInMenu",extension:"HubsExtension"}:{blade:"BrowseGroupsInMenu",extension:"HubsExtension",parameters:{resourceType:t.lowerCaseResourceGroupsType}}:(0,P.isFeatureEnabled)("artbrowse")?{blade:"BrowseResourceGroups",extension:"HubsExtension"}:{blade:"BrowseResourceGroupBlade",extension:"HubsExtension",parameters:{resourceType:t.lowerCaseResourceGroupsType}}}(n));const l=e.get(_e);return MsPortalFx.tryImmediateResolve(l.assetTypesComplete,(async()=>{const t=l.getAssetTypeByResourceType(i);if(!t)return null;const s=await Ce(e,t.id.toLowerCase(),null,t,o,n,r)||l.getAssetTypeDeepLink(t,o,n,r);if(!s||"string"!=typeof s||!s.startsWith("#blade/"))return null;const a=s.substring(7).split("?")[0].split("/");let d="";if(!a.length||a.length<2)return null;a.length%2!=0&&(d=a[a.length-1],a.pop());const c=a[0].trim(),p=a[1].trim(),u={};for(let e=2;e<a.length;e+=2)u[a[e]]=decodeURIComponent(a[e+1]);return d&&(u.menuid=d),{blade:p,extension:c,parameters:u}}))}t.getBrowseBladeUri=Ce,t.getBrowseBladeReference=Pe;let we=class{constructor(e,t,s,i,o,n){this._diContainer=e,this._viewModelManager=t,this._manifestCache=s,this._redirectMap=i,this.assetTypes=[],this.featureCardMap=FxImpl.lowerCaseStringMap(),this._resourceTypeMap={},this._assetTypeByIdBrowseLink={},this._assetTypeByResourceTypePromises=[],this._selectionFromResourceIdPromises=[],this._bladeInfoPromises=[],this._memoizedManifestsLoadedError=MsPortalFx.memoize((e=>ee(e))),this._serviceMenuEnabled=o.isEnabled("servicemenu"),this._lifetimeManager=new FxImpl.TriggerableLifetimeManager,this._cachedUser=n.getCurrentUser(),o.isEnabled("policyforrestypes")?(this._policyForResourceTypesPromise=W(Q((0,b.readUserSettings)(this._diContainer.get(b.SettingsManager),["resourceTypeRestrictions"])),(e=>{try{const t=e&&e.resourceTypeRestrictions;return t&&JSON.parse(t)}catch(e){return void q.warning(new H.Error({message:"Failed to deserialize resource type restrictions from user settings",innerErrors:[e]}))}})),W(Q((0,I.lazyUserDataMemo)(this._diContainer)),(e=>{W(Q(this._policyForResourceTypesPromise),(async t=>{const s=(e,t)=>(t=t||[],(e=e||[]).length===t.length&&e.every((e=>t.includes(e))));let i=e.policyForResourceTypes;if(i){if(i.hasErrors)return void q.warning(new H.Error({message:"Failed loading the policy restrictions for resource types"}));if(i.isIncomplete){q.warning(new H.Error({message:"Did not finish loading the policy restrictions for resource types on server, retrying from client"}));const e=await this._getPolicyForResourceTypes();if(e.ignore)return;i=e.policies}if(!s(null==t?void 0:t.required,null==i?void 0:i.required)||!s(null==t?void 0:t.deny,null==i?void 0:i.deny)){const e={required:(null==i?void 0:i.required)||[],deny:(null==i?void 0:i.deny)||[]};e?(0,b.writeUserSettings)(this._diContainer.get(b.SettingsManager),{resourceTypeRestrictions:JSON.stringify(e)},0,0):(0,b.deleteUserSettings)(this._diContainer.get(b.SettingsManager),["resourceTypeRestrictions"]),await(0,b.flush)(this._diContainer.get(b.SettingsManager)),this.assetTypesComplete.isPending()?this._policyForResourceTypesPromise=Q(e):(F.Diagnostics.Telemetry.trace({source:"Shell",action:"PolicyForResourceTypesUpdate",name:"Services.AssetTypes",data:{oldPolicies:e,newPolicies:i}}),this._diContainer.get(C.NotificationHandler).showModalNotification({diContainer:this._diContainer,messageContext:{srcWindowId:k.Shell,destWindowId:k.Shell,callStack:null},messageArg:{primaryButtonClickAction:2,primaryButtonText:w.AssetTypesNotification.primaryButtonText,secondaryButtonText:w.AssetTypesNotification.secondaryButtonText,notification:{title:d.ResourceTypeRestrictions.policyChangeTitle,description:d.ResourceTypeRestrictions.policyChangeDescription,status:V.Warning,timestamp:new Date}}}))}}}))}))):this._policyForResourceTypesPromise=Q(),this.assetTypesComplete=this._listenForExtensions()}_getPolicyForResourceTypes(){const e=new MsPortalFx.Base.UriBuilder(`providers/microsoft.management/managementgroups/${this._cachedUser.tenantId}/providers/microsoft.policyinsights/checkPolicyRestrictions?api-version=2022-03-01`);return(0,i.batch)({type:"POST",uri:e.toString(),content:{pendingFields:[{field:"type"}]},setTelemetryHeader:"PolicyForResourceTypesFromClient"}).then((e=>{var t,s;const i=[],o=[];let n=0;return null===(s=null===(t=null==e?void 0:e.content)||void 0===t?void 0:t.fieldRestrictions)||void 0===s||s.forEach((e=>{var t;"type"===(null==e?void 0:e.field)&&(++n,null===(t=e.restrictions)||void 0===t||t.forEach((e=>{switch(null==e?void 0:e.result){case"Deny":i.push(...e.values);break;case"Required":o.push(...e.values)}})))})),q.verbose("Policy resource types loaded client-side. Data: "+JSON.stringify({tenantId:this._cachedUser.tenantId,source:"ARM",totalPolicies:n})),{policies:{deny:i,required:o}}})).catch((()=>(q.warning("Policy resource types failed to load client-side. Data: "+JSON.stringify({tenantId:this._cachedUser.tenantId})),{policies:{deny:[],required:[]},ignore:!0})))}dispose(){MsPortalFx.disposeDisposable(this._memoizedManifestsLoadedError,this._lifetimeManager,this._resourceIdSelectionCache)}getMappedBladeLocator(e){if(1===e.type){const t=this._mappedBrowseBlades.get(e.getExtensionName());if(t&&t.get(e.name))return g.resourceMenu}return e}getAssetType(e,t,s){if(e&&t){const i=e.toLowerCase(),o=t.toLowerCase();return ve(this.assetTypes,(e=>e.lowerCaseExtension===i&&e.lowerCaseAssetType===o&&ge(e,s)))}}getAssetTypeById(e,t){if(e){const s=e.toLowerCase();return ve(this.assetTypes,(e=>e.lowerCaseAssetTypeId===s&&ge(e,t)))}}getAssetTypeByResourceType(e,t){if(e){const s=e.toLowerCase();return ve(this.assetTypes,(e=>e.lowerCaseResourceType===s&&ge(e,t)))}}getAssetTypeByResourceTypeWithFallback(e,t){let s=this.getAssetTypeByResourceType(e,t);return s||(s=MsPortalFx.clone(this.getAssetType("HubsExtension",D,t)),s.assetTypeManifest.resourceType={resourceTypeName:e}),s}getAssetTypeDeepLink(e,t,s,i){const o=e.assetTypeManifest,n=o.name,r=o.bladeName,l=e.extension,d=o.bladeExtensionName||l,c=o.resourceType,p=c&&c.resourceTypeName,m=(e,t)=>(0,u.getBladeDeepLink)("HubsExtension",e,t);let g="";const h=this._serviceMenuEnabled&&o.serviceMenuBlade;if(!i&&o.browseDeepLink)g=o.browseDeepLink;else if(h)g=(0,u.getBladeDeepLink)(o.serviceMenuBladeExtension||e.extension,h,{id:o.serviceMenuItemId});else{const i=FxImpl.lowerCaseStringMap();switch(i.set(E.AllResources,{blade:B.BrowseAllResourcesBlade,inMenuBlade:"BrowseAllInMenu"}),i.set(E.ResourceGroups,{blade:B.BrowseResourceGroupBlade,inMenuBlade:"BrowseGroupsInMenu"}),i.set(E.RecentResources,{blade:J,inMenuBlade:J}),o.browseType){case 1:{const e=i.get(p||E.AllResources)||{blade:B.BrowseResourceBlade,inMenuBlade:"BrowseInMenu"};g=m(s?e.inMenuBlade:e.blade,t?{resourceType:p,kind:t}:{resourceType:p});break}case 2:if("HubsExtension"===d){const e=FxImpl.lowerCaseStringMap();e.set(B.BrowseAllResourcesBlade,{resourceType:E.AllResources,bladeName:B.BrowseAllResourcesBlade}),e.set(J,{bladeName:J});const t=e.get(r);t&&(g=m(t.bladeName,t.resourceType?{resourceType:t.resourceType}:null))}else(0,a.supportsContract)(o.contracts,32768)&&(g=m(B.AssetMenuBlade,{assetName:n,extensionName:l}));if(!g){g="Dashboard"===n&&"HubsExtension"===d?"#":(0,u.getBladeDeepLink)(d,r),n===T.Gallery&&(g+="/selectedMenuItemId/home")}break;case 3:g=this.getBrowseLinkUri(e);break;case 999:g=r&&(0,u.getBladeDeepLink)(l,r)}}return!g&&p&&q.error(`<${p}> asset type does not have a deep link. Side bar & search results will not be able to open any blades.`),g}getBrowseLinkUri(e){const t=this._cachedUser,s=this._assetTypeByIdBrowseLink[e.id];if(s)return s;let i=e.assetTypeManifest.browseLinkUri;if(i){const e=j.links.classicPortal.format({domain:t&&t.tenantDomain});i=i.format({accountPortal:j.links.accountPortal,classicPortal:e,domain:t&&t.tenantDomain,tenantId:t&&t.tenantId})}return this._assetTypeByIdBrowseLink[e.id]=i,i}getAssetTypeInformation(e,s){const i=t.Internal.getAssetTypeInformationOverride;return i?Q(i(e,s)):Q(W(this._getAssetTypePromise(e,s),(t=>{if(!t)throw ee(`Asset type not found: AssetType <${e}:${s}>`);return this.mapAssetTypeToAssetTypeInformation(t)})))}getResourceTypeAssetTypeInformation(e){const s=t.Internal.getResourceTypeAssetTypeInformationOverride;if(s)return Q(s(e));const i=(e,t)=>({resourceType:e,topLevelTenantAlias:null,topLevelResourceTypeAlias:null,extensionName:null,assetType:null,browseType:-1,compositeDisplayName:null,icon:null,viewModelLocator:null,viewModel:null,viewModelExtensionName:null,contracts:0,lowerCaseExtension:null,lowerCaseAssetType:null,lowerCaseResourceType:ne(e),reason:MsPortalFx.getLogFriendlyMessage(t)}),o=[],n=[],r=FxImpl.lowerCaseStringMap();return e.forEach((e=>{e.split("/").length>=2?r.set(e,!0):n.push(e)})),o.push(...n.map((e=>i(e,"Invalid resource type")))),r.forEach(((e,t)=>{const s=Q(W(this.assetTypesComplete,(()=>{const e=this.getAssetTypeByResourceType(t);return e?this.mapAssetTypeToResourceTypeAssetTypeInformation(e):i(t,"Asset type not found")})));o.push(s)})),Q.all(o)}mapAssetIdToResourceId(e){const t=e.extensionName,s=e.assetType,i=e.assetId,n=o.ArmId.parse(i,!0);return 1===n.kind||4===n.kind||(0,c.isResourceAtAnyLevel)(n)?Q(i):Q.reject(ee("Asset ID not a resource ID. "+`Extension <${t}> : AssetType <${s}> : ID _REDACTED_`))}mapResourceIdToAssetId(e){return Q(W(this._getAssetTypeByResourceId(e),(t=>{if(!t)throw ee(`Asset type not found: ResourceId <${(0,c.sanitizeId)(e)}>`);const s=t.assetTypeManifest,i=s.name,o=s.resourceType,n=t.extension;if(!o)throw he(`ResourceId <${(0,c.sanitizeId)(e)}>`,n,i);return{extensionName:n,assetType:i,assetId:e}})))}mapAssetIdToDynamicSelectionAndIcon(e,t){const s=e.extensionName,i=e.assetType,n=e.assetId;return Q(W(this._getAssetTypePromise(s,i),(r=>{if(r){e.assetId=n&&ko.unwrap(n);const s=o.ArmId.parse(e.assetId,!0);if(function(e){return 1===e.kind||4===e.kind||(0,c.isResourceAtAnyLevel)(e)}(s)){if(0===s.kind)throw fe(e.assetId);return this._getDynamicSelectionAndIconFromResourceId(r,e.assetId,s,e,t)}return this._getDynamicSelectionAndIconFromAssetId(r,e)}throw ee(`Asset type not found: AssetType <${s}:${i}>`)})))}getBrowseBladeReference(e){return Pe(this._diContainer,e)}mapResourceIdToDynamicSelectionAndIcon(e,t){const s=o.ArmId.parse(e,!0);if(this._resourceIdSelectionCache=this._resourceIdSelectionCache||new p.ItemArrayCache(216e5),0===s.kind)return Q.reject(fe(e));const i=this._resourceIdSelectionCache.first((t=>re(t.resourceId,e)));return i?Q(i.value):Q(W(W(this._getAssetTypeByResourceId(e),(i=>{if(!i)throw ee(`Asset type not found: ResourceId <${(0,c.sanitizeId)(e)}>`);const o=i.assetTypeManifest,n=o.name;if(!o.resourceType)throw he(`ResourceId <${(0,c.sanitizeId)(e)}>`,i.extension,n);return W(this.mapResourceIdToAssetId(e),(o=>this._getDynamicSelectionAndIconFromResourceId(i,e,s,o,t)))})),(t=>(this._resourceIdSelectionCache.pushEntry({resourceId:e,value:t}),t))))}mapResourceIdAndKindToBladeInfo(e,t){e=e||"";const s=(t=t||"").toLowerCase(),i=o.ArmId.parse(e,!0),n=o.ResourceName.getDisplayName({id:e,armId:i});let r;r=1===i.kind?Q(W(MsPortalFx.Azure.getSubscriptionInfo(i.subscription),(e=>e.displayName),(()=>n))):Q(n);const a=e.startsWith("/")?`#resource${e}`:`#resource/${e}`,l=i.resourceType||"",d=l.toLowerCase(),c=ve(this._bladeInfoPromises,(e=>e.resourceKind===s&&e.resourceType===d));let p=c&&c.promise;return p||(p=Q(W(this.getResourceTypeAssetTypeInformation([l,o.ArmId.parse(e).resourceType]),(e=>{const i=e&&e[0].assetType&&e[0]||e[1]||{},o=i.kindMap&&(i.kindMap[s]||i.kindMap[i.defaultKind]),n=o||{},r=n.singularDisplayName||i.compositeDisplayName&&i.compositeDisplayName.singular||l,a=n.icon||i.icon||$,c=r?R.CustomImageWithOptions(a,{title:r}):a,p=(void 0!==n.isPreview?n.isPreview:i.isPreview)?R.CustomImageWithBadge(c,G):c;let u=A,m="HubsExtension";const g=n.bladeName||i.bladeName;g&&(u=g,m=n.bladeExtensionName||i.bladeExtensionName||i.extensionName);const h={icon:c,previewIcon:p,bladeName:u,bladeExtension:m};return t&&!o||be(this._bladeInfoPromises,{resourceType:d,resourceKind:s,promise:Q(h)},200),h}),(()=>K)))),Q(W(p,(({icon:e,previewIcon:t,bladeName:s,bladeExtension:i})=>W(r,(o=>({displayName:o,deepLink:a,icon:e,previewIcon:t,bladeName:s,bladeExtension:i}))))))}mapAssetTypeToAssetTypeInformation(e){const t=e.assetTypeManifest,s=t.keywords;return{extensionName:e.extension,assetType:t.name,options:t.options,browseType:void 0!==t.browseType?t.browseType:-1,browseLinkUri:this.getBrowseLinkUri(e),compositeDisplayName:e.compositeDisplayName,icon:e.icon,viewModelLocator:t.viewModelLocator,viewModel:t.viewModel,viewModelExtensionName:t.viewModelExtensionName,contracts:t.contracts,isPreview:e.isPreview,isDisabled:t.isDisabled,privateBrowse:t.privateBrowse,keywords:s?s.split(","):void 0,hiddenCommands:t.hiddenCommands,browseCommandExperiments:t.browseCommandExperiments,extensibleCommandsApiVersions:t.extensibleCommandsApiVersions}}mapAssetTypeToResourceTypeAssetTypeInformation(e){const t=e.assetTypeManifest,s=t.resourceType||{},i=t.browseType,o=t.keywords;let n=s.proxyRoutingFilters;return n||"microsoft_azure_marketplace"!==e.lowerCaseExtension||"galleryrpitem"!==e.lowerCaseAssetType||(n=[1,3]),{resourceType:s.resourceTypeName,topLevelTenantAlias:s.topLevelTenantAlias,topLevelResourceTypeAlias:s.topLevelResourceTypeAlias,apiVersion:s.apiVersion,routingType:s.routingType,bladeName:t.bladeName,bladeExtensionName:t.bladeExtensionName,partName:t.partName,partExtensionName:t.partExtensionName,kinds:s.kinds,kindMap:e.kindMap,defaultKind:e.defaultKind,proxyRoutingFilters:n,extensionName:e.extension,assetType:t.name,options:t.options,browseType:void 0!==i?i:-1,browseLinkUri:this.getBrowseLinkUri(e),compositeDisplayName:e.compositeDisplayName,icon:e.icon,viewModelLocator:t.viewModelLocator,viewModel:t.viewModel,viewModelExtensionName:t.viewModelExtensionName,contracts:t.contracts,isPreview:e.isPreview,isDisabled:t.isDisabled,noPdlCreateBlade:t.noPdlCreateBlade,noPdlCreateExtension:t.noPdlCreateExtension||e.extension,noPdlCreateParameters:t.noPdlCreateParameters,postCreateBlade:t.postCreateBlade,marketplaceItemId:t.marketplaceItemId,marketplaceMenuItemId:t.marketplaceMenuItemId,staticOverview:t.staticOverview,privateBrowse:t.privateBrowse,keywords:o&&o.split(","),lowerCaseAssetType:e.lowerCaseAssetType,lowerCaseExtension:e.lowerCaseExtension,lowerCaseResourceType:e.lowerCaseResourceType,description:t.description,links:t.links,argBrowseOption:t.argBrowseOption,browseDeepLink:t.browseDeepLink,showArgColumns:t.showArgColumns,hiddenCommands:t.hiddenCommands,hideBrowseInfoBox:t.hideBrowseInfoBox,browseCommandExperiments:t.browseCommandExperiments,extensibleCommandsApiVersions:t.extensibleCommandsApiVersions,featureCardOptions:t.featureCardOptions}}_getAssetTypePromiseWorker(e){const t=e();return t?Q(t):Q(W(this.assetTypesComplete,(()=>Q(e()))))}_getAssetTypeByResourceId(e){const t=o.ArmId.parse(e,!0);return 0===t.kind?Q.reject(fe(e)):Q(W(this._getAssetTypeByResourceType(t.resourceType),(t=>{if(!t){const t=o.ArmId.parse(e);return W(this._getAssetTypeByResourceType(t.resourceType),(e=>e))}return t})))}_getAssetTypeByResourceType(e,t){const s=ne(e),i=ve(this._assetTypeByResourceTypePromises,(e=>e.resourceType===s&&e.requirements===t));if(i)return i.promise;const o=Q(this._getAssetTypePromiseWorker((()=>this.getAssetTypeByResourceType(e,t))));if(!Q.isRejected(o)){const e={resourceType:s,promise:o,requirements:t};be(this._assetTypeByResourceTypePromises,e,200),Q.isPending(o)&&o.catch((t=>{t.message===Y&&q.warning(Y),Z(this._assetTypeByResourceTypePromises,e)}))}return o}_getDynamicSelectionAndIconFromAssetId(e,t){const s=me(e,t.assetId);if((0,a.supportsContract)(e.assetTypeManifest.contracts,32768)){const t=s.selection;t.extension="HubsExtension",t.detailBlade=B.AssetMenuBlade,t.detailBladeInputs={assetName:e.assetTypeManifest.name,extensionName:e.extension}}return Q(s)}_getDynamicSelectionAndIconFromResourceId(e,t,s,i,n){const r=me(e,i.assetId),d=r.selection,c=e&&e.assetTypeManifest;if(1===s.kind||4===s.kind)return d.extension="HubsExtension",d.detailBlade=A,Q(r);const p=c&&c.resourceType;if(p&&p.routingType===z.Extension&&!(0,a.supportsContract)(c.contracts,64))return Q(r);if(c&&(0,a.supportsContract)(c.contracts,128))return d.extension="HubsExtension",d.detailBlade=A,Q(r);const u=ve(this._selectionFromResourceIdPromises,(e=>e.resourceId===t));if(u)return u.promise;let m;if(!c||p&&p.kinds&&(!(0,a.supportsContract)(c.contracts,512)||(0,a.supportsAnyContract)(c.contracts,13312))){let s;if((0,a.supportsContract)(c.contracts,64)){const i=e.assetTypeManifest.viewModelLocator||e.assetTypeManifest.viewModel,n=this._lifetimeManager.createChildLifetime();s=this._viewModelManager.getViewModel(e.extension,i,11).then((s=>{let r=!1;if(n.registerForDispose((()=>{r=!0,this._viewModelManager.releaseViewModel(s)})),!r)return s.content().getResource(t).then((e=>MsPortalFx.extend2(e,{armId:o.ArmId.parse(e.id,!0)})));throw xe("asset type service",e.extension,i)})).finally((()=>n.dispose()))}else s=Q((0,l.getResource)(t,n));m=Q(W(s,(t=>{if(!c||c.name===D)return Q(r);if((0,a.supportsOption)(c.options,2))return Q(r);const s=e.kindMap&&(e.kindMap[(t.kind||"").toLowerCase()]||e.kindMap[(e.defaultKind||"").toLowerCase()]);if(s&&(0,a.supportsOption)(s.options,2))return Q(r);let i=!1;return(0,a.supportsContract)(c.contracts,8)&&(d.extension="HubsExtension",d.detailBlade=A,i=!0),W(MsPortalFx.require("MsPortalImpl/Services/Services.AssetTypesDelayed"),(s=>{if(p&&p.kinds){let o=!1,n=!1,l=!1;if(s.getIconAndBladeFromAssetTypeInformation(t,e.kindMap,e.defaultKind,null,(e=>{e?(0,a.supportsContract)(c.contracts,16)&&(d.extension="HubsExtension",d.detailBlade=A,i=!0):i=!1}),(e=>{n||(n=!0,r.isPreview=e)}),(e=>{o||(o=!0,r.icon=e)}),((t,s)=>{l||i||(l=!0,d.extension=t||e.extension,d.detailBlade=s)})),l||i)return r}return r}))}))).catch((s=>{const o=function(e,t,s){let i;return H.isInstanceOfErrorType(e,H.Error)?i=ee(e,s):U.isXMLHttpRequestLike(e)?(i=ee(e.message||t,e.stack,s),MsPortalFx.shallowCopyFromObject(i,e,["readyState","status","statusText","responseText"])):i=ee(new H.Error({message:t,data:s,innerErrors:e})),i}(s,"_getDynamicSelectionAndIconFromResourceId have unexpected error.",{assetType:e,resourceId:t,assetId:i,telemetry:n});throw o}))}else m=Q(W(Q(r),MsPortalFx.identity));const g={resourceId:t,promise:m};return be(this._selectionFromResourceIdPromises,g,200),m.catch((e=>{MsPortalFx.remove(this._selectionFromResourceIdPromises,g)})),m}_preventDuplicateResourceTypes(e,t,s){if(this._resourceTypeMap[e]){const i=ve(this.assetTypes,(t=>t.lowerCaseResourceType&&t.lowerCaseResourceType===e)),o=ye(i.assetTypeManifest),n=ye(s);if(!(o<n))return o>n||X(`Extension <${t}> has duplicate resource type <${e}> also found in <${i.extension}> extension`),!1;delete this._resourceTypeMap[e],MsPortalFx.remove(this.assetTypes,i)}return!0}_listenForExtensions(){const e=this._mappedBrowseBlades=FxImpl.lowerCaseStringMap(),s={system:!0,"v2.0,system":!0,"v12.0,system":!0};return Q(W(Q(this._policyForResourceTypesPromise),(i=>{var o,n,r,l;let d;i&&(d={required:(null===(o=i.required)||void 0===o?void 0:o.length)&&FxImpl.lowerCaseStringMap(),deny:(null===(n=i.deny)||void 0===n?void 0:n.length)&&FxImpl.lowerCaseStringMap()},null===(r=i.required)||void 0===r||r.forEach((e=>d.required.set(e,!0))),null===(l=i.deny)||void 0===l||l.forEach((e=>d.deny.set(e,!0))));const c=[];return this._manifestCache.getManifests("assetTypes",((t,i)=>{e.has(t)||e.set(t,FxImpl.lowerCaseStringMap());const o=i.assetTypes;o&&o.forEach((o=>{if(4===o.browseType)return;if(3===o.browseType&&!(o.browseLinkUri||"").match(de))return;const n=this._redirectMap.getAssetRedirect(t+"_"+o.name),r=n&&n.toExtension===t&&n.toAsset===o.name;if(n&&!r)return;const l=o.resourceType,p=l&&l.resourceTypeName,u=ue(o);if(p){if(p.split("/").length<2)return void X(`Skipping asset type <${o.name}> with invalid resource type <${p}> in extension <${t}>`);if(!this._preventDuplicateResourceTypes(u,t,o))return;this._resourceTypeMap[u]=!0,c.push(p.toLowerCase())}const m=(s,i,o)=>{if(s&&o){const o=i||t;e.has(o)||e.set(o,FxImpl.lowerCaseStringMap()),e.get(o).set(s,!0)}},g=l&&l.kinds,h=(0,a.supportsContract)(o.contracts,8);if(g&&g.length){if(g.forEach((e=>{m(e.bladeName||o.bladeName,e.bladeExtensionName||o.bladeExtensionName,void 0!==e.useResourceMenu?e.useResourceMenu:h),e.filterMap=MsPortalFx.extendArrayIntoMap(Object.create(null),e.kinds||[e.name],(e=>ne(e)),(e=>!0)),e.isDefault&&(e.filterMap[""]=!0)})),"SqlAzureExtension"===t&&"Database"===o.name){const e=MsPortalFx.find(g,(e=>"v12.0,user,datawarehouse"===ne(e.name))),t=MsPortalFx.find(g,(e=>"v12.0,user,datawarehouse,gen2"===ne(e.name)));e&&t&&(e.filterMap[ne(e.name)]=!0,e.filterMap[ne(t.name)]=!0,t.filterMap[ne(e.name)]=!0,t.filterMap[ne(t.name)]=!0)}}else m(o.bladeName,o.bladeExtensionName,h);!function(e,t){const s=(e,t)=>MsPortalFx.unique((e||"").split(",").filter((e=>!!e)).concat(t)).join(","),i=t.name,o=pe(e,i,"");o&&o.length&&(t.keywords=s(t.keywords,o)),((t.resourceType||{}).kinds||[]).forEach((t=>{const o=ne(t.name),n=pe(e,i,o);n&&n.length&&(t.keywords=s(t.keywords,n))}))}(t,o);const f=te(t,o.name),x=function(e,t,s,i,o){var n,r,l;const d=i.resourceType&&i.resourceType.kinds||[],c=MsPortalFx.find(d,(e=>e.isDefault));let p=(0,a.supportsOption)(i.options,16);return!p&&o&&(null===(n=i.resourceType)||void 0===n?void 0:n.resourceTypeName)&&(o.required&&(p=p||!o.required.has(null===(r=i.resourceType)||void 0===r?void 0:r.resourceTypeName)),o.deny&&(p=p||o.deny.has(null===(l=i.resourceType)||void 0===l?void 0:l.resourceTypeName))),p&&(i.isDisabled=p),{lowerCaseAssetType:ne(i.name),lowerCaseExtension:ne(e),lowerCaseAssetTypeId:ne(t),lowerCaseResourceType:ue(i)||"",kindMap:MsPortalFx.extendArrayIntoMap(Object.create(null),d,(e=>ne(e.name)),MsPortalFx.identity),defaultKind:c&&ne(c.name),assetTypeManifest:i,id:t,extension:e,compositeDisplayName:ce(i),icon:i&&i.icon||se,isPreview:s.isPreview||!!i.isPreview}}(t,f,i,o,d);void 0===o.options&&(o.privateBrowse&&(o.options=1|o.options),"microsoft.sql/servers/databases"===u&&x.kindMap&&(0,P.forEachKey)(x.kindMap,((e,t)=>{s[e]&&void 0===t.options&&(t.options=2|t.options)}))),"microsoft_azure_datafactory"!==t.toLowerCase()||"datafactory"!==o.name.toLowerCase()&&"datafactoryv2"!==o.name.toLowerCase()||void 0!==o.argBrowseOption||(o.argBrowseOption=4),this.assetTypes.push(x)}))})).then((()=>(c.unshift(t.lowerCaseAllResourcesType),c.unshift(t.lowerCaseResourcesWithTagType),(0,_.getBrowseCuration)()))).then((e=>this._manifestCache.getManifests("featureCards",((t,s)=>{var i,o;const n=null==s?void 0:s.featureCards;e.featureCardAllowList&&(null===(o=null===(i=null==n?void 0:n.filter((s=>-1!==e.featureCardAllowList.findIndex((e=>e.extension.toLowerCase()===t.toLowerCase()&&e.id.toLowerCase()===s.id.toLowerCase())))))||void 0===i?void 0:i.sort(((s,i)=>e.featureCardAllowList.findIndex((e=>e.extension.toLowerCase()===t.toLowerCase()&&e.id.toLowerCase()===s.id.toLowerCase()))-e.featureCardAllowList.findIndex((e=>e.extension.toLowerCase()===t.toLowerCase()&&e.id.toLowerCase()===i.id.toLowerCase())))))||void 0===o||o.forEach((e=>{if(e.resourceTypes){const s=FxImpl.lowerCaseStringMap();MsPortalFx.forEachKey(e.resourceTypes,((e,t)=>s.set(e,t))),c.forEach((i=>{(s.has(i)||s.has("*"))&&(this.featureCardMap.has(i)||this.featureCardMap.set(i,[]),this.featureCardMap.get(i).push({extension:t,manifest:e}))}))}})))}))))})))}_getAssetTypePromise(e,t,s){return this._getAssetTypePromiseWorker((()=>this.getAssetType(e,t,s)))}};we=__decorate([__metadata("fx:diagnostics",[e,"AssetTypeServiceImpl"]),s.Class(),__metadata("design:paramtypes",[s.Container,m.ViewModelManager,f.ManifestCache,f.RedirectMap,y.Features,h.AuthStateManager])],we);class _e{static create(e){return e}}__decorate([__metadata("fx:diagnostics",[e,"AssetTypeService"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[we]),__metadata("design:returntype",_e)],_e,"create",null),t.AssetTypeService=_e})),
define("MsPortalImpl/Services/Services.GlobalResourceFilters",["require","exports","Fx/DependencyInjection","Weave","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.Subscriptions","FxHubs/RpcEndPoints","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/Hubs/UI.NotificationManager","FxInternal/AsyncLoader","FxInternal/ResourceManagement/GlobalResourceFilters","FxInternal/Weave","Fx/Telemetry"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u){"use strict";var m;Object.defineProperty(t,"__esModule",{value:!0}),t.getGlobalResourceFilterObservableHandler=t.ResourceFilterManager=void 0;var g=MsPortalFx.Base,h=g.Diagnostics.Telemetry,f=MsPortalFx.Hubs.Notifications.NotificationStatus;r.Subscriptions.CountTypeEnum;const x=g.Diagnostics.createLog(e),b="selected.subscriptions",v={currentFilterId:"",filters:Object.create(null),optedIn:void 0};function y(e,t){e.setSettings({store:19,settings:{currentFilterId:t.currentFilterId,filters:t.filters,optedIn:t.optedIn}})}let M=m=class{static async create(e){const t=await e.getAsync(o.SettingsManager),s=await async function(e){let t,s;try{t=await e.queryStore(19)}catch(e){return x.warning(`Error retrieving global resource filter settings from user settings. Error details: ${MsPortalFx.getLogFriendlyMessage(e)}`),v}if(!t)return v;try{s=t.filters||v.filters}catch(e){x.warning(`Error parsing global resource filter settings. Error details: ${MsPortalFx.getLogFriendlyMessage(e)}`),s=v.filters,t.currentFilterId=v.currentFilterId}let i={currentFilterId:t.currentFilterId||v.currentFilterId,filters:s,optedIn:t.optedIn};i.currentFilterId&&!s[i.currentFilterId]&&(i=Object.assign(Object.assign({},i),{currentFilterId:v.currentFilterId})),MsPortalFx.deepEquals(i,t)||y(e,i);const o=i.filters[i.currentFilterId],n={filterCount:Object.keys(i.filters).length};return o?(n.currentFilterId=o.id,n.facetCount=o.facets.length):n.currentFilterId="<default>",(0,u.trace)({source:"ResourceFilterManager",action:"getFilterSettingsFromUserSettings",data:n}),i}(t);return new m(e,s)}constructor(e,t){this._diContainer=e,this._lifetime=new FxImpl.TriggerableLifetimeManager,MsPortalImpl.sessionStorage.getItem("subscriptions_selected_migrated")&&(MsPortalImpl.sessionStorage.removeItem("subscriptions_selected_migrated"),e.get(l.NotificationManager).addClientNotification({title:a.filtersOptInSuccessTitle,description:a.filtersOptInSuccessMessage,status:f.Success,timestamp:new Date}));const s=[];MsPortalFx.forEachKey(t.filters,((e,t)=>s.push(t))),this._filters=(0,i.makeArrayComputation)(s),this._filtersMap=this._filters.compose((e=>e.reduce(((e,t)=>(e[t.id]=t,e)),Object.create(null)))),this._currentFilterId=(0,i.makeWritableComputation)(t.currentFilterId?t.currentFilterId:""),(0,i.subscribe)(this._lifetime,[this._filtersMap,this._currentFilterId],(async(e,s)=>{y(await this._diContainer.getAsync(o.SettingsManager),{filters:e||Object.create(null),currentFilterId:s||"",optedIn:t.optedIn})})),this._currentFilterComputation=(0,i.composeComputation)([this._currentFilterId,this._filtersMap],((e,t)=>t[e]||null)),this.canAddFilter=this._filters.compose((e=>e.length<10)),this.currentFilterObservable=(0,p.toObservable)(this._lifetime,this.currentFilter)}get filters(){return this._filters}get currentFilter(){return this._currentFilterComputation}activateFilter(e){if(!MsPortalFx.isNullOrUndefined(e))return""===e?this._currentFilterId(v.currentFilterId):void((0,i.evaluate)(this._lifetime,this._filtersMap)[e]?this._currentFilterId(e):x.warning(`Attempted to activate filter with ID "${e}" which does not exist.`))}addFilter(e,t,s=!1){if(this._filters.value.length>=10)return null;const i=MsPortalFx.newGuid(),o={id:i,name:e,facets:t};return this._filters.push(o),s&&this._currentFilterId(i),o}deleteFilter(e){if(!e)return;const t=MsPortalFx.findIndex(this._filters.value,(t=>t.id===e));t<0?x.warning(`Filter with ID "${e}" could not be located.`):(this._currentFilterId.value===e&&this._currentFilterId(v.currentFilterId),this._filters.splice(t,1))}updateFilter(e){if(!e)return;const t=(e||{}).id;if(!t)return;const s=MsPortalFx.findIndex(this._filters.value,(e=>e.id===t));s<0?x.warning(`Filter with ID "${t}" could not be located.`):this._filters.set(s,e)}async createSelectedSubscriptionsFilter(){const e=(0,i.evaluate)(this._lifetime,this._filtersMap)["selected.subscriptions"],t=h.startTrace({source:"ResourceFilterManager",action:"MigrateSelectedSubscriptions"}),s=await this._diContainer.getAsync(n.SubscriptionsUserContext),o=(await s.getGlobalSelectedSubscriptions())().map((e=>e.subscriptionId)),r=await s.getAllSubscriptionsCount();if(!o.length)return h.completeTrace(t,{data:{selectedSubscriptionCount:0}}),e&&(this.deleteFilter(b),this.activateFilter("")),null;if(1===r.type&&o.length===r.value)return h.completeTrace(t,{data:{allSelected:!0}}),e&&(this.deleteFilter(b),this.activateFilter("")),null;const l={id:b,name:a.UiSettings.selectedSubscriptionsFilterName,facets:[{type:"subscriptionId",operator:"==",value:o}]};return e?this.updateFilter(l):this._filters.push(l),this._currentFilterId(b),h.completeTrace(t,{data:{previouslyMigrated:!!e,selectedSubscriptionCount:o.length}}),l}};__decorate([__metadata("fx:diagnostics",[e,"ResourceFilterManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s.Container]),__metadata("design:returntype",Promise)],M,"create",null),M=m=__decorate([__metadata("fx:diagnostics",[e,"1"]),s.Class(),__metadata("design:paramtypes",[s.Container,Object])],M),t.ResourceFilterManager=M,t.getGlobalResourceFilterObservableHandler=(0,d.defineHandler)(c.getGlobalResourceFilterObservableEndPoint,(e=>e.diContainer.getAsync(M).then((e=>e.currentFilterObservable))))})),
define("MsPortalImpl/Services/Services.Permissions",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","Fx/ResourceManagement","Fx","FxHubs/Helpers/PermissionsHelpers"],(function(e,t,s,i,o,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PermissionsChecker=t.hasPermissionsToShell=t.PermissionsManager=t.isRDFEAction=void 0;var a=FxImpl.Extension;const l=window,d=()=>Q(MsPortalFx.require(e.normalize("./PermissionsHelpers")));function c(e){return e&&1===e.length&&"rdfe"===e[0]}t.isRDFEAction=c;class p{static create(e){return new u(e)}}__decorate([__metadata("fx:diagnostics",[e,"PermissionsManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s.Container]),__metadata("design:returntype",p)],p,"create",null),t.PermissionsManager=p;class u{constructor(e){this._diContainer=e;const t=m(((e,t)=>d().then((s=>s.getPermissions(e,t)))));this._cachedPermissionsGetter=t,this._getPermissionsCallback=(e,s)=>t.getPermissions(e,s)}hasPermission(e,t,s){if(c(t))return d().then((i=>i.hasPermissionsImpl(this._diContainer,e,t,s)));return 0===o.ArmId.parse(e,!0).kind?Q("The entity ID for hasPermission must be a resource ID, a subscription ID or a resource group ID"):d().then((i=>i.hasPermission(e,t,null,this._getPermissionsCallback,s)))}getDiagnosticsData(){const e=[],t=this._cachedPermissionsGetter.getCachedPermissions(),s=[];return Object.keys(t).forEach((i=>{e.push(t[i]().then((e=>{s.push({entityId:i,permissions:e})})))})),Q.all(e).then((()=>s))}}function m(e,t){if(!t&&l.fxDisableRbacCache)return{getPermissions:e,getCachedPermissions:()=>({}),clear:MsPortalFx.noop};{let t;const s=()=>(t=t||{},t);return{getPermissions:(t,i)=>{const o=s();return(o[t]||(o[t]=(0,n.memoizePromise)((t=>Q(e(t,i))))))(t)},getCachedPermissions:s,clear:e=>{const t=s()[e];t&&t.clear()}}}}t.hasPermissionsToShell=i.defineHandler(a.hasPermissionsToShell,(e=>e.diContainer.get(p).hasPermission(e.messageArg.entityId,e.messageArg.requestedActions,e.messageContext.srcWindowId)));class g{constructor(e,t){this._permissionsCache=m((t=>d().then((s=>s.getPermissionsFromArm(t,e)))),t)}hasPermission(e,t,s,i){return c(t)?this.hasRdfePermissions(e):d().then((o=>o.hasPermission(e,t,s,(e=>this._permissionsCache.getPermissions(e,i)),i)))}getDiagnostics(){return this._permissionsCache.getCachedPermissions()}hasRdfePermissions(e){const t=o.ArmId.parse(e,!0);return 1!==t.kind?Q(!1):Q(MsPortalFx.Azure.getSubscriptionInfo(t.subscription)).then(r.subscriptionRequiresRdfe)}static create(){return new g("HubsExtension")}}__decorate([__metadata("fx:diagnostics",[e,"PermissionsChecker"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",g)],g,"create",null),t.PermissionsChecker=g})),
define("MsPortalImpl/Services/Services.PersistentStorage",["require","exports","Fx/DependencyInjection","MsPortalImpl/Services/Services.Settings","FxInternal/AsyncLoader","FxInternal/RpcEndPointsCore"],(function(e,t,s,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAllKeysHandler=t.clearHandler=t.removeSettingsHandler=t.readSettingsHandler=t.writeSettingHandler=t.StorageCapacityExceededError=t.KeySizeExceededError=t.PersistentStorageSettings=void 0;var r=MsPortalFx.Base.Diagnostics.Telemetry;const a=e=>`${e}PersistentStorage`,l=e=>`__fx_metadata__${e}`;let d=class{constructor(e){this._settingsManager=e,this._cache={}}writeSetting(e,t,s,i=[]){const o=(e,t)=>(c.error(e,0,t),Promise.reject(e.message));if(t.length>241)return o(new p,{keyLength:t.length});const n=a(e),r=this._traceAction(e,"ClearPersistentStorage");return this._getCacheStorage(e).then((e=>{const a=[[t,s]];i.length&&a.push([l(t),JSON.stringify({readers:i})]);const d=2*a.reduce(((e,t)=>e+t[0].length+t[1].length),0);return d+e.size>102400?o(new u,{keyValuePairsSize:d,cacheSize:e.size}):Promise.all(a.map((t=>{const[s,i]=t,o=2*(s.length+i.length);return e.size+=o,e.storage.set(s,i),this._settingsManager.setSettingWithPromise(n,s,i)}))).then((()=>{r({sizeAdded:d})}))}))}readSettings(e,t,s=e){const i=this._traceAction(e,"ReadPersistentSettings");return this._getCacheStorage(e).then((o=>{const n=t.reduce(((t,i)=>{const n=o.storage.get(i),r=o.storage.get(l(i))||"",a=r.length?JSON.parse(r):{},d=null==a?void 0:a.readers;return(e===s||"*"===d||(null==d?void 0:d.includes(s)))&&void 0!==n&&(t[i]=n),t}),{});return i({numberOfRequestedKeys:t.length,numberOfReturningPairs:Object.keys(n).length}),n}))}removeSettings(e,t){const s=a(e),i=t.concat(t.map(l)),o=this._traceAction(e,"RemovePersistentSettings");return this._getCacheStorage(e).then((e=>(i.forEach((t=>{if(e.storage.has(t)){const s=(e.storage.get(t)||"").length;e.size-=s+t.length,e.storage.delete(t)}})),this._settingsManager.deleteSettingsWithPromise({store:s,keys:i}).then(o).catch((e=>{c.error(e)})))))}clear(e){const t=this._traceAction(e,"ClearPersistentStorage");return this.getAllSettingsKeys(e).then((s=>this.removeSettings(e,s).then((()=>{t({numberOfKeysRemoved:s.length})}))))}getAllSettingsKeys(e){return this._getCacheStorage(e).then((e=>Array.from(e.storage.keys()).filter((e=>!e.startsWith("__fx_metadata__")))))}_getCacheStorage(e){var t;const s=Date.now();return(null===(t=this._cache[e])||void 0===t?void 0:t.expires)>s?Promise.resolve(this._cache[e]):this._settingsManager.querySettings({store:a(e)}).then((t=>{let i=0;const o=Object.keys(t).map((e=>(i+=2*(e.length+t[e].length),[e,t[e]])));return this._cache[e]={expires:s+36e5,storage:new Map(o),size:i},this._cache[e]})).catch((e=>(c.error(e),{expires:s+36e5,storage:new Map,size:0})))}_traceAction(e,t){const s=MsPortalFx.startTimer(),i=e=>e&&{size:e.size,numberOfKeys:Array.from(e.storage.keys()).length},o=i(this._cache[e]);return n=>{const a=i(this._cache[e]);r.trace({source:"Services.PersistentStorage",action:t,actionModifier:r.ActionModifier.Complete,name:e,data:{initialCacheState:o,finalCacheState:a,extraData:n,duration:s()}})}}};d=__decorate([__metadata("fx:diagnostics",[e,"PersistentStorageSettings"]),s.Class(),__metadata("design:paramtypes",[i.SettingsManager])],d),t.PersistentStorageSettings=d;const c=MsPortalFx.Base.Diagnostics.createLog(e);class p extends Error{constructor(){super("Attempting to set a key/value pair that has a key size that exceeds the portal's limit: 241 characters."),this.name="KeySizeExceededError"}}t.KeySizeExceededError=p;class u extends Error{constructor(){super("Attempting to set a key/value pair which when combined with all settings would exceed the portal's limit: 102400 bytes."),this.name="StorageCapacityExceededError"}}t.StorageCapacityExceededError=u,t.writeSettingHandler=(0,o.defineHandler)(n.writeSettingEndPoint,(e=>Q(e.diContainer.get(d).writeSetting(e.messageContext.srcWindowId,e.messageArg.key,e.messageArg.value,e.messageArg.readers)))),t.readSettingsHandler=(0,o.defineHandler)(n.readSettingsEndPoint,(e=>Q(e.diContainer.get(d).readSettings(e.messageArg.extensionName,e.messageArg.keys,e.messageContext.srcWindowId)))),t.removeSettingsHandler=(0,o.defineHandler)(n.removeSettingsEndPoint,(e=>Q(e.diContainer.get(d).removeSettings(e.messageContext.srcWindowId,e.messageArg.keys)))),t.clearHandler=(0,o.defineHandler)(n.clearEndPoint,(e=>Q(e.diContainer.get(d).clear(e.messageContext.srcWindowId)))),t.getAllKeysHandler=(0,o.defineHandler)(n.getAllKeysEndPoint,(e=>Q(e.diContainer.get(d).getAllSettingsKeys(e.messageContext.srcWindowId))))})),
define("MsPortalImpl/UI/UI.NavigationManager.ForceSignIn",["require","exports","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/Base/Base.ImplUtils"],(function(e,t,s,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forceSignIn=void 0;var r=MsPortalFx.Base,a=r.Diagnostics.Telemetry;t.forceSignIn=async function(e,t,l){const d=a.startTrace({source:"UI.NavigationManager",action:"ForceSignInHandler"}),c=e.get(s.AuthStateManager),p=await c.getUserInfo();MsPortalImpl.sessionStorage.setItem("forceSignIn_previousSessionId",MsPortalFx.sessionId);const u={callingExtension:l,reason:t.reason,tenantSource:"Options"},m=c.getSignedInUserTenant();let g=t.tenantId;g?g.toLowerCase()!==m.toLowerCase()&&(u.newTenantId=g):(g=m,u.tenantSource="Current");const h=new MsPortalFx.Base.UriBuilder(fx.environment.applicationPath);if(h.setRelativePath(`${h.getRelativePath()}/${g}`),t.bladeDeepLink)h.fragment=MsPortalFx.sanitizeMessage(t.bladeDeepLink);else if(t.bladeReference){const e=t.bladeReference,s=(0,o.getBladeDeepLink)(e.extensionName,e.bladeName,e.parameters,{selectedMenuItemId:t.bladeReference.menuId});u.deepLink=MsPortalFx.sanitizeMessage(s),h.fragment=s}if(h.query=new r.QueryStringBuilder((0,n.getQueryStringSegment)(location.href)),h.query.setParameter("loginHint",MsPortalFx.isFeatureEnabled("preferredusername")?p.preferredUsername:p.email),h.query.setParameter("forcesignin","true"),h.query.setParameter("feature.msaljs",MsPortalFx.isFeatureEnabled("msaljs")+""),h.query.setParameter("feature.msaljslogin",MsPortalFx.isFeatureEnabled("msaljslogin")+""),h.query.setParameter("msaljsscript",MsPortalFx.isFeatureEnabled("msaljsscript")+""),t.signInParameters){const e=function(e){const t=Object.create(null);return Object.keys(e).forEach((s=>{"acr_values"!==s&&"amr_values"!==s&&"claims"!==s||(t[s]=e[s])})),t}(t.signInParameters);h.query.setParameter("signInParameters",JSON.stringify(e)),u.providedSignInParameters=Object.keys(t.signInParameters),u.effectiveSignInParameters=Object.keys(e)}a.completeTrace(d,u),e.get(i.WindowManager).redirect({uri:h.toString(),redirectAction:3,reason:"forceSignIn"})}})),
define("MsPortalImpl/Services/Services.Recents",["require","exports","Fx/DependencyInjection","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.Settings","FxHubs/RpcEndPoints","MsPortalImpl/Services/LazyUserData/LazyUserDataHelpers","MsPortalImpl/Services/Services.SecurityTokens"],(function(e,t,s,i,o,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEV=t.MruTokensSettingsManager=t.RecentServicesManager=t.loadRecentsFromLazyData=void 0;const l=MsPortalFx.Base.Diagnostics.createLog(e);t.loadRecentsFromLazyData=function(e){(0,r.lazyUserDataMemo)(e).then((e=>{e.recentResources&&n.AssetTypes.setRecentResourcesEndPoint.invoke(FxImpl.Rpc.client,"HubsExtension",{recentResourcesMap:e.recentResources})}))};let d=class{constructor(e,t){this._settingsManager=e,this._assetTypesService=t}addService(e){MsPortalFx.tryImmediateResolve(this._ensureServices(),(()=>{var t;e=e.toLowerCase();const s=this._services,i=this._assetTypesService.getAssetTypeById(e);(null===(t=null==i?void 0:i.assetTypeManifest)||void 0===t?void 0:t.isDisabled)||(MsPortalFx.remove(s,(t=>t.assetId===e)),s.length>=10&&s.pop(),s.unshift({assetId:e,timeStamp:Date.now()}),this._settingsManager.setSetting(16,"recentServices",{version:1,data:this._services}))}))}getServices(){return MsPortalFx.tryImmediateResolve(this._ensureServices(),(()=>this._services))}_ensureServices(){return void 0===this._services?MsPortalFx.tryImmediateResolve(Q(this._settingsManager.querySetting(16,"recentServices")),(e=>MsPortalFx.tryImmediateResolve(this._assetTypesService.assetTypesComplete,(()=>{this._services=((e||{}).data||[]).filter((e=>{var t,s;const i=(e.assetId||"").split("."),o=i.length>1?i.slice(0,i.length-1).join("."):e.assetId,n=i.length>1?i[i.length-1]:void 0,r=this._assetTypesService.getAssetTypeById(o);if(!r)return!1;if(null===(t=null==r?void 0:r.assetTypeManifest)||void 0===t?void 0:t.isDisabled)return!1;const a=r.kindMap&&(n&&r.kindMap[null==n?void 0:n.toLowerCase()]||r.kindMap[null===(s=r.defaultKind)||void 0===s?void 0:s.toLowerCase()]);return a?1!=(1&a.options):1!=(1&r.assetTypeManifest.options)}))})))):Q()}};d=__decorate([__metadata("fx:diagnostics",[e,"RecentServicesManager"]),s.Class(),__metadata("design:paramtypes",[o.SettingsManager,i.AssetTypeService])],d),t.RecentServicesManager=d;let c=class{constructor(e,t){this._settingsManager=e;const s=this._mruTokensMap={},i=this._mruTokensQueue=[];this._loadInitialSettingsPromise=Q(this._settingsManager.querySetting(16,"mruTokens").then((e=>{MsPortalFx.forEachKey(e,((e,t)=>{t.length&&"string"==typeof t[0]?(s[e]=t.map((e=>({resource:e,audience:""}))),t.forEach((t=>{i.push({extension:e,resource:t,audience:""})}))):(s[e]=t,t.forEach((t=>{i.push({extension:e,resource:t.resource,audience:t.audience})})))}))}))).then((()=>{MsPortalFx.isFeatureEnabled("msaljs")&&MsPortalFx.isFeatureEnabled("msaljsprefetch")&&MsPortalFx.forEachKey(s,((e,s)=>{s.forEach((s=>{s.audience&&t.getToken({extensionName:e,resourceName:s.resource,audience:s.audience,skipCache:!1,isBackground:!0})}))}))})),t.saveMruTokenFunc=e=>{e?e.extension?e.resource&&this._loadInitialSettingsPromise.then((()=>{this.addMruEntry(e)})):l.warning("The 'entry.extension' to save to MRU token settings was null."):l.warning("The 'entry' to save to MRU token settings was null.")}}addMruEntry(e){const t=e.extension,s=e.resource;if("fx"===t||!s)return;const i=this._mruTokensQueue,o=this._mruTokensMap,n=o[t]||[];if(n.some((e=>e.resource===s)))MsPortalFx.remove(i,(e=>e.resource===s&&e.extension===t)),i.unshift(e);else{if(i.length>=5){const e=i.pop(),t=e.extension;MsPortalFx.remove(o[t],(t=>t.resource===e.resource)),o[t].length||delete o[t]}i.unshift(e),n.push({resource:s,audience:e.audience}),o[t]=n,this._settingsManager.setSetting(16,"mruTokens",o)}}};c=__decorate([__metadata("fx:diagnostics",[e,"MruTokensSettingsManager"]),s.Class(),__metadata("design:paramtypes",[o.SettingsManager,a.SecurityTokensManager])],c),t.MruTokensSettingsManager=c})),
define("MsPortalImpl/UI/Hubs/UI.BrowseManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Services/Services.AssetTypes"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowseManager=t.compareAssetTypeForSort=void 0;const o=MsPortalFx.Base.Constants.ResourceTypes.ResourceGroups.toLowerCase(),n=MsPortalFx.forEachKey;function r(e,t){const s=e.toLocaleLowerCase(),i=t.toLocaleLowerCase();return s===i?0:s<i?-1:1}t.compareAssetTypeForSort=r;let a=class{constructor(e){this._assetTypeService=e,this._browsePackages={};(this._ltm=new FxImpl.TriggerableLifetimeManager).registerForDispose((()=>{n(this._browsePackages,((e,t)=>{t.cancel(),t.dispose()}))}))}dispose(){this._ltm.dispose()}getFilteredAssetTypes(){const e=[],t=[];return this._assetTypeService.assetTypes.forEach((t=>{const s=t.assetTypeManifest;this._assetTypeMeetsRequirements(s)&&e.push(t)})),e.length&&t.push(...MsPortalFx.stableSort(e,((e,t)=>r(e.compositeDisplayName.service||e.compositeDisplayName.plural,t.compositeDisplayName.service||t.compositeDisplayName.plural)))),t}_assetTypeMeetsRequirements(e){if(!e)return!1;if(void 0===e.browseType)return!1;const t=e.resourceType;if(!t)return!0;const s=t.resourceTypeName;if(s.toLowerCase()===o)return!0;return!(s.split("/").length<2)}};a=__decorate([__metadata("fx:diagnostics",[e,"BrowseManager"]),s.Class(),__metadata("design:paramtypes",[i.AssetTypeService])],a),t.BrowseManager=a})),
define("MsPortalImpl/UI/Hubs/UI.FavoritesManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Services/Services.BrowseCuration","MsPortalImpl/UI/Hubs/UI.BrowseManager","MsPortalImpl/UI/Hubs/UI.NotificationManager","Weave","FxHubs/ResourceManagement"],(function(e,t,s,i,o,n,r,a,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FavoritesManager=t.findFavoriteItem=t.getFavoriteType=t.getAssetTypeKeywords=t.getAssetTypeIcon=t.getAssetTypeDisplayText=t.getAssetTypeKind=t.getAssetId=void 0;var p=MsPortalFx.Base,u=MsPortalFx.Extension,m=p.Constants.AssetNames,g=FxImpl.Assets,h=MsPortalFx.Hubs.Notifications.NotificationStatus,f=p.Diagnostics,x=f.Telemetry,b=MsPortalFx.tryImmediateResolve,v=(u.BrowseType,p.Promises.cancelOnDispose);const y=i.Favorites,M=y.Notification,I=(f.createLog(e),JSON.parse),C=JSON.stringify,P=/\s+/g,w=MsPortalFx.find,_={};function S(e,t,s){return t===m.BrowseResourceGroupBlade&&(t=m.ResourceGroups),g.getAssetTypeOrResourceTypeIdByWindowId(e,t)+(s?"."+s.toLowerCase():"")}function F(e,t){return t&&e.kindMap&&e.kindMap[(t||"").toLowerCase()]}function k(e,t){return t&&(t.serviceDisplayName||t.pluralDisplayName||y.assetPlusKindFormat.format(e.compositeDisplayName.service,t.name))||e.compositeDisplayName.service}function T(e,t){return t&&t.icon||e.icon}function D(e,t){return t&&t.keywords||e.assetTypeManifest.keywords}function E(e){const t=e.diContainer.get(o.AssetTypeService),s=e.assetType.assetTypeManifest,i=s&&(0,c.supportsOption)(s.options,1),n=F(e.assetType,e.kind),r=n&&(0,c.supportsOption)(n.options,1),a=n&&(0,c.supportsOption)(n.options,4),l=n?i?!a:r:i,d=k(e.assetType,n);return{id:e.assetTypeIdWithKind||e.assetType.id,image:T(e.assetType,n),isFavorite:ko.observable(!1),isFilteredOut:ko.observable(!1),isHidden:ko.observable(l),label:d,labelId:d.replace(P,""),keywords:(D(e.assetType,n)||"").split(","),matches:ko.observable(),uri:t.getAssetTypeDeepLink(e.assetType,e.kind),opensExternal:3===s.browseType,isPreview:e.assetType.isPreview,assetType:e.assetType,kind:e.kind,resourceType:s.resourceType&&s.resourceType.resourceTypeName,boost:e.boost,relevanceScore:ko.observable(),subCategoryId:e.subCategory,isDisabled:e.assetType.assetTypeManifest.isDisabled}}function B(e,t,s){if(!t)return null;const i=t,o=t,r=s.get(n.RedirectMap).getAssetRedirect(t);if(r&&(t=S(r.toExtension,r.toAsset,r.toKind)),r){const e=s.get(A);e.remove(i),e.add(t),x.trace({source:"SideBar",action:"FavoriteRedirected",name:o,data:{from:o,to:t}})}let a,l;const d=t.indexOf(".");d>0&&(l=t,t=l.substring(0,d),a=l.substring(d+1));const c=t.toLowerCase(),p=MsPortalFx.find(e,(e=>e.id.toLowerCase()===c));return p&&E({assetType:p,kind:a,diContainer:s,assetTypeIdWithKind:l})}FxImpl.getAssetTypeMappingData=()=>_,t.getAssetId=S,t.getAssetTypeKind=F,t.getAssetTypeDisplayText=k,t.getAssetTypeIcon=T,t.getAssetTypeKeywords=D,t.getFavoriteType=E,t.findFavoriteItem=B;let A=class{constructor(e,t,s){this._assetTypeService=e,this._browseManager=t,this._diContainer=s,this.favorites=(0,d.makeArrayComputation)(),this._notificationsForItems=ko.observable(),this._ltm=new FxImpl.TriggerableLifetimeManager,this._missingFavoritesWithIndex={},this._assetTypes=ko.observable(),this._initialFavorites=[],this.remove=e=>{const t=this._savedFavorites().length&&I(this._savedFavorites())||[],s=t.indexOf(e);-1!==s&&(t.splice(s,1),this._savedFavorites(C(t)))},this.add=e=>{const t=I(this._savedFavorites())||[];t.includes(e)||(t.push(e),this._savedFavorites(C(t)))},this.move=e=>{const t=I(this._savedFavorites())||[],s=this.favorites.value[e],i=t.indexOf(s.id);t.splice(e,0,t.splice(i,1)[0]),this._savedFavorites(C(t))},this._savedFavorites=ko.observable("")}initializeFavorites(e){const t=this._savedFavorites=MsPortalFx.isFeatureEnabled("skipsavedfavorites")?ko.observable(""):e.favorites,s=!(!t||!t());s&&(MsPortalFx.isFeatureEnabled("skipfavoritesupgrade")||function(e,t,s){const i=[],o=[[],["Microsoft_AAD_IAM_AzureActiveDirectory","Microsoft_Azure_Monitoring_AzureMonitoring","Microsoft_Azure_Security_SecurityDashboard","Microsoft_Azure_Billing_Billing","Microsoft_Azure_Support_HelpAndSupport"],["Microsoft_Azure_Expert_AzureAdvisor"]];if(s&&e.version()<o.length-1){const t=e.favorites,s=t().toLowerCase(),n=I(t());for(let t=(e.version()||0)+1;t<o.length;t++)o[t].forEach((e=>{const t=e.toLowerCase();s.indexOf(t)<0&&(n.push(e),i.push(e))}));t(C(n))}t(i),e.version(o.length-1)}(e,this._notificationsForItems,s),this._initialFavorites=I(t())),this.loadFavorites(),this._registerDependency()}loadFavorites(){const e=this._savedFavorites&&this._savedFavorites().length&&(e=>{const t=[];return e.forEach((e=>{switch(typeof e){case"string":if(e.startsWith("{"))try{const s=I(e);"string"==typeof s.typeId&&s.typeId&&t.push(s.typeId)}catch(e){}else t.push(e);break;case"object":e&&"string"==typeof e.typeId&&t.push(e.typeId)}})),this._savedFavorites(C(t)),t})(I(this._savedFavorites()))||[],t=[],s=(Q.isFulfilled(this._assetTypeService.assetTypesComplete),(e,s)=>{const i=B(this._assetTypes(),e,this._diContainer);i?(i.isFavorite(!0),t.push(i)):this._missingFavoritesWithIndex[e]=s}),i=()=>{const e=this._notificationsForItems()||[],s=e.slice(0);e.forEach((e=>{const i=w(t,(t=>e===t.id));if(i){const t=M.titleFmt.format(i.label),o=i.assetType.assetTypeManifest||{};(0,l.getNotificationManager)().addClientNotification({title:t,description:M.Description[(o.name||"").toLowerCase()]||t,status:h.Information,timestamp:new Date,uri:i.uri}),MsPortalFx.remove(s,e)}})),this._notificationsForItems(s),this.favorites.setAll(t)};return e.length?(e.forEach(((e,t)=>{e&&s(e,t)})),i(),Q()):Q(v(this._ltm,(0,r.getBrowseCuration)()).then((e=>{const t=this._initialFavorites;e.favorites.forEach((e=>{const s=S(e.extensionName,e.assetType,e.kind);t.push(s)})),this._initialFavorites.forEach(((e,t)=>{s(e,t)})),this._savedFavorites(C(t)),i()})))}dispose(){this._ltm.dispose()}_registerDependency(){this._assetTypes([]),b(v(this._ltm,this._assetTypeService.assetTypesComplete),(()=>{const e=this._browseManager.getFilteredAssetTypes()||[];e.length&&this._assetTypes(e),MsPortalFx.forEachKey(this._missingFavoritesWithIndex,((t,s)=>{if(-1!==s){const i=B(e,t,this._diContainer);i&&(i.isFavorite(!0),s=Math.min(s,this.favorites.value.length),this.favorites.insert(s,i),this._missingFavoritesWithIndex[t]=-1)}}))}))}};A=__decorate([__metadata("fx:diagnostics",[e,"FavoritesManager"]),s.Class(),__metadata("design:paramtypes",[o.AssetTypeService,a.BrowseManager,s.Container])],A),t.FavoritesManager=A})),
define("_generated/MsPortalImpl/Svg/Library/Polychromatic/AllServices.svg",["require","exports"],(function(e,t){"use strict";return{type:385,data:"<svg viewBox='0 0 18 18' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><defs><linearGradient id='a' x1='1.65' x2='1.65' y1='6.09' y2='3.44' gradientUnits='userSpaceOnUse'><stop offset='0' stop-color='#5e9624'/><stop offset='.4' stop-color='#65a227'/><stop offset='1' stop-color='#76bc2d'/></linearGradient><linearGradient id='b' x1='1.65' x2='1.65' y1='10.47' y2='7.83' gradientUnits='userSpaceOnUse'><stop offset='0' stop-color='#5e9624'/><stop offset='.54' stop-color='#6aa928'/><stop offset='1' stop-color='#76bc2d'/></linearGradient><linearGradient id='c' x1='1.65' x2='1.65' y1='15.02' y2='12.37' gradientUnits='userSpaceOnUse'><stop offset='0' stop-color='#5e9624'/><stop offset='.54' stop-color='#6aa928'/><stop offset='1' stop-color='#76bc2d'/></linearGradient></defs><rect width='13.97' height='1.45' x='3.73' y='4.04' fill='#8a8a8a' rx='.73'/><rect width='13.97' height='1.45' x='3.73' y='8.42' fill='#8a8a8a' rx='.73'/><rect width='13.97' height='1.45' x='3.73' y='12.97' fill='#8a8a8a' rx='.73'/><rect width='2.64' height='2.64' x='.32' y='3.44' fill='url(#a)' rx='1.32'/><rect width='2.64' height='2.64' x='.32' y='7.83' fill='url(#b)' rx='1.32'/><rect width='2.64' height='2.64' x='.32' y='12.37' fill='url(#c)' rx='1.32'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Library/Polychromatic/Dashboard.svg",["require","exports"],(function(e,t){"use strict";return{type:350,data:"<svg viewBox='0 0 18 18' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><defs><linearGradient id='a' x1='9' x2='9' y1='790.787' y2='774.125' gradientTransform='matrix(1 0 0 -1 0 791.516)' gradientUnits='userSpaceOnUse'><stop offset='0' stop-color='#6cc6b9'/><stop offset='.46' stop-color='#6ac4b7'/><stop offset='.64' stop-color='#62bdb0'/><stop offset='.77' stop-color='#56b1a4'/><stop offset='1' stop-color='#258277'/></linearGradient></defs><path fill='url(#a)' d='M.549 2.636h16.912a.518.518 0 0 1 .539.489v11.75a.518.518 0 0 1-.539.489H.549A.528.528 0 0 1 0 14.875V3.145a.529.529 0 0 1 .548-.509z'/><rect width='1.532' height='9.349' x='12.459' y='4.206' opacity='.9' rx='.147' class='msportalfx-svg-c01'/><rect width='8.572' height='1.937' x='1.628' y='11.629' opacity='.6' rx='.159' class='msportalfx-svg-c01'/><rect width='1.532' height='5.524' x='14.808' y='8.031' opacity='.9' rx='.113' class='msportalfx-svg-c01'/><path d='m9.117 4.772-2.13 3.79-2.253-2.295-2.322 3.011.544.427 1.842-2.376 2.338 2.386L9.72 5.119l-.603-.347z' class='msportalfx-svg-c01'/><ellipse cx='4.761' cy='6.795' rx='.876' ry='.881' class='msportalfx-svg-c01'/><ellipse cx='7.136' cy='8.979' rx='.876' ry='.881' class='msportalfx-svg-c01'/><ellipse cx='9.341' cy='5.055' rx='.876' ry='.881' class='msportalfx-svg-c01'/><ellipse cx='2.775' cy='9.363' rx='.876' ry='.881' class='msportalfx-svg-c01'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/Home.svg",["require","exports"],(function(e,t){"use strict";return{type:335,data:"<svg viewBox='0 0 18 18' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><defs><linearGradient id='a' x1='9' x2='9' y1='17.66' y2='.34' gradientUnits='userSpaceOnUse'><stop offset='0' stop-color='#0078d4'/><stop offset='.17' stop-color='#1c84dc'/><stop offset='.38' stop-color='#3990e4'/><stop offset='.59' stop-color='#4d99ea'/><stop offset='.8' stop-color='#5a9eee'/><stop offset='1' stop-color='#5ea0ef'/></linearGradient></defs><path fill='url(#a)' d='M17.8 8.29 9.41.5a.61.61 0 0 0-.82 0L.2 8.29a.62.62 0 0 0 .47 1.06h1.72a.3.3 0 0 1 .3.3v7.4a.61.61 0 0 0 .61.61h11.4a.61.61 0 0 0 .61-.61v-7.4a.3.3 0 0 1 .3-.3h1.72a.62.62 0 0 0 .47-1.06z'/><path fill='#e6e6e6' d='M7.07 12.4h3.86a.36.36 0 0 1 .32.38v4.88h-4.5v-4.88a.36.36 0 0 1 .32-.38z'/><path fill='#005ba1' d='M.67 9.35h.53l7.39-6.86a.61.61 0 0 1 .82 0l7.39 6.86h.53a.62.62 0 0 0 .47-1.06L9.41.5a.61.61 0 0 0-.82 0L.2 8.29a.62.62 0 0 0 .47 1.06z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/MonochromeHome.svg",["require","exports"],(function(e,t){"use strict";return{type:398,data:"<svg viewBox='0 0 2048 2048' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='m1024 165 941 942-90 90-83-82v805h-640v-640H896v640H256v-805l-83 82-90-90 941-942zm640 1627V987l-640-640-640 640v805h384v-640h512v640h384z'/></g></svg>"}})),
define("MsPortalImpl/Widgets/Widgets.SideBar",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/Hubs/UI.FavoritesManager","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/MsPortalImpl/Svg/Startup/Home.svg","_generated/MsPortalImpl/Svg/Startup/MonochromeHome.svg","MsPortalImpl/Services/Services.Recents","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Services/Services.GeneralSettings","_generated/MsPortalImpl/Svg/Library/Polychromatic/Dashboard.svg","_generated/MsPortalImpl/Svg/Library/Polychromatic/AllServices.svg","Weave","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.SideBar.css","MsPortalImpl/Base/Base.BrowserDetection"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g,h,f,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.reorderFavorite=t.ViewModel=void 0,(0,h.injectCss)(f);var b=MsPortalFx.Base,v=b.Images,y=b.Promises.cancelOnDispose;const M=window.fx.environment,I="li.fxs-sidebar-item",C=o.SideBar,P="fxs-sidebar-menu-container",w=MsPortalFx.isNullOrUndefined;let _=class extends r.ViewModel{setCollapsed(e,t=!0){this.focusBehavior(t),this.isCollapsed(e)}openCreate(){S("SideBarNewMenuOpened"),this.launchBlade((0,i.getGalleryDeepLink)("hub"))}reorderFavorites(e){!function(e,t,s){const i=$(document.activeElement).parent(),o=40===s?i.next(I):i.prev(I);if(o.length>0){const s=F(o.attr("data-id"),e,t);s>=0&&Q.fcall((()=>{const e=t.favoritesManager.favorites.value[s].uri,i=$.querySelectorAll(`.fxs-sidebar-bar [href|='${e}']`)[0];i&&i.focus()}))}}($(document.activeElement).parent().attr("data-id"),this,e)}openExternal(e){window.open(e,"_blank")}setWidget(e){this._widget=e}getRootElement(){return this._widget&&this._widget.element}constructor(e,t,s){super(),this.diContainer=e,this.favoritesManager=t,this._recentsManager=s,this.menuBladeId=(0,g.makeWritableComputation)(),this.menuBladePartContainer=(0,g.makeWritableComputation)(),this.allServiceLinkClicked=(0,g.makeWritableComputation)(!1),this.isCollapsed=(0,g.makeWritableComputation)(!0),this.layoutMode=(0,g.makeWritableComputation)(),this.hamburgerMode=(0,g.makeWritableComputation)(!0),this.focusBehavior=(0,g.makeWritableComputation)(!0),this.sideBarMenuIsActivated=(0,g.makeWritableComputation)(!1),this.hamburgerButton=new g.ElementRef,this.extensionSideBar=ko.observable(""),this.openFavorite=(e,t,s)=>{let i;if(i="number"==typeof e?this.favoritesManager.favorites.value[e]:e,i){if(i.opensExternal)return this.openExternal(i.uri),!0;if(!t&&!s){const e=i.assetType,t=i.kind;return e&&this._recentsManager.addService(e.id+(t?"."+t:"")),this.launchBlade(i.uri,i),!0}}};const n=MsPortalFx.isFeatureEnabled("brandingsidebar")?M.branding.browseLabel:C.allServices,r=MsPortalFx.isFeatureEnabled("monochromehomeicon")?l:a;this.topSectionLinks=[!M.chrome.hideCreateButton&&{classes:"fxs-sidebar-create",title:C.createTooltip,text:C.createResource,icon:v.Add({customClass:"msportalfx-fill-success"}),href:(0,i.getGalleryDeepLink)("hub"),onClick:()=>{S("SideBarNewMenuOpened")}},MsPortalFx.isFeatureEnabled("azurehome")&&{classes:"fxs-sidebar-home",title:o.AzureHome.azureHome,text:o.AzureHome.home,icon:r,href:(0,i.getHomeDeeplink)(),onClick:()=>{S("AzureHomeLinkClicked")}},!MsPortalFx.isFeatureEnabled("hidedashboards")&&{classes:"fxs-sidebar-dashboard",title:o.NavBar.home,text:o.NavBar.home,icon:u,href:(0,i.getDefaultDashboardDeeplink)(),onClick:()=>{S("DashboardNavigation")}},!MsPortalFx.isFeatureEnabled("hideallservices")&&{classes:"fxs-sidebar-browse",title:n,text:n,icon:m,href:(0,i.getAllServicesDeeplink)(),onClick:()=>{S("AllServicesMenuOpened"),this.allServiceLinkClicked(!0)}}].filter(MsPortalFx.identity),this.favorites=t.favorites,this.effectiveFavorites=this.favorites.cFilter((e=>!!e)),this.hamburgerMode(!(0,p.isSideBarDocked)(e)),this.extensionSideBar(e.get(FxImpl.Features).getValue("extensionsidebar"))}};function S(e,t,s){b.Diagnostics.Telemetry.trace({source:"SideBar",name:t,action:e,data:s})}function F(e,t,s){const i=s.favoritesManager.favorites,o=i.value,n=k(e,o),r=k(t,o);if(n>=0&&r>=0&&n!==r){S("SideBarFavoriteMoved",t,{oldIndex:r,newIndex:n});const e=i.value[r];return i.removeAt(r),i.insert(n,e),s.favoritesManager.move(n),n}return-1}_=__decorate([__metadata("fx:diagnostics",[e,"ViewModel"]),s.Class(),__metadata("design:paramtypes",[s.Container,n.FavoritesManager,d.RecentServicesManager])],_),t.ViewModel=_,t.reorderFavorite=F;function k(e,t){for(let s=0;s<t.length;++s)if(t[s]&&t[s].id===e)return s;return-1}t.Widget=class{constructor(e,t,s,i){this.ltm=e,this.element=t,this.options=s,this._diContainer=i,this._renderGuard=!1,s.setWidget(this);const o=this.ltm;this._lastFocusedElement=document.activeElement,this._settings=s.diContainer.get(p.GeneralSettings),s.hamburgerMode(!(0,p.isSideBarDocked)(s.diContainer)),this.render(window.innerWidth,window.innerHeight),this._settings.sideBarLayout.subscribe(o,(()=>{s.hamburgerMode(!(0,p.isSideBarDocked)(s.diContainer)),s.hamburgerMode.value||2!==s.layoutMode.value?s.setCollapsed(!0):2===s.layoutMode.value&&s.setCollapsed(this._settings.sideBarCollapsedKey()),this.render()})),(0,g.subscribe)(o,[s.isCollapsed],(e=>{e?c.unregister(this._dismissHandle):s.focusBehavior.value&&c.register(this._dismissHandle),this.render(),S("SideBarCollapsedChanged","",e?"collapsed":"expanded")}));const n=e=>!s.hamburgerMode.value&&2===s.layoutMode.value||this.element[0]===e||$.contains(this.element[0],e)?0:2;this._dismissHandle={dismissFn:()=>{s.setCollapsed(!0),c.unregister(this._dismissHandle)},shouldDismissOnFocusOutFn:n,shouldDismissOnMouseDownFn:n,shouldDismissOnMouseWheelFn:n,logName:"sidebar"};const r=()=>{x.isAndroidOrMobile||this.render(window.innerWidth,window.innerHeight)};window.addEventListener("resize",r),o.registerForDispose((()=>window.removeEventListener("resize",r))),this._attachEventHandlers()}render(e,t){if(this._renderGuard)return;this._renderGuard=!0;const s=this.options,i=s.isCollapsed,o=s.hamburgerMode,n=s.layoutMode.value;let r=n;var a;if(w(e)||w(t)||(a=e,r=t<500||a<640?0:a<1024?1:2,w(n)||S("SideBarLayoutChanged","",function(e){switch(e){case 0:return"SideBarFlyout";case 1:return"SideBarCollapsed";case 2:return"SideBarExpanded"}}(r))),r!==n&&(o.value||2!==r?s.setCollapsed(!0):2===r&&s.setCollapsed(this._settings.sideBarCollapsedKey()),(0===r||0===n)&&s.menuBladeId.value))if(0!==r){const e=this.element.findByClassName("fxc-menu");e.detach(),e.appendTo(s.menuBladePartContainer.value)}else{const e=s.menuBladePartContainer.value.findByClassName("fxc-menu");e.detach(),this.element.findByClassName(P).empty(),e.appendTo(this.element.findByClassName(P))}if(!o.value&&n!==r&&2===r){const e=document.getElementsByClassName("fxs-part-reactframe"),t=document.createEvent("Event");t.initEvent("resize",!0,!0);for(let s=0;s<e.length;s++)e[s].dispatchEvent(t)}if(s.focusBehavior.value&&(o.value||0===r))if(i.value){const e=this.element[0],t=document.activeElement;$.contains(e,t)&&c.validatePreviousFocusedElement(this._dismissHandle,this._lastFocusedElement)&&$(this._lastFocusedElement).focus()}else this.setFocus();n!==r&&s.layoutMode(r),this._renderGuard=!1}setFocus(){this._lastFocusedElement=document.activeElement,this.options.hamburgerButton.focus()}_attachEventHandlers(){y(this.ltm,Promise.all([MsPortalFx.require(e.normalize("MsPortalImpl/Widgets/Widgets.HoverCard")),MsPortalFx.require(e.normalize("MsPortalImpl/Widgets/ServiceHoverCard"))])).then((([e,t])=>{e.attach(this.ltm,this.element,".fxs-sidebar-favorite-item",(s=>{const i=this.options.favorites.value,o=i[k($(s.currentTarget).attr("data-id"),i)],n=this.element.find(`.fxs-hover-card-balloon[data-name='${o.id}']`).first(),r=new t.ViewModel(o,$(s.currentTarget),this._diContainer,"SidebarFavorite");return r.favoriteOnDismiss=!0,r.positionHint=4,b.Diagnostics.Telemetry.trace({source:"HoverCard",name:o.id,action:"InitialReveal",data:{hoverCardLocation:"SidebarFavorite"}}),new e.Widget(n,r,this._diContainer)}),this._diContainer)}))}}})),
define("MsPortalImpl/AzFramework/AzHost",["require","exports","Fx","Fx/Composition/Selectable","Fx/Controls/Toolbar","FxInternal/AsyncLoader","FxInternal/Controls/Essentials","FxInternal/UriScrubber","FxInternal/Weave","FxHubs/RpcEndPoints","MsPortalImpl/Base/Base.Events","MsPortalImpl/Base/Base.ImplUtils","MsPortalFx/Globalization","MsPortalImpl/RpcEndPoints","MsPortalImpl/AzFramework/AzExtensionCore","MsPortalImpl/Services/Services.ArmEvents","MsPortalImpl/Services/Services.Subscriptions","MsPortalImpl/Services/Services.Tenants","MsPortalImpl/Services/Services.PersistentStorage","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.Permissions","MsPortalImpl/Services/Kusto/KustoHelper","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/Services/Services.GlobalResourceFilters","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/UI/UI.BladeOpener","MsPortalImpl/UI/UI.NavigationManager.ForceSignIn","MsPortalImpl/Services/Services.PortalIdleState","MsPortalImpl/Widgets/Widgets.SideBar"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g,h,f,x,b,v,y,M,I,C,P,w,_,S,F){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.create=void 0;var k=MsPortalFx.Base,T=MsPortalFx.Base.Diagnostics,D=T.Telemetry,E=FxImpl.TelemetryContext,B=MsPortalFx.ViewModels.Toolbars,A=MsPortalFx.Hubs.Notifications,N=MsPortalFx.Composition.PartReference,O=d.AssetTypes.getRecentResourcesEndPoint;const R=k.Diagnostics.createLog(e),L=D.Context.getBladeContext;function z(e){const{extensionName:t,partName:s,parameters:i,initialSize:o,resourceId:n}=e;if(n)return e;let r,a,l;return"number"==typeof o?r=o:o&&(r=99,a=o.height,l=o.width),new N(s,i||{},{extensionName:t,initialSize:r,initialHeight:a,initialWidth:l})}function H(e){return e&&(0,g.isValidUri)(e)?k.Images.ImageUri(e):null}function U(e,t,s){"result"in t?e.resolve(s(t.result)):e.reject(new Error(t.error))}function W(e){let t;try{t=JSON.stringify(e,((e,t)=>{let s=t;return t instanceof Error&&(s={message:t.message,stack:t.stack,isError:!0}),s}))}catch(e){t="<Failed to serialize error>"}return t}t.create=function(t){const{lifetime:g,getToken:N,parameters:V,defaultTokenPromise:j,telemetryContextState:q,container:G,initializedDeferred:K,onMessageReceived:J,viewModel:X,extensionName:Y,extensionVersion:Z,diContainer:ee,selectedSubscriptions:te,getUserInfo:se,contentRevealedDeferred:ie,theme:oe,frameWindow:ne,features:re,router:ae,redirectBaseUri:le,provisioningContext:de,reactFrameType:ce,extensionStorage:pe,getSafeLink:ue,setContextPaneWidth:me,inContextPane:ge,globalResourceFilter:he,frameId:fe}=t,xe=void 0!==ce;let be;const ve=q&&E.usingState((()=>(be=L(),E.getCurrentValues())),q),ye=null==be?void 0:be.id;let Me,Ie,Ce=null,Pe=te;const we=e=>{if(Pe=e,!Pe){const e=ee.get(f.SubscriptionsUserContext).getInSessionSelectedSubscriptions();Pe={get:()=>e.then((e=>e())),onChangedPromise:e}}Me&&Me.dispose(),Me=g.createChildLifetime(),Pe.onChangedPromise.then((e=>e.subscribe(Me,(e=>{De(1005,{subscriptions:e})}))))};we(te);const{registerFunction:_e,callRegisteredFunction:Se,validStubId:Fe}=function(){let e=1;const t={};function s(s,o){if(s){const n=e++;return t[n]=o?function(){i(n),s.apply(null,arguments)}:s,n}}function i(e){n(e)&&delete t[e]}function o(e){const{responseStubId:s,response:i}=e;t[s].call(null,i)}function n(e){return"number"==typeof e}return{registerFunction:s,callRegisteredFunction:o,validStubId:n}}(),ke=[];let Te,De=function(e,t){ke.push({kind:e,data:t})};function Ee(e,t){De(1001,{stubId:e,args:t})}function Be(e){const{bladeName:t,extensionName:s,parameters:o,marketplaceId:n,marketplaceOptions:r,onClosed:a,referenceType:l,initialData:d,providerConfig:c,receiveResult:p,menuId:u,contentBladeReference:m}=e,g=Fe(a)&&((e,t)=>{Ee(a,[e,t])})||null;let h;if(1===l)h=new i.ParameterProviderBladeReference(t,s,{parameters:o,onClosed:g,supplyInitialData:d&&(()=>FxImpl.fromSerializableObject(d)),supplyProviderConfig:c&&(()=>c),receiveResult:Fe(p)&&(e=>{Ee(p,[e&&FxImpl.toSerializableObject(e)])})});else if(2===l){const e=m&&Be(m);h=new i.MenuBladeReference(t,u,s,{contentBladeReference:e,parameters:o,onClosed:g})}else h=3===l?new i.ProvisioningBladeReference(t,s,n||r,{parameters:o,onClosed:g}):new i.PdlBladeReference(t,s,{parameters:o,onClosed:g});return FxImpl.shellInterface(h,FxImpl.shellInterface(e)),h}function Ae(e){return{bladeName:e.bladeName,extensionName:e.extensionName,parameters:e.parameters}}function Ne(e){const{uri:t,target:s,onLinkOpened:i}=e;return{uri:ko.observable(t),target:ko.observable(s),onLinkOpened:Fe(i)&&(e=>Ee(i,[e]))}}function Oe(e,t){De(1033,{responseStubId:e.responseStubId,response:{result:t,calleeEndTime:Date.now()}})}function Re(e){const t=e.options.onClosed;e.options.onClosed=function(e,s){ct(),null==t||t(e,s)}}const Le=new FxImpl.TriggerableLifetimeManager;function ze(e,t){k.Promises.cancelOnDispose(Le,e).then((e=>Oe(t,e))).catch((e=>{g.isDisposed()||De(1033,{responseStubId:t.responseStubId,response:{error:W(e),calleeEndTime:Date.now()}})}))}function He(){const{currentTheme:e,highContrastMode:t}=oe;return{mode:e().mode,highContrastMode:t()}}function Ue(e){const{inContextPane:t,fromMenu:s,options:i}=e;let o;return(null==i?void 0:i.asNewJourney)?o|=8:t?(o|=1,o|=ge&&4):s&&(o|=s&&4),o|=(null==i?void 0:i.asSubJourney)&&2,o|=ge&&16,o|=1===(null==i?void 0:i.helpPane)&&64,o|=2===(null==i?void 0:i.helpPane)&&128,o}const We=(()=>{const e=[];return{request:t=>{const{bladeReferenceStubId:s,fromMenu:i}=t,o=e[s]=Q.defer();let n=o.promise;const r=Ue(t);i&&(n=o.promise.then((e=>(Re(e),e))));const a=ee.get(w.BladeOpener).openBlade(n,{container:G,flags:r,telemetryName:"AzHost"});i&&a.then(dt),ze(a,t)},response:t=>{const{responseStubId:s,response:i}=t;U(e[s],i,Be)}}})(),Ve=e=>{e.subscribe(g,(e=>{we(null),Ce=null,De(3082,{name:null==e?void 0:e.name})}))};let je=he;je?Ve(je):ee.get(f.SubscriptionsUserContext).useGlobalResourceFiltersPromise.then((e=>{e&&(je?Ve(je):ee.getAsync(C.ResourceFilterManager).then((e=>{je=e.currentFilterObservable,Ve(je)})))})),ee.get(h.ArmEvents).subscribeToArmEvent({status:"succeeded"},(e=>De(1030,e)));const qe=()=>{var e;return null===(e=location.hash)||void 0===e?void 0:e.replace("#","")};ee.get(c.PortalCustomEvents).addHandler(g,"fxdeeplinkchanged",(()=>{De(1031,qe())}));const $e=j&&k.Promises.cancelOnDispose(g,j).then((e=>({result:e}))).catch((e=>({error:e}))),Qe=k.Promises.cancelOnDispose(g,se?se():ee.get(P.AuthStateManager).getUserInfo()).then((e=>({result:e}))).catch((e=>({error:e})));function Ge(e,t){J&&J[e]&&J[e]();const s=tt.get(e);s?s(t):R.error(`Handler[${e}] is undefined`,null,{extension:Y,context:ve})}function Ke(e){E.usingState((()=>{T.Telemetry.trace({name:ye,source:"AzHost",action:"ReactViewErrors",actionModifier:"complete",extension:Y,data:{frameId:fe,errors:e}})}),q)}const Je=Q.defer(),Xe=(()=>{const e=FxImpl.Rpc.client;return()=>FxImpl.Rpc.client===e&&!window.azTestHooks})(),Ye=e=>{Xe()&&FxImpl.Extension.traceToExtensionEndPoint.invoke(FxImpl.Rpc.client,Y,[e,q]),"HubsExtension"!==Y&&D.trace(e)},Ze=()=>ye.includes("HubsExtension")?"LighthousePerfVizClientTelemetry":"LighthousePerfVizExtTelemetry",et=e=>Object.assign({bladeId:ye,tableName:Ze()},e&&{shellVersions:JSON.stringify((null==e?void 0:e.shellVersions)||[]),extensionVersions:JSON.stringify((null==e?void 0:e.extensionVersions)||[]),features:JSON.stringify((null==e?void 0:e.features)||[]).replace(/"/g,'\\"')}),tt=new Map,st=()=>{De(1,function(){const e=FxImpl.internalEnv.extensionTelemetryUri,t=FxImpl.internalEnv.extensionTraceUri,s=MsPortalFx.sessionId,i=MsPortalFx.extend2(FxImpl.getStandardHeaders(Y,Z),{"Accept-Language":u.displayLanguage,"x-ms-effective-locale":FxImpl.Intl.effectiveLocale,"x-ms-client-session-id":s}),o=ko.computed(g,(()=>He()));let n;if(o.subscribe(g,(e=>De(1004,{theme:e}))),!window.azTestHooks){const{layoutMode:e}=ee.get(F.ViewModel),{sideBarLayout:t}=ee.get(I.GeneralSettings),s=(0,l.toObservable)(g,e);n=ko.explicitComputed(g,[s,t],(e=>(0,I.isSideBarDocked)(ee)?e:0)),n.subscribe(g,(e=>{De(3078,e)}))}return{parameters:V,sessionId:s,diagnostics:{telemetryContext:ve,headers:i,telemetryUri:e,loggingUri:t},features:re,theme:o(),deepLink:qe(),sideBarLayoutMode:null==n?void 0:n()}}()),$e.then((e=>De(2,{token:e}))),Qe.then((e=>De(4,{userInfo:e})))};!xe||window.azTestHooks?tt.set(0,st):(tt.set(1042,(()=>{const e=window.location.hash;window.location.hash="#home",setTimeout((()=>window.location.hash=e))})),st()),tt.set(1e3,(e=>{e.forEach((e=>Ge(e.kind,e.data)))})),tt.set(1010,(()=>{ie.resolve(),G.revealContent()})),tt.set(1011,(()=>K.resolve())),tt.set(1012,(e=>{const t=e&&e.title,s=e&&e.subtitle;if(2===ce)G.partTitle(t),G.assetName(s);else{const e=X;e.title(t),e.subtitle(s)}})),!xe&&tt.set(1013,(()=>{let e;return t=>{const{indicator:s}=t;if(s&&0!==s){e||(e=Q.defer(),G.operations.add(e.promise));const t=2===s||3===s,i=2===s?0:3===s?1:null;G.operations.update(e.promise,{blockUi:t,shieldType:i})}else e&&(e.resolve(),e=null)}})()),tt.set(1014,(e=>{const{bladeReference:t,fromMenu:s}=e,i=Be(t),o=Ue(e);s&&Re(i);const n=ee.get(w.BladeOpener).openBlade(i,{container:G,flags:o,telemetryName:"AzHost"});s&&n.then(dt),ze(n,e)})),tt.set(1015,We.request),tt.set(1016,We.response),tt.set(1028,(()=>{window.location.hash="#menu/directory"})),tt.set(3006,(e=>{ze(Q(MsPortalFx.require("FxInternal/ResourceManagement/ResourceGroups").then((({getArmResourceGroups:t})=>t(e.subscriptionIds)))),e)})),tt.set(3007,(e=>{const t=Q(ee.get(y.PermissionsManager).hasPermission(`/subscriptions/${e.subscriptionId}`,["Microsoft.Resources/subscriptions/resourcegroups/write"],k.Constants.Shell).then((t=>MsPortalFx.ViewModels.getValidationResult(t?void 0:MsPortalFx.Resources.Strings.ResourceGroup.Validation.subscriptionHasNoPermissionsMessage.format(e.subscriptionId)))));ze(Q(MsPortalFx.Azure.ResourceGroups.validateResourceGroupName(e.resourceGroupName,e.subscriptionId,e.existingResourceGroupNames,void 0,t)).then((e=>({valid:e.valid,message:e.message}))),e)})),tt.set(3004,(e=>{ze(MsPortalFx.require("FxInternal/Controls/Essentials").then((({getEssentialsResourceInfo:t})=>t(G,e.resourceId,e.includeTags))),e)})),tt.set(3025,(e=>{ze(ee.get(v.AssetTypeService).mapResourceIdAndKindToBladeInfo(e.resourceId).then((t=>({bladeName:t.bladeName,extensionName:t.bladeExtension,parameters:{id:e.resourceId}}))),e)})),tt.set(3026,(e=>{const t=new r.TagResourcesBladeReference(e);ze(Q(Ae(t)),e)})),tt.set(3028,(e=>{const t=new r.EditTagsBladeReference({resource:e.resourceId,tagName:e.tagName});ze(Q(Ae(t)),e)})),tt.set(3042,(e=>{const t=Q.defer();MsPortalFx.require("FxHubs/ArmHelpers/ArmTags").then((s=>{s.handleTagsContextPaneResults(e.resourceToTagsMap).then((s=>{if(s.armErrorsMap.get(e.resourceId))t.resolve();else{const i=s.newTagsMap.get(e.resourceId),o=Object.keys(i).map((e=>({key:e,value:i[e]})));t.resolve(o)}}))})),ze(t.promise,e)})),tt.set(3029,(e=>{const t=new i.PdlBladeReference("RmAddResourceWizardBlade","Microsoft_Azure_ResourceMove",{parameters:e});ze(Q(Ae(t)),e)})),tt.set(3060,(e=>{ze(ee.get(v.AssetTypeService).getBrowseBladeReference(e.browseBladeReferenceOptions).then((e=>e&&{bladeName:e.blade,extensionName:e.extension,parameters:e.parameters})),e)})),tt.set(1017,(e=>{ze(G.closeChildBlade(),e)})),tt.set(1018,(e=>{ze(G.closeContextBlade(),e)})),tt.set(1019,(e=>{const{partReferences:t,options:s}=e;ze(MsPortalFx.require("Fx/Pinner").then((({pin:e})=>e(t.map(z),{notify:s&&s.notify}))),e)}));const it=[];tt.set(3059,(e=>{it.push(e)})),tt.set(1020,(e=>{const{metadata:t,code:s,message:i,details:o}=e,n={message:i,metadata:t,code:s,capturedErrors:it,details:o};G.fail(Object.assign(Object.assign({},e),{error:{data:n}})),K.reject(n),Ke(n),pt()})),tt.set(1032,(e=>{const{message:t,timestamp:s}=e;G.handledError(null!=t?t:"No message");Ke({message:t,capturedErrors:it}),pt({timestamp:s})})),tt.set(1023,(e=>{const{message:t,timestamp:s}=e;G.noDataMessage(t);Ke({message:t,capturedErrors:it}),pt({timestamp:s})})),tt.set(1021,(e=>{const{message:t,timestamp:s}=e;G.notFound(t);Ke({message:t,capturedErrors:it}),pt({timestamp:s})})),tt.set(1022,(e=>{const{message:t,timestamp:s}=e,i="string"==typeof t?t:function(e){const{header:t,title:s,description:i,callToActionText:o,callToActionUri:n,imageType:r}=e;return{noticeHeader:t,noticeTitle:s,noticeDescription:i,noticeCallToActionText:o,noticeCallToActionUri:n,noticeImageType:r}}(t);G.unauthorizedMessage(i);Ke({message:i,capturedErrors:it}),pt({timestamp:s})})),!xe&&tt.set(1024,(e=>{ze(G.openDialog(function(e){const{buttons:t,defaultButton:s,onClosed:i}=e;return MsPortalFx.extend2(e,{buttons:"number"==typeof t&&t||Array.isArray(t)&&t.map((e=>{const{displayText:t,button:s}=e;return{displayText:t,button:s}}))||null,defaultButton:s,onClosed:Fe(i)&&(e=>{Ee(i,[e])})})}(e)),e)})),tt.set(3090,(t=>{MsPortalFx.require(e.normalize("MsPortalImpl/AzFramework/AzHost.Notifications")).then((e=>{e.mapAndPublishInternalNotification(t,Y)}))})),tt.set(3091,(t=>{MsPortalFx.require(e.normalize("MsPortalImpl/AzFramework/AzHost.Notifications")).then((e=>{e.mapAndPublishInternalPendingNotification(t,Y)}))})),tt.set(3092,(t=>{MsPortalFx.require(e.normalize("MsPortalImpl/AzFramework/AzHost.Notifications")).then((e=>{e.mapAndPublishInternalPollingNotification(t,Y)}))})),tt.set(1025,(e=>{const{status:t,title:s,description:i,descriptionAsHtml:o,correlationIds:n,percentComplete:r,linkTo:a}=e,l={status:t,title:s,description:i,descriptionAsHtml:o,correlationIds:n,percentComplete:r};if(a)if("string"==typeof a)l.uri=a;else if(a.assetId){const{extensionName:e,assetType:t,assetId:s}=a;l.asset={extensionName:e,assetType:t,assetId:s}}else{const e=a,{extensionName:t,bladeName:s,parameters:i}=e;l.linkedBlade={detailBlade:s,extension:t,detailBladeInputs:i||{}}}A.ClientNotification.publish(l)})),tt.set(1003,Se),tt.set(1006,(e=>{const{resourceName:t}=e;ze(N(t&&{resourceName:t}),e)})),tt.set(1007,(e=>{ze(Pe.get(),e)})),tt.set(3084,(e=>{ze(MsPortalFx.require("Fx/Notifications/IrisNotifications").then((({getIrisContent:t})=>t(e))),e)})),tt.set(3085,(e=>{ze(MsPortalFx.require("Fx/Notifications/IrisNotifications").then((({sendIrisSignal:t})=>t(e))),e)})),tt.set(3055,(e=>{MsPortalFx.UI.AssetManager.notifyResourceDeleted(e.resourceId)})),tt.set(3077,(e=>{ze(ee.getAsync(n.get("MsPortalImpl/UI/Compositions/UI.Composition.BladeHistory","BladeHistory")).then((e=>e.getEntries())),e)}));const ot=()=>{if(!Ce){const e=Q.defer();ee.get(f.SubscriptionsUserContext).getInSessionDisplayedSubscriptions().then((t=>e.resolve(t.subscriptions))),Ce=e.promise}return Ce};tt.set(3001,(e=>{ze(ot(),e)})),tt.set(3002,(e=>{const t=Q.defer(),s=e.subscriptions.reduce(((e,t)=>(e[t.subscriptionId]=!0)&&e),{});ot().then((e=>{const i=e.map((e=>e.subscriptionId)).filter((e=>s[e]));ee.get(f.SubscriptionsUserContext).setInSessionSelectedSubscriptions(i).then((()=>t.resolve(!0)))})),ze(t.promise,e)})),tt.set(3081,(e=>{const t=je&&je();ze(Q(null==t?void 0:t.name),e)})),tt.set(3015,(e=>{ze(Q(FxImpl.Azure.getLocationsForCreate(FxImpl.Rpc.client,{subscriptionId:e.subscriptionId,resourceTypes:e.resourceTypes}).then((e=>e))),e)})),tt.set(3080,(e=>{ze((0,s.memoizePromise)((()=>MsPortalFx.Azure.getLocations()))(),e)})),tt.set(3037,(e=>{ze(Q(ee.get(b.PersistentStorageSettings).writeSetting(Y,e.key,e.value,e.readers)),e)})),tt.set(3038,(e=>{var t;ze(Q(ee.get(b.PersistentStorageSettings).readSettings(null!==(t=e.extensionName)&&void 0!==t?t:Y,e.keys,Y)),e)})),tt.set(3039,(e=>{ze(Q(ee.get(b.PersistentStorageSettings).removeSettings(Y,e.keys)),e)})),tt.set(3040,(e=>{ze(Q(ee.get(b.PersistentStorageSettings).clear(Y)),e)})),tt.set(3041,(e=>{ze(Q(ee.get(b.PersistentStorageSettings).getAllSettingsKeys(Y)),e)})),tt.set(3018,(e=>{ze(ee.get(v.AssetTypeService).getResourceTypeAssetTypeInformation(e.resourceTypes),e)})),tt.set(3019,(e=>{ze(ee.get(f.SubscriptionsUserContext).getSubscription(e.subscriptionId),e)})),tt.set(1026,(e=>{const{dashboardId:t}=e;ae.navigateWithRoute("dashboard",null,{dashboardId:t})})),tt.set(3067,(()=>{ae.goToLandingPage({interactionSource:"Blade",replaceHistory:!1})})),tt.set(3068,(()=>{$.querySelectorAll(".fxs-topbar-sidebar-collapse-button").trigger("fxtogglesidebar",{updateSettings:!0})})),tt.set(3071,(e=>{ae.route(e,{openedBy:4})})),!xe&&tt.set(1027,(e=>{const{baseUri:t}=e;le(t)})),tt.set(3043,(e=>{if(m.extensionsAllowedToForceSignIn.includes(Y)){const{reason:t,bladeReference:s,signInParameters:i,tenantId:o}=e,n=s&&Be({extensionName:s.extensionName,bladeName:s.bladeName,parameters:s.parameters,referenceType:null,menuId:null}),r=(0,_.forceSignIn)(ee,{bladeReference:n,reason:t,signInParameters:i,tenantId:o},Y);ze(Q(r),e)}else ze(Q.reject(`The extension '${Y}' is not allowlisted to access the 'forceSignIn' API.`),e)})),tt.set(1029,(e=>{const t=e.forceSvg?{customClass:"forceSvg"}:{symbol:!0};ze(MsPortalFx.require("MsPortalImpl/Base/Base.ImageHelper").then((({GetImageData:s})=>s({type:e.type,options:t},{bypassCache:!0}))).then((e=>e.map((e=>e.outerHTML)).join(""))),e)})),tt.set(3020,(e=>{ze(MsPortalFx.require("Fx/Assets/AssetTypes").then((({getAllAssetTypes:t})=>t(e))),e)})),tt.set(3005,(e=>{ze(ee.get(x.TenantsService).getTenants().then((e=>e.tenants)),e)})),tt.set(2e3,(e=>{const t=X,s=t.icon(),i=H(e.iconUri);s&&i&&s.data===i.data||t.icon(i)})),tt.set(2001,(e=>{const{stubId:t}=e,s=Fe(t)?()=>{const e=Q.defer();return De(1002,{stubId:t,responseStubId:_e((t=>{U(e,t,z)}),!0)}),Q(k.Promises.cancelOnDispose(g,e.promise))}:null;X.setOnPinHandler(s)})),tt.set(4e3,(e=>{const{stubId:t}=e,s=Fe(t)?()=>{De(1001,{stubId:t})}:null;X.setOnClickHandler(s)})),tt.set(4001,(e=>{const{stubId:t,options:s}=e,i=Fe(t)?e=>{De(1001,{stubId:t,args:[e]})}:null;X.setUpdatableHeaderHandler(i,s)}));const nt=(0,s.memoizePromise)((()=>{const e={};return MsPortalFx.require("FxInternal/Composition/ViewModelAdapters.DoesProvisioning").then((({setProvisioning:t})=>(t(ee,e,de,G,be,void 0,Le),e)))}),{onError:t=>((0,p.logToExtension)(e,Y,2,t),!0)});de&&nt(),tt.set(3008,(e=>{ze(nt().then((e=>({initialValues:e.initialValues,marketplaceItem:e.marketplaceItem,resourceGroupName:e.resourceGroupName,telemetryId:e.telemetryId}))),e)})),tt.set(3009,(async e=>{ze((await nt()).validateTemplate(e),e)}));const rt=Object.create(null);tt.set(3010,(async e=>{const t=(await nt()).deployTemplate(e),s=Q.defer();t.finally((()=>setTimeout(s.resolve,5e3))),ze(t,e)})),tt.set(3075,(async e=>{const t=(await nt()).deployStack(e),s=Q.defer();t.finally((()=>setTimeout(s.resolve,5e3))),ze(t,e)})),tt.set(3011,(async e=>{const t=await nt(),s=Q.defer(),i=MsPortalFx.getUniqueId();rt[i]=s,t.deployCustom({provisioningPromise:s.promise}),Oe(e,i)})),tt.set(3012,(e=>{rt[e.deploymentId].resolve()})),tt.set(3076,(async e=>(await nt()).setMarketplaceId(e))),tt.set(3013,(async e=>{const t=(await nt()).getArmErrorsBladeReference(e);Oe(e,{bladeName:t.bladeName,extensionName:t.extensionName,parameters:t.parameters})})),tt.set(3014,(async e=>{const t=(await nt()).getAutomationBladeReference(e);Oe(e,{bladeName:t.bladeName,extensionName:t.extensionName,parameters:t.parameters})})),tt.set(3016,(e=>{K.resolve(e)})),tt.set(3017,(e=>{ze(MsPortalFx.require("MsPortalImpl/UI/UI.LinkHandler").then((t=>{const s=t.getUriAndHandler(g,ee,e,!1);return s.uriPromise?s.uriPromise().then((()=>FxImpl.ensureAbsoluteUri(s.uri()))):FxImpl.ensureAbsoluteUri(s.uri())})),e)})),!xe&&tt.set(2002,(e=>{const t=X;t.commandBar||(t.commandBar=new B.Toolbar(g));const s=t.commandBar,i=s.items(),n=(Te=e).map((e=>{let t=e.name&&MsPortalFx.find(i,(t=>t instanceof B.ToolbarItem&&t.name===e.name));return t||(t=function(e){const{type:t}=e;function s(){return MsPortalFx.find(Te,(t=>t.name===e.name))}switch(t){case 4:return new B.CommandButton({name:e.name,command:{canExecute:ko.observable(),execute:e=>(Ee(s().execute),Q())}});case 2:{const t=new B.OpenLinkButton({name:e.name,uri:""});return t.clickableLink.onLinkOpened=e=>{Ee(s().clickableLink.onLinkOpened)},t}case 12:return new B.Separator;case 6:{const t=e;return new B.ToggleButton({name:e.name,optionGroupName:t.optionGroupName,command:{canExecute:ko.observable(),execute:e=>(Ee(s().execute,[e.checked]),Q())}})}case 1e3:return o.ToolbarItems.createFeedbackButton(G,{onButtonClicked:e=>{Ee(s().onButtonClicked,[e])},telemetryName:e.telemetryName});default:throw new Error(`Unsupported toolbar item - ${String(t)}.`)}}(e)),function(e,t){if(12===e.type||1e3===e.type)return;{const s=e,i=t;i.ariaLabel(s.ariaLabel),i.disabled(s.disabled);const o=H(s.iconUri);switch(MsPortalFx.deepEquals(o,i.icon())||i.icon(o),i.label(s.label),i.tooltip(s.tooltip),i.unauthorizedMessage(s.unauthorizedMessage),e.type){case 4:i.command.canExecute(!s.disabled);break;case 2:{const e=i,t=s;e.clickableLink.uri(t.clickableLink.uri),e.clickableLink.target(t.clickableLink.target);break}case 6:{const e=i,t=s;if(e.command.canExecute(!s.disabled),e.checked(t.checked),e.optionGroupName!==(t.optionGroupName||""))throw new Error("Can't modify 'optionGroupName' dynamically.");break}}}}(e,t),t}));s.setItems(n)})),tt.set(2003,(e=>{ze(G.closeCurrentBlade(e.returnedData),e)})),!xe&&tt.set(2004,(e=>{const t=e,s=t&&{text:t.text,state:t.state,onClick:"number"==typeof t.onClick?()=>Ee(t.onClick):t.onClick&&Ne(t.onClick)};X.statusBar(s)})),tt.set(2005,(e=>{const{id:t,parametersOrOverrideBlade:s}=e;G.menu.switchItem(t,s?Be(s):null)})),tt.set(2006,(e=>{const t=e&&e.title,s=e&&e.subtitle,i=X.menuContent;i.title(t),i.subtitle(s)})),tt.set(2007,(e=>{e?G.form.configureAlertOnClose(ko.observable(e)):G.form.configureAlertOnClose(1)})),tt.set(3030,(e=>{if(new MsPortalFx.Base.UriBuilder(e.url).getAuthority().includes(FxImpl.origin))return;const t=window.fetch(e.url,{headers:new Headers(e.headers),method:e.method,body:e.body}).then((e=>{const t={};return e.headers.forEach(((e,s)=>{t[s]=e})),e.text().then((s=>({responseHeaders:t,responseText:s,status:e.status,statusText:e.statusText})))}));ze(Q(t),{responseStubId:e.responseStubId})})),tt.set(3061,(e=>{MsPortalFx.require("FxHubs/ArtHelpers/ResourceHoverCardHelpers").then((t=>{ze(t.getResourceFromArg(e.manifestColumns,e.projectedColumns,e.browseQuery,e.armId,e.resourceId,e.assetTypes,e.locations,e.directoriesMap,g),e)}))})),tt.set(3062,(async e=>{const t=await d.ArtBrowse.getBrowsePrereqsEndpoint.invoke(FxImpl.Rpc.client,"fxw",Object.assign({},e));Promise.all([MsPortalFx.require("FxHubs/ArtHelpers/ResourceHoverCardHelpers"),MsPortalFx.require("FxHubs/ArtHelpers/ArgBrowseHelpers"),MsPortalFx.require("FxHubs/ResourceCommands/BrowseBulkCommandConfig")]).then((([s,i,o])=>{Oe(e,{browsePrereqs:t,bulkCommandDefinitions:o.BulkCommandDefinitions,defaultProperties:s.defaultProperties,columnIdToStringMap:i.columnIdToStringMap,columnIdToArgColumn:i.columnIdToArgColumn})}))})),tt.set(3063,(e=>{MsPortalFx.require("FxHubs/ResourceCommands/BrowseBulkCommandImpl").then((s=>{new s.BulkCommandImpl(t.lifetime,"ResourceHoverCard",{resourceType:e.resourceType,hasSelectedItems:ko.observable(!0),selectedBrowseItems:ko.observable([{name:e.resourceName,id:e.resourceId,type:e.resourceType}])},e.commandDefinition).execute({button:6})}))})),tt.set(3064,(e=>{ze(d.AssetTypes.isResourceFavoriteEndPoint.invoke(FxImpl.Rpc.client,"HubsExtension",{resourceId:e.resourceId}),e)})),tt.set(3065,(e=>{ze(d.AssetTypes.removeFavoriteResourceEndPoint.invoke(FxImpl.Rpc.client,"HubsExtension",{resourceId:e.resourceId,telemetrySource:e.telemetrySource}),e)})),tt.set(3066,(e=>{ze(d.AssetTypes.addFavoriteResourceEndPoint.invoke(FxImpl.Rpc.client,"HubsExtension",Object.assign({},e)),e)}));const at=ee.get(S.PortalIdleStateService);let lt;if(tt.set(3052,(()=>at.signalBusy(1,ce))),tt.set(3051,(()=>at.signalIdle(1))),xe){lt=pe.registerChangeListener((e=>{De(3024,e)})),tt.set(3021,(e=>{pe.setItem(e)})),tt.set(3022,(e=>{pe.removeItem(e)})),tt.set(3023,(e=>{pe.clear(e)})),tt.set(3031,(e=>{ze(Q({uri:ue(e.uri,Y)}),e)})),tt.set(3035,(e=>{["keyup","keydown"].includes(e.type)&&window.document.dispatchEvent(new KeyboardEvent(e.type,e.event))})),tt.set(3044,(e=>{null==me||me(e)})),tt.set(3045,(e=>{ze(O.invoke(FxImpl.Rpc.client,"HubsExtension",{}),e)})),tt.set(3047,(e=>{MsPortalFx.require("Fx/ResourceManagement").then((t=>t.addRecentResource(e)))})),tt.set(3048,(e=>{ze(ee.getAsync(n.get("MsPortalImpl/UI/UI.SupportContext","SupportContext")).then((t=>t.hasMenuItem(e.menuId))),e)})),tt.set(3049,(e=>{Oe(e,qe())})),tt.set(3050,(async e=>{const t=MsPortalFx.clone(await Je.promise,!0);if(null==t?void 0:t.data){const e=t.data;delete e.ajaxCalls,delete e.longTasks}E.usingState((()=>{Ye({name:ye,source:"AzHost",action:"ReactViewReady",actionModifier:"complete",extension:Y,data:Object.assign(Object.assign(Object.assign({},e.profileData),t&&{lighthouse:t}),{frameId:fe}),duration:e.duration})}),q)})),tt.set(3057,(e=>{ze((async()=>{(await ee.getAsync(n.get("MsPortalImpl/UI/UI.HelpPane","HelpPane"))).open(e,q)})(),e)})),tt.set(3058,(t=>{let s;MsPortalFx.isFeatureEnabled("azureconsole")?s=ee.getAsync(n.get("MsPortalImpl/UI/UI.AzureConsole","AzureConsole")).then((e=>e.executeInCloudShell(t,q))).catch((e=>(R.error(FxImpl.createError("Failed to execute in CloudShell",{innerErrors:e})),!1))):((0,p.logToExtension)(e,Y,1,"Azure Console feature is not enabled in this environment."),s=Promise.resolve(!1)),ze(s,t)}));const t=e=>({instanceId:e.instanceId,data:e.data,lighthouseMetrics:e.LighthouseMetrics});tt.set(3069,(e=>{ze((0,M.getPrimaryData)(M.QueryType.LoadLighthousePerfProfiles,et(e),!0).then((e=>e.data.map(t))),e)})),tt.set(3070,(e=>{const s=e.instanceId;ze((0,M.getPrimaryData)(M.QueryType.LoadLighthousePerfProfile,{tableName:Ze(),instanceId:s},!0).then((e=>{if(1===e.data.length)return t(e.data[0]);throw new Error("Load failed")})),e)})),tt.set(3086,(e=>{ze(Promise.all([(0,M.getPrimaryData)(M.QueryType.LighthouseTimelineSummary,et(e),!0),(0,M.getPrimaryData)(M.QueryType.LighthouseScoreSummary,et(e),!0)]).then((([e,t])=>{const s=e.data,[i]=t.data;return{profileData:s,lighthouseMetrics:i}})),e)})),tt.set(3089,(()=>{const e=MsPortalFx.Resources.Strings.Azure.Subscriptions.DropDown,t=MsPortalFx.ViewModels.getValidationResultPromise;return async s=>{const i=s.subscription,o=await MsPortalFx.require("FxInternal/ResourceManagement/ArmTemplate");ze(o.canRegisterSubscriptionWithRPs(ee,i.subscriptionId,s.resourceProviders).then((s=>{if(s.success)return t();{const o=i.uniqueDisplayName||i.subscriptionId,n=s.disallowedRPs||[];return n.length?t(e.subDisallowedRP.format(o,n.join(", "))):t(e.subCantRegisterWithRP.format(o,s.failedRPs.join(", ")))}})).then((t=>t||o.hasPermission(ee,`/subscriptions/${i.subscriptionId}`,s.requiredPermissions,e.requiredPermissionsValidationMessage))).catch((()=>t())),s)}})()),tt.set(3079,(e=>{Ie&&window.removeEventListener("message",Ie),window.addEventListener("message",Ie=t=>{const{signature:s,href:i}=t.data;if("OAuthRequest"===s&&"string"==typeof i){ze(new Promise((e=>{var s,o;const n=t.source.opener,r=t.origin,a=window.location.origin,l=null===(s=null==n?void 0:n.parent)||void 0===s?void 0:s.parent,d=(null===(o=i.match(/\/extensionname\/(\w+)(?=[^a-z0-9])/i))||void 0===o?void 0:o[1])||"";n===ne&&r===a&&l===window&&d.toLowerCase()===Y.toLowerCase()?e(i):e("")})),e)}})})),tt.set(3083,(e=>{ze((0,M.getPrimaryData)(M.QueryType.LoadLighthousePerfProfilesMetadata,et(),!0).then((({data:e})=>({shellVersions:e[0].shellVersions,extensionVersions:e[0].extensionVersions}))),e)}))}let dt=MsPortalFx.noop,ct=MsPortalFx.noop,pt=MsPortalFx.noop;return{initialize:e=>{const{setOnMessage:t,reactViewOptions:s}=e;if(({postMessage:De}=e),s){const{dispose:e,onUnloaded:t,hide:i,show:o}=s,n=Q.defer();let r,l;tt.set(3034,(()=>{n.resolve()})),tt.set(3053,(({data:e,complete:t,valid:s})=>{r=e,t&&d(!1,s)}));const d=(e,t)=>{l||(l=!0,Je.resolve(t?r:null),FxImpl.TelemetryContext.usingState((()=>{var s;const i=!e&&t;Xe()&&FxImpl.Extension.onReactViewInteractiveEndPoint.invoke(FxImpl.Rpc.client,Y,{bladeInstanceId:be.instanceId,time:i?r.data.interactiveTime:void 0}),Ye({name:ye,source:"Shell",action:"BladeLighthouse",actionModifier:i?"complete":"cancel",extension:Y,data:Object.assign(Object.assign({},r),{data:Object.assign(Object.assign({},null==r?void 0:r.data),(null===(s=null==r?void 0:r.data)||void 0===s?void 0:s.ajaxCalls)&&{ajaxCalls:r.data.ajaxCalls.map((({name:e,nameIsUrl:t,startTime:s,duration:i})=>({name:t?(0,a.scrubUri)(e)||"REDACTED_URL":e,startTime:s,duration:i})))})})})}),q))},c=async(s=!1)=>{lt&&lt(),De(3033,{waitForPendingPromises:!s});const i=n.promise.then((()=>{e(),Le.dispose()})),o=Q.delay(1e3).then((()=>d(s)));await Q.allSettled([i,o]),t()};tt.set(3087,(e=>{E.usingState((()=>{T.Telemetry.trace(Object.assign(Object.assign({},e),{extension:Y,source:be.id}))}),q)})),dt=i,ct=o,pt=e=>{e&&K.resolve(e),i(),c(!0)},g.registerForDispose({dispose:()=>{const e=[];MsPortalFx.forEachKey(rt,((t,s)=>e.push(s.promise))),Q.allSettled(e).finally((()=>{c()}))}})}t(Ge),ke.forEach((e=>De(e.kind,e.data)))},toggleDevTools:()=>De(3046),toggleTelemetryInsights:e=>De(3088,e),togglePerfTools:()=>{const e=Q.defer();return De(3056,{responseStubId:_e((t=>{U(e,t,(()=>{}))}),!0)}),k.Promises.cancelOnDispose(g,e.promise)}}}})),
define("MsPortalImpl/Base/Base.FeatureDetection",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canPreventScrollOnFocus=t.getScrollbarHeight=t.getScrollbarWidth=t.getMaxElementHeight=void 0;const s=window;let i,o,n,r;function a(e){return FxImpl.createElement("div",e)}function l(){const e=$(a({style:"position:fixed;right:-1000px;bottom:-1000px;width:100px;height:100px;overflow:scroll"})).appendTo("body"),t=e[0];n=t.offsetWidth-t.clientWidth,o=t.offsetHeight-t.clientHeight,e.remove()}$(s).on("resize",(()=>{i=0,o=0,n=0})),t.getMaxElementHeight=function(){if(!i){let e=1e8,t=1e4;const s=$(a({class:"fxs-detect-maxheight",style:"position:fixed;right:-10px;bottom:-10px;width:10px"})).appendTo("body");let o,n;for(;(n=e-t)>10;)o=0|t+n/2,s.height(o),o===(0|s.height())?t=o:e=o-1;i=t,s.remove()}return i},t.getScrollbarWidth=function(){return n||l(),n},t.getScrollbarHeight=function(){return o||l(),o},t.canPreventScrollOnFocus=function(){if(void 0===r){r=!1;const e=a();e.addEventListener("focus",(function(e){e.preventDefault(),e.stopPropagation()}),!0),e.focus({get preventScroll(){return r=!0,!1}}),e.remove()}return r}})),
define("MsPortalImpl/Base/Base.KnockoutExtensions",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s="fxs-display-none",i=ko.bindingHandlers,o=ko.virtualElements.allowedBindings,n=ko.utils,r=n.domData,a=MsPortalFx.wrap({controlsDescendentBindings:!0});i.commands={update:function(e,t,s,i,o){const r=ko.unwrap(t());if(r&&r.group){const t=$(e),s=e=>{const s=ko.unwrap(r.viewModel),i=$.Event("rightclick",{target:e.target,clientX:e.clientX,clientY:e.clientY});t.trigger(i,{commandGroup:r.group,viewModel:s,entityType:2}),e.preventDefault(),e.stopPropagation()};t.on("fxcontextmenurequest",s),n.domNodeDisposal.addDisposeCallback(e,(e=>{t.off("fxcontextmenurequest",s)}))}}},i.visible={update:function(e,t){const i=ko.unwrap(t()),o=e.classList;o?o.toggle(s,!i):$(e).toggleClass(s,!i)}},i.keyedCss={update:function(e,t){const s=[],i=[];MsPortalFx.forEachKey(ko.unwrap(t()),((t,o)=>{const a=ko.unwrap(o);if("string"!=typeof a)MsPortalFx.forEachKey(a,((e,t)=>{ko.unwrap(t)?s.push(e):i.push(e)}));else{t="_fxCss_"+t;const o=r.get(e,t)||[],l=a.split(" ").filter(MsPortalFx.identity)||[];n.compareArrays(o,l,{sparse:!0}).forEach((e=>{void 0===e.moved&&("added"===e.status?s.push(e.value):"deleted"===e.status&&i.push(e.value))})),r.set(e,t,l)}})),$(e).removeClass(i.join(" ")).addClass(s.join(" "))}},o.vtext=o.text,i.vtext=i.text,o.text=!1,i.text={init:a,update:function(e,t){let s=ko.unwrap(t());s=void 0===s?"":s,e.textContent=s}}})),
define("_generated/Less/MsPortalImpl/Widgets/CopyField.css",["module"],(function(e){"use strict";return{css:".fxs-copyfield{display:none;position:absolute;width:24px;top:0;right:0}.fxs-copyfield .fxc-copyablelabel{padding:0;margin:-3px 0 -3px -.5px}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox{display:none}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox .azc-input{padding:0;border:0;margin:0;height:auto;background-color:transparent}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button{padding:2px 1px 0;margin:0;background-color:transparent;outline-width:1px}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button:hover{background-color:transparent}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button svg{height:90%;width:90%}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button .fxc-copyablelabel-copyimage{height:22px;width:22px}.fxs-copyfield-container .fxs-copyfield-wrapper{position:absolute;top:0;right:0;width:24px;height:24px}.fxs-copyfield-container .fxs-copyfield{display:block}.fxs-copyfield-container.fxs-copyfield-copied .fxc-copyablelabel{padding-right:24px}.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield-wrapper{width:100%}.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield{width:100%}.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield .fxc-copyablelabel-textbox{display:block}.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield .fxc-copyablelabel-copybutton{margin-right:-24px}.fxs-part-resourcesummary .fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox .azc-input{font-size:13px}.fxs-mode-light .fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton:focus{outline:1px solid #605e5c}.fxs-mode-dark .fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton:focus{outline:1px solid #fff}",moduleId:e.id}})),
define("MsPortalImpl/Base/Base.KnockoutExtensions.Copy",["require","exports","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Widgets/Widgets.Common","Fx/Controls/CopyableLabel","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/CopyField.css"],(function(e,t,s,i,o,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initializeCopyBinding=t.CopyField=void 0;var a=FxImpl.TriggerableLifetimeManager,l=MsPortalFx.Base;(0,n.injectCss)(r);l.Diagnostics.createLog(e);const d="opacity";function c(e,t,n,r){const l=$(e),c=r||new a,p=function(e,t,n,r,a){const l="fxs-copyfield",c="fxs-copyfield-copied",p=$(t),u=$(FxImpl.createElement("div",{class:"fxs-copyfield-wrapper","data-bind":"stopBindings: true"})),m=$(FxImpl.createElement("div",{class:l,"data-bind":"pcCopyableLabel: $data"}));m.appendTo(u),u.appendTo(p);const g=o.create(e,r);return g.readOnly(!0),ko.reactor(e,(()=>{const e=ko.unwrap(n);g.value(e),p.toggleClass("fxs-copyfield-container",!MsPortalFx.isNullOrWhiteSpace(e))})),ko.applyBindingsToDescendants(g,u[0]),e.registerForDispose([p.setEvents(["fxcopybuttonclick",()=>{p.addClass(c)}],["mouseleave",()=>{p.removeClass(c)}]),()=>{u&&(a||ko.utils.cleanDescendantNodes(u),u.remove())}]),s.isIeOrEdgeNonChromium&&i.waitForBindings(m[0]).then((()=>{const t=m.findByClassName("fxc-copyablelabel-copybutton");e.registerForDispose([t.setEvents(["keydown",e=>{const s=e.which;if(13===s||32===s){t.focus();const e=t.find(".fxc-copyablelabel-clicked")[0];e&&ko.contextFor(e).$ctl._showClickedTooltip()}}])])})),m.css(d,"0"),m}(c,e,t,n,!!r);let u=!1;const m=ko.observable(!1),g=ko.observable(!1);c.registerForDispose(l.setEvents(["focusin",()=>{m(!0)}],["focusout",()=>{m(!1)}],["mouseenter",()=>{g(!0)}],["mouseleave",()=>{g(!1)}])),ko.computed(c,[m,g],((e,t)=>{const s=e||t;s!==u&&(e=>{u=e,p.css(d,e?"1":"0")})(s)})),r||ko.utils.domNodeDisposal.addDisposeCallback(e,(()=>c.dispose()))}t.initializeCopyBinding=c,ko.bindingHandlers.copy={init:(e,t)=>c(e,t())}})),
define("MsPortalImpl/Base/Base.KnockoutExtensions.HtmlTemplateBinding",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl.Controls/Controls/Base/WidgetBinding","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl.Controls/Controls/Base/Base","MsPortalImpl/Base/Base.LruMap","MsPortalImpl/Controls/ControlBindings"],(function(e,t,s,i,o,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTrustedFragment=void 0;var l=ko.utils,d=ko.bindingHandlers;const c=l.domData,p="htmlTemplate",u="untrustedHtml",m="untrustedContent",g="trustedHtml",h="trustedContent",f=document.createRange(),x=new a.LruMap(100),b=new a.LruMap(100);function v(t,s,o,n,r){let a;if(s){const l=(1===o?b:x).getOrAdd(s,(s=>{if(1!==o){s=t.get(i.KOAllowedTemplateSanitizer).sanitize({diContainer:t,value:s,localRequire:e,windowContext:n,contextData:r}).sanitizedMarkup}return s&&f.createContextualFragment(s)}));l&&(a=l.cloneNode(!0))}return a}const y=e=>{const t=e.$ctl;return null==t?void 0:t.isTrusted},M=w(0,u,y),I=w(1,g),C=[null,null,M,d.pcControl.update,I];function P(e,t,s,i,o){return{controlsDescendantBindings:!0}}function w(e,t,i){return(n,r,a,d,c)=>{const p=ko.unwrap(r());let u,m,g,h=p;null!==p&&"object"==typeof p&&(h=ko.unwrap(p.html),m=p.data,u=ko.unwrap(m),g=ko.unwrap(p.isolated)),ko.ignoreDependencies((()=>{let r=e;0===r&&(null==i?void 0:i(c))&&(r=1);const a=v(c.$dicontainer||s.container,h,r,n,{BindingName:t});g?c=o.createIsolatedContext(u||d,c):m&&(c=c.createChildContext(u)),l.cleanDescendantNodes(n),a?(n.innerHTML="",n.appendChild(a),ko.applyBindingsToDescendants(c,n)):n.innerHTML=""}))}}function _(e,t,s){return(i,o,a,d,p)=>{let u=ko.unwrap(o())||"",m=1;ko.ignoreDependencies((()=>{let o=e;0===o&&(null==s?void 0:s(p))&&(o=1);const a=c.get(i,t);if(u.controlType?m=3:u.htmlTemplate&&(m=1===o?4:2,u={html:u.htmlTemplate,data:u.viewModel}),c.set(i,t,m),3===a){n.cancelBindings(i);const e=r.getWidget($(i));MsPortalFx.disposeDisposable(e)}a&&1!==a&&l.cleanDescendantNodes(i),1===m?i.textContent=u:i.innerHTML=""})),1!==m&&C[m](i,(()=>u),a,d,p)}}d.htmlTemplate={init:P,update:w(0,p)},d.untrustedHtml={init:P,update:M},d.trustedHtml={init:P,update:I},d.untrustedContent={init:P,update:_(0,m,y)},d.trustedContent={init:P,update:_(1,h)},t.getTrustedFragment=function(e,t,s,i){return v(e,t,s?1:0,i)}})),
define("MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedAttrBinding",["require","exports","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.ImplUtils"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});MsPortalFx.Base.Diagnostics;const o=ko.bindingHandlers;function n(t,i,o,n){const r=function(t,i,o,n){if(i&&"object"==typeof i){const r={};return Object.getOwnPropertyNames(i).forEach((a=>{if(!MsPortalFx.isSerializableProperty(a))return;const l=ko.unwrap(i[a]);if(s.getAllowListedAttr().indexOf(a)>-1)r[a]=l||null;else switch(a){case"href":if(l){const d="string"!=typeof l?i:s.sanitizeLinkUri(l,{diContainer:t,localRequire:e,windowContext:n});!1!==d?r[a]=d:o.push(`The value "${l}" is not a valid absolute URI or deep link, which should start with "http://" or "https://" or "#".`)}else r[a]=null;break;case"poster":case"src":l?s.validateUriOrBlank(l,null,{diContainer:t,localRequire:e,windowContext:n})||"src"===a&&s.validateDataImage(l)?r[a]=l:o.push(`The value "${l}" is not a valid absolute URI, which should start with "http://" or "https://", nor a valid "data:image" entry.`):r[a]=null;break;default:o.push("The attribute '{0}' is not allowed.".format(a))}})),r}return null}(t,ko.unwrap(i()),o,n);return()=>r}o.sanitizedAttr={init:function(e,t,s,i,r){const a=o.attr;if(a.init){const o=n(r.$dicontainer,t,[],e);return a.init(e,o,s,i,r)}return null},update:function(t,s,r,a,l){const d=[],c=n(l.$dicontainer,s,d,t);if(d.length>0){const s=d.reduce(((e,s)=>{const i=t.getAttribute("data-bind")||"None";return e+="Sanitization error found in 'sanitizedAttr' binding\nTag name: {0}; Binding attribute: \"{1}\"\nMessage: {2}".format(String(t.tagName),i,s)+"\n"}),"");i.logToExtension(e,t,2,s)}return o.attr.update(t,c,r,a,l)}}})),
define("MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedCssBinding",["require","exports","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/Base/Base.ImplUtils"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o="Sanitization error found in 'sanitizedCss' binding\nTag name: {0}; Binding attribute: \"{1}\"\nDisallowed class name(s): {2}",n=ko.bindingHandlers,r=n.css;function a(e,t){const i=function(e,t){if(e&&"object"==typeof e){const i={};return Object.getOwnPropertyNames(e).forEach((o=>{MsPortalFx.isSerializableProperty(o)&&(s.isAllowedCssClassName(o)?i[o]=e[o]:o&&t.push(o))})),i}{const i=String(e||"").split(" ");return Array.prototype.map.call(i,(e=>(e=String(e||""),s.isAllowedCssClassName(e)?e:(e&&t.push(e),"")))).join(" ")}}(ko.unwrap(e()),t);return()=>i}n.sanitizedCss={init:function(e,t,s,i,o){if(r.init){const n=a(t,[]);return r.init(e,n,s,i,o)}return null},update:function(t,s,n,l,d){const c=[],p=a(s,c);return c.length&&function(t,s,n){const r=s.getAttribute("data-bind")||"None",a=o.format(String(s.tagName),r,n.join(", "));(0,i.logToExtension)(e,s,2,a,{diContainer:t})}(d.$dicontainer,t,c),r.update(t,p,n,l,d)}}})),
define("MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedHtmlBinding",["require","exports","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","Fx/DependencyInjection"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=ko.bindingHandlers,n=o.html;o.sanitizedHtml={init:function(e,t,s,i,o){return n.init(e,t,s,i,o)},update:function(t,o,r,a,l){let d=ko.unwrap(o());null==d&&(d="");const c=d.toString().substring(0,1e5),p=i.container.get(s.KODeniedTemplateSanitizer).sanitize({value:c,localRequire:e,windowContext:t,diContainer:l.$dicontainer||i.container}),u=MsPortalFx.wrap(p.sanitizedMarkup);return n.update(t,u,r,a,l)}},o.html=o.sanitizedHtml})),
define("MsPortalImpl/Base/Base.Pipeline",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPipelineInstance=t.createDescriptor=t.Pipeline=t.Step=t.PipelineDescriptor=t.Task=void 0;var o=MsPortalFx.Base.Promises.cancelOnDispose;let n=1,r=class{};r=__decorate([__metadata("fx:diagnostics",[e,"Task"]),s.Value("pipeline")],r),t.Task=r;class a{constructor(e,t,s){this.configurationClass=e,this.resourcesClass=t,this.taskArgsClass=s,this._pipelineFactories=[]}register(e){this._registerFactory((t=>this._createInstance(t,e)))}registerAsync(e,t,s,n=0){this._registerFactory(((n,r,a,l,d)=>{if(s(a,l,d))return o(r,i.get(e,t)).then((e=>this._createInstance(n,e)))}),n)}registerFactory(e,t=0){this._registerFactory(((t,s,i,o,n)=>{function r(t){return{factory:e,steps:t||[]}}const a=e(t,s,i,o,n);return Q.isPromiseAlike(a)?a.then((e=>r(e))):r(a)}))}_registerFactory(e,t=0){const s=this._pipelineFactories.length&&this._pipelineFactories[t]||[];s.push(e),this._pipelineFactories[t]=s}registerAsyncFactory(e,t,s,i){this._registerFactory((function(o,n,r,a,l){return s(r,a,l)?MsPortalFx.require(e,i).then((e=>({factory:t,steps:t(n,e,r,a,l)}))):void 0}))}getHandlers(e,t,s,i,o,n=0){return(this._pipelineFactories[n]||[]).map((n=>n(e,t,s,i,o)))}getRegisteredStepsCount(){return(this._pipelineFactories||[]).length}createPipeline(e,t,s,i){return d(e,t,this,s,i)}_createInstance(e,t){if(e.isDisposed())throw new MsPortalFx.Errors.CanceledError;const s=e.get(t);return{factory:t,steps:(Reflect.getOwnMetadata("fximpl:pipelinesteps",t.prototype)||[]).map((e=>(t,i)=>s[e](t,i)))}}}t.PipelineDescriptor=a,t.Step=function(e){return function(t,s,i){const o=Reflect.getOwnMetadata("fximpl:pipelinesteps",t)||[];o[e]=s,Reflect.defineMetadata("fximpl:pipelinesteps",o,t)}};class l{constructor(e,t,s,i,o){this._diContainer=e,this._lifetime=t,this._descriptor=s,this._configuration=i,this._resources=o}async startTask(e){const t=this._descriptor,s=this._lifetime.createChildLifetime(),i=this._diContainer.createChildContainer("pipeline"),o=n++,a=ko.observable(!1),l={pipeline:this,indicateTaskComplete:()=>{a(!0)},taskId:o,lifetime:s};i.set(r,l),t.configurationClass&&i.set(t.configurationClass,this._configuration),t.resourcesClass&&i.set(t.resourcesClass,this._resources),t.taskArgsClass&&i.set(t.taskArgsClass,e);const d=o=>function(e,t,s,i,o,n,r){const a=t.getHandlers(s,i,o,n,r,e).filter((e=>!!e));let l;return a.forEach(((e,t)=>{Q.isPromiseAlike(e)&&(l||(l=[]),l[t]=e.then((e=>{a[t]=e})))})),l?Promise.all(l.filter((e=>!!e))).then((()=>a.filter((e=>!!e)))):a}(o,t,i,s,this._configuration,this._resources,e);function c(e,t){function s(s){s.forEach((s=>{s.steps.forEach(((s,i)=>{if(i>=t){const t=e[i]||{step:i,handlers:[]};t.handlers.push(s),e[i]=t}}))}))}const i=d(t);return i instanceof Array?void s(i):i.then(s)}let p=d(0);Q.isPromiseAlike(p)&&(p=await p),await(async o=>{const n=function(e){const t=[],s=Math.max(...e.map((e=>e.steps.length)));for(let i=0;i<s;i++)e.forEach((e=>{if(e.steps[i]){const s=t[i]||{step:i,handlers:[]};s.handlers.push(e.steps[i]),t[i]=s}}));return t}(o);let r,d=!0;try{await async function(e,t,s,i,o,n,r,a){const l=new Promise((e=>{n.registerForDispose(e)}));o.registerForDispose((()=>s(!0)));const d=Math.max(e.length,a);for(let o=0;o<d&&!s();o++){if(!s()&&o){const t=r(e,o);t&&await Promise.race([t,l])}if(e[o])for(let n=0;n<e[o].handlers.length&&!s();n++){const s=e[o].handlers[n](i,t);Q.isPromiseAlike(s)&&await Promise.race([s,l])}}}(n,e,a,l,this._lifetime,s,c,t.getRegisteredStepsCount())}catch(e){d=!1,r=e}finally{if(await i.disposeAsync().then((()=>s.dispose())),!d)throw r}})(p)}}function d(e,t,s,i,o){return new l(e,t,s,i,o)}t.Pipeline=l,t.createDescriptor=function(e,t,s){return new a(e,t,s)},t.createPipelineInstance=d})),
define("MsPortalImpl/Interactions/Interactions.ContextMenuTouch",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unregister=t.register=t.HintClassIdentifier=t.MoveTolerancePixels=t.ReactionDelayMillis=void 0,t.ReactionDelayMillis=550,t.MoveTolerancePixels=10,t.HintClassIdentifier="fxs-contextMenuTouchHint";const s=$(FxImpl.createElement("div",{class:t.HintClassIdentifier})),i=110,o=".cmtevt";let n,r={startTime:0,target:null,targetX:0,targetY:0};function a(e){const t=e.originalEvent,s=t&&t.touches,i=s&&1===s.length,o=s&&s[0];return i?o:null}function l(e,t){t.off(o),clearTimeout(n),function(e){if(e){const e={opacity:.2},t={opacity:1};s.animate(e,25).animate(t,25).animate(e,25).animate(t,25)}s.animate({width:0,height:0,top:"+=55",left:"+=55"},75,(function(){s.detach()}))}(e),r={startTime:0,target:null,targetX:0,targetY:0}}function d(e){l(!0,$(e.currentTarget))}function c(e){const s=a(e)||{clientX:0,clientY:0},i=Math.abs(r.targetX-s.clientX),o=Math.abs(r.targetY-s.clientY);(i>t.MoveTolerancePixels||o>t.MoveTolerancePixels)&&l(!0,$(e.currentTarget))}function p(e){const s=$(e.currentTarget);if(r.startTime){if(Math.abs(Date.now()-r.startTime)>=t.ReactionDelayMillis){s.off("contextmenu.cmtevt");const e=$.Event("contextmenu");e.clientX=r.targetX,e.clientY=r.targetY,$(r.target).trigger(e)}}l(!1,s)}function u(e){const o=a(e),u=$(e.currentTarget);o?r&&0!==r.startTime||(r={startTime:Date.now(),target:e.target,targetX:o.clientX,targetY:o.clientY},n=setTimeout((()=>{!function(){const e={width:0,height:0,top:r.targetY,left:r.targetX};s.css(e),$.querySelectorAll("body").append(s),s.animate({width:i,height:i,top:"-=60",left:"-=55"},75)}()}),t.ReactionDelayMillis),u.on("contextmenu.cmtevt",(function(){return!1})).on("touchmove.cmtevt",c).on("touchcancel.cmtevt",d).on("touchend.cmtevt",p)):l(!0,u)}t.register=function(e){e.on("touchstart",u)},t.unregister=function(e){e.off("touchstart",u),l(!0,e)}})),
define("_generated/Less/MsPortalImpl/Interactions/Interactions.FullScreenMode.css",["module"],(function(e){"use strict";return{css:".fxs-portal-fullscreen .fxs-sidebar,.fxs-portal-fullscreen .fxs-topbar,.fxs-portal-fullscreen .fxs-journey-breadcrumb{display:none !important}.fxs-portal-fullscreen .fxs-startboard-button{display:none}.fxs-portal-fullscreen .fxs-startboard-dropdown,.fxs-portal-fullscreen .fxs-startboard-commandBar{display:none}.fxs-portal-fullscreen .fxs-startboard-title-next,.fxs-portal-fullscreen .fxs-startboard-commandBar-fullScreen{display:block}",moduleId:e.id}})),
define("MsPortalImpl/Interactions/Interactions.FullScreenMode",["require","exports","Fx/DependencyInjection","FxInternal/Css","_generated/Less/MsPortalImpl/Interactions/Interactions.FullScreenMode.css"],(function(e,t,s,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FullScreenMode=void 0,(0,i.injectCss)(o);const n=document.body,r=n.classList;let a=class{constructor(){this.isActive=ko.observable(!1);new MutationObserver((()=>{this.isActive(r.contains("fxs-portal-fullscreen"))})).observe(n,{attributes:!0,attributeFilter:["class"]})}enter(){r.add("fxs-portal-fullscreen")}exit(){r.remove("fxs-portal-fullscreen")}toggle(){this.isActive()?this.exit():this.enter()}};a=__decorate([__metadata("fx:diagnostics",[e,"FullScreenMode"]),s.Class(),__metadata("design:paramtypes",[])],a),t.FullScreenMode=a})),
define("_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardOnlyOutlines.css",["module"],(function(e){"use strict";return{css:".fxs-hidefocusoutline *{outline:none !important}",moduleId:e.id}})),
define("MsPortalImpl/Interactions/Interactions.KeyboardOnlyOutlines",["require","exports","FxInternal/Css","_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardOnlyOutlines.css"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unregister=t.register=void 0,(0,s.injectCss)(i);const o=document.body,n=e=>{$(o).toggleClass("fxs-hidefocusoutline",!e).toggleClass("fxs-showfocusoutline",e)},r=()=>{n(!1)},a=e=>{const t=e.keyCode;9!==t&&13!==t&&27!==t&&32!==t&&37!==t&&38!==t&&39!==t&&40!==t||n(!0)};t.register=function(){o.addEventListener("mousedown",r,!0),o.addEventListener("pointerdown",r,!0),o.addEventListener("keydown",a,!0),r()},t.unregister=function(){o.removeEventListener("mousedown",r,!0),o.removeEventListener("pointerdown",r,!0),o.removeEventListener("keydown",a,!0),$(o).removeClass("fxs-showfocusoutline").removeClass("fxs-hidefocusoutline")}})),
define("MsPortalImpl/Interactions/Interactions.OverflowAutoTooltip",["require","exports","MsPortalImpl/Base/Base.Timers"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unregister=t.register=void 0;const i=".msportalfx-tooltip-overflow,.msportalfx-text-ellipsis",o=(0,s.throttleByAnimationFrame)((e=>{const t=e.currentTarget,s=$(t);t.offsetWidth<t.scrollWidth&&!t.title&&s.attr("title",s.text()||s.val()||s.attr("placeholder")||null).addClass("fxs-autotooltip")}));t.register=function(e){e.on("mouseenter",i,o)},t.unregister=function(e){e.off("mouseenter",i,o)}})),
define("MsPortalImpl/Widgets/Widgets.ContextMenu",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Base/Base.Events","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Interactions/Interactions.OverflowAutoTooltip","MsPortalImpl/Widgets/Widgets.WidgetBase","WeaveDOM/DirectRender/DataAttribute","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextMenu.css"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.ViewModel=void 0,(0,p.injectCss)(u);var m=MsPortalFx.Base.Diagnostics;const g=window,h=m.createLog(e),f="fxs-contextMenu",x="fxs-contextMenu-active",b="fxs-popup",v="fxs-portal-bg-txt-br",y="msportalfx-shadow-level2",M=s(i.Root,null,s("ul",{role:"menu",class:"fxs-contextMenu-itemList","data-bind":{attr:{"aria-label":"ariaLabel"}}},s(i.KoForEach,{items:"commands"},s("li",{role:"menuitem",class:"fxs-contextMenu-item msportalfx-command-like-button",tabindex:"0","data-bind":{css:{"fxs-portal-hover":"enabled","fxs-contextMenu-itemDisabled msportalfx-command-like-button-disabled":"!enabled()","fxs-contextMenu-extensioncommand":"!!$data._extension"},attr:{title:"$data.tooltip()","aria-disabled":"!enabled()","aria-label":"ariaLabel","aria-posinset":"$index() + 1","aria-setsize":"$parent.commands().length"}}},s("div",{class:"fxs-contextMenu-icon","data-bind":{image:"icon"}}),s("div",{class:"fxs-contextMenu-text msportalfx-text-ellipsis","data-bind":{text:"text"}})))));function I(e,t){return t||h.error(`ContextMenuViewModel.${e} is not accessible. Please call registerForCleanup first.`),t}function C(e){return e.isShellCommand}class P extends d.ViewModel{constructor(){super(),this.visible=ko.observable(!1),this.menuItems=ko.observableArray(),this.topOffsetCorrection=0}getOrderedMenuItemsCommandsComputed(){return I("orderedMenuItemsCommands",this._orderedMenuItemsCommands)}getOrderedMenuItemsComputed(){return I("orderedMenuItems",this._orderedMenuItems)}get hasVisibleCommands(){return I("hasVisibleCommands",this._hasVisibleCommands)}registerForCleanup(e){const t=this.menuItems,s=this._ltm=e.createChildLifetime(),i=this._orderedMenuItemsCommands=t.filter(s,(e=>e.visible()&&!C(e)&&!e.hasPopup())),o=this._orderedMenuItems=t.filter(s,(e=>e.visible()&&C(e)&&e.enabled()));this._hasVisibleCommands=ko.computed(s,(()=>i().length+o().length>0)),s.registerForDispose((()=>{this._ltm=this._orderedMenuItemsCommands=this._orderedMenuItems=this._hasVisibleCommands=null}))}}t.ViewModel=P;class w extends d.Widget{constructor(e,t,s){super(e,t),this._newRenderFlag=s,this._lastShowArgs=ko.observable(null);const i=this.ltm,o=e=>{const t=this.element[0];return t===e||$.contains(t,e)?0:2},a={dismissFn:()=>{this.hide()},shouldDismissOnMouseDownFn:o,shouldDismissOnMouseWheelFn:o,logName:"contextmenu"};s||(t.registerForCleanup(i),e.html(M).addClass(`fxs-contextMenu fxs-popup ${v} ${y}`),this._bindDescendants({ariaLabel:n.ContextMenu.ariaLabel,commands:ko.explicitComputed(i,[t.getOrderedMenuItemsComputed(),t.getOrderedMenuItemsCommandsComputed()],((e,t)=>e.concat(t)))}));const l=new MutationObserver((()=>this.updateRenderedPositionFromLastShow()));l.observe(e.findByClassName("fxs-contextMenu-itemList")[0],{childList:!0}),i.registerForDispose((()=>l.disconnect())),this._initializeHandlers(),t.visible.subscribeAndRun(i,(e=>{const t=this.element;if(e){const e=document.activeElement;a.restoreFocus=()=>{r.validatePreviousFocusedElement(a,e)&&e.focus()},t.css(this._ensureInViewPort(this._lastShowArgs())).addClass(x),this.setFocus(),r.register(a)}else this._lastShowArgs(null),t[0].contains(document.activeElement)&&a.restoreFocus&&a.restoreFocus(),t.removeClass(x),r.unregister(a)}))}dispose(){this.hide(),this._cleanElement(f,b,v,y),super.dispose()}hide(){this.options.visible(!1)}show(e=0,t=0,s=!1){o.isFullscreen()?this.hide():(this._lastShowArgs({xCoord:e,yCoord:t,forceLeft:s}),this.options.visible(!0))}updateRenderedPositionFromLastShow(){const e=this._lastShowArgs();e&&this.element.css(this._ensureInViewPort(e))}setFocus(){Q.fcall((()=>{this.element.find("[tabindex=0]:first-of-type").focus()}))}_initializeHandlers(){const e=this.element,t=this.ltm,s=e=>{if(e.stopPropagation(),e.preventDefault(),$(e.currentTarget).hasClass("fxs-contextMenu-itemDisabled"))return;this.hide();const t=this._newRenderFlag?(0,c.getElementData)(e.currentTarget):ko.dataFor(e.target);t&&t.enabled()&&t.execute(!0)};new a.KeyboardNavigation(this.ltm,{element:e}),l.register(e),ko.computed(t,(()=>{this._lastShowArgs()&&(this.options.menuItems().forEach((e=>{e.enabled()})),this.updateRenderedPositionFromLastShow())})),t.registerForDispose([()=>{l.unregister(e)},e.setEvents(["contextmenu",e=>!1]),e.find("ul").setEvents(["click",".fxs-contextMenu-item",s],["keydown",".fxs-contextMenu-item",e=>{13===e.which&&s(e)}])])}_ensureInViewPort(e){const{xCoord:t,yCoord:s,forceLeft:i}=e;let o=s,n="auto";const r=this.element,a=r.outerHeight(),l=r.outerWidth();this._isRtl()?(n=t-l,(i||n-l<0)&&(n+=l,o+=this.options.topOffsetCorrection)):(n=t,(i||n+l>g.innerWidth)&&(n-=l,o+=this.options.topOffsetCorrection));const d=g.innerHeight;return o+a>d&&(o-a>=0?o-=a:o=a<d?MsPortalFx.truncate((d-a)/2):0,o+=this.options.topOffsetCorrection),{top:o,left:n}}}t.Widget=w})),
define("MsPortalImpl/Interactions/Interactions.PortalReader",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PortalReader=void 0;const s=document;if(!s.getElementById("PortalReader")){s.body.appendChild(FxImpl.createElement("div",{id:"PortalReader",class:"fxs-hide-accessible-label","aria-atomic":"false","aria-live":"polite"}))}const i=s.getElementById("PortalReader");t.PortalReader=class{constructor(e,t){this._nextId=MsPortalFx.getUniqueIdGenerator(null==t?void 0:t.idPrefix);const s=(null==t?void 0:t.removalDelayMs)>=0?null==t?void 0:t.removalDelayMs:6e4,o=this._liveRegion=FxImpl.createElement("div",{id:this._nextId(),class:"fxs-hide-accessible-label","aria-live":"polite","aria-atomic":"false","aria-relevant":"additions"});i.appendChild(o),e.registerForDispose((()=>{setTimeout((()=>{i.removeChild(o)}),s)}))}read(e){const t=FxImpl.createElement("div",{id:this._nextId()});t.textContent=e,this._liveRegion.appendChild(t)}}})),
define("MsPortalImpl/Widgets/Widgets.UIElementBase",["require","exports","MsPortalImpl/Widgets/Widgets.WidgetBase"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.ViewModel=void 0;const i="Not implemented in base class.";class o extends s.ViewModel{constructor(e){super(),this.locked=ko.observable(!0),this.id=e}getViewSettings(){throw new Error(i)}applyViewSettings(e){throw new Error(i)}}t.ViewModel=o;const n=new WeakMap;class r extends s.Widget{constructor(e,t,s=!1){if(super(e,t,s),!t.id||"string"!=typeof t.id)throw new Error("An unique identifier is required and it must be a string.");r.attachId(e,t.id)}dispose(){r.detachId(this.element),super.dispose()}static attachId(e,t){const s=e[0];s&&n.set(s,t)}static detachId(e){const t=e[0];t&&n.delete(t)}static getId(e){const t=e[0];return t&&n.get(t)}addChild(e){throw new Error(i)}insertChild(e,t){throw new Error(i)}removeChild(e){throw new Error(i)}moveChild(e,t,s,o){throw new Error(i)}saveViewSettings(){throw new Error(i)}setSize(e,t){throw new Error(i)}discardStateOfUnusedChildren(){return{stateDiscarded:!1}}}t.Widget=r,r.viewSettingsChanged="viewSettingsChanged"})),
define("MsPortalImpl/Widgets/Widgets.ContextPane",["require","exports","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Interactions/Interactions.PortalReader","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.BrowserDetection","Weave","Fx/Experimentation","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextPane.css"],(function(e,t,s,i,o,n,r,a,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.ViewModel=void 0,(0,d.injectCss)(c);const p="fxs-react-contextpane",u="fxs-contextpane-content",m="fxsContextPaneTitle";class g extends i.ViewModel{constructor(e){super("fxs-contextpane-identifier"),this.diContainer=e,this.opened=(0,a.makeWritableComputation)(!1),this.loading=(0,a.makeWritableComputation)(!1),this.hideExpandButton=(0,a.makeWritableComputation)(!0),this.openedFromTopBar=(0,a.makeWritableComputation)(!1),this.childElementCount=(0,a.makeWritableComputation)(0),this.close=MsPortalFx.noop}setWidget(e){this._widget=e}getWidget(){return this._widget}getRootElement(){return this._widget.element}}t.ViewModel=g;class h extends i.Widget{constructor(e,t){super(e,t,!0),this._prewarmContextPanes=!1,this._announce=new o.PortalReader(this.ltm,{idPrefix:"contextpane"}),t.setWidget(this),this._$progress=$(e[0].querySelector(".fxs-contextpane-loadindicator")),(0,a.subscribe)(this.ltm,[t.loading],(e=>{e?this._announce.read(n.Shell.Reader.contextPaneLoading):this._announce.read(n.Shell.Reader.contextPaneReady)})),(0,a.subscribe)(this.ltm,[t.opened],(e=>{e||this._announce.read(n.Shell.Reader.contextPaneClosed)})),t.diContainer.get(l.Experimentation).getAssignments().then((e=>this._prewarmContextPanes=e.getBooleanValue("PrewarmContextPanes")))}dispose(){this._cleanElementClasses([p]),super.dispose()}hasContent(){return!!this._$content}addChild(e){this._addChild(e)}insertChild(e,t){this._addChild(e,t)}_addChild(e,t){var i,o;if(!e)throw new Error("Can't add null child.");if(this._prewarmContextPanes&&this.element.toggleClass(p,null===(o=null===(i=e.options)||void 0===i?void 0:i.bladeName)||void 0===o?void 0:o.name.toLowerCase().endsWith(".reactview")),this.hasContent()&&!t&&this.removeChild(null),t>=0){const e=$(this._getChildElement()[t-1]);e&&e.addClass("fxs-display-none")}const n=this._$content=e.element?e.element:e;n.addClass(u).insertBefore(this._$progress),s.waitForBindings(n[0]).then((()=>{const e=n.find(".fxs-contextpane-title, .fxs-blade-title-titleText"),t=e.attr("id");t?this.element.attr("aria-labelledby",t):(this.element.attr("aria-labelledby",m),e.attr("id",m))})),this.options.hideExpandButton(!n.hasClass("fxs-partgallery-container")),this.options.childElementCount(this.options.childElementCount.value+1)}removeChild(e,t){const s=this._$content;if(!s)return!0;t?s.detach():s.remove(),s.removeClass(u);const i=this.options.childElementCount;if(i(Math.max(i.value-1,0)),i.value>0){const e=$(this._getChildElement()[i.value-1]);e.removeClass("fxs-display-none"),this._$content=e}else this._$content=null;return!0}clear(){return this.removeChild(null)}setFocus(){if(!r.isAndroidOrMobile){const e=this._$content;e&&s.waitForBindings(this.element[0]).then((()=>{let t;const s=e.findByClassName("fxs-blade-content-container");s&&(t=s.findFirstTabbable()),s&&0!==t.length||(t=e.findFirstTabbable()),0!==t.length&&t.focus()}))}}getBladeHost(e,t){return Q(MsPortalFx.require("MsPortalImpl/Widgets/Widgets.Blade")).then((s=>{const i=new s.ViewModel(MsPortalFx.getUniqueId(),this.options.diContainer);i.title(t.title),i.defaultContent.title(t.title),i.defaultContent.bladeStyle(4),i.defaultContent.bladeWidth(t.bladeWidth),i.defaultContent.reflowReady(!0);const o=s.createBladeWidget($(FxImpl.createElement("section")),i);return o.initializeLayout(),o.getContentWidget().initializeLayout(),o.getContentWidget().addChild(e),i.loaded(!0),i.defaultContent.loaded(!0),i.close=e=>{this.options.close(e)},o}))}_getChildElement(){return this.element.children(".fxs-contextpane-content")}}t.Widget=h})),
define("MsPortalImpl/Widgets/Widgets.Portal.State",["require","exports","Fx/DependencyInjection","Weave"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PortalState=void 0;let o=class{constructor(){this.displayMode=(0,i.makeWritableComputation)("None"),this.inOrganizeMode=ko.observable(!1),this.settingsFlyoutState=(0,i.makeWritableComputation)(0)}};o=__decorate([__metadata("fx:diagnostics",[e,"PortalState"]),s.Class()],o),t.PortalState=o})),
define("MsPortalImpl/Services/Services.Storage",["require","exports","Fx/DependencyInjection"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StorageService=t.ComponentName=void 0;const i=MsPortalFx.Base.Diagnostics.createLog(e),o=JSON.stringify;var n;!function(e){e[e.DesktopManager=2]="DesktopManager",e[e.AssetMruList=3]="AssetMruList",e[e.ExtensionManager=4]="ExtensionManager",e[e.Router=5]="Router",e[e.UserSettings_Journeys=6]="UserSettings_Journeys",e[e.UserSettings_EditScopes=7]="UserSettings_EditScopes",e[e.Relex=8]="Relex",e[e.ManifestVersions=9]="ManifestVersions",e[e.Redirect=10]="Redirect",e[e.Cdn=11]="Cdn",e[e.UserSettings_NewJourneys=12]="UserSettings_NewJourneys",e[e.Telemetry=13]="Telemetry",e[e.Dashboard=14]="Dashboard",e[e.Avatar=15]="Avatar",e[e.UserSettingsService=16]="UserSettingsService",e[e.AppBanner=19]="AppBanner",e[e.IEBanner=20]="IEBanner"}(n=t.ComponentName||(t.ComponentName={}));const r=MsPortalFx.getEnumArray(n),a={};r.forEach((e=>{a[e.name]={count:0,keySize:0,valueSize:0}}));class l{constructor(e,t){function s(e){return n[e]+"_"}function l(e,t){return s(e)+(t||"")}function d(s){return 1===s?e:t}function c(e,t,s){for(let i=0;i<e.length;i++){const o=e.key(i);t.call(s,e.getItem(o),o,e)}}function p(e){const t=(r.forEach((e=>{const t=a[e.name];t.count=t.keySize=t.valueSize=0})),a);let s,i=0,n="";c(e,((e,s)=>{const a=MsPortalFx.find(r,(e=>MsPortalFx.startsWith(s,e.name)));if(a){const r=t[a.name];r.count++,r.keySize+=s.length;const l=o(e).length;r.valueSize+=l,l>i&&(i=l,n=s)}}));try{s=o(t)}catch(e){s=`Could not stringify the summary. Exception: ${MsPortalFx.getLogFriendlyMessage(e)}`}return"Summary: {0}. The longest value (key == {1}) took {2} bytes. The total storage length is {3}.".format(s,n,i,e.length)}this.getValue=(e,t,s)=>d(s).getItem(l(e,t)),this.getAllComponentItems=(e,t)=>{const i=s(e),o=d(t),n={},r=i.length;return c(o,((e,t)=>{if(t.startsWith(i)){const s=t.substring(r,t.length);n[s]=e}})),n},this.setValue=(e,t,s,o)=>{const n=d(o),r=l(e,t);try{n.setItem(r,s)}catch(e){const s=new Error("Storage.setItem failed.");s.innerError=e,s.storageState=p(n),s.key=r||t,i.error(s)}},this.clearValue=(e,t,s)=>{const i=d(s),o=l(e,t),n=i.getItem(o);return i.removeItem(o),n},this.clearAllComponentItems=(e,t)=>{const i=s(e),o=d(t),n=[];c(o,((e,t)=>{t.startsWith(i)&&n.push(t)})),n.forEach((e=>o.removeItem(e)))},this.clearAll=()=>{t.clear(),e.clear()}}static create(){return new l(MsPortalImpl.sessionStorage,MsPortalImpl.localStorage)}}__decorate([__metadata("fx:diagnostics",[e,"StorageService"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",l)],l,"create",null),t.StorageService=l})),
define("MsPortalImpl/Widgets/Widgets.ContextMenu.Component",["require","exports","Weave/DirectMode","MsPortalImpl/Resources/ImplScriptResources","Weave","FxInternal/Weave","FxInternal/Weave/Util"],(function(e,t,s,i,o,n,r){"use strict";function a(e){return e+1}Object.defineProperty(t,"__esModule",{value:!0}),t.ContextMenu=void 0,t.ContextMenu=function(e){const{vm:t,className:l}=e,d=(0,o.composeComputation)([(0,n.toComputation)(t.getOrderedMenuItemsComputed()),(0,n.toComputation)(t.getOrderedMenuItemsCommandsComputed())],((e,t)=>e.concat(t)));return s("div",{className:["fxs-contextMenu","fxs-popup","fxs-portal-bg-txt-br","msportalfx-shadow-level2","msportalfx-unselectable",l]},s("ul",{role:"menu",className:"fxs-contextMenu-itemList","aria-label":i.ContextMenu.ariaLabel},s(o.ForEach,{collection:d,fn:({item:e,index:t,length:i})=>{const o=(0,n.toComputation)(e.enabled),l=o.compose(r.negation),d=t.compose(a);return s("li",{role:"menuitem",className:["fxs-contextMenu-item msportalfx-command-like-button",{"fxs-portal-hover":o,"fxs-contextMenu-itemDisabled":l,"msportalfx-command-like-button-disabled":l,"fxs-contextMenu-extensioncommand":e._extension}],tabindex:"0",title:(0,n.toComputation)(e.tooltip),"aria-disabled":l,"aria-label":(0,n.toComputation)(e.ariaLabel),"aria-posinset":d,"aria-setsize":i,data:e},s("div",{className:"fxs-contextMenu-icon",image:(0,n.toComputation)(e.icon)}),s("div",{className:"fxs-contextMenu-text"},(0,n.toComputation)(e.text)))}})))}})),
define("MsPortalImpl/Widgets/Widgets.ContextPane.Component",["require","exports","Weave/DirectMode","FxInternal/Weave/Components/LoadingIndicator"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContextPane=void 0,t.ContextPane=function(e){const{vm:t,className:o}=e,n=t.opened,r=t.loading;return s("div",{className:["fxs-contextpane fxs-portal-bg-txt-br az-noprint",o,{"fxs-contextpane-visible":n,"fxs-contextpane-loading":r}],role:"complementary","aria-labelledby":"fxsContextPaneTitle"},s("div",{className:"fxs-contextpane-loadindicator"},s(i.LoadingIndicator,null)))}})),
define("_generated/MsPortalImpl/Svg/Library/ArrowRight.svg",["require","exports"],(function(e,t){"use strict";return{type:262,data:"<svg viewBox='0 0 14.2 9.7' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='m8.6 9 3.7-3.6H0v-1h12.3L8.6.7l.8-.7 4.8 4.9-4.8 4.8z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/DoubleChevron.svg",["require","exports"],(function(e,t){"use strict";return{type:345,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M14.65 15.53 8 8.88l-6.65 6.65-.7-.71L8 7.47l7.35 7.35-.7.71z'/><path d='M14.65 8.53 8 1.88 1.35 8.53l-.7-.71L8 .47l7.35 7.35-.7.71z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/Ellipsis.svg",["require","exports"],(function(e,t){"use strict";return{type:176,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M2 7a1 1 0 0 1 .39.08.94.94 0 0 1 .53.53 1 1 0 0 1 0 .78.94.94 0 0 1-.53.53 1 1 0 0 1-.78 0 .94.94 0 0 1-.53-.53 1 1 0 0 1 0-.78.94.94 0 0 1 .53-.53A1 1 0 0 1 2 7zm6 0a1 1 0 0 1 .39.08.94.94 0 0 1 .53.53 1 1 0 0 1 0 .78.94.94 0 0 1-.53.53 1 1 0 0 1-.78 0 .94.94 0 0 1-.53-.53 1 1 0 0 1 0-.78.94.94 0 0 1 .53-.53A1 1 0 0 1 8 7zm6 0a1 1 0 0 1 .39.08.94.94 0 0 1 .53.53 1 1 0 0 1 0 .78.94.94 0 0 1-.53.53 1 1 0 0 1-.78 0 .94.94 0 0 1-.53-.53 1 1 0 0 1 0-.78.94.94 0 0 1 .53-.53A1 1 0 0 1 14 7z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/Hamburger.svg",["require","exports"],(function(e,t){"use strict";return{type:313,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M1 4.5v-1h14v1zm0 4v-1h14v1zm0 4v-1h14v1z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/Hyperlink.svg",["require","exports"],(function(e,t){"use strict";return{type:31,data:"<svg viewBox='0 0 16 15' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M14.3 1H10V0h6v6h-1V1.7l-8 8-.7-.7z'/><path d='M11 8v5a.9.9 0 0 1-1 1H2a.9.9 0 0 1-1-1V6a.9.9 0 0 1 1-1h6l1-1H2a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/Star.svg",["require","exports"],(function(e,t){"use strict";return{type:283,data:"<svg viewBox='0 0 12 12' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='m6 .3 1.5 4.3 4.5.1-3.6 2.7 1.3 4.3L6 9.1l-3.7 2.6 1.3-4.3L0 4.7l4.5-.1z'/></g></svg>"}})),
define("MsPortalImpl/Widgets/Widgets.SideBar.Component",["require","exports","Weave/DirectMode","Weave","MsPortalImpl/Widgets/Widgets.SideBar","_generated/MsPortalImpl/Svg/Startup/Hyperlink.svg","_generated/MsPortalImpl/Svg/Startup/Ellipsis.svg","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Services/Services.GeneralSettings","_generated/MsPortalImpl/Svg/Library/ArrowRight.svg","_generated/MsPortalImpl/Svg/Startup/DoubleChevron.svg","_generated/MsPortalImpl/Svg/Startup/Star.svg","_generated/MsPortalImpl/Svg/Startup/Hamburger.svg","MsPortalImpl/Resources/ImplScriptResources"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SideBar=void 0;const f=window.fx.environment;t.SideBar=function(e){const{vm:t,className:x}=e,b=n,v=r,y=t.isCollapsed,M=t.extensionSideBar(),I=(0,i.composeComputation)([t.hamburgerMode,y],((e,t)=>!(e&&t||M)));let C;const P=t.sideBarMenuIsActivated.compose((e=>e?h.SideBar.menuCollapse:h.SideBar.menuExpand)),w=(0,i.composeComputation)([t.menuBladeId,t.layoutMode],((e,t)=>!!e&&0===t));return M&&Promise.all([MsPortalFx.require("MsPortalImpl/UI/UI.BladeOpenerImpl"),MsPortalFx.require("Fx/Composition/Selectable")]).then((([{BladeOpener:e},{PdlBladeReference:s}])=>{const[,i,o]=M.split("/");t.diContainer.get(e).openBlade(new s(o,i),{flags:512})})),s(i.GetContext,{fn:({diContainer:e})=>s(i.LifetimeManagerScoped,{fn:n=>((0,i.subscribeAndRun)(n,[w],t.sideBarMenuIsActivated),s("div",{className:[x,M&&"fxs-extension-sidebar fxs-portal-background",{"fxs-sidebar-menu-activated":t.sideBarMenuIsActivated,"fxs-sidebar-menu":w,"fxs-sidebar-is-collapsed":y,"fxs-display-none":!!f.chrome.hideSidebarNav}],role:"presentation",onDragOver:({event:e})=>{e.preventDefault()},onDrop:({event:e})=>{const s=e.target,i=$(s).closest(".fxs-sidebar-droppable")[0];e.preventDefault(),i&&(0,o.reorderFavorite)(i.getAttribute("data-id"),C,t)},afterMount:s=>{new o.Widget(n,$(s),t,e)}},s("nav",{className:"fxs-sidebar-bar msportalfx-shadow-level3","aria-label":l.SideBar.svcNavLabel,onKeyDown:({event:e})=>{if(32===e.keyCode&&4!==(0,d.getModifierKeys)(e)){const t=e.target;t.click(),t.classList.contains("fxs-sidebar-filter-input")||e.preventDefault(),e.stopPropagation()}}},s("div",{className:"fxs-sidebar-header"},s("button",{className:"fxs-sidebar-item-link fxs-sidebar-hamburger fxs-sidebar-button",title:l.SideBar.hamburger,"aria-label":l.SideBar.hamburger,onClick:S,ref:t.hamburgerButton},s("div",{className:"fxs-sidebar-icon",image:g})),s("a",{className:"fxs-sidebar-menu-toggle-link",href:"#",title:P,"aria-label":P,onClick:({event:e})=>{e.preventDefault(),t.sideBarMenuIsActivated(!t.sideBarMenuIsActivated.value)}},s("div",{className:"fxs-sidebar-menu-icon fxs-sidebar-icon",image:MsPortalFx.Base.Images.CustomImageWithOptions(p,{palette:99})}),s("div",{className:"fxs-sidebar-menu-text fxs-sidebar-label"},P)),s("div",{className:"fxs-sidebar-divider2"})),s(i.Once,{"data-odebug":"16",condition:I,trueFn:()=>s(i.Fragment,null,s("div",{className:"fxs-sidebar-top fxs-sidebar-menu-activated-hidden"},s("button",{className:"fxs-sidebar-collapse-button fxs-sidebar-button",title:y.compose((e=>e?l.SideBar.expand:l.SideBar.collapse)),image:u,onClick:()=>{const e=!t.isCollapsed.value;2===t.layoutMode.value&&t.diContainer.get(c.GeneralSettings).sideBarCollapsedKey(e),t.setCollapsed(e)}}),t.topSectionLinks.map((e=>s("a",{className:"fxs-sidebar-item-link "+e.classes,href:e.href,title:e.title,"aria-label":e.title,onClick:()=>{e.onClick(),S()}},s("div",{className:"fxs-sidebar-icon",image:e.icon}),s("div",{className:"fxs-sidebar-label"},e.text))))),MsPortalFx.isFeatureEnabled("hidefavoritesdivider")?null:s("div",{className:"fxs-sidebar-favorites-section fxs-sidebar-menu-activated-hidden"},s("div",{className:"fxs-sidebar-divider"}),s("div",{className:"fxs-sidebar-fav-icon",image:m}),s("span",{className:"fxs-sidebar-myfavorites"},l.SideBar.myFavorites),s("div",{className:"fxs-sidebar-divider"})),s("div",{className:"fxs-sidebar-middle fxs-sidebar-menu-activated-hidden"},s("ul",{className:"fxs-sidebar-favorites fxs-sidebar-list","aria-label":l.SideBar.svcList,afterMount:(e,t)=>{const s=new MutationObserver((()=>{if(!e.querySelector('.fxs-sidebar-item-link[tabindex="0"]')){const t=e.querySelector(".fxs-sidebar-item-link");t&&t.setAttribute("tabindex","0")}}));s.observe(e,{childList:!0}),t.registerForDispose((()=>s.disconnect())),new a.KeyboardNavigation(t,{element:$(e),tabTriggers:12,itemSelector:".fxs-sidebar-item-link"})}},s(i.ForEach,{collection:t.effectiveFavorites,fn:({item:e})=>s("li",{className:"fxs-sidebar-item fxs-sidebar-favorite-item fxs-sidebar-draggable fxs-sidebar-droppable",draggable:"true","data-id":e.id,onDragStart:_},s("a",{tabindex:"-1",className:"fxs-sidebar-item-link",href:e.uri,title:e.label,"aria-label":e.label,onClick:F},s("div",{className:"fxs-sidebar-icon",image:e.image}),s("div",{className:"fxs-sidebar-label"},e.label),e.opensExternal?s("div",{className:"fxs-sidebar-external",image:b}):null,s("div",{className:"fxs-sidebar-handle",image:v})),s("div",{className:"fxs-hover-card-balloon",style:{display:"hidden"},"data-name":e.id,"data-source":"SidebarFavorite"}))})))),falseFn:()=>s("div",{className:"fxs-sidebar-content"})}),s("div",{className:"fxs-sidebar-menu-container"}),s("div",{className:"fxs-sidebar-shadow"}))))})});function _(e){const t=e.event,s=t.dataTransfer;s&&(s.setData("text","fxs-draganddrop"),s.effectAllowed="move"),C=t.currentTarget.getAttribute("data-id")}function S(){(t.hamburgerMode.value||2!==t.layoutMode.value)&&t.setCollapsed(!0)}function F(e){const s=e.event,i=s.currentTarget.parentElement.getAttribute("data-id"),o=t.favorites.value,n=o[function(e,t){for(let s=0;s<t.length;++s)if(t[s]&&t[s].id===e)return s;return-1}(i,o)];if(MsPortalFx.Base.Diagnostics.Telemetry.trace({source:"SideBar",name:i,action:"SideBarItemOpened",data:{isFavorite:n.isFavorite()}}),(0,d.isCtrlOrCommandOnly)(s)||s.shiftKey)return!0;t.openFavorite(n)&&s.preventDefault(),S()}}})),
define("MsPortalImpl/UI/UI.DesktopManager",["require","exports","Fx/DependencyInjection"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreviouslyFocusedElement=t.DesktopManagerMode=void 0;let i=class{constructor(){this.value=ko.observable(0)}};i=__decorate([__metadata("fx:diagnostics",[e,"DesktopManagerMode"]),s.Class()],i),t.DesktopManagerMode=i;let o=class{constructor(){this.value=ko.observable()}};o=__decorate([__metadata("fx:diagnostics",[e,"PreviouslyFocusedElement"]),s.Class()],o),t.PreviouslyFocusedElement=o})),
define("MsPortalImpl/Resources/Resources.Images",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=[{MsPortalImpl:[{AdvisorNotifications:[{AdvisorDashboard:["cscz.svg","dede.svg","enus.svg","eses.svg","frfr.svg","huhu.svg","itit.svg","jajp.svg","kokr.svg","nlnl.svg","plpl.svg","ptbr.svg","ptpt.svg","ruru.svg","svse.svg","trtr.svg","zhcn.svg","zhtw.svg"]}]},{AvatarMenu:[{AvatarMenu:["defaultAvatarSmall.png"],Badge:["github.png"]}]},{Blade:[{Blade:["icon.gif"]}]},{ControlsWizard:[{ControlsWizard:["loadingImage.gif"]}]},{General:[{FlowLayout:["gridShadow.png"]}]},{Notice:[{Notice:["comingSoon.png","noSubscription.png","unauthorized.png"]}]},{PartError:[{PartError:["icon.png"]}]},{PartGallery:[{PartGallery:["collectionPartWithRollup.svg","collectionSummary.svg","donutChart.svg","donutChartPartial.svg","extensions.svg","gridWithMoreData.svg","map.svg","multiLineChartMultiTrendLine.svg","multiScatterChart.svg","multiStackedBarChart.svg","mutliLineChart.svg","pricingTier.svg","quotaGauge.svg","resourceMap.svg","singleAreaChart.svg","singleAreaChartSingleThreshold.svg","singleAreaChartSingleTrendline.svg","singleBarChartLarge.svg","singleBarChartSmall.svg","singleLineChart.svg","singleScatterChart.svg","singleScatterSingleThreshold.svg","singleValueGauge.svg","splitBarChart.svg","stackedAreaChart.svg"]}]},{ProvisioningPart:[{ProvisioningPart:["running.gif"]}]}]}];["AdvisorDashboard","AvatarMenu","Badge","Blade","ControlsWizard","FlowLayout","Notice","PartError","PartGallery","ProvisioningPart"].forEach((e=>{var i;t["get"+e]=(i=e,()=>MsPortalFx.getImages(s,i))}))})),
define("MsPortalImpl/Widgets/Widgets.DropMenu",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","Fx/Telemetry","MsPortalImpl/Weave/Util","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.DropMenu.css"],(function(e,t,s,i,o,n,r,a,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.ViewModel=void 0,(0,d.injectCss)(c);const p="fxs-dropmenu-button",u="fxs-dropmenu-hidden",m="fxs-dropmenu-is-open",g="fxs-dropmenu-invisible",h="aria-label",f=s(i.Root,null,s("div",{class:"fxs-dropmenu",role:"presentation"},s("button",{class:"fxs-dropmenu-button","aria-haspopup":"true","aria-expanded":"false"}),s("div",{class:"fxs-dropmenu-content fxs-text-link",role:"menu"})));class x extends n.ViewModel{constructor(e,t,s,i,o){super(),this.isMenuOpen=ko.observable(!1),this.buttonLabel=ko.observable(),this.buttonDescribedBy=ko.observable(),this.buttonTooltip=ko.observable(),this.menuLabel=ko.observable(),this.buttonTemplate=e,this.menuTemplate=t,this.togglesVisibility=!!i,this.itemSelector=s,this.telemetrySource=o,this.autoDismissMenu=!0}open(){this.isMenuOpen(!0)}close(){this.isMenuOpen(!1)}toggle(){this.isMenuOpen(!this.isMenuOpen.peek())}}t.ViewModel=x;class b extends n.Widget{constructor(e,t,s,i=!1){super(e,t,i),this._newRender=s;const o=this.ltm;if(s){const t=e[0].querySelector(".fxs-dropmenu"),s=t.querySelector(".fxs-dropmenu-button"),i=t.querySelector(".fxs-dropmenu-content");this._dropMenu=$(t),this._dropMenuButton=$(s),this._dropMenuContent=$(i)}else{const s=MsPortalFx.getUniqueId(),i=this._dropMenu=$(FxImpl.createElement("div",{trustedInnerHTML:f}).children[0]);this._dropMenuButton=i.findByClassName(p).attr("id",t.buttonId||null).addClass(t.buttonClass).addClass("fxs-popup-button").html(t.buttonTemplate).attr("aria-controls",s),this._dropMenuContent=i.findByClassName("fxs-dropmenu-content").html(t.menuTemplate).attr("id",s).addClass("fxs-popup").addClass("fxs-portal-bg-txt-br").addClass("msportalfx-shadow-level2").addClass(0===t.alignMenu?"fxs-dropmenu-right":"fxs-dropmenu-left"),e.append(this._dropMenu)}const n=this._dropMenuButton,r=this._dropMenuContent,l=this._dropMenu;if(t.isMenuOpen[s?"subscribe":"subscribeAndRun"](o,(e=>{e?(t.telemetrySource&&(0,a.trace)({source:t.telemetrySource,action:"DropMenuOpened"}),this._show()):this._hide()})),!s){let e,s;ko.reactor(o,(()=>{n.attr("title",t.buttonTooltip()).attr(h,t.buttonLabel()),r.attr(h,t.menuLabel())}));const i="click";l.on(i,".fxs-dropmenu-button",e=e=>{e.preventDefault(),t.toggle()}),r.on(i,t.itemSelector,s=e=>{t.close()}),o.registerForDispose((()=>{l.off(i,".fxs-dropmenu-button",e),r.off(i,t.itemSelector,s)}))}let d;window.addEventListener("resize",(()=>{this.options.close()}));const c="contextmenu";e.on(c,d=e=>{if(t.isMenuOpen())return!1}),o.registerForDispose((()=>{e.off(c,d)}))}_show(){this._newRender||(this._dropMenuButton.attr("aria-expanded",!0),this._dropMenuContent.removeClass("fxs-dropmenu-invisible fxs-dropmenu-hidden").addClass(m).attr("aria-hidden",!1));const e=this._dropMenuContent;if(this.options.autoDismissMenu){if(!this._dismissHandle){const e=e=>$.contains(this._dropMenu[0],e)?0:2;this._dismissHandle={dismissFn:()=>{this.options.close()},shouldDismissOnFocusOutFn:()=>$.contains(this._dropMenu[0],document.activeElement)?0:1,shouldDismissOnMouseDownFn:e,shouldDismissOnMouseWheelFn:e,restoreFocus:()=>{this._dropMenuButton[0].focus()},logName:"dropMenu"}}if(!this._dismissLifetime||this._dismissLifetime.isDisposed()){const t=this._dismissLifetime=this.ltm.createChildLifetime(),s=this._dismissHandle;o.register(s),new r.KeyboardNavigation(this._dismissLifetime,{element:e,tabTriggers:12,itemSelector:this.options.itemSelector}),t.registerForDispose([()=>{o.unregister(s)}])}}else this._dismissLifetime&&this._dismissLifetime.dispose();this.options.containInViewport&&requestAnimationFrame((()=>{const e=window.innerWidth-this._dropMenuContent[0].getBoundingClientRect().right-20;e<0&&this._dropMenuContent.css({left:`${e}px`})})),this.options.setItemFocusWhenOpen&&(this._newRender?(0,l.tryFocusAfterChangePropagation)(e[0]):e.focus())}_hide(){this._newRender||(this._dropMenuButton.attr("aria-expanded",!1),this._dropMenuContent.addClass(this.options.togglesVisibility?g:u).removeClass(m).attr("aria-hidden",!0)),this.options.containInViewport&&this._dropMenuContent.css({left:""}),this._dismissLifetime&&this._dismissLifetime.dispose()}setFocus(){this.options.isMenuOpen.peek()?this._newRender?(0,l.tryFocusAfterChangePropagation)(this._dropMenuContent[0]):this._dropMenuContent.focus():this._newRender?(0,l.tryFocusAfterChangePropagation)(this._dropMenuButton[0]):this._dropMenuButton.focus()}}t.Widget=b})),
define("MsPortalImpl/Widgets/Widgets.DropMenu.Component",["require","exports","Weave/DirectMode","MsPortalImpl/Widgets/Widgets.DropMenu","FxInternal/Weave","Weave","FxInternal/Weave/Util"],(function(e,t,s,i,o,n,r){"use strict";function a(e){const t=e.vm,i=MsPortalFx.getUniqueId(),a=(0,o.toComputation)(t.isMenuOpen),l=a.compose(r.negation),d=MsPortalFx.getUniqueId(),c=(0,o.toComputation)(t.buttonDescribedBy);return s("div",{className:"fxs-dropmenu",role:"presentation"},s("button",{id:t.buttonId,"aria-controls":i,className:["fxs-dropmenu-button","fxs-popup-button",t.buttonClass],"aria-haspopup":"true","aria-expanded":a,title:(0,o.toComputation)(t.buttonTooltip),"aria-label":e.buttonLabel||(0,o.toComputation)(t.buttonLabel),"aria-describedby":c.compose((e=>e?d:null)),onClick:({event:e})=>{e.preventDefault(),t.toggle()}},e.button),s(n.If,{condition:c,concealmentBehavior:"remove",trueFn:()=>s("div",{id:d,className:"az-display-none"},c)}),s("div",{id:i,className:["fxs-dropmenu-content","fxs-text-link","fxs-popup","fxs-portal-bg-txt-br","msportalfx-shadow-level2",0===t.alignMenu?"fxs-dropmenu-right":"fxs-dropmenu-left",{"fxs-dropmenu-is-open":a,[t.togglesVisibility?"fxs-dropmenu-invisible":"fxs-dropmenu-hidden"]:l}],role:"menu","aria-hidden":l,"aria-label":(0,o.toComputation)(t.menuLabel),onClick:({event:e})=>{const s=e.currentTarget;let i=e.target;for(i&&!i.matches&&(Element.prototype.matches=Element.prototype.msMatchesSelector);i&&!i.matches(t.itemSelector)&&i!==s;)i=i.parentElement;i&&i.matches(t.itemSelector)&&t.close()}},e.content))}Object.defineProperty(t,"__esModule",{value:!0}),t.DropMenu=t.DropMenuInner=void 0,t.DropMenuInner=a,t.DropMenu=function(e){return s("div",{className:e.className,afterMount:(t,s)=>{s.registerForDispose(new i.Widget($(t),e.vm,!0))}},s(a,{button:e.button,buttonLabel:e.buttonLabel,content:e.content,vm:e.vm}))}})),
define("MsPortalImpl/Widgets/Widgets.AvatarMenu.Component",["require","exports","Weave/DirectMode","MsPortalImpl/Widgets/Widgets.DropMenu.Component","FxInternal/Weave","Weave","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Resources/Resources.Images"],(function(e,t,s,i,o,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AvatarMenu=void 0,t.AvatarMenu=function(e){const{vm:t,className:l}=e;let d,c=0;const p=()=>d&&d(),u=a.getAvatarMenu().defaultAvatarSmall,m=(0,n.composeComputation)([t.userIdentity,t.avatarImage],((e,t)=>e&&!e.isAnonymous&&(t||e.defaultAvatarUri||"").trim()||u)),g=s("div",{className:["fxs-avatarmenu-header",{"fxs-avatarmenu-open":(0,o.toComputation)(t.dropMenuOptions.isMenuOpen)}],title:t.tooltip,onTouchStart:f,onMouseDown:f,onTouchEnd:p,onMouseUp:p},s("div",{className:"fxs-avatarmenu-tenant-container"},s("div",{className:"fxs-avatarmenu-username"},t.displayName),s("div",{className:"fxs-avatarmenu-tenant"},t.tenantDisplayName)),s("div",{className:"fxs-avatarmenu-tenant-image-container"},s("img",{className:"fxs-avatarmenu-tenant-image",src:m,alt:""}),t.userIdentity.compose((e=>(null==e?void 0:e.gitHubUserId)?s("img",{className:"fxs-avatarmenu-tenant-image-overlay",src:MsPortalFx.Base.Resources.getVersionlessContentUri("Content/static/MsPortalImpl/AvatarMenu/badge_github.png"),alt:""}):"")))),h=s("div",{className:"fxs-flyout"});return s(n.GetContext,{fn:({diContainer:e})=>s("div",{className:["fxs-avatarmenu",l],afterMount:(s,i)=>{d=()=>{c&&Date.now()-c>t.showDiagnosticsDelay&&MsPortalFx.require("MsPortalImpl/UI/UI.Portal.Actions").then((i=>{i.showDebugPrompt(e,s,t)})),c=0},i.registerForDispose((()=>d=null))}},s(i.DropMenuInner,{vm:t.dropMenuOptions,buttonLabel:(0,n.composeComputation)([t.displayName,t.tenantDisplayName],((e,t)=>`${r.AvatarMenu.label} ${t?r.AvatarMenu.userWithTenantLabel.format(e,t):r.AvatarMenu.userLabel.format(e)}`)),button:g,content:h}))});function f(){c=Date.now()}}})),
define("_generated/MsPortalImpl/Svg/Startup/Close.svg",["require","exports"],(function(e,t){"use strict";return{type:55,data:"<svg viewBox='0 0 15.8 15.8' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='m8.7 7.9 7.1 7.1-.8.8-7.1-7.1-7.1 7.1L0 15l7.1-7.1L0 .8.8 0l7.1 7.1L15 0l.8.8z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/Search.svg",["require","exports"],(function(e,t){"use strict";return{type:248,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='m10.5 0 1.5.2a3.8 3.8 0 0 1 1.3.6l1.1.8.9 1.1a6.9 6.9 0 0 1 .5 1.3 7.7 7.7 0 0 1 .2 1.5 7.7 7.7 0 0 1-.2 1.5 6.9 6.9 0 0 1-.5 1.3l-.9 1.1-1.1.9-1.3.5-1.5.2a5.8 5.8 0 0 1-1.9-.3 5.4 5.4 0 0 1-1.6-1L.9 15.9H.1a.8.8 0 0 1 0-.8L6.3 9a5.4 5.4 0 0 1-1-1.6A5.8 5.8 0 0 1 5 5.5 7.7 7.7 0 0 1 5.2 4a3.8 3.8 0 0 1 .6-1.3 4.4 4.4 0 0 1 .8-1.1L7.7.8A3.8 3.8 0 0 1 9 .2zm0 10a3.9 3.9 0 0 0 1.8-.4 4.2 4.2 0 0 0 1.4-.9 4.2 4.2 0 0 0 .9-1.4 3.9 3.9 0 0 0 .4-1.8 3.3 3.3 0 0 0-.4-1.7 3.8 3.8 0 0 0-.9-1.5 4.2 4.2 0 0 0-1.4-.9 3.9 3.9 0 0 0-1.8-.4 3.3 3.3 0 0 0-1.7.4 3.8 3.8 0 0 0-1.5.9 3.8 3.8 0 0 0-.9 1.5A3.3 3.3 0 0 0 6 5.5a3.9 3.9 0 0 0 .4 1.8 4.2 4.2 0 0 0 .9 1.4 3.8 3.8 0 0 0 1.5.9 3.3 3.3 0 0 0 1.7.4z'/></g></svg>"}})),
define("MsPortalImpl/Widgets/Widgets.Search.Component",["require","exports","Weave/DirectMode","MsPortalImpl/Resources/ImplScriptResources","FxInternal/Weave/Util","FxInternal/Weave","Weave","_generated/MsPortalImpl/Svg/Startup/Search.svg","_generated/MsPortalImpl/Svg/Startup/Close.svg"],(function(e,t,s,i,o,n,r,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Search=void 0,t.Search=function(e){const{vm:t,className:d}=e,c=i.KeyboardShortcuts.search,p=(0,n.toComputation)(t.filter).compose(o.negation),u=MsPortalFx.isFeatureEnabled("asyncsearch")||MsPortalFx.isFeatureEnabled("globalsearch")?i.Search.globalPlaceholder:i.Search.placeholder,m=new r.ElementRef;return s("div",{className:["fxs-search",d,{"fxs-search-activated":t.isExpanded,"fxs-search-showmenu":(0,n.toComputation)(t.showMenu)}],role:"search"},s("div",{className:["fxs-search-wrapper",{"fxs-searching":(0,n.toComputation)(t.showSearching)}]},s("div",{"aria-hidden":"true",className:"fxs-search-icon-mini",image:a}),s("div",{className:"fxs-search-box fxs-topbar-input"},s("input",{type:"text",className:"azc-input","aria-label":u,placeholder:u,autocomplete:"off",maxlength:100,ref:m})),s("div",{className:"fxs-search-indicator"},s("div",null),s("div",null),s("div",null)),s("div",{role:"presentation",className:["fxs-search-clear",{"fxs-display-none":p}],image:l})),s("a",{href:"#",className:"fxs-search-icon fxs-topbar-button",role:"button",title:c,"aria-label":c,image:a,onFocus:g,onMouseDown:g}),s("div",{className:"fxs-search-menu fxs-dropmenu-content fxs-portal-background msportalfx-shadow-level4"}));function g(e){e.event.preventDefault(),t.isExpanded(!0),m.focus()}}})),
define("MsPortalImpl/Notifications/PortalNotifications",["require","exports","Fx/Ajax","FxHubs/RpcEndPoints","MsPortalFx/Globalization","MsPortalImpl/Notifications/NotificationsClientStrings","MsPortalImpl/Resources/PortalNotificationsTelemetry","FxInternal/AsyncLoader","Fx/DependencyInjection","MsPortalImpl/Services/Services.BrowserSettings","MsPortalImpl/Services/Services.Subscriptions"],(function(e,t,s,i,o,n,r,a,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEV=t.initServiceHealthAlerts=t.init=t.irisTelemetryHandler=t.PortalNotifications=t.irisDurationMap=t.scrapeIrisValue=t.replaceActionWithAction=t.getToastDuration=void 0;var p=MsPortalFx.Base.Diagnostics.Telemetry,u=MsPortalFx.Hubs.Notifications.NotificationStatus,m=FxImpl.Hubs.Notifications.InternalClientNotification;const g=new Map;g.set("serviceissue",n.ServiceHealthAlertTypeNames.serviceIssue),g.set("plannedmaintenance",n.ServiceHealthAlertTypeNames.plannedMaintenance),g.set("healthadvisory",n.ServiceHealthAlertTypeNames.healthAdvisory),g.set("securityadvisory",n.ServiceHealthAlertTypeNames.securityAdvisory);let h=(0,d.hideSmallModals)();function f(e){let s=t.irisDurationMap[(e.duration||"").toString().toLowerCase()];return void 0!==s?s:(s=Number.parseInt(e.duration),s||0)}function x(e,t,s){p.trace({source:r.Source.PortalNotifications,action:e,actionModifier:t,data:s||{}})}function b(e,t){return t.indexOf("{ACTION}")<0?(x(r.Action.IrisNotification,r.ActionModifier.InvalidIrisTelemetryUri,{originalAction:e,originalUri:((t||"").split("?")[0]||"")+""+(t.indexOf("?")>-1?"?_QUERY_PARAMS_REDACTED_":"")}),""):t.replace("{ACTION}",e)}function v(e,t){const s=((e||"").split("?")[1]||"").split("&").filter((e=>!!e));for(let e=0;e<s.length;e++){const i=s[e].split("=");if((i[0]||"").toLowerCase()===t)return i[1]||""}return""}t.getToastDuration=f,t.replaceActionWithAction=b,t.scrapeIrisValue=v,t.irisDurationMap={modal:4,sticky:2,long:1,short:0,suppress:3};let y=class{constructor(){this._contactabilityModalDetails=null,this._shouldShowContactability=MsPortalFx.isFeatureEnabled("testcontactabilitymodal"),this._shouldShowIrisAdvisor=!1,this._irisMessageLimit=Number(MsPortalFx.getFeatureValue("irismessagelimit")||1)}_makeIrisAdvisorContent(e,t,s){var i;const o=`${r.Action.IrisNotification}_${r.Action.IrisAdvisor}`;return{timestamp:new Date,title:e.title,modalNotificationData:e.modalNotificationData,description:e.description,descriptionAsHtml:!0,status:e.status||u.Information,toastDuration:s,inlineForm:{buttons:null!==(i=e.button&&[e.button])&&void 0!==i?i:null},irisNotificationDetails:Object.assign(Object.assign({},t),{notificationId:o}),notificationId:o}}_handleContactabilityNotification(e){return this._contactabilityModalDetails=e,this._shouldShowContactability=!0,this.logIrisNotificationTelemetry({irisNotificationDetails:e,action:r.ActionModifier.ContactabilityNotificationReceived})}_handleIrisAdvisor(e,t,s){if(MsPortalFx.isFeatureEnabled("showirisadvisor"))return this._shouldShowIrisAdvisor=!0,this._irisAdvisorContent=this._makeIrisAdvisorContent(e,t,s),this.logIrisNotificationTelemetry({irisNotificationDetails:t,action:r.ActionModifier.AdvisorNotificationReceived})}_logIrisNotificationTelemetry(e){const t=(e=e||{}).action,i=e.irisNotificationDetails;if(t&&i){const e=i.actionBeaconUri,o=i.impressionsUri,n={actionASID:v(e,"asid"),actionPID:v(e,"pid"),impressionASID:v(o,"asid"),impressionPID:v(o,"pid"),messageLimit:this._irisMessageLimit,originalModifier:t,notificationId:null==i?void 0:i.notificationId};x(r.Action.IrisNotification,t,n);const a=t===r.ActionModifier.NotificationShown||t===r.ActionModifier.ControlNotificationReceived?r.ActionModifier.ImpressionsBeaconCall:r.ActionModifier.ActionsBeaconCall,l=a===r.ActionModifier.ImpressionsBeaconCall?o:b(t,e||"");return l?(0,s.ajax)({type:"POST",uri:MsPortalFx.Base.Resources.getAppRelativeUri(a===r.ActionModifier.ImpressionsBeaconCall?"/api/iris/impressionsbeacon":"/api/iris/actionsbeacon"),isBackgroundTask:!0,setAuthorizationHeader:!0,headers:{Accept:"application/json","x-ms-correlation-id":MsPortalFx.newGuid(),"Content-Type":"application/json","x-ms-tracking-id":MsPortalFx.newGuid()},data:JSON.stringify({beaconParams:`?${l.split("?")[1]}`,beaconAction:t})}).then((()=>{const e=a+"Success";x(r.Action.IrisNotification,e,n)})).catch((e=>{const t=a+"Failed";n.error=JSON.stringify(null==e?void 0:e.jqXHR),x(r.Action.IrisNotification,t,n)})):Q()}}logIrisNotificationTelemetry(e){return this._logIrisNotificationTelemetry(e)}async publishIrisNotification(e){var t,s,i,o;const n=null===(t=null==e?void 0:e.ad)||void 0===t?void 0:t.properties,a=null===(s=null==e?void 0:e.prm)||void 0===s?void 0:s._imp,l=null===(i=null==e?void 0:e.tracking)||void 0===i?void 0:i.baseUri;if(!n||!a||!l)return void x(r.Action.IrisNotification,r.ActionModifier.NotificationNotShown_InvalidContent,{ad:!!e.ad,adProperties:!!n,tracking:!!e.tracking,trackingBaseUri:!!l,prm:!!e.prm,prmImp:!!a});const d=n||{},c={actionBeaconUri:l,impressionsUri:a};if("true"===(null==d?void 0:d.isControl)||!0===(null==d?void 0:d.isControl))return await this.logIrisNotificationTelemetry({irisNotificationDetails:c,action:r.ActionModifier.ControlNotificationReceived});if("contactability"===(null==d?void 0:d.type))return this.contactabilityProperties=null==d?void 0:d.properties,await this._handleContactabilityNotification(Object.assign(Object.assign({},c),{notificationId:r.Source.UpdateContactabilityDialog}));if(d.title&&d.description){let e=f(d);return"advisor"===d.type?this._handleIrisAdvisor(d,c,e):d.type?void x(r.Action.IrisNotification,r.ActionModifier.NotificationNotShown_InValidNotificationType,{actionASID:v(l,"asid"),actionPID:v(l,"pid"),description:d.description,title:d.title,impressionASID:v(a,"asid"),impressionPID:v(a,"pid"),messageLimit:this._irisMessageLimit,type:null==d?void 0:d.type}):(4!==e||MsPortalFx.isFeatureEnabled("allowirismodalnotifications")||(e=1),m.internalPublish({timestamp:new Date,title:d.title,modalNotificationData:d.modalNotificationData,description:d.description,descriptionAsHtml:!0,status:d.status||u.Information,toastDuration:e,inlineForm:{buttons:null!==(o=d.button&&[d.button])&&void 0!==o?o:null},irisNotificationDetails:c,notificationId:r.Action.IrisNotification+MsPortalFx.getUniqueId()}),await this.logIrisNotificationTelemetry({irisNotificationDetails:c,action:r.ActionModifier.NotificationShown}))}x(r.Action.IrisNotification,r.ActionModifier.NotificationNotShown_NoTitleOrDescription,{actionASID:v(l,"asid"),actionPID:v(l,"pid"),description:d.description,title:d.title,impressionASID:v(a,"asid"),impressionPID:v(a,"pid"),messageLimit:this._irisMessageLimit})}async publishIrisNotifications(e){const t=null==e?void 0:e.Notifications;if(!t||0!==MsPortalFx.localeCompareIgnoreCase(o.formatCulture,e.FormatCulture))return void x(r.Action.IrisNotification,r.ActionModifier.NotificationNotShown_NoNotificationsOrCultureMismatch,{cultureMatch:0===MsPortalFx.localeCompareIgnoreCase(o.formatCulture,e&&e.FormatCulture),formatCulture:o.formatCulture,hasIrisNotifications:!(!e||!e.Notifications),irisFormatCulture:e&&e.FormatCulture});const s=!MsPortalFx.isArrayOrObservableArray(t);if(1===this._irisMessageLimit&&s)return await this.publishIrisNotification(t);if(s)return void x(r.Action.IrisNotification,r.ActionModifier.NotificationNotShown_NoNotificationsOrCultureMismatch,{type:typeof t});const i=[];t.forEach((e=>{i.push(this.publishIrisNotification(e))})),await Q.allResolved(i)}publishServiceHealthNotifications(e){e.forEach((e=>{const t=e.eventType&&g.get((e.eventType||"").toLowerCase());if(t&&e.description)return m.internalPublish({timestamp:new Date,title:t,description:e.description,status:"serviceissue"===e.eventType.toLowerCase()?u.Error:u.Information,notificationId:r.Action.ServiceHealthAlertNotification+MsPortalFx.getUniqueId(),correlationIds:[e.trackingId],isServerEvent:!0,uri:`#blade/Microsoft_Azure_Health/AzureHealthBrowseBlade/trackingId/${e.trackingId}`});x(r.Action.ServiceHealthAlertNotification,r.ActionModifier.NotificationNotShown_InvalidContent,{title:e.eventType,description:e.description})}))}shouldShowContactability(){return this._shouldShowContactability}shouldShowIrisAdvisor(){return this._shouldShowIrisAdvisor}async showIrisAdvisor(e){if(this._shouldShowIrisAdvisor=!1,!h&&this._irisAdvisorContent){const t=await e.get(c.SubscriptionsUserContext).getAllSubscriptionsCount();return 0!==t.value||1!==t.type?m.internalPublish(this._irisAdvisorContent):x(r.Action.IrisNotification,"AdvisorModelSkipped",{subscriptionsCount:t.value,subscriptionsCountType:t.type}),await this.logIrisNotificationTelemetry({irisNotificationDetails:this._irisAdvisorContent.irisNotificationDetails,action:r.ActionModifier.NotificationShown})}}async showContactabilityModal(t){if(this.shouldShowContactability())return this._shouldShowContactability=!1,MsPortalFx.require(e.normalize("MsPortalImpl/Notifications/ContactabilityHelper")).then((e=>e.invokeContactabilityModal(t,this._contactabilityModalDetails,this.contactabilityProperties)))}async showHatsModal(e,t){const s=await MsPortalFx.require("MsPortalImpl/Notifications/HatsHelper");return await s.invokeHatsModal(e,t)}};y=__decorate([__metadata("fx:diagnostics",[e,"PortalNotifications"]),(0,l.Class)("")],y),t.PortalNotifications=y,t.irisTelemetryHandler=(0,a.defineHandler)(i.Impl.irisTelemetryEndpoint,(e=>{e.diContainer.get(y).logIrisNotificationTelemetry(e.messageArg)})),t.init=async function(e,t){await e.get(y).publishIrisNotifications(t)},t.initServiceHealthAlerts=function(e,t){e.get(y).publishServiceHealthNotifications(t)}})),
define("MsPortalImpl/Weave/Components",["require","exports","Weave","WeaveDOM/Core/InternalUtil","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/Weave/Util"],(function(e,t,s,i,o,n){"use strict";function r(e){return"string"==typeof e.content?a(e.content,e.require,e.skipSanitization||!1):e.content?e.content.compose((t=>a(t,e.require,e.skipSanitization||!1))):void 0}function a(e,t,s){return{type:"html",data:{content:e,moduleName:t.normalize(),skipSanitization:s}}}function l(e){return{type:"external",applyBindingHandler:c,content:e.content,skipSanitization:e.skipSanitization||!1}}function d(e,t,s){return e?"string"==typeof e?s?e:r({skipSanitization:!1,content:e,require:t}):l({skipSanitization:!1,content:e,require:t}):null}function c(t,r,a){const l=r.dynamicNodeId,d=this.skipSanitization,c=t.getDynamicNodeMetadata(l),u=c.selfLtm.innerLtmRoot,{commentStart:m,commentEnd:g}=c;let h;(0,s.subscribeAndRun)(u,[this.content],(s=>{if(h&&h.dispose(),h=u.createChildLifetime(),p(m,g),t.clear(r),s&&s.htmlTemplate){const t=d?s.htmlTemplate:a.diContainer.get(o.KOAllowedTemplateSanitizer).sanitize({value:s.htmlTemplate,localRequire:e,windowContext:$(m.parentElement),diContainer:a.diContainer,contextData:{weaveCommentNodeText:c.commentStart.textContent}}).sanitizedMarkup;(0,i.insertHtmlBeforeNode)(g,t),function(e,t,s,i){if(ko.isObservable(t)){let o;t.subscribeAndRun(e,(t=>{if(o&&o.dispose(),o=e.createChildLifetime(),ko.isObservable(t)){let e;t.subscribeAndRun(o,(t=>{e&&e.dispose(),e=o.createChildLifetime(),i((0,n.weaveContextToKoContext)(s,e,t))}))}else i((0,n.weaveContextToKoContext)(s,o,t))}))}else i((0,n.weaveContextToKoContext)(s,e,t))}(h,s.viewModel,a,(e=>{p(m,g),function(e,t,s){const o=t.nextSibling;let n=o;const r=ko.bindingProvider.instance,a=r.preprocessNode;if(a){for(;n&&n!==s;){const e=ko.virtualElements.nextSibling(n);a.call(r,n),n=e}n=o}for(;n&&n!==s;){const t=ko.virtualElements.nextSibling(n);((0,i.isNodeType)(n,1)||(0,i.isNodeType)(n,8))&&ko.applyBindings(e,n),n=t}}(e,m,g)}))}})),u.registerForDispose((()=>{p(m,g)}))}function p(e,t){let s=e.nextSibling;for(;s!==t;){const e=s.nextSibling;ko.cleanNode(s),s=e}}Object.defineProperty(t,"__esModule",{value:!0}),t.TextOrKo=t.HtmlOrKo=t.Ko=t.ShellHtml=void 0,t.ShellHtml=r,t.Ko=l,t.HtmlOrKo=function(e){return(0,s.isComputation)(e.content)?e.content.compose((t=>d(t,e.require,!1))):d(e.content,e.require,!1)},t.TextOrKo=function(e){return(0,s.isComputation)(e.content)?e.content.compose((t=>d(t,e.require,!0))):d(e.content,e.require,!0)}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.ModalToast.css",["module"],(function(e){"use strict";return{css:".fxs-modaltoast-item{position:absolute;top:50%;left:50%;padding:24px;transform:translate(-50%,-50%);width:400px;border-radius:2px;overflow-y:auto;max-width:calc(90% - 32px);max-height:calc(90% - 32px)}.fxs-modaltoast-modalimage{padding-top:8px;padding-bottom:12px}.fxs-modaltoast-description{padding-bottom:12px;width:100%}.fxs-modaltoast-title{font-size:18px;font-weight:600;width:100%;padding-bottom:4px;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2}.fxs-modaltoast-inlineform{text-align:center}.fxs-modaltoast-inlineform .fxc-section{display:flex}.fxs-modaltoast-inlineform .fxc-simplebutton{margin-right:5px}.fxs-modaltoast-inlineform .fxc-simplebutton .fxs-button{display:inline-flex;max-width:100%}.fxs-modaltoast-inlineform .fxs-button-text{display:inline-block;width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-modaltoast-close{position:absolute;top:8px;right:8px;background:none;border:none;cursor:pointer}.fxs-modaltoast-close svg{height:12px;width:12px}.fxs-mode-dark .fxs-modaltoast-close{background-color:#323130}",moduleId:e.id}})),
define("MsPortalImpl/Widgets/Widgets.ModalToast",["require","exports","Weave/DirectMode","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Interactions/Interactions.DismissHandler","_generated/Less/MsPortalImpl/Widgets/Widgets.ModalToast.css","Weave","MsPortalImpl/Weave/Components","MsPortalImpl/Resources/ImplScriptResources"],(function(e,t,s,i,o,n,r,a,l){"use strict";let d;Object.defineProperty(t,"__esModule",{value:!0}),t.ModalToast=void 0;const c="msportalfx-modalimage-hideonzoom";t.ModalToast=function(t){const{vm:p}=t,u=p.modalToast;let m;const g={dismissFn:()=>{h()},logName:"modalToast"},h=()=>{m.dispose(),o.unregister(g);const e=u.value;e&&e.onDismissFn&&e.onDismissFn(!1),d.focus()};return o.register(g),s("div",{className:"fxs-portal-shield"},s(r.Css,{css:n}),s("div",{className:"fxs-portal-modaltoast",role:"presentation",afterMount:(e,t)=>{m=new i.KeyboardNavigation(t,{element:$(e)}),d=$(document.activeElement);const s=$(e).findByClassName("fxs-modaltoast-description").findFirstTabbable();if(s.length>0)return s.focus();const o=$(e).findByClassName("fxs-modaltoast-inlineform").findFirstTabbable();o.length>0?o.focus():$(e).findFirstTabbable().focus()}},s(r.If,{condition:u,trueFn:()=>{var t;return s("div",{className:"fxs-modaltoast-item fxs-portal-bg-txt-br fxs-popup msportalfx-shadow-level3",style:{width:(null===(t=u.value.modalNotificationData)||void 0===t?void 0:t.width)||"400px"}},s("button",{tabindex:0,className:"fxs-modaltoast-close fxs-portal-svg fxs-button-default","aria-label":l.ModalToast.closeModal,image:MsPortalFx.Base.Images.Close(),onClick:({event:e})=>{h(),e.preventDefault()}},l.NotificationMenu.dismissToast),s(r.If,{condition:u.compose((e=>{var t,s;return null===(s=null===(t=e.modalNotificationData)||void 0===t?void 0:t.image)||void 0===s?void 0:s.imageUrl})),trueFn:()=>{const e=u.value.modalNotificationData.image;return s("div",{className:"fxs-modaltoast-modalimage",afterMount:(e,t)=>{const s=$(e);if(s.children("img").hasClass(c)){let e=0,i=0;const o=new ResizeObserver((t=>{if((0===e&&s.outerHeight()>0||e<s.outerHeight())&&(e=s.outerHeight()),e>0){const e=t[0].target.clientHeight,o=document.querySelector(".fxs-modaltoast-item");o.scrollHeight>o.clientHeight&&(0===i&&(i=o.scrollHeight),s.attr("hidden",!0)),.9*e>i+32&&s.attr("hidden",!1)}}));o.observe(document.body),t.registerForDispose((()=>{o.unobserve(document.body)}))}}},s("img",{src:e.imageUrl,alt:e.alternativeText||"",className:!0===e.showOnZoom||"true"===e.showOnZoom?"":c,style:{width:e.imageWidth||"100%",height:e.imageHeight||"auto"},role:"image"}))}}),s("div",{className:"fxs-modaltoast-title fxs-portal-text",tabindex:"-1"},u.compose((e=>e.title))),s("div",{className:"fxs-modaltoast-description fxs-portal-title",tabindex:"-1"},s(a.ShellHtml,{content:u.compose((e=>"string"==typeof e.description?e.description:e.description.htmlTemplate)),require:e})),u.compose((e=>e.formSection?e.formSection.section("msportalfx-form fxs-modaltoast-inlineform"):null)))}})))}})),
define("MsPortalImpl/Widgets/Widgets.ModalToastViewModel",["require","exports","Weave"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ViewModel=void 0;t.ViewModel=class{constructor(){this.modalToast=(0,s.makeWritableComputation)()}addModalToast(e){if(!this.modalToast.value){this.modalToast(e);const t=e.formSection;if(t){const s=t.buttons;s.forEach(((t,i)=>{const o=s[i].onClick;s[i].onClick=()=>{o(),e.onDismissFn&&e.onDismissFn(!0,i)}}))}}}}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.NotificationsPane.css",["module"],(function(e){"use strict";return{css:"@keyframes fxs-notificationmenu-indeterminate-progress{from{left:-100%}to{left:150%}}.fxs-notificationspane-progressbar{position:absolute;overflow:hidden;height:2px;top:35px;left:1px;bottom:1px;right:1px;transition:opacity 1.5s ease-in-out 1s}.fxs-notificationspane-progressbar>div{position:absolute;width:60%;height:100%;animation:fxs-notificationmenu-indeterminate-progress 1.5s linear infinite;background-color:#00bcf2}.fxs-notificationspane-button-unreadcount{font-size:10px;position:absolute;top:5px;right:5px;border-radius:16px;text-align:center}.fxs-notificationspane-button-unreadcount-circle{height:16px;width:16px}.fxs-notificationspane-button-unreadcount-oval{width:28px}.fxs-notificationspane-header{padding:0 20px 10px}.fxs-notificationspane{width:525px;max-width:100%;height:100%;box-sizing:border-box;font-size:13px;line-height:normal;display:flex;flex-direction:column;overflow:hidden}.fxs-notificationspane-label{color:#fff;padding-bottom:3px}.fxs-notificationspane-top{overflow:auto;width:100%;padding:0 20px;box-sizing:border-box}.fxs-notificationspane-top .nodata-content{padding:15px 0;text-align:center;font-weight:bold;font-size:14px}.fxs-notificationspane-dismisscontainer{margin-left:auto;display:flex}.fxs-notificationspane-dismissitem{display:flex}.fxs-notificationspane-list{overflow:hidden;list-style:none;padding:0;margin:0;width:100%}.fxs-notificationmenu-notification-wrapper{padding:10px 5px 10px 10px;display:flex;position:relative}.fxs-notificationmenu-notification-li.fxs-portal-border{border-top-width:1px;border-top-style:solid}.fxs-notificationmenu-notification-li.fxs-portal-border:last-child{border-bottom-width:1px;border-bottom-style:solid}.fxs-notificationmenu-notificationclick:hover{text-decoration:underline}.fxs-notificationmenu-notification-dismissIcon{cursor:pointer;background-color:transparent;border:0;margin:0;padding:0;height:14px;width:10px;opacity:.4;margin-left:4px;padding-right:15px;padding-bottom:8px;flex:0 0 auto;position:absolute;top:8px;right:0;opacity:1}.fxs-notificationmenu-notification-dismissIcon svg{padding:5px}.fxs-mode-light .fxs-notificationmenu-notification-dismissIcon svg{fill:#605e5c}.fxs-notificationmenu-notification-expandIcon{cursor:pointer;background-color:transparent;border:0;margin:0;padding:0;height:8px;width:8px;opacity:.4}.fxs-notificationmenu-notification-dismissIcon:hover,.fxs-notificationmenu-notification-expandIcon:hover{opacity:1}.fxs-notificationmenu-notification-details{margin-top:10px;text-decoration:underline;cursor:pointer}.fxs-notificationmenu-notification-iconVerticalTransform{transform:scale(-1,-1);background-color:rgba(255,255,255,.3);padding-bottom:9px}.fxs-notificationmenu-notification-title{display:flex;padding-bottom:2px;max-width:calc(100% - 20px)}.fxs-notificationmenu-notification-title-icon{margin-right:4px;min-width:16px}.fxs-notificationmenu-notification-title-icon svg{height:16px;width:16px;vertical-align:middle}.fxs-notificationmenu-notification-title-text{font-size:14px;display:block;display:-webkit-box;line-height:19px;max-height:38px;overflow:hidden;text-overflow:ellipsis;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow-wrap:break-word;margin:0 4px;flex:1 0 0;font-weight:600}.fxs-notificationmenu-notification-title-subtitle{font-size:13px;line-height:normal}.fxs-notificationmenu-notification-description{font-size:13px;line-height:normal;display:block;line-height:18px;max-height:144px;overflow:hidden;position:relative;padding-top:5px;text-overflow:ellipsis;white-space:pre-wrap;width:100%}.fxs-notificationmenu-notification-expandedDescription{max-height:100%;overflow-y:auto}.fxs-notification-inlineform{padding-top:15px}.fxs-notification-inlineform .fxc-section{display:flex}.fxs-notification-inlineform .fxc-simplebutton{margin-right:5px}.fxs-notification-inlineform .fxc-simplebutton .fxs-button{display:inline-flex;max-width:100%}.fxs-notification-inlineform .fxs-button-text{display:inline-block;width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-notificationmenu-notification-progressbar{margin-top:10px}.fxs-notification-dropdown-button-icon{height:14px;width:14px;display:flex;align-items:center;justify-content:center;cursor:pointer}.fxs-notification-dropdown-button-icon>svg{height:100%;width:100%}.fxs-notification-dropdown-button-container{display:flex;align-items:center}.fxs-notification-dropdown-button{margin:4px 5px 0;padding:4px 5px;opacity:.7;border:none;width:100%;text-align:left}.fxs-notifications-empty{display:flex;flex-direction:column;align-items:center;justify-content:center}.fxs-notifications-emptyicon{height:100px;width:100px;padding-top:40px;padding-bottom:20px;opacity:.4}.fxs-notification-header-content{display:flex;flex:1 1 auto;padding-top:15px}.fxs-notification-action-menu{margin-top:-5px}.fxs-notification-user-time-info{min-height:20px;padding-top:10px;text-decoration:#7a7a7a;display:flex}.fxs-notification-user-time-info .fxs-notification-user-time-info-part{margin-left:auto}.fxs-notification-user-time-info .fxs-notification-user-time-info-part:first-child{margin-left:0}.fxs-notification-seemore-link{display:flex;width:fit-content}.fxs-notification-feedback-wrapper{float:right;margin-left:auto;min-height:20px;padding-top:10px}.fxs-notification-is-this-helpful,.fxs-notification-thank-you{color:#292827;display:inline-flex;font-size:12px;font-weight:normal;line-height:15px}.fxs-notification-is-this-helpful{margin-right:6px}.fxs-notification-like-button,.fxs-notification-dislike-button{color:#0078d4;cursor:pointer;display:inline-block;fill:#0078d400;height:11px;margin:-1px 0 0 7px;stroke:#0078d4;width:13px;transform:scale(-1,1)}.fxs-notification-like-button:focus,.fxs-notification-dislike-button:focus{color:#106ebe;fill:#106ebe00;stroke:#106ebe;transform:scale(-1.1,1.1)}.fxs-notification-like-button:hover,.fxs-notification-dislike-button:hover{color:#106ebe;fill:#106ebe00;stroke:#106ebe;transform:scale(-1.1,1.1)}.fxs-notification-like-button.fxs-notification-feedback-selected,.fxs-notification-dislike-button.fxs-notification-feedback-selected{color:#106ebe;fill:#106ebe;stroke:#106ebe}.fxs-notification-dislikeButton{margin:3px 0 0 14px}.fxs-notification-hide{display:none}.fxs-notification-see-more-less{padding-right:5px}.fxs-notificationmenu-notification{width:100%}.fxs-notificationmenu-arrow{padding-top:2px;padding-left:3px;height:10px;width:10px}",moduleId:e.id}})),
define("MsPortalImpl/UI/Hubs/UI.NotificationHelper",["require","exports","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Widgets/Widgets.ModalToastViewModel","MsPortalImpl/Widgets/Widgets.ModalToast","MsPortalImpl/Resources/PortalNotificationsTelemetry","MsPortalImpl/Notifications/PortalNotifications","MsPortalImpl/Weave/DirectRender","MsPortalImpl/Weave/Components","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.NotificationsPane.css"],(function(e,t,s,i,o,n,r,a,l,d,c,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEV=t.updateNotificationCount=t.showToastAndUpdateCount=t.updateUnreadCountOnButton=t.constructDescription=t.iconMap=void 0,(0,c.injectCss)(p);var u=MsPortalFx.Base,m=u.Diagnostics,g=u.Images.StatusBadge,h=MsPortalFx.Hubs.Notifications.NotificationStatus;const f=m.createLog(e),x="fxs-notificationspane-button-unreadcount";t.iconMap={},t.iconMap[h.Information]=g.Info(),t.iconMap[h.Warning]=g.Warning(),t.iconMap[h.Error]=g.Error(),t.iconMap[h.InProgress]=u.Images.Loading.EllipsisSquare(),t.iconMap[h.Success]=g.Success();let b=0,v=0,y=!1;const M=MsPortalFx.isFeatureEnabled("enablecustomnotificationsprovider");function I(e,t,s,i){const o=t.irisNotificationDetails;o?(0,a.irisTelemetryHandler)({diContainer:e,messageArg:{irisNotificationDetails:o,action:s},messageContext:null}):m.Telemetry.trace({source:i,action:s,data:{notificationId:t.notificationId}})}function C(e){const t=$.querySelectorAll(".fxs-topbar-notifications");v=e,t.attr("aria-label",s.NotificationMenu.overflowTitle.format(e)),t.findByClassName(x).remove(),e>20?t.append(FxImpl.createElement("div",{class:`${x} fxs-notificationspane-button-unreadcount-oval`},MsPortalFx.encodeHtml(s.NotificationMenu.overflowCountMessage))):e&&t.append(FxImpl.createElement("div",{class:`${x} fxs-notificationspane-button-unreadcount-circle`},e+""))}t.constructDescription=function(t,s){return"string"==typeof t?s?(0,d.ShellHtml)({skipSanitization:!1,content:t,require:e}):t:(0,d.ShellHtml)({skipSanitization:!1,content:t.htmlTemplate,require:e})},t.updateUnreadCountOnButton=C,t.showToastAndUpdateCount=function(e,a,d,c){var p,u;if(3===a.status&&(b++,(0,i.unhide)($.querySelectorAll(".fxs-topbar-notifications>.fxs-notificationspane-progressbar"))),4===a.toastDuration){if(!y){y=!0;const t=new o.ViewModel,s=new FxImpl.TriggerableLifetimeManager;return t.addModalToast({modalNotificationData:a.modalNotificationData,title:a.title,description:a.description,formSection:a.formSection,onDismissFn:(t,i)=>{var o,n;s.dispose(),I(e,a,t?r.Action.NotificationClicked+((null===(n=null===(o=a.inlineForm)||void 0===o?void 0:o.buttons[i])||void 0===n?void 0:n.id)||i):r.ActionModifier.NotificationDismissed,r.Source.ToastTray)}}),void(0,l.appendToElement)({element:$.querySelectorAll("body")[0],ltm:s,weaveContext:{diContainer:e},weaveNode:(0,n.ModalToast)({vm:t})})}f.warning(`Modal toast already shown. Showing current toast as sticky. Details: ${JSON.stringify(a.irisNotificationDetails)}; Correlation ids: ${a.correlationIds.join(",")}`)}d.isPaneOpen()?((null===(u=a.inlineForm)||void 0===u?void 0:u.buttons)||a.actions||[]).forEach((e=>{e.id="NotificationClicked"+e.id})):(((null===(p=a.inlineForm)||void 0===p?void 0:p.buttons)||a.actions||[]).forEach((e=>{e.id="ToastClicked"+e.id})),!M&&a.timestamp.getTime()>=d.lastPaneOpenedTime()&&C(++v),c.addToasts({notificationId:a.notificationId,icon:t.iconMap[a.status],title:a.title,description:a.description||"",descriptionAsHtml:a.descriptionAsHtml,time:a.timestamp.toString({hour:"numeric",minute:"numeric"}),ids:a.correlationIds,descriptiveText:s.Toast.description.format(a.title),data:a,clickable:!!(a.asset||a.linkedBlade||a.uri||a.linkTo),formSection:a.formSection,duration:a.toastDuration,onDismissFn:()=>{I(e,a,r.Action.ToastDismissed,r.Source.ToastTray)},uri:a.uri}))},t.updateNotificationCount=function(e,t){!M&&!t.isPaneOpen()&&e.timestamp.getTime()>=t.lastPaneOpenedTime()&&v&&C(--v),3===e.status&&(--b||(0,i.hide)($.querySelectorAll(".fxs-topbar-notifications>.fxs-notificationspane-progressbar")))}})),
define("MsPortalImpl/Widgets/Widgets.ToastViewModel",["require","exports","Fx/DependencyInjection","MsPortalImpl/Resources/PortalNotificationsTelemetry","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.WidgetBase","Weave"],(function(e,t,s,i,o,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addToasts=t.ViewModel=t.clearItemTimeout=void 0;FxImpl.Hubs.Notifications.ToastDuration;function a(e){const t=e&&e.timeoutID;t&&clearTimeout(t.value)}t.clearItemTimeout=a;class l extends n.ViewModel{constructor(e={}){super(),this.items=(0,r.makeArrayComputation)(),this.eventHandlers=ko.observableArray(),this.addOSToast=null,this.displayCount=e.displayCount||4}static create(){return new l}addToasts(e){c(this,e)}removeToast(e){a(e),d(e),this.items.remove(e)}removeAllToasts(){this.items.value.forEach((e=>{a(e),d(e)})),this.items.clear()}startRemoveTimer(e){const t=e.duration?e.duration.value:0;2!==t&&e.timeoutID(setTimeout((()=>{this.items.remove(e),d(e)}),1===t?3e4:5e3))}}function d(e){var t;const s=(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.value)||null,i=(s||Object.create(null)).inlineForm,o=(s||Object.create(null)).actions;((null==i?void 0:i.buttons)||o||[]).forEach((e=>{e.id&&e.id.startsWith("ToastClicked")&&(e.id="NotificationClicked"+e.id.substring("ToastClicked".length))}))}function c(e,t){const s=Array.isArray(t)?t:[t];s.length&&s.forEach((t=>{var s,n;const l=e.items.value,d=t.icon,c=t.title,p=t.description,u=t.descriptionAsHtml,m=t.uri,g=t.time,h=t.ids||[],f=t.data||null,x=t.duration||0,b=t.htmlContent||"",v=!1!==t.clickable,y=t.descriptiveText||o.Toast.description.format(t.title),M=t.notificationId;if(3===x)return;let I;if(h.length>0&&(I=MsPortalFx.find(l,(e=>{const t=e.ids.value;return h.some((e=>t.indexOf(e)>-1))}))),I)I.icon(d),I.title(c),I.description(p),I.descriptionAsHtml(u),I.uri(m),I.time(g),I.ids(h),I.data(f),I.clickable(v),I.htmlContent(b),I.descriptiveText(y),I.duration(x),I.formSection(t.formSection),a(I),e.startRemoveTimer(I);else{const i={icon:(0,r.makeWritableComputation)(d),title:(0,r.makeWritableComputation)(c),description:(0,r.makeWritableComputation)(p),descriptionAsHtml:(0,r.makeWritableComputation)(u),uri:(0,r.makeWritableComputation)(m),time:(0,r.makeWritableComputation)(g),ids:(0,r.makeWritableComputation)(h),data:(0,r.makeWritableComputation)(f),htmlContent:(0,r.makeWritableComputation)(b),timeoutID:(0,r.makeWritableComputation)(null),clickable:(0,r.makeWritableComputation)(v),onDismissFn:t.onDismissFn,descriptiveText:(0,r.makeWritableComputation)(y),duration:(0,r.makeWritableComputation)(x),formSection:(0,r.makeWritableComputation)(t.formSection),notificationId:M};(l.length<e.displayCount||function(e,t){const s=e.items.value;for(let i=0;i<=t+0;i++)for(let t=s.length-1;t>=0;t--){const o=s[t];if(o.duration.value===i)return e.removeToast(o),!0}return!1}(e,x))&&e.items.unshift(i);const o=f||{},a=o.actions&&o.actions.slice(0,3)||(null===(s=o.inlineForm)||void 0===s?void 0:s.buttons)&&(null===(n=o.inlineForm)||void 0===n?void 0:n.buttons.slice(0,3)),I=t.formSection,C=I&&I.buttons&&I.buttons.slice(0,3);(null==C?void 0:C.length)&&a&&MsPortalFx.isArrayOrObservableArray(a)&&a.forEach(((t,s)=>{if(!t.endpoint){const t=C[s].onClick;C[s].onClick=()=>{t(),e.removeToast(i)}}})),e.startRemoveTimer(i)}MsPortalFx.Base.Diagnostics.Telemetry.trace({source:i.Source.ToastTray,action:i.Action.ToastAdded,data:{notificationId:M}}),e.addOSToast&&e.addOSToast(t)}))}__decorate([__metadata("fx:diagnostics",[e,"ViewModel"]),(0,s.Factory)(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",l)],l,"create",null),t.ViewModel=l,t.addToasts=c})),
define("MsPortalImpl/Widgets/Widgets.Toast.Component",["require","exports","MsPortalImpl/Widgets/Widgets.ToastViewModel","Weave/DirectMode","_generated/MsPortalImpl/Svg/Startup/Close.svg","MsPortalImpl/Resources/PortalNotificationsTelemetry","WeaveDOM/DirectRender/DataAttribute","Weave","FxInternal/Weave/Util","FxInternal/Weave","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Weave/Components","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.Toast.css","MsPortalImpl/UI/Hubs/UI.NotificationHelper"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Toast=void 0,(0,m.injectCss)(g);var f=n.Source,x=n.Action;t.Toast=function(t){const n=MsPortalFx.getFeatureValue("rapidtoasts");if("0"===n||"true"===n)return null;const{vm:m,className:g}=t;return i(a.GetContext,{fn:({diContainer:t})=>{const n=(0,d.toComputation)(t.get(c.GeneralSettings).notificationToastEnabledKey);return i(a.Once,{"data-odebug":"22",condition:(0,a.composeComputation)([n,m.items],((e,t)=>e&&t&&t.length>0)),trueFn:()=>i("div",{role:"presentation",className:g,afterMount:(e,t)=>{const s=$(e);m.eventHandlers.map(t,((e,t)=>{e.registerForDispose(s.setEvents([t.events,t.selector,e=>t.handler(e,(0,r.getElementData)($(e.target).closest(".fxs-toast-item")[0]))]))}))}},i("ul",{role:"presentation",className:["fxs-toast",{"fxs-display-none":n.compose(l.negation)}]},i(a.ForEach,{collection:m.items,fn:({item:t})=>{const n=()=>(0,s.clearItemTimeout)(t),r=()=>t.duration&&m.startRemoveTimer(t);return i("li",{data:t,className:"fxs-toast-item fxs-popup fxs-portal-bg-txt-br msportalfx-shadow-level4",role:"alert","aria-live":"polite","aria-atomic":"true","aria-label":t.descriptiveText,onFocusIn:n,onFocusOut:r,onMouseEnter:n,onMouseLeave:r},i(a.If,{condition:t.htmlContent,concealmentBehavior:"remove",trueFn:()=>i("div",{className:"fxs-toast-content","aria-hidden":"true"},i(u.ShellHtml,{content:t.htmlContent,skipSanitization:!0,require:e})),falseFn:()=>i("div",{className:"fxs-toast-wrapper"},i("div",{className:"fxs-toast-header"},i("div",{className:"fxs-toast-icon",image:t.icon}),i(a.If,{condition:t.clickable,concealmentBehavior:"remove",trueFn:()=>i("a",{href:"#",className:"fxs-toast-title fxs-toast-link",onClick:({event:e})=>{e.preventDefault(),t.clickable.value&&(MsPortalFx.Base.Diagnostics.Telemetry.trace({source:f.ToastTray,action:x.ToastClicked,data:{notificationId:t.notificationId||t.data&&t.data.value.notificationId}}),$(e.currentTarget).trigger("fxtoastclick"),m.removeToast(t))}},t.title),falseFn:()=>i("div",{className:"fxs-toast-title fxs-portal-text"},t.title)})),i("div",{className:"fxs-toast-description fxs-portal-title"},t.description.compose((e=>(0,h.constructDescription)(e,t.descriptionAsHtml.value)))),t.formSection?t.formSection.compose((e=>e?e.section("msportalfx-form fxs-notification-inlineform"):null)):null)}),i("button",{className:"fxs-toast-close fxs-portal-svg","aria-label":p.NotificationMenu.dismissToast,image:o,title:p.NotificationMenu.dismissToast,onClick:({event:e})=>{e.preventDefault(),t.onDismissFn?t.onDismissFn():MsPortalFx.Base.Diagnostics.Telemetry.trace({source:f.ToastTray,action:x.ToastDismissed,data:{notificationId:t.notificationId}}),m.removeToast(t)}}))}})))})}})}})),
define("_generated/MsPortalImpl/Svg/Internal/UpdateIcon.svg",["require","exports"],(function(e,t){"use strict";return{type:1,data:"<svg viewBox='0 0 14 14' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><circle cx='7' cy='7' r='6.5' fill='none' stroke='#000'/><g fill='none' stroke='#000' clip-path='url(#a)'><path d='M4.778 6.611 7 4.39l2.222 2.22M7 4.389v5.778'/></g><defs><clipPath id='a'><path d='M3 3.5h8v8H3z' class='msportalfx-svg-c01'/></clipPath></defs></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/Bug.svg",["require","exports"],(function(e,t){"use strict";return{type:391,data:"<svg viewBox='0 0 18 18' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><rect width='10' height='12' x='4' y='5' fill='none' stroke='#000' rx='5'/><path fill='none' stroke='#000' d='M14 8.25a2 2 0 0 1 2 2v1.5m-14 0v-1.5a2 2 0 0 1 2-2M14.5 2.5V4a2 2 0 0 1-2 2H12M6 6h-.5a2 2 0 0 1-2-2V2.5m10.5 10a3 3 0 0 1 0 4m-10 0a3 3 0 0 1 0-4M6 1l1.5 1.5M12 1l-1.5 1.5M7.65 5.4a2 2 0 0 1 0-3 2 2 0 0 1 2.7 0 2 2 0 0 1 0 3'/></g></svg>"}})),
define("MsPortalImpl/Widgets/Widgets.TopBar.Component",["require","exports","Weave","MsPortalImpl/Resources/ImplScriptResources","_generated/MsPortalImpl/Svg/Startup/Bug.svg","_generated/MsPortalImpl/Svg/Startup/Hamburger.svg","_generated/MsPortalImpl/Svg/Library/ArrowRight.svg","_generated/MsPortalImpl/Svg/Internal/UpdateIcon.svg","MsPortalImpl/Services/Services.GeneralSettings","Weave/DirectMode","MsPortalImpl/Widgets/Widgets.Search.Component","MsPortalImpl/Widgets/Widgets.AvatarMenu.Component","MsPortalImpl/Widgets/Widgets.Toast.Component","FxInternal/Weave/Util","FxInternal/Weave","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/UI.AuthStateManager","FxInternal/Weave/Components/Button"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g,h,f,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TopBar=void 0;var b=MsPortalFx.Base;const v=window.fx.environment;function y(e,t){b.Diagnostics.Telemetry.trace({source:"TopBar",action:e,data:t})}t.TopBar=function(e){const{vm:t}=e,b=t.loadingIdList.compose(m.isEmptyArray);return d(s.LifetimeManagerScoped,{fn:e=>d(s.GetContext,{fn:M=>{const I=M.diContainer,C=I.get(FxImpl.Features),P=C.isEnabled("canmodifyextensions")||C.isEnabled("renderdevmodeux"),w=I.get(f.AuthStateManager),_=C.getValue("showbugreportlink"),S="force"===_||"true"===_&&w.isMicrosoftOrAmeTenant&&!C.isEnabled("ci"),F=(0,s.makeWritableComputation)(),k=(0,s.makeWritableComputation)();I.get(l.GeneralSettings).landingPage.subscribeAndRun(e,(()=>{const e=(0,l.isLandingPageDashboard)(I);F(e?i.Dashboard.defaultTitle:i.AzureHome.home),k(e?"#dashboard":"#home")}));const T=()=>{y("CustomizeModeExited",{dashboardChanged:!!t.dashboardChanged.value,onDashboard:!!t.dashboardVisible.value}),t.exitOrganizeMode()},D=I.get(h.DesktopManagerMode).value,E=(0,s.composeComputation)([t.dashboardChanged,t.newDashboardSaveEnabled,t.displayMode],((e,t,s)=>t&&e&&"Dashboard"!==s||e&&!t)),B=(0,s.composeComputation)([t.dashboardVisible,t.newDashboardSaveEnabled],((e,t)=>e&&!t)),A=(0,s.composeComputation)([(0,g.toComputation)(D),t.newDashboardSaveEnabled],((e,t)=>1===e&&!t));return d("div",{className:["fxs-topbar az-noprint msportalfx-unselectable",{"fxs-topbar-devmode fxs-bg-warning":P,"fxs-topbar-dashboard-changed":E,"fxs-topbar-dashboard-visible":B,"fxs-topbar-search-activated":t.searchViewModel.isExpanded}],role:"presentation"},d(s.Once,{"data-odebug":"23",condition:A,trueFn:()=>d("div",{className:"fxs-topbar-exit-customize"},d("div",{className:"fxs-topbar-exit-customize-message"},i.TopBar.exitCustomizeText),d(x.Button,{className:"fxs-topbar-exit-customize-button",text:i.ShellCommands.exitOrganizeMode,onClick:T,style:0}))}),d("div",{className:["fxs-topbar-content",{"fxs-hide-in-customize":t.newDashboardSaveEnabled.compose(m.negation)}],role:"banner","aria-labelledby":"bannerlabel"},v.chrome.hideSidebarNav?null:d("a",{href:"#","aria-label":i.TopBar.hamburger,title:i.TopBar.hamburger,className:["fxs-topbar-sidebar-collapse-button","fxs-topbar-button msportalfx-svg-flip-horizontal fxs-topbar-search-activated-hidden"],image:n,role:"button",onClick:({event:e})=>{e.preventDefault(),y("TopBarHamburgerButtonClicked"),$(e.currentTarget).trigger("fxtogglesidebar")},onKeyDown:({event:e})=>{32===e.keyCode&&($(e.currentTarget).trigger("click"),e.preventDefault(),e.stopPropagation())}}),d("h1",{className:("false"!==C.getValue("internalonly")?"fxs-topbar-preview":"fxs-topbar-brand")+" fxs-topbar-search-activated-hidden",id:"bannerlabel"},d("a",{className:"fxs-topbar-home",title:fx.environment.branding.productName,href:k,role:"link",onClick:()=>y("BannerButtonClicked")},"false"!==C.getValue("internalonly")?d(s.Fragment,null,d("div",{className:"fxs-topbar-internal fxs-internal-short"},i.TopBar.internalText),d("div",{className:"fxs-topbar-internal fxs-internal-full"},fx.environment.branding.productName," (",i.TopBar.internalText,")")):`${fx.environment.branding.productName}`)),P?d("a",{className:"fxs-topbar-exitdevmode fxs-topbar-debug-button fxs-topbar-search-activated-hidden",href:"#",role:"button",onClick:({event:e})=>{e.preventDefault(),t.exitDevMode()}},i.TopBar.exitDevModeLinkText):null,S?d("a",{href:"#",className:"fxs-topbar-reportbug fxs-topbar-debug-button fxs-topbar-search-activated-hidden",role:"button",title:i.TopBar.reportBugTitle,"aria-label":i.TopBar.reportBug,onClick:({event:e})=>{e.preventDefault(),t.reportBug()}},d("span",{className:"fxs-topbar-reportbug-icon",image:o}),d("span",{className:"fxs-topbar-reportbug-text"},i.TopBar.reportBug)):null,d(s.If,{condition:t.canUpgradeSubscription,concealmentBehavior:"remove",trueFn:()=>d("a",{href:t.upgradeableSubscription.compose((e=>`#blade/Microsoft_Azure_Billing/SubscriptionUpgradeBlade/azureSubscriptionId/${e.subscriptionId}/appId/AzPortal_UpgradeBtn`)),className:"fxs-topbar-upgradebutton fxs-topbar-search-activated-hidden",role:"button",title:i.TopBar.upgradeText,"aria-label":i.TopBar.upgradeButtonText,onClick:()=>{MsPortalFx.Base.Diagnostics.Telemetry.trace({action:"FreeTrialUpgradeClicked",source:"TopBar",data:{subscriptionId:t.upgradeableSubscription.value.subscriptionId,creditsRemaining:t.upgradeableSubscription.value.remaining}})}},d("span",{className:"fxs-topbar-upgradebutton-icon",image:a}),d("span",{className:"fxs-topbar-upgradebutton-text"},i.TopBar.upgradeButtonText))}),d("div",{className:"fxs-topbar-placeholder fxs-topbar-search-activated-hidden"}),d("a",{href:"#",tabindex:"-1",className:"fxs-search-back-icon fxs-topbar-button msportalfx-svg-flip-horizontal",role:"button",title:i.TopBar.back,"aria-label":i.TopBar.back,image:r,onClick:({event:e})=>e.preventDefault()}),d(c.Search,{className:"fxs-topbar-search",vm:t.searchViewModel}),d("div",{className:"fxs-topbar-buttons-container fxs-topbar-search-activated-hidden"},t.actionDefinitions.map((e=>e.showNotification?d("div",{className:(0,g.toComputation)(e.active||ko.observable(!1)).compose((t=>e.classNames+(t?" fxs-topbar-active":""))),onClick:({event:t})=>{t.preventDefault(),e.clickHandler()}},d("a",{href:"#",className:"fxs-topbar-button",role:"button",title:e.name,"aria-label":e.name,image:(0,g.toValueOrComputation)(e.icon)}),d("div",{className:"fxs-notificationspane-progressbar fxs-display-none"},d("div",null)),(0,g.toComputation)(e.showNotification).compose((e=>e?d("div",{className:"fxs-notificationspane-button-unreadcount fxs-notificationspane-button-unreadcount-circle"}):null))):d("a",{href:"#",className:["fxs-topbar-button",e.classNames],role:"button",title:e.name,"aria-label":e.name,"aria-expanded":e.ariaExpanded,"aria-controls":e.ariaControls,image:(0,g.toValueOrComputation)(e.icon),onClick:({event:t})=>{t.preventDefault(),e.clickHandler()}})))),d(u.Toast,{className:"fxs-topbar-toast",vm:t.toastViewModel}),d("div",{className:"fxs-topbar-actionsmenu fxs-topbar-search-activated-hidden"}),d(p.AvatarMenu,{className:["fxs-topbar-avatarmenu","fxs-topbar-search-activated-hidden"],vm:t.avatarMenuVM})),d(s.Once,{"data-odebug":"24",condition:E,trueFn:()=>{const e=t.dashboardWritable.compose((e=>e?i.TopBar.saveDashboardButton:i.TopBar.saveDashboardCopyButton)),o=t.dashboardWritable.compose((e=>e?i.TopBar.saveMessage:i.TopBar.saveCopyMessage)),n=t.displayMode,r=(0,s.composeComputation)([(0,g.toComputation)(t.isInOrganizeMode),n],((e,t)=>e&&"Dashboard"===t)),a=n.compose((e=>"Dashboard"!==e)),l=(0,s.composeComputation)([r,a],((e,t)=>!e&&t)),c=n.compose((e=>"Dashboard"===e)),p=c.compose(m.negation),u=(0,s.composeComputation)([r,a,c],((e,t,s)=>!e&&!t&&s));return d("div",{className:"fxs-topbar-dashboard"},d("div",{className:"fxs-topbar-dashboard-message"},o),d(x.Button,{className:["fxs-topbar-dashboard-done-customize",{"fxs-display-none":r.compose(m.negation)}],text:i.TopBar.exitCustomizeButton,onClick:T,style:0,visible:r}),d(x.Button,{className:["fxs-topbar-dashboard-view",{"fxs-display-none":a.compose(m.negation)}],text:i.TopBar.viewDashboardButton,style:l.compose((e=>e?0:1)),onClick:()=>{y("DashboardView"),MsPortalFx.ViewModels.navigateToDashboardEndPoint.invoke(FxImpl.Rpc.client,"fx",["TopBar"])}}),d(x.Button,{className:["fxs-topbar-dashboard-save",{"fxs-display-none":p}],text:e,style:u.compose((e=>e?0:1)),onClick:()=>{const e=t.dashboardWritable.value,s=e?1:2;y(e?"DashboardPublish":"DashboardSaveACopy"),t.finishDashboardEdit(s,"TopBar")}}),d(x.Button,{className:["fxs-topbar-dashboard-discard",{"fxs-display-none":p}],text:i.TopBar.discardDashboardButton,style:1,onClick:()=>{y("DashboardDiscard"),t.finishDashboardEdit(3)}}))}}),d("div",{className:["fxs-loading5dots-container fxs-blade-progress-translucent",{"fxs-display-none":b}]},d("div",null),d("div",null),d("div",null),d("div",null),d("div",null)))}})})}})),
define("MsPortalImpl/Widgets/Widgets.Portal.html",["require","exports","Weave/DirectMode","Weave","Weave/Core/Computation","MsPortalImpl/Weave/DirectRender","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.SideBar.Component","MsPortalImpl/Widgets/Widgets.ContextPane.Component","MsPortalImpl/Widgets/Widgets.ContextMenu.Component","FxInternal/Weave/Components/LoadingIndicator","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Widgets/Widgets.TopBar.Component","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Services/Services.Storage","MsPortalImpl/Services/Services.BrowseCuration"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g,h){"use strict";var f;Object.defineProperty(t,"__esModule",{value:!0}),t.Journey=t.renderPortal=void 0;var x=MsPortalFx.Base.Diagnostics.Telemetry;const b=(null===(f=null===fx||void 0===fx?void 0:fx.environment)||void 0===f?void 0:f.writesDisallowedTenants)||[];t.renderPortal=function(e,t,o,r){const c=window.fx.getTimestamp(),h=m.isIOS&&!m.isSafari&&MsPortalFx.getEnvironmentValue("branding").iosAppId&&!function(e){const t=e.get(g.StorageService).getValue(g.ComponentName.AppBanner,"dismiss",0);return t&&parseInt(t)>=Date.now()-6048e5}(o),f=o.get(FxImpl.Features).isEnabled("outagebanner"),x=o.get(FxImpl.Features).isEnabled("infobanner"),b=function(e){if(e.isEnabled("electrondeprecationbannerforce"))return!0;return(window.portalAppApi||window.nodeRequire)&&e.isEnabled("electrondeprecationbanner")}(o.get(FxImpl.Features)),v=s(i.PromiseFragment,{"data-odebug":"p5",promise:_(x)});t.contextMenuViewModel.registerForCleanup(r);const M=s(i.Fragment,null,h?s(i.PromiseFragment,{"data-odebug":"p6",promise:P()}):null,s(i.PromiseFragment,{"data-odebug":"p7",promise:S(!1)}),v,s(u.TopBar,{vm:t.topBar}),s("div",{className:"fxs-global-notification-banner fxs-blade-statusbg fxs-bg-warning az-noprint"},f?s(i.PromiseFragment,{"data-odebug":"p8",promise:F(o)}):null),b?s(i.PromiseFragment,{promise:w()}):null,s("div",{className:"fxs-portal-tip az-noprint"}),s("div",{className:["fxs-portal-main",{"fxs-topbar-dashboard-changed":t.topBar.dashboardChanged}]},s(a.SideBar,{className:"fxs-sidebar az-noprint msportalfx-unselectable",vm:t.sideBar}),s(y,{vm:t}),s(l.ContextPane,{className:"fxs-portal-contextpane-right msportalfx-shadow-level3",vm:t.rightContextPane}),s(l.ContextPane,{className:"fxs-portal-contextpane-shell msportalfx-shadow-level3",vm:t.shellContextPane})),s("div",{className:"fxs-portal-console az-noprint",id:"consoleRegionId",role:"presentation"}),s(d.ContextMenu,{className:"fxs-commands-contextMenu az-noprint",vm:t.contextMenuViewModel}),s(i.PromiseFragment,{"data-odebug":"p9",promise:S(!0)})),I=window.fx.getTimestamp();(0,n.applyToElement)({element:e,ltm:r,weaveNode:M,weaveContext:{diContainer:o},opName:"portal"}),o.get(p.PortalStartupMarkers).portalTsx={beforeStart:c,tsxFnEnd:I}};const v=MsPortalFx.isFeatureEnabled("allServicesWithOverview");function y(e){const{vm:t}=e;return s("main",{className:"fxs-panorama fxs-portal-content"},s(i.Fragment,null,s(i.Once,{"data-odebug":"15",condition:t.displayMode.compose((e=>"AllServices"===e)),trueFn:()=>s(i.PromiseFragment,{"data-odebug":"p10",promise:I(t),whilePending:s(c.LoadingIndicator,null)})}),s(i.If,{condition:t.settingsFlyoutState,trueFn:()=>s(i.PromiseFragment,{"data-odebug":"p11",promise:C(t),whilePending:s(c.LoadingIndicator,null)})}),s("div",{className:["fxs-startboard fxs-startboard-target fxs-theme-context-start fxs-portal-text",{"fxs-startboard-notfound":t.startboardNotFound,"fxs-startboard-loading":t.startboardLoading}],"aria-label":r.Dashboard.ariaLabel}),s("div",{className:"fxs-home-target"}),s(M,null)))}function M(){return s("div",{className:"fxs-journey-target"},s("div",{className:["fxs-journey-breadcrumb","fxs-portal-bg-txt-br","az-noprint","msportalfx-unselectable","fxs-display-none"]}),s("div",{className:"fxs-journey-layout"}))}async function I(e){const[t,n]=await Promise.all([MsPortalFx.require("MsPortalImpl/Widgets/Widgets.SideBarFlyout"),MsPortalFx.require("MsPortalImpl/Widgets/Widgets.AllServicesMenu.Component"),v&&MsPortalFx.require("MsPortalImpl/Services/BrowseCuration/AllServicesCardData"),MsPortalFx.require(`MsPortalImpl/Services/BrowseCuration/${h.browseCurationFile}`).catch((e=>{(0,h.handleInvalidCurationFileError)(e)}))]),r=x.start({source:"AllServicesMenu",action:"AllServicesMenuLoad"});return performance.mark("AllServicesMenuLoadStart"),s(i.GetContext,{fn:a=>{const l=a.diContainer,d=n.AllServicesMenu,c=new t.ViewModel;return c.filterInputValue=e.allServicesMenuInput.filter,c.categoryInputValue=e.allServicesMenuInput.category,s("div",{className:"fxs-sidebar-flyout fxs-portal-background",role:"presentation",afterMount:(e,s)=>{const n=new t.Widget($(e),c,l),a=s.createChildLifetime();s.registerForDispose(n),(0,i.subscribeAndRun)(a,[c.isLoading],(e=>{e||(a.dispose(),(0,o.invokeAfterChangePropagation)((()=>{performance.mark("AllServicesMenuLoadEnd"),performance.measure("AllServicesMenuLoad","AllServicesMenuLoadStart","AllServicesMenuLoadEnd"),x.completeTrace(r)})))}))}},s(d,{vm:c}))}})}async function C(e){return(await MsPortalFx.require("MsPortalImpl/Weave/Components/SettingsFlyout.Component")).getFlyoutComponent(e.settingsFlyoutState)}async function P(){const{AppBanner:e}=await MsPortalFx.require("MsPortalImpl/Widgets/Widgets.AppBanner.Component");return s(e,null)}async function w(){const{ElectronDeprecatedBanner:e}=await MsPortalFx.require("MsPortalImpl/Widgets/Widgets.ElectronDeprecatedBanner.Component");return s(e,null)}async function _(e){if(e){const e=await MsPortalFx.Base.Security.getUserInfo();if(!!~b.indexOf(null==e?void 0:e.directoryId)){const{GlobalInfoBanner:e}=await MsPortalFx.require("MsPortalImpl/Widgets/Widgets.GlobalInfoBanner.Component");return s(e,null)}}return null}async function S(e){const t=await MsPortalEarly.preload,i=t&&t.securityClassification;if(i){const{GlobalSecurityBanner:t}=await MsPortalFx.require("MsPortalImpl/Widgets/Widgets.GlobalSecurityBanner.Component");return s("div",e?{className:"fxs-global-security-banner-bottom"}:{className:"fxs-global-security-banner-top"},s(t,{classification:i}))}return null}async function F(e){const t=await MsPortalEarly.preload,i=t&&t.outages||[],{GlobalNotificationBanner:o}=await MsPortalFx.require("MsPortalImpl/Widgets/Widgets.GlobalNotificationBanner.Component");return s(o,{notifications:i,container:e})}t.Journey=M})),
define("MsPortalImpl/Interactions/Interactions.RightClick",["require","exports","MsPortalImpl/Base/Base.KeyboardHelper"],(function(e,t,s){"use strict";var i;return function(e){const t="fx-rightClick";e.setup=function(e,i,o){let n,r,a,l=o&&o.formTarget;function d(){e.removeClass(t);const s=i();s&&s.forEach((e=>{e.dispose()})),n&&(e.off("fxcontextmenurequest",n),n=null),r&&(e.off("keydown",r),r=null),a&&(e.off("remove",a),a=null)}function c(t){const s=i();s&&s.length>0&&(t.preventDefault(),t.stopPropagation(),function(t,s){const o=$.Event("fxcontextmenu");o.clientX=t,o.clientY=s,l||(l=e.hasClass("fxs-bladecontent")?e:null);e.trigger(o,{commands:i(),formTarget:l,srcElement:e[0]})}(t.clientX,t.clientY))}return e.addClass(t),e.on("fxcontextmenurequest",n=(e,t)=>{c(e)}),e.on("keydown",r=(e,t)=>{if(121===e.which&&4===s.getModifierKeys(e)){const t=e.target.getClientRects()[0];e.clientX=t&&t.left,e.clientY=t&&t.top,c(e)}}),e.on("remove",a=d),{dispose:d}}}(i||(i={})),i})),
define("MsPortalImpl/UI/Compositions/UI.Composition.PartSize",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isAdaptiveWidth=t.isVariableSize=t.isFixedSize=t.getSize=t.getDefaultSize=t.getCorrespondingStandardSize=t.getGridPixelSize=t.AllCssClasses=t.AllSizes=t.GridSpacingHeight=t.GridSpacingWidth=t.CellSpacingHeight=t.CellSpacingWidth=t.CellHeight=t.CellWidth=void 0;var s=MsPortalFx.Parts;function i(e,t,s){return e<0?-1:0===e?0:Math.max(0,e*t+(e-1)*s)}function o(e,s){return{width:i(e,t.CellWidth,t.CellSpacingWidth),height:i(s,t.CellHeight,t.CellSpacingHeight)}}function n(e,t,s){return Math.ceil(e/(t+s))}function r(e){return $.extend(!0,{},MsPortalFx.find(t.AllSizes,(t=>t&&t.name===e)))}function a(e){return t=>t===e}t.CellWidth=85,t.CellHeight=85,t.CellSpacingWidth=5,t.CellSpacingHeight=5,t.GridSpacingWidth=t.CellWidth+t.CellSpacingWidth,t.GridSpacingHeight=t.CellHeight+t.CellSpacingHeight,t.AllSizes=(()=>{const e=[],t=(t,i,n)=>{e[t]={name:t,css:"fxs-tilesize-"+s.InternalPartSize[t].toLowerCase(),size:o(i,n),span:{colSpan:i,rowSpan:n}}};return t(0,1,1),t(1,2,1),t(2,2,2),t(3,4,2),t(4,2,4),t(5,6,4),t(6,4,6),t(7,6,0),t(8,-1,0),t(9,-1,-1),t(10,4,4),t(11,6,6),t(99,0,0),e})(),t.AllCssClasses=t.AllSizes.map((e=>e.css)),t.getGridPixelSize=function(e,t){const s=e=>Math.ceil(Math.min(Math.max(e,1),25));return o(s(e),s(t))},t.getCorrespondingStandardSize=function(e,s){let i=MsPortalFx.find(t.AllSizes,(t=>{const i=t&&t.size;return t&&i.width===e&&i.height===s}));return i||(i=r(99),i.size={width:e,height:s},i.span=function(e,s){return{colSpan:n(e,t.CellWidth,t.CellSpacingWidth),rowSpan:n(s,t.CellHeight,t.CellSpacingHeight)}}(e,s)),$.extend(!0,{},i)},t.getDefaultSize=function(){return r(2)},t.getSize=r;const l=[0,1,2,3,4,10,5,6,11,99];t.isFixedSize=function(e){const t=a(e);return l.some(t)};const d=[7,8,9];t.isVariableSize=function(e){const t=a(e);return d.some(t)};const c=[8,9];t.isAdaptiveWidth=function(e){const t=a(e);return c.some(t)}})),
define("MsPortalImpl/Widgets/Widgets.LayoutBase",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Orientation=void 0,function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(t.Orientation||(t.Orientation={}))})),
define("MsPortalImpl/Widgets/Widgets.TileActionBar.Component",["require","exports","Weave/DirectMode","FxInternal/Weave","Weave"],(function(e,t,s,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileActionBar=void 0,t.TileActionBar=function(e){const{vm:t}=e;return s("div",{className:"fxs-tile-actionbar-actionlist fxs-portal-background",role:"menubar","aria-label":t.partTitle.compose((e=>`${e} part actions`))},s(o.Once,{"data-odebug":"21",condition:t.visible,trueFn:()=>s(o.ForEach,{collection:t.actions.cFilter((e=>(0,i.toComputation)(e.command.enabled))),fn:({item:e})=>{const t=e.command;return s("button",{type:"button",className:["fxs-tile-actionbar-action fxs-portal-svg",e.className],role:"menuitem",title:(0,i.toComputation)(t.text),"aria-label":(0,i.toComputation)(t.text),image:(0,i.toComputation)(t.icon),onClick:({event:e})=>{e.stopPropagation(),MsPortalFx.Base.Diagnostics.Telemetry.trace({source:"TileAction",action:"TileActionClicked",name:t.commandName}),t.execute(!1)}})}})}))}})),
define("MsPortalImpl/Widgets/Widgets.Tile.Component",["require","exports","Weave/DirectMode","FxInternal/Weave/Components/LoadingIndicator","Weave","MsPortalImpl/Widgets/Widgets.TileActionBar.Component"],(function(e,t,s,i,o,n){"use strict";function r(e){const t=e.vm,r=(0,o.composeComputation)([t.isInBlockingLoadingState,t.hasOngoingOperation],((e,t)=>{let s=0;return e?s=2:t&&(s=1),s}));return s(o.Fragment,null,s("div",{className:"fxs-tile-actionbarcontainer"},s("div",{className:"fxs-tile-actions"},s(n.TileActionBar,{vm:t.actionBarViewModel})),s("div",{className:"fxs-tile-actions-contextmenu"})),s("div",{className:"fxs-tile-overlay"}),s("div",{className:["fxs-tile-progress-transparent fxs-loading5dots-container",{"fxs-display-none":r.compose((e=>1!==e))}]},s("div",{className:"fxs-portal-background"}),s("div",{className:"fxs-portal-background"}),s("div",{className:"fxs-portal-background"}),s("div",{className:"fxs-portal-background"}),s("div",{className:"fxs-portal-background"})),s(i.LoadingIndicator,{className:["fxs-tile-progress fxs-portal-background",{"fxs-display-none":r.compose((e=>2!==e))}]}))}Object.defineProperty(t,"__esModule",{value:!0}),t.TileInner=t.Tile=void 0,t.Tile=function(e){const t=e.vm;return s("div",{id:t.tsxRootElementId,className:"fxs-tile fxs-portal-bg-txt-br"},s(r,{vm:t}))},t.TileInner=r})),
define("MsPortalImpl/Widgets/Widgets.TileActionBar",["require","exports","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.ContextMenu","MsPortalImpl/Base/Base.BrowserDetection","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.TileActionBar.css","Weave"],(function(e,t,s,i,o,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.ViewModel=t.TileActionViewModel=t.actionClassName=t.widgetClassName=void 0,(0,n.injectCss)(r);const l="fxs-tile-actionbar-actionlist",d="fxs-tile-actionbar",c=[];t.widgetClassName=d,t.actionClassName="fxs-tile-actionbar-action";t.TileActionViewModel=class{};class p extends s.ViewModel{constructor(){super(...arguments),this.actions=(0,a.makeArrayComputation)(),this.visible=(0,a.makeWritableComputation)(!1),this.partTitle=(0,a.makeWritableComputation)()}update(){this.visible.value&&this.actions.value.forEach((e=>{e.command.activate(),e.bindCommand()}))}}t.ViewModel=p;class u extends s.Widget{constructor(e,t,s,o){super(e,s);const n=this.options,r=this.ltm;c.push(this),e.addClass(d);const p=new i.ViewModel;p.topOffsetCorrection=25;const u=this.contextMenuWidget=new i.Widget(t,p);r.registerForDispose(e.setEvents(["click","."+l,e=>{const t=e.target;$(t).hasClass(l)&&(o(t),e.preventDefault(),e.stopPropagation())}])),(0,a.subscribeAndRun)(r,[n.visible],(t=>{if(!t){const e=document.activeElement;this.has(e)&&o(e)}t?n.update():u.hide(),$(e).toggleClass("fxs-tile-transparent",!t),t&&c.forEach((e=>{e!==this&&e.options.visible(!t)}))})),r.registerForDispose((()=>{u.dispose(),p.menuItems.removeAll(),this.contextMenuWidget=null,MsPortalFx.remove(c,this)})),this._bindDescendants()}dispose(){this._cleanElement(d),super.dispose()}showTileManagementContextMenu(){this.options.actions.value.forEach((e=>{const t=e.command;"function"==typeof t._getActionClassIdentifier&&"opencontextmenu"===t._getActionClassIdentifier()&&t.execute(!1)}))}setFocus(){!o.isAndroidOrMobile&&this.options.visible.value&&this.element.findFirstTabbable().focus()}has(e){return!(!this.element.has(e).length&&!this.contextMenuWidget.element.has(e).length)}}t.Widget=u})),
define("MsPortalImpl/Widgets/Widgets.Tile",["require","exports","Weave/DirectMode","MsPortalImpl/Interactions/Interactions.RightClick","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/Widgets/Widgets.TileActionBar","MsPortalImpl/Widgets/Widgets.UIElementBase","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.Tile.css","MsPortalImpl/Weave/DirectRender","MsPortalImpl/Widgets/Widgets.Tile.Component","Weave"],(function(e,t,s,i,o,n,r,a,l,d,c,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.createTileWidget=t.ViewModel=t.actionBarContainerClassName=t.overlayClassName=t.widgetClassName=void 0,(0,a.injectCss)(l);const u=MsPortalFx.Base.Diagnostics.createLog(e),m="fxs-tile",g="fxs-tile-overlay",h="fxs-portal-bg-txt-br";t.widgetClassName=m,t.overlayClassName=g,t.actionBarContainerClassName="fxs-tile-actionbarcontainer";let f=0;class x extends r.ViewModel{constructor(e,t){super(e),this.isInBlockingLoadingState=(0,p.makeWritableComputation)(!1),this.hasOngoingOperation=(0,p.makeWritableComputation)(!1),this.size=ko.observable(),this.gridHeight=ko.observable(),this.gridWidth=ko.observable(),this.supportedSizes=ko.observableArray(),this.commands=[],this.actionBarViewModel=new n.ViewModel,this.selected=ko.observable(!1),this.selectedFromHover=ko.observable(!1),this.userResizable=ko.observable(!1),this.inLockedContext=!1,this.tsxRootElementId=`__tile_${f++}__`,this.applyViewSettings(t)}getViewSettings(){return{NormalState:{size:this.size()}}}applyViewSettings(e){e&&e.NormalState&&void 0!==e.NormalState.size&&(this.size=ko.observable(e.NormalState.size))}}t.ViewModel=x,t.createTileWidget=function(e,t,s,i,o){return new b(e,t,s,i,o)};class b extends r.Widget{constructor(e,t,n,r,a){super(e,t),this._tsxRender=r,this._getActions=a;const l=this.ltm;t.size&&void 0!==t.size()||(u.warning("No initial size was set on the Tile view model."),t.size=ko.observable(o.getDefaultSize().name));const p=o.getSize(t.size());if(e.addClass(p&&p.css),r||((0,d.applyToElement)({element:e[0],ltm:this.ltm,weaveNode:s(c.TileInner,{vm:t}),weaveContext:{diContainer:n}}),e.addClass(m).addClass(h)),99===p.name){const s=o.getGridPixelSize(t.gridWidth(),t.gridHeight());e.css({width:s.width,height:s.height})}else o.isFixedSize(t.size())&&(t.gridWidth(p.span.colSpan),t.gridHeight(p.span.rowSpan));this._attachEventHandlers();const g=i.setup(e,ko.observableArray(t.commands));l.registerForDispose(g)}dispose(){this._actionBarWidget&&(this._actionBarWidget.dispose(),this._actionBarWidget=null),this._tsxRender?this.element.removeClass(o.AllCssClasses.join(" ")):this._cleanElement(o.AllCssClasses.join(" "),m,h),super.dispose()}addChild(e){if(!e)throw new Error("Can't add null child.");(e.element||e).insertBefore($(this.element).findByClassName(g))}removeChild(e){return!1}saveViewSettings(){return this.options.getViewSettings()}setSize(e,t){let s=o.getCorrespondingStandardSize(e,t);s||(s=o.getDefaultSize());const i=s.size,n=this.options,r=n.size(),a=this.element;if(r&&r===s.name){if(99!==r)return;if(parseInt(a.css("height"))===i.height&&parseInt(a.css("width"))===i.width)return}n.size(s.name),n.gridHeight(s.span.rowSpan),n.gridWidth(s.span.colSpan),a.css({height:"",width:""}).removeClass(o.AllCssClasses.join(" ")).addClass(s.css),99===s.name&&a.css({height:i.height,width:i.width});a.handleTransitionEndOnce("height",300,(e=>{!this.ltm.isDisposed()&&a.trigger("fxsizechanged",[s.name])}))}get actionBarWidget(){return this._actionBarWidget}setFocus(e){const t=this._actionBarWidget;if(!e&&t&&t.options.visible.value)t.setFocus();else{const e=this.element.find(".fxs-part");e&&e.focus()}}showTileManagementContextMenu(){const e=this.options,t=this.actionBarWidget;!e.locked()&&e.selected()&&t&&t.showTileManagementContextMenu()}_createActionBarWidget(){if(!this._actionBarWidget){const e=this.element,t=this.options,s=t.actionBarViewModel,i=this._getActions;s.actions.setAll(i&&i()),this._actionBarWidget=new n.Widget(e.findByClassName("fxs-tile-actions"),e.findByClassName("fxs-tile-actions-contextmenu"),s,(s=>{e[0].contains(s)&&(this.setFocus(!0),Q.nextTick((()=>{t.selectedFromHover(!1)})))}))}}_attachEventHandlers(){const e=this.element,t=this.options,s=this.ltm;if(t.size.subscribe(s,(()=>{e.trigger(r.Widget.viewSettingsChanged,this.saveViewSettings())})),t.userResizable.subscribeAndRun(s,(e=>{e&&MsPortalFx.tryImmediateResolve(MsPortalFx.require("MsPortalImpl/Interactions/Interactions.FlowLayoutUserResize"),(e=>{e.addUserResizeBehavior(this)}))})),ko.computed(s,t.locked,(t=>{e.trigger("fxsizechanged")})).extend({deferred:!0}),ko.computed(s,(()=>{const s=t.selected(),i=t.selectedFromHover(),o=s||i;ko.ignoreDependencies((()=>{o&&this._createActionBarWidget()})),t.actionBarViewModel.visible(o),e.toggleClass("fxs-tile-selected",s)})),!t.inLockedContext){const i=e=>{t.selectedFromHover()||t.selectedFromHover(!0)},o=e=>{!t.selectedFromHover()||this.actionBarWidget&&this.actionBarWidget.has(document.activeElement)||t.selectedFromHover(!1)};let n=!1;const r=t=>{const s=e[0],i=s.contains(t.target)&&(s.contains(t.relatedTarget)||n);return n=!1,i},a=e=>{!r(e)&&i(e)},l=e=>{!r(e)&&o(e)},d=e[0],c=e=>{27===e.keyCode&&e.target&&d.contains(e.target)&&this.setFocus(!0)},p=e=>{n=!0};e.on("mouseenter",i).on("mouseleave",o).on("keydown",".fxs-tile-actionbar-action",c).on("mousedown",".fxs-tile-actionbar-action",p),d.addEventListener("focus",a,!0),d.addEventListener("blur",l,!0),s.registerForDispose((()=>{e.off("mouseenter",i).off("mouseleave",o).off("keydown",c).off("mousedown",p),d.removeEventListener("focus",a,!0),d.removeEventListener("blur",l,!0)}))}}}t.Widget=b})),
define("MsPortalImpl/Widgets/Widgets.FlowLayout",["require","exports","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.LayoutBase","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","Weave","MsPortalImpl/Widgets/Widgets.Tile.Component","MsPortalImpl/Weave/DirectRender","MsPortalImpl/Weave/Util","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.FlowLayout.css","FxInternal"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlowLayoutPositionConflictResolver=t.FlowLayoutPositioningEngine=t.Widget=t.ViewModel=t.validateGrid=t.calculateSize=t.calculateSpan=void 0;var h=MsPortalFx.Base.Diagnostics,f=o.Orientation;(0,u.injectCss)(m);const x=h.createLog(e),b=r.Widget.getId,v=i.Widget.getWidget,y="fxs-flowlayout",M="fxs-flowlayout-childcontainer",I="fxs-flowlayout-element";t.calculateSpan=(e,t,s)=>Math.min(25,Math.ceil((e+s)/(t+s)));t.calculateSize=(e,t,s)=>e*t+(e-1)*s,t.validateGrid=function(e){const t=new S;let s,i=!0;for(let o=0;o<e.length;o++){const n=e[o],r=n.position,a=r.row,l=r.col,d=n.rowSpan,c=n.colSpan;if(!t.isRectangleFree(l,a,d,c)){i=!1,s={misplacedPart:n.id,overlappedParts:[]};for(let e=l;e<l+c;e++)for(let i=a;i<a+d;i++){const o=t.getItemAt(e,i);o&&-1===s.overlappedParts.indexOf(o.id)&&s.overlappedParts.push(o.id)}break}t.markOccupancy(n)}return{success:i,result:s}};const C={38:1,39:2,40:3,37:4};class P extends r.ViewModel{constructor(e,t){super(e),this._positions=[],this.minColumns=(0,l.makeWritableComputation)(1),this.minRows=(0,l.makeWritableComputation)(1),this.maxColumns=(0,l.makeWritableComputation)(999),this.maxRows=(0,l.makeWritableComputation)(999),this.columnSize=a.CellWidth,this.rowSize=a.CellHeight,this.gutterSize=a.CellSpacingWidth,this.orientation=f.Horizontal,this.allowReorder=!1,this.allowOverflow=!1,this.allowGaps=!1,this.resolutionGuides=!1,this.resolutionGuidesOffset={x:0,y:0},this.childContainerHeight=(0,l.makeWritableComputation)(""),this.childContainerWidth=(0,l.makeWritableComputation)(""),this.positionUpdatedSignal=ko.observable(0),this.applyViewSettings(t)}getViewSettings(){return{positions:this.positions}}applyViewSettings(e){e&&e.positions&&(this.positions=e.positions,this.positionUpdatedSignal(this.positionUpdatedSignal()+1))}get positions(){return this._positions}set positions(e){this._positions=e||[]}}t.ViewModel=P;class w extends r.Widget{constructor(e,t,s){super(e,t,s),this._tsxRender=s,this._dropPlaceholder=null,this._childContainer=null,this._engine=new k(t),this._engine.positions=t.positions,s||(e.addClass(y).html("<div class='"+M+"'></div>"),t.resolutionGuides&&this._addResolutionGuides()),this._childContainer=$(this.element[0].querySelector("."+M)),this._initializeComputed(),s||this._relayoutPositions(),this._attachEventHandlers()}dispose(){this._childElements.forEach((e=>{e.removeClass(I),ko.cleanNode(e[0]),e.remove()})),ko.cleanNode(this._childContainer[0]),this._childContainer.remove(),this.element.removeClass(y),super.dispose()}get _childElements(){const e=this._childContainer.children("."+I),t=[];return $.each(e,(function(e,s){t.push($(s))})),t}get dropPlaceholder(){return this._dropPlaceholder}createTiles(e,t){if(0===e.length)return[];const s=new Array(e.length),i=(0,p.createFragment)(e.map(((e,t)=>(0,l.Once)({condition:s[t]=(0,l.makeWritableComputation)(!1),falseFn:()=>(0,d.Tile)({vm:e.vm})})))),o=this.ltm.createChildLifetime();return(0,l.subscribeAndRun)(o,[(0,l.makeLiftedArrayComputation)(s).cEvery(g.identity)],(e=>{e&&o.dispose()})),(0,c.appendToElement)({element:this._childContainer[0],ltm:o,weaveNode:i,weaveContext:{diContainer:t},opName:"Tiles"}),e.map(((e,i)=>{const o=$(document.getElementById(e.vm.tsxRootElementId)),r=n.createTileWidget(o,e.vm,t,!0,e.getActions),a=s[i];return r.ltm.registerForDispose((()=>a(!0))),this._postProcessAddChild(o),r}))}addChild(e){if(!e)throw new Error("Cannot add a null child.");const t=e.element?e.element:e;this._childContainer.append(t),this._postProcessAddChild(t)}_postProcessAddChild(e){e.css("visibility","hidden"),e.addClass(I);const t=this._getChildDimensions(e),s=this.options;try{s.positions=this._engine.append(b(e),t.rowSpan,t.colSpan)}catch(t){return x.warning("New element could not be appended to the grid. {0}".format(t.toString())),e.removeClass(I),void e.remove()}s.positions=this._engine.positions,this._refreshElementSize(e),this._setContainerSize(),this._relayoutPositions(),this.element.trigger("layoutUpdated"),e.css("visibility","")}removeChild(e,t){const i=MsPortalFx.findIndex(this._childElements,(function(t){return b(t)===e})),o=this._childElements[i];if(!o)return!1;return this.options.positions=this._engine.remove(e),this.element.trigger("layoutUpdated"),s.hide(o).removeClass(I),t?o.detach():o.remove(),this._setContainerSize(),this._relayoutPositions(),!0}resizeChild(e,s,i,o){const n=this.options,a=n.rowSize,l=n.columnSize,d=n.gutterSize,c=MsPortalFx.find(this._childElements,(function(t){return b(t)===e}));if(!c)return;const p=MsPortalFx.find(this._engine.positions,(function(t){return t.id===e}));s=Math.max(s,l),i=Math.max(i,a);const u=(0,t.calculateSpan)(i,a,d),m=(0,t.calculateSpan)(s,l,d),g=this._engine.resize(e,m,u,o);n.positions=g;const h=MsPortalFx.find(g,(function(t){return t.id===e})),f=(0,t.calculateSize)(h.rowSpan,a,d),x=(0,t.calculateSize)(h.colSpan,l,d);if(this._setContainerSize(!0),this._relayoutPositions(),o){p.rowSpan===h.rowSpan&&p.colSpan===h.colSpan||this.element.trigger("layoutUpdated");const e=v(c,r.Widget);this._setElementSize(e,c,x,f)}}moveChild(e,t,s,i){const o=b(e),n=this._getChildDimensions(e),r=this._engine.move(o,{col:t,row:s},n.colSpan,n.rowSpan,i);this.options.positions=r,this._setContainerSize(!0),this._relayoutPositions(),i&&this.element.trigger("layoutUpdated")}refreshLayout(){this.options.positions=this._engine.positions,this._setContainerSize(),this._relayoutPositions(),this._refreshSizes()}saveViewSettings(){const e=this.options;return e.positions=this._engine.positions,e.getViewSettings()}createDropPlaceholder(e,t){this._dropPlaceholder&&this.disposeDropPlaceholder(),this._dropPlaceholder=$(FxImpl.createElement("div",{class:"fxs-flowlayout-drop-placeholder"})).css({width:e,height:t}),this._childContainer.append(this._dropPlaceholder)}disposeDropPlaceholder(){this._dropPlaceholder&&this._dropPlaceholder.remove(),this._dropPlaceholder=null}moveDropPlaceholder(e){this._setElementPositioningCss(this.dropPlaceholder,e)}resizeDropPlaceholder(e,s){const i=this.options,o=i.rowSize,n=i.columnSize,r=i.gutterSize,a=(0,t.calculateSpan)(s,o,r),l=(0,t.calculateSpan)(e,n,r),d=(0,t.calculateSize)(a,o,r),c=(0,t.calculateSize)(l,n,r);this._dropPlaceholder.css({width:c,height:d})}getDomOrderedChildren(){return this._engine.getNaturalDomElementOrder()}discardStateOfUnusedChildren(){let e=[];const t={stateDiscarded:!1};return this._engine&&(e=e.concat(this._engine.discardUnusedPositions())),e.length&&(t.stateDiscarded=!0,t.message="Removed Positions: "+JSON.stringify(e)),t}_initializeComputed(){const e=this.options,t=this.ltm;(0,l.subscribeAndRun)(t,[e.minRows,e.maxRows,e.minColumns,e.maxColumns],(()=>this._setContainerSize())),e.positionUpdatedSignal.subscribe(t,(()=>{this._engine.positions=e.positions}))}_getChildDimensions(e){const s=this.options,i=v(e,n.Widget),o=i&&i.options,r=o&&o.size();let l,d;a.isFixedSize(r)?(l=a.getSize(r),d=99===r?a.getGridPixelSize(o.gridWidth(),o.gridHeight()):l.size):d=this._getChildAccurateDimensions(e);return{rowSpan:(0,t.calculateSpan)(d.height,s.rowSize,s.gutterSize),colSpan:(0,t.calculateSpan)(d.width,s.columnSize,s.gutterSize)}}_getChildAccurateDimensions(e){if(!e[0])return x.warning("Attempted to measure a non-existant item in _getChildAccurateDimensions. Assuming 0 as size."),{height:0,width:0};const t=e[0].getBoundingClientRect();return{height:Math.round(t.height),width:Math.round(t.width)}}_setContainerSize(e){const s=this.options,i=this._engine.getMaxOccupiedPositions(e?s.positions:null),o=Math.max(s.minRows.value,i.row),n=Math.max(s.minColumns.value,i.col),r=(0,t.calculateSize)(o,s.rowSize,s.gutterSize),a=(0,t.calculateSize)(n,s.columnSize,s.gutterSize);this._tsxRender?(s.childContainerHeight(r+"px"),s.childContainerWidth(a+"px")):this._childContainer.css({height:r,width:a})}_relayoutPositions(){let e,t,s,i;for(let o=0;o<this._childElements.length;o++)t=this._childElements[o],e=b(t),s=MsPortalFx.find(this.options.positions,(function(t){return t.id===e})),i=s?s.position:{row:0,col:0},this._setElementPositioningCss(t,i)}_setElementPositioningCss(e,t){const s=this.options,i=t.col*(s.columnSize+s.gutterSize),o=t.row*(s.rowSize+s.gutterSize);let n;n=this._isRtl()?{right:i,top:o}:{left:i,top:o},e.css(n)}_refreshSizes(){this._childElements.forEach(this._refreshElementSize,this)}_refreshElementSize(e){const s=this.options,i=v(e,r.Widget);if(i){const o=b(e),n=MsPortalFx.find(s.positions,(function(e){return e.id===o})),r=(0,t.calculateSize)(n.rowSpan,s.rowSize,s.gutterSize),a=(0,t.calculateSize)(n.colSpan,s.columnSize,s.gutterSize);this._setElementSize(i,e,a,r)}}_setElementSize(e,t,s,i){e?e.setSize(s,i):t.css({width:s,height:i})}_moveFocusInDirection(e){const t=$(document.activeElement).closest("."+n.widgetClassName),s=b(t);if(!s)return;const i=this._engine.getAdjacentElement(s,e),o=MsPortalFx.find(this._childElements,(e=>i===b(e)));if(!o)return;const r=v(o,n.Widget);r&&r.setFocus()}_attachEventHandlers(){const e=this.element,t=(e,t,s,i,o)=>{this.resizeChild(t,s,i,void 0===o||o),e.stopPropagation()},s=e=>{const t=$(e.target);if(t.is("input[type=text], textarea, select")||t.closest(".fxs-contextMenu").length)return;const s=e.which,i=C[s]||0;0!==i&&(e.preventDefault(),e.stopPropagation(),this._moveFocusInDirection(i))};e.on("fxsizechange",t),e.on("keydown",s),this.ltm.registerForDispose((()=>{e.off("fxsizechange",t),e.off("keydown",s)}))}_addResolutionGuides(){const e=this.options.resolutionGuidesOffset;[{x:1024,y:768},{x:1366,y:768},{x:1440,y:900},{x:1920,y:1080},{x:3840,y:2160}].forEach((t=>{const s=$(FxImpl.createElement("div",{class:`fxs-flowlayout-resolutionguide fxs-flowlayout-resolutionguide-${t.x}x${t.y} fxs-hide-in-normal`}));(e.x||e.y)&&s.css({top:e.y+"px",left:e.x+"px"}),this.element.prepend(s)}))}}var _;t.Widget=w,function(e){e.top=function(e){return e.position.row},e.bottom=function(e){return e.position.row+e.rowSpan},e.left=function(e){return e.position.col},e.right=function(e){return e.position.col+e.colSpan}}(_||(_={}));class S{constructor(){this._occupancyGrid=[]}reset(e){this._occupancyGrid.length=0,e&&e.forEach((e=>{this.markOccupancy(e)}))}isRectangleFree(e,t,s,i){const o=e+i,n=t+s;for(let s=e;s<o;s++)for(let e=t;e<n;e++)if(this.isPositionOccupied(s,e))return!1;return!0}isPositionOccupied(e,t){return!!this._occupancyGrid[e]&&!!this._occupancyGrid[e][t]}getItemAt(e,t){const s=this._occupancyGrid[e];return s?s[t]:null}markOccupancy(e,t){const s=_.top(e),i=_.bottom(e),o=_.left(e),n=_.right(e),r=this._occupancyGrid;for(let a=o;a<n;a++)for(let o=s;o<i;o++)r[a]||(r[a]=[]),r[a][o]||(r[a][o]=null),r[a][o]=t?null:e}}const F={};class k{constructor(e){this._occupancyGrid=new S,this._items=[],this._filledPositions={},this._gridOptions=e}append(e,t,s){let i=this._getExistingItem(e);if(this._filledPositions[e]=!0,i)return this._items;const o=this._maxRows(),n=this._maxCols();if(!this._gridOptions.allowOverflow&&(t>o||s>n))throw new Error("The element cannot fit in this grid. ElementRowSpan: {0}, ElementColSpan: {1}, GridMaxRowSpan: {2}, GridMaxColSpan: {3}".format(t,s,o,n));const r=this._findNextAvailablePositionForRectangle(t,s);if(!r)throw new Error("The element cannot fit in the remaining space available in the grid.");return i={id:e,position:r,rowSpan:t,colSpan:s},this._items.push(i),this._occupancyGrid.markOccupancy(i),this._items}move(e,t,s,i,o){const n={id:e,position:t,colSpan:s,rowSpan:i};let r;this._applyGridConstraints(n);const a=new T(this._items,n,this._gridOptions);return r=a.resolved?a.getItems():this._items,o&&(a.resolved&&(this._items.length=0,this._items.push(...r||[])),this._occupancyGrid.reset(this._items),this.collapseGaps()),r}resize(e,t,s,i){const o=this._getExistingItem(e),n=o.position,r={id:o.id,position:{col:n.col,row:n.row},colSpan:t,rowSpan:s},a=r.position;let l;if(this._applyGridConstraints(r),a.row<0||a.col<0)return this._items;const d=Math.max(0,t-o.colSpan),c=Math.max(0,s-o.rowSpan);let p=a.col,u=a.row;this._gridOptions.allowGaps||(p=Math.min(p,Math.max(0,n.col-d)),u=Math.min(u,Math.max(0,n.row-c)));for(let i=p;i<=a.col;i++){for(let o=u;o<=a.row;o++){const n={id:e,position:{col:i,row:o},colSpan:t,rowSpan:s},r=new T(this._items,n,this._gridOptions);if(r.resolved&&((!l||r.shiftCost<l.shiftCost)&&(l=r),l&&0===l.shiftCost))break}if(l&&0===l.shiftCost)break}const m=l?l.getItems():this._items;return i&&(l&&(this._items.length=0,this._items.push(...m||[])),this._occupancyGrid.reset(this._items),this.collapseGaps()),m}remove(e){const t=this._getExistingItem(e);this._filledPositions[e]=!1;const s=this._items.indexOf(t);return-1===s||(this._items.splice(s,1),this._occupancyGrid.markOccupancy(t,!0),this.collapseGaps()),this._items}collapseGaps(){if(this._gridOptions.allowGaps)return;const e={grid:this,isPositionOccupied:function(e,t){return this.grid._occupancyGrid.isPositionOccupied(e,t)},getMaxPositions:function(){return this.grid.getMaxOccupiedPositions()},getMinSize:function(){return{col:this.grid._minCols(),row:this.grid._minRows()}},getItemAt:function(e,t){return this.grid._occupancyGrid.getItemAt(e,t)},shiftItem:function(e,t){e.position.col-=t}},t={grid:this,isPositionOccupied:function(e,t){return this.grid._occupancyGrid.isPositionOccupied(t,e)},getMaxPositions:function(){const e=this.grid.getMaxOccupiedPositions();return{col:e.row,row:e.col}},getMinSize:function(){return{col:this.grid._minRows(),row:this.grid._minCols()}},getItemAt:function(e,t){return this.grid._occupancyGrid.getItemAt(t,e)},shiftItem:function(e,t){e.position.row-=t}};this._orientation()===f.Horizontal?(this._collapseGapsWithGridVisitor(e),this._collapseGapsWithGridVisitor(t)):(this._collapseGapsWithGridVisitor(t),this._collapseGapsWithGridVisitor(e))}getNaturalDomElementOrder(){const e=[],t=this.getMaxOccupiedPositions();for(let s=0;s<t.row;s++)for(let i=0;i<t.col;i++){const t=this._occupancyGrid.getItemAt(i,s);if(t){const s=t.id;-1===e.indexOf(s)&&e.push(s),i+=t.colSpan-1}}return e}getAdjacentElement(e,t){const s=this._getExistingItem(e);if(!s)return e;const i=F[t];return(i?i(this,s):s).id}get positions(){return this._items}set positions(e){this._items.length=0,this._items=e||[],this._occupancyGrid.reset(this._items)}discardUnusedPositions(){const e=[];return this._items.slice(0).forEach((t=>{this._filledPositions[t.id]||(e.push(t),this.remove(t.id))})),e}_orientation(){return this._gridOptions.orientation}_minRows(){return this._gridOptions.minRows.value}_maxRows(){return this._gridOptions.maxRows.value}_minCols(){return this._gridOptions.minColumns.value}_maxCols(){return this._gridOptions.maxColumns.value}getMaxOccupiedPositions(e){let t;const s=e||this._items;let i=0,o=0;for(t=0;t<s.length;t++){const e=s[t],n=e.position;i=Math.max(i,n.col+e.colSpan),o=Math.max(o,n.row+e.rowSpan)}return{col:i,row:o}}_getExistingItem(e){return MsPortalFx.find(this._items,(function(t){return t.id===e}))}_applyGridConstraints(e){let t;if(this._gridOptions.allowOverflow)return;const s=e.position;t=_.bottom(e)-this._maxRows(),t>0&&(s.row-=t),t=_.right(e)-this._maxCols(),t>0&&(s.col-=t)}_findNextAvailablePositionForRectangle(e,t){const s=this._maxCols()-t+1,i=this._maxRows()-e+1;let o,n;if(this._orientation()===f.Horizontal){for(n=0;n<s;n++)for(o=0;o<i;o++)if(this._isRectangleFree(n,o,e,t))return{col:n,row:o};if(this._gridOptions.allowOverflow){return{col:0,row:this.getMaxOccupiedPositions().row}}}else{for(o=0;o<i;o++)for(n=0;n<s;n++)if(this._isRectangleFree(n,o,e,t))return{col:n,row:o};if(this._gridOptions.allowOverflow){return{col:this.getMaxOccupiedPositions().col,row:0}}}}_isRectangleFree(e,t,s,i){const o=e+i,n=t+s;return!(!this._gridOptions.allowOverflow&&(n>this._maxRows()||o>this._maxCols()))&&this._occupancyGrid.isRectangleFree(e,t,s,i)}_collapseGapsWithGridVisitor(e){let t=e.getMaxPositions(),s=t.col,i=t.row;const o=[];let n,r,a=!1;if(!(s<=e.getMinSize().col))for(let l=0;l<s;l++){r=null;for(let t=0;t<i;t++){a=!1,o[t]=this._findGap(t,l,s,e);const i=o[t].colSpan;if(0===i)return;if((!r||i<r)&&(r=i),t>0&&!this._gapsAreContiguous(o[t-1],o[t]))break;a=!0}if(a){n={};for(let t=0;t<i;t++)for(let i=_.right(o[t]);i<s;i++){const s=e.getItemAt(i,t);s&&(n[s.id]=s)}$.each(n,((t,s)=>{e.shiftItem(s,r)})),this._occupancyGrid.reset(this._items),t=e.getMaxPositions(),s=t.col,i=t.row}}}_gapsAreContiguous(e,t){const s=_.left(t),i=_.right(t),o=_.left(e);return _.right(e)>=s&&o<=i}_findGap(e,t,s,i){let o=t;const n={id:"",position:{row:e,col:0},rowSpan:1,colSpan:0};for(;o<s&&i.isPositionOccupied(o,e);)o++;for(n.position.col=o;o<s&&!i.isPositionOccupied(o,e);)n.colSpan++,o++;return n}static _scanAdjacentUp(e,t){const s=t.position,i=s.col,o=s.row-1,n=s.col+t.colSpan;for(let t=o;t>=0;t--)for(let s=i;s<n;s++){const i=e._occupancyGrid.getItemAt(s,t);if(i)return i}return t}static _scanAdjacentRight(e,t){const s=t.position,i=s.col+t.colSpan,o=s.row,n=e.getMaxOccupiedPositions().col,r=s.row+t.rowSpan;for(let t=i;t<n;t++)for(let s=o;s<r;s++){const i=e._occupancyGrid.getItemAt(t,s);if(i)return i}return t}static _scanAdjacentDown(e,t){const s=t.position,i=s.col,o=s.row+t.rowSpan,n=s.col+t.colSpan,r=e.getMaxOccupiedPositions().row;for(let t=o;t<r;t++)for(let s=i;s<n;s++){const i=e._occupancyGrid.getItemAt(s,t);if(i)return i}return t}static _scanAdjacentLeft(e,t){const s=t.position,i=s.col-1,o=s.row,n=s.row+t.rowSpan;for(let t=i;t>=0;t--)for(let s=o;s<n;s++){const i=e._occupancyGrid.getItemAt(t,s);if(i)return i}return t}}t.FlowLayoutPositioningEngine=k,F[1]=k._scanAdjacentUp,F[2]=k._scanAdjacentRight,F[3]=k._scanAdjacentDown,F[4]=k._scanAdjacentLeft;class T{constructor(e,t,s){this.shiftCost=0,this.resolved=!1,this._resolvedItems=[],this._occupancyGrid=new S,this._gridOptions=s,e.forEach((e=>{let s;t.id!==e.id&&(s=$.extend(!0,{},e),this._resolvedItems.push(s),this._occupancyGrid.markOccupancy(s))})),this.resolved=this._resolveConflict(t);const i=$.extend(!0,{},t);this._resolvedItems.push(i),this._occupancyGrid.markOccupancy(i)}getItems(){return this._resolvedItems}_orientation(){return this._gridOptions.orientation}_maxRows(){return this._gridOptions.maxRows.value||999}_maxCols(){return this._gridOptions.maxColumns.value||999}_resolveConflict(e){let t=!1;return this._orientation()===f.Horizontal?(t=this._tryMoveConflictsLeft(e,{})||t,t=this._tryMoveConflictsUp(e,{})||t,t=this._tryMoveConflictsDown(e,{})||t,t=this._tryMoveConflictsRight(e,{})||t):(t=this._tryMoveConflictsUp(e,{})||t,t=this._tryMoveConflictsLeft(e,{})||t,t=this._tryMoveConflictsRight(e,{})||t,t=this._tryMoveConflictsDown(e,{})||t),t}_tryMoveConflictsUp(e,t){t[e.id]=!0;for(let s=_.left(e);s<_.right(e);s++)for(let i=_.top(e);i<_.bottom(e);i++){const o=this._occupancyGrid.getItemAt(s,i);if(o&&!t[o.id]){t[o.id]=!0,i=_.bottom(o);const s=_.top(e)-_.bottom(o),n=this._getConflictArea(o,0,s);if(_.bottom(n)>this._maxRows()||_.top(n)<0)return!1;if(!this._tryMoveConflictsUp(n,t))return!1;this._moveItem(o,0,s),t[o.id]=!1}}return!0}_tryMoveConflictsDown(e,t){t[e.id]=!0;for(let s=_.left(e);s<_.right(e);s++)for(let i=_.bottom(e)-1;i>=_.top(e);i--){const o=this._occupancyGrid.getItemAt(s,i);if(o&&!t[o.id]){t[o.id]=!0,i=_.top(o);const s=_.bottom(e)-_.top(o),n=this._getConflictArea(o,0,s);if(_.bottom(n)>this._maxRows()||_.top(n)<0)return!1;if(!this._tryMoveConflictsDown(n,t))return!1;this._moveItem(o,0,s),t[o.id]=!1}}return!0}_tryMoveConflictsLeft(e,t){t[e.id]=!0;for(let s=_.top(e);s<_.bottom(e);s++)for(let i=_.left(e);i<_.right(e);i++){const o=this._occupancyGrid.getItemAt(i,s);if(o&&!t[o.id]){t[o.id]=!0,i=_.right(o);const s=_.left(e)-_.right(o),n=this._getConflictArea(o,s,0);if(_.right(n)>this._maxCols()||_.left(n)<0)return!1;if(!this._tryMoveConflictsLeft(n,t))return!1;this._moveItem(o,s,0),t[o.id]=!1}}return!0}_tryMoveConflictsRight(e,t){t[e.id]=!0;for(let s=_.top(e);s<_.bottom(e);s++)for(let i=_.right(e)-1;i>=_.left(e);i--){const o=this._occupancyGrid.getItemAt(i,s);if(o&&!t[o.id]){t[o.id]=!0,i=_.left(o);const s=_.right(e)-_.left(o),n=this._getConflictArea(o,s,0);if(_.right(n)>this._maxCols()||_.left(n)<0)return!1;if(!this._tryMoveConflictsRight(n,t))return!1;this._moveItem(o,s,0),t[o.id]=!1}}return!0}_getConflictArea(e,t,s){const i=s<0,o=t<0,n=e.position;return{id:e.id,position:{row:i?n.row+s:n.row,col:o?n.col+t:n.col},rowSpan:e.rowSpan+Math.abs(s),colSpan:e.colSpan+Math.abs(t)}}_moveItem(e,t,s){this._occupancyGrid.markOccupancy(e,!0);const i=e.position;i.col+=t,i.row+=s,this._occupancyGrid.markOccupancy(e),this.shiftCost+=e.colSpan*e.rowSpan}}t.FlowLayoutPositionConflictResolver=T})),
define("MsPortalImpl/Widgets/Widgets.StartBoard",["require","exports","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.RightClick","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Widgets/Widgets.DropMenu","MsPortalImpl/Widgets/Widgets.FlowLayout","MsPortalImpl/Widgets/Widgets.LayoutBase","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Base/Base.Timers","MsPortalImpl/UI/UI.DesktopManager","Viva.Controls/Util/Viva.Resize","Weave","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.StartBoard.css"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.ViewModel=void 0,(0,m.injectCss)(g);const h=MsPortalFx.Base.Diagnostics.createLog(e),f=s.Dashboard,x=window.fx.environment;class b extends l.ViewModel{constructor(e,t,i,o,l,d,c){super(e),this.loading=l,this.notFound=d,this.diContainer=c,this.title=(0,u.makeWritableComputation)(s.Dashboard.defaultTitle),this.dashboardList=(0,u.makeWritableComputation)(),this.headerMode=(0,u.makeWritableComputation)(0),this.isShared=(0,u.makeWritableComputation)(!1),this.notFoundMessage=(0,u.makeWritableComputation)(""),this.subscriptionsInfo=(0,u.makeWritableComputation)(""),this.dashboardErrorMessage=(0,u.makeWritableComputation)(""),this.dashboardChanged=(0,u.makeWritableComputation)(!1),this.dashboardSaveInProgress=(0,u.makeWritableComputation)(!1),this.userPermissions=(0,u.makeWritableComputation)({canModify:!1,canDelete:!1}),this.finishDashboardEdit=$.noop,this.locked(!1);const p=this.flowLayoutOptions=new r.ViewModel("fxs-flowlayout-instanceid");p.allowReorder=!0,p.allowOverflow=!0,p.allowGaps=!0,p.resolutionGuides=!0,p.resolutionGuidesOffset.y=-88,p.orientation=a.Orientation.Vertical,p.minColumns(4),p.maxColumns(6),p.minRows(4),p.locked(!1),this.filtersWidgetViewModel=i,this.dashboardDropMenuViewModel=new n.ViewModel(void 0,void 0,".fxs-startboard-dropdown-dashboard, .fxs-startboard-button-browse"),this.dashboardDropMenuViewModel.alignMenu=0,this.dashboardDropMenuViewModel.telemetrySource="Dashboard",this.commands=o,this.applyViewSettings(t)}getViewSettings(){return{NormalState:{layoutSettings:this.flowLayoutOptions.getViewSettings()}}}applyViewSettings(e){e&&e.NormalState&&e.NormalState.layoutSettings&&this.flowLayoutOptions.applyViewSettings(e.NormalState.layoutSettings)}setWidget(e){this._widget=e}getWidget(){return this._widget}exitOrganizeMode(){this.diContainer.get(c.DesktopManagerMode).value(0);const e=this._widget.element.find(".fxs-startboard-button-edit>.azc-toolbarButton-container");e.length&&e.focus()}}t.ViewModel=b;class v extends l.Widget{constructor(e,t,n){super(e,t,!0),this._focusToDropMenu=n,this._layout=null,this._setFocusOnAnimationFrame=d.throttleByAnimationFrame((()=>{let e;if(this._$lastFocused&&$.contains(this.element[0],this._$lastFocused[0])&&o.isVisible(this._$lastFocused)&&(this._$lastFocused.focus(),e=!0),!e){const e=this._layout.element.findFirstTabbable();1===e.length?e.focus():this._focusToDropMenu()}})),t.setWidget(this);const a=this.ltm;let l;this._features=t.diContainer.get(FxImpl.Features),(0,u.subscribeAndRun)(a,[t.title],(e=>{document.title=s.Portal.windowTitleFormat.format(e,x.branding.title)})),this._layout=new r.Widget($(e[0].querySelector(".fxs-startboard-layout")),t.flowLayoutOptions,!0);const m=e=>{l=e;const s=Math.max(6,Math.floor((e-420)/90));t.flowLayoutOptions.maxColumns(s)},g=t.diContainer.get(c.DesktopManagerMode).value;g.subscribe(this.ltm,(e=>{1===e&&m(this.element.width())})),p.track(this.ltm,this.element,(e=>{1===g()&&l!==e&&m(e)})),this._initializeCommands(a,e),this._attachEventHandlers(e),a.registerForDispose([i.setup(e,ko.observableArray(t.commands))])}dispose(){this._layout.dispose(),super.dispose()}createTiles(e){return this._layout.createTiles(e,this.options.diContainer)}addChild(e){if(!e)throw new Error("Can't add null child.");this._layout.addChild(e)}removeChild(e){return this._layout.removeChild(e)}moveChild(e,t,s,i){this._layout.moveChild(e,t,s,i)}setFocus(){this._features.isEnabled("skipautofocus")||this._setFocusOnAnimationFrame()}saveViewSettings(){return this.options.getViewSettings()}discardStateOfUnusedChildren(){return h.assert(!!this._layout,"FlowLayout not defined."),this._layout?this._layout.discardStateOfUnusedChildren():{stateDiscarded:!1}}getDomOrderedChildren(){return this._layout.getDomOrderedChildren()}_attachEventHandlers(e){this.ltm.registerForDispose(e.setEvents(["layoutUpdated",t=>{e.trigger(l.Widget.viewSettingsChanged,this.saveViewSettings()),t.stopPropagation()}],["focusout",e=>{this._$lastFocused=$(e.target)}]))}_initializeCommands(e,t){const s=this.options,i=s.dashboardDropMenuViewModel,o=d.debounce((()=>{this._focusToDropMenu()}));i.isMenuOpen.subscribe(e,(e=>{e&&s.refreshDashboardList&&(s.dashboardList(void 0),s.refreshDashboardList((e=>{s.dashboardList(e),o()})))})),(0,u.subscribeAndRun)(this.ltm,[s.title],(e=>{i.buttonTooltip(e),i.buttonLabel(f.switcherLabel),i.buttonDescribedBy(f.switcherDescribedby.format(e))}))}}t.Widget=v})),
define("MsPortalImpl/Widgets/Widgets.AsyncSearch",["require","exports","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.WidgetBase","Weave","Weave/Core/Computation","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css"],(function(e,t,s,i,o,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.ViewModel=t.searchBoxClass=t.searchClass=void 0;var l=MsPortalFx.Base.Images;(0,r.injectCss)(a),t.searchClass="fxs-search",t.searchBoxClass="fxs-search-box";const d=s.Search,c=s.SideBarFlyout.disabledMessage;class p extends i.ViewModel{constructor(){super(),this._ltm=new FxImpl.TriggerableLifetimeManager,this._dropdownInitialized=Q.defer(),this.isExpanded=(0,o.makeWritableComputation)(!1),this.showMenu=ko.observable(!1),this.showResults=ko.observable(!1),this.showSearching=ko.observable(!1),this.showNoResults=ko.observable(!1),this.noResultsMessage=ko.observable(),this.noResultsChangeSubscriptionsText=d.Pills.noResultsMessageDetails.format("#menu/subscriptions"),this.showChangeSubscriptions=ko.observable(!1),this.isSearchComplete=ko.observable(!1),this.text=Object.assign(Object.assign({},d),{DisabledByPolicyMessage:c}),this.filter=ko.observable(""),this.searchInFilterText=ko.observable(),this.subscriptionSummary=ko.observable(),this.mruItems=ko.observableArray(),this.searchHistory=ko.observableArray(),this.recentServices=ko.observableArray(),this.additionalSearchProviders=ko.observableArray(),this.resultsPanel=ko.observableArray(),this.pillsCollection=ko.observable(),this.currentPill=ko.observable(),this.menuId=MsPortalFx.getUniqueId(),this.icons={hyperlink:l.Hyperlink(),favorite:l.Star({palette:99}),notFavorite:l.Favorite({palette:99})}}isDropdownInitialized(){return this._dropdownInitialized.promise}dispose(){this._ltm.dispose()}setFocus(){this._widget&&this._widget.setFocus()}setWidget(e){this._widget=e}getWidget(){return this._widget}getRootElement(){return this._widget.element}}t.ViewModel=p;class u extends i.Widget{constructor(e,s,i){super(e,s,!0),this._documentCategoryDisplayName=d.documentation,s.setWidget(this),s.showMenu.subscribe(this.ltm,(e=>{e||(s.filter(""),this._textField&&this._textField.val(""))})),window.fx.environment.chrome.hideSearchBox&&e.addClass("fxs-display-none"),this._textField=$(e[0].querySelector(`.${t.searchBoxClass} input`));const o=e=>{n.dispose(),s.showMenu(!0),MsPortalFx.require("MsPortalImpl/Widgets/Widgets.AsyncSearchDeferred").then((e=>{e.initialize(this.ltm,i,s,this._textField),s._dropdownInitialized.resolve()}))};e[0].addEventListener("focusin",o);const n=this.ltm.createChildLifetime();n.registerForDispose((()=>e[0].removeEventListener("focusin",o)))}setFocus(){this.options.isExpanded(!0);const e=document.activeElement;(0,n.invokeAfterChangePropagation)((()=>{e===document.activeElement&&this._textField.focus()}))}}t.Widget=u})),
define("MsPortalImpl/Services/Services.FavoritesSettings",["require","exports","Fx/DependencyInjection","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.SettingsProcessor","FxInternal/AsyncLoader","FxInternal/DirectoryManagement","Fx/Telemetry"],(function(e,t,s,i,o,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.saveUserDirectorySettingsHandler=t.getUserDirectorySettingsHandler=t.UserDirectorySettings=t.UserDirectorySettingsManager=t.FavoritesSettings=t.FavoritesSettingsManager=void 0;const l=MsPortalFx.Base.Diagnostics.createLog(e);let d=!1;class c extends o.SettingsProcessor{static create(e){return o.create(c,e,new p,8,!0)}}__decorate([__metadata("fx:diagnostics",[e,"FavoritesSettingsManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[i.SettingsManager]),__metadata("design:returntype",Promise)],c,"create",null),t.FavoritesSettingsManager=c;class p{constructor(){this.favorites=ko.observable(""),this.version=ko.observable(0)}static create(e){return e.value}}__decorate([__metadata("fx:diagnostics",[e,"FavoritesSettings"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[c]),__metadata("design:returntype",p)],p,"create",null),t.FavoritesSettings=p;class u extends o.SettingsProcessor{static create(e){return o.create(u,e,new m,7,!0)}}__decorate([__metadata("fx:diagnostics",[e,"UserDirectorySettingsManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[i.SettingsManager]),__metadata("design:returntype",Promise)],u,"create",null),t.UserDirectorySettingsManager=u;class m{constructor(){this.favoriteDirectoriesList=ko.observableArray(),this.userDefaultDirectory=ko.observable(),this.signInToLastVisitedDirectory=ko.observable(!0),this.recentDirectoriesList=ko.observableArray()}static create(e){return e.value}addRecentDirectory(e){if(d||!e)return;const t=e.toLowerCase(),s=this.recentDirectoriesList(),i=s.indexOf(t);i>-1&&s.splice(i,1),s.unshift(t),this.recentDirectoriesList(s.slice(0,3)),d=!0}}__decorate([__metadata("fx:diagnostics",[e,"UserDirectorySettings"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[u]),__metadata("design:returntype",m)],m,"create",null),t.UserDirectorySettings=m,t.getUserDirectorySettingsHandler=(0,n.defineHandler)(r.getUserDirectorySettingsEndPoint,(e=>{const t=e.diContainer.get(u).value;return(0,a.trace)({source:"Services.FavoritesSettings",action:"getUserDirectorySettingsRpc",data:{callingExtension:e.messageContext.srcWindowId}}),Q({favoriteDirectoriesList:t.favoriteDirectoriesList(),userDefaultDirectory:t.userDefaultDirectory()})})),t.saveUserDirectorySettingsHandler=(0,n.defineHandler)(r.saveUserDirectorySettingsEndPoint,(e=>{const t=e.messageArg;let s=!1;const i=Object.create(null);i.callingExtension=e.messageContext.srcWindowId;try{const o=e.diContainer.get(u).value;if(t.favoriteDirectoriesList&&(i.newFavoritesCount=t.favoriteDirectoriesList.length,i.oldFavoritesCount=o.favoriteDirectoriesList().length,o.favoriteDirectoriesList(t.favoriteDirectoriesList)),t.userDefaultDirectory){const e=o.userDefaultDirectory(),s=e&&e.id;s!==t.userDefaultDirectory.id&&(i.oldDefaultId=s,i.newDefaultId=t.userDefaultDirectory.id,o.userDefaultDirectory(t.userDefaultDirectory))}s=!0}catch(e){l.error(`Failed to save user directory settings. Error: "${MsPortalFx.getLogFriendlyMessage(e)}"`)}return(0,a.trace)({source:"Services.FavoritesSettings",action:"saveUserDirectorySettingsRpc",data:MsPortalFx.extend(i,{saveSuccess:s})}),Q(s)}))})),
define("MsPortalImpl/UI/UI.PassthroughUser",["require","exports","MsPortalImpl/Services/Services.Subscriptions","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/UI.DialogManager","Fx/Telemetry","MsPortalImpl/UI/UI.AuthStateManager"],(function(e,t,s,i,o,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.launchPassthroughModalDialog=t.checkPassthroughUserWithNoSubs=void 0;MsPortalFx.ViewModels;const a=i.Passthrough;t.checkPassthroughUserWithNoSubs=async function(e){if(FxImpl.features.isEnabled("forcecheckpassthroughuser"))return!0;if(!FxImpl.features.isEnabled("checkpassthroughuser"))return!1;const[t,i]=await Promise.all([e.get(r.AuthStateManager).getCurrentUser(),e.get(s.SubscriptionsUserContext).getAllSubscriptionsCount()]),o=!t.objectId&&t.tenantId!==FxImpl.internalEnv.fxAadInfrastructureTenantId&&!t.hasAaiClaim&&[4,1].includes(i.type)&&0===i.value;return(0,n.trace)({source:"UI.PassthroughUser",action:"PassthroughUser",data:{isPassthroughUser:o}}),o},t.launchPassthroughModalDialog=async function(e,t){const s=await e.getAsync(o.DialogManager);if(3===await s.showModalDialog({title:a.dialogTitle,description:a.dialogContent,buttons:4,defaultButtonText:a.dialogDefaultButtonText,cancelButtonText:a.dialogCancelButtonText}))return t()}})),
define("_generated/MsPortalImpl/Svg/Library/Feedback.svg",["require","exports"],(function(e,t){"use strict";return{type:228,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M7.484 10.375a5.6 5.6 0 0 1 1.438.828 5.376 5.376 0 0 1 1.109 1.2 5.682 5.682 0 0 1 .711 1.461A5.5 5.5 0 0 1 11 15.5v.5h-1v-.5a4.385 4.385 0 0 0-.352-1.75 4.459 4.459 0 0 0-.968-1.43 4.654 4.654 0 0 0-1.43-.961A4.458 4.458 0 0 0 5.5 11a4.385 4.385 0 0 0-1.75.352 4.459 4.459 0 0 0-1.43.968 4.654 4.654 0 0 0-.961 1.43A4.458 4.458 0 0 0 1 15.5v.5H0v-.5a5.391 5.391 0 0 1 .969-3.1 5.7 5.7 0 0 1 1.109-1.187 5.614 5.614 0 0 1 1.438-.836 3.359 3.359 0 0 1-.633-.563 3.551 3.551 0 0 1-.477-.687 3.387 3.387 0 0 1-.3-.781A3.858 3.858 0 0 1 2 7.5a3.391 3.391 0 0 1 .273-1.359 3.525 3.525 0 0 1 1.86-1.86A3.5 3.5 0 0 1 5.5 4a3.391 3.391 0 0 1 1.359.273 3.525 3.525 0 0 1 1.86 1.86A3.5 3.5 0 0 1 9 7.5a3.424 3.424 0 0 1-.1.836 3.311 3.311 0 0 1-.3.781 4.035 4.035 0 0 1-.477.695 3.076 3.076 0 0 1-.639.563ZM5.5 10a2.424 2.424 0 0 0 .969-.2 2.523 2.523 0 0 0 .789-.532 2.6 2.6 0 0 0 .539-.8 2.478 2.478 0 0 0 .008-1.946 2.46 2.46 0 0 0-.539-.789 2.746 2.746 0 0 0-.8-.539A2.348 2.348 0 0 0 5.5 5a2.424 2.424 0 0 0-.969.2A2.537 2.537 0 0 0 3.2 6.531a2.505 2.505 0 0 0 0 1.938 2.631 2.631 0 0 0 .532.8 2.436 2.436 0 0 0 .8.539A2.484 2.484 0 0 0 5.5 10ZM16 0v8h-2l-3 3V8h-1V7h2v1.586L13.586 7H15V1H5v1.8a8.641 8.641 0 0 0-.5.078 2.926 2.926 0 0 0-.5.141V0Z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Library/LaunchCurrent.svg",["require","exports"],(function(e,t){"use strict";return{type:227,data:"<svg viewBox='0 0 16 15' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M14.3 1H10V0h6v6h-1V1.7l-8 8-.7-.7z'/><path d='M11 8v5a.9.9 0 0 1-1 1H2a.9.9 0 0 1-1-1V6a.9.9 0 0 1 1-1h6l1-1H2a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Library/Mail.svg",["require","exports"],(function(e,t){"use strict";return{type:267,data:"<svg viewBox='0 0 16 10' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M16 0v10H0V0zm-1 9V2.1L8 5.6 1 2.1V9zM1.1 1 8 4.4 14.9 1z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Library/Person.svg",["require","exports"],(function(e,t){"use strict";return{type:44,data:"<svg viewBox='0 0 14 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M9.4 9.4a6.9 6.9 0 0 1 1.9 1 7.5 7.5 0 0 1 1.5 1.6 5.6 5.6 0 0 1 .9 1.9A7.1 7.1 0 0 1 14 16h-1a6.4 6.4 0 0 0-.5-2.4 7.6 7.6 0 0 0-1.2-1.9 7.6 7.6 0 0 0-1.9-1.2A6.4 6.4 0 0 0 7 10l-1.6.2-1.5.6-1.2.9-.9 1.2-.6 1.5A7.8 7.8 0 0 0 1 16H0a8.3 8.3 0 0 1 .3-2.2 6.4 6.4 0 0 1 1-1.8 7 7 0 0 1 1.4-1.6l1.9-1-1.1-.8-.8-1a5 5 0 0 1-.5-1.3A5.1 5.1 0 0 1 2 5a4.1 4.1 0 0 1 .4-1.9 3.8 3.8 0 0 1 1.1-1.6A3.8 3.8 0 0 1 5.1.4 4.1 4.1 0 0 1 7 0a4.1 4.1 0 0 1 1.9.4 3.8 3.8 0 0 1 1.6 1.1 3.8 3.8 0 0 1 1.1 1.6A4.1 4.1 0 0 1 12 5a5.1 5.1 0 0 1-.2 1.3 5 5 0 0 1-.5 1.3l-.8 1zM3 5a4.1 4.1 0 0 0 .3 1.6 3.4 3.4 0 0 0 .9 1.2 3.4 3.4 0 0 0 1.2.9A4.1 4.1 0 0 0 7 9a4.1 4.1 0 0 0 1.6-.3 3.4 3.4 0 0 0 1.2-.9 3.4 3.4 0 0 0 .9-1.2A4.1 4.1 0 0 0 11 5a4.1 4.1 0 0 0-.3-1.6 3.4 3.4 0 0 0-.9-1.2 3.4 3.4 0 0 0-1.2-.9A4.1 4.1 0 0 0 7 1a4.1 4.1 0 0 0-1.6.3 3.4 3.4 0 0 0-1.2.9 3.4 3.4 0 0 0-.9 1.2A4.1 4.1 0 0 0 3 5z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Library/Signout.svg",["require","exports"],(function(e,t){"use strict";return{type:226,data:"<svg viewBox='0 0 14 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='m9.2 2.3 1.9 1a12.1 12.1 0 0 1 1.6 1.6 6.6 6.6 0 0 1 .9 1.9A5.7 5.7 0 0 1 14 9a12.3 12.3 0 0 1-.2 1.9 8 8 0 0 1-.8 1.6 3.8 3.8 0 0 1-1.1 1.4 3.8 3.8 0 0 1-1.4 1.1l-1.6.8L7 16l-1.9-.2-1.6-.8a3.8 3.8 0 0 1-1.4-1.1A3.8 3.8 0 0 1 1 12.5a4.6 4.6 0 0 1-.7-1.6A6.3 6.3 0 0 1 0 9a5.7 5.7 0 0 1 .4-2.2 6.6 6.6 0 0 1 .9-1.9 12.1 12.1 0 0 1 1.6-1.6l1.9-1 .4 1a4.6 4.6 0 0 0-1.7.9 5.7 5.7 0 0 0-1.4 1.3 8 8 0 0 0-.8 1.6A5.8 5.8 0 0 0 1 9a7.8 7.8 0 0 0 .2 1.6l.6 1.4a4 4 0 0 0 1 1.2 4 4 0 0 0 1.2 1l1.4.6L7 15l1.6-.2 1.4-.6a4 4 0 0 0 1.2-1 4 4 0 0 0 1-1.2l.6-1.4A7.8 7.8 0 0 0 13 9a5.8 5.8 0 0 0-.3-1.9 8 8 0 0 0-.8-1.6 5.7 5.7 0 0 0-1.4-1.3 4.6 4.6 0 0 0-1.7-.9zM7.5 8h-1V0h1z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/DirectoryFilter.svg",["require","exports"],(function(e,t){"use strict";return{type:392,data:"<svg viewBox='0 0 19.723 20' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M3.578 0a1.766 1.766 0 0 0-.744.166A2.153 2.153 0 0 0 2.217.6a2.13 2.13 0 0 0-.433.621 1.762 1.762 0 0 0-.165.739V4H0v1.418h1.619v6.589H0v1.415h1.619v2.044a1.893 1.893 0 0 0 .154.762 1.969 1.969 0 0 0 .42.623 1.944 1.944 0 0 0 .625.421 1.91 1.91 0 0 0 .75.152h7.459v-1.415H6.485V1.416h9.13v6h1.415V0zm1.5 16.009H3.7a.645.645 0 0 1-.26-.051.686.686 0 0 1-.212-.144.711.711 0 0 1-.145-.214 1.861 1.861 0 0 1-.047-.387v-1.791h.7v-1.415h-.7V5.418h.7V4h-.7V2.084a.493.493 0 0 1 .054-.22.88.88 0 0 1 .39-.391.5.5 0 0 1 .22-.057h1.382z'/><path d='M19.514 8.63H8.826v1.894l.061.061 3.454 4.442V20h3.867v-4.973l3.454-4.442.061-.061V8.63zm-4.637 5.755-.061.061v4.164h-1.085v-4.168l-.061-.061-3.376-4.364h7.961z'/></g></svg>"}})),
define("MsPortalImpl/ViewModels/AvatarMenuCommon",["require","exports","_generated/MsPortalImpl/Svg/Startup/DirectoryFilter.svg","_generated/MsPortalImpl/Svg/Library/Feedback.svg","MsPortalImpl/Resources/ImplScriptResources","_generated/MsPortalImpl/Svg/Library/LaunchCurrent.svg","_generated/MsPortalImpl/Svg/Library/Mail.svg","_generated/MsPortalImpl/Svg/Library/Person.svg","_generated/MsPortalImpl/Svg/Library/Signout.svg","MsPortalImpl/Widgets/Widgets.WidgetBase","Weave"],(function(e,t,s,i,o,n,r,a,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ViewModel=void 0;var p=MsPortalFx.Base.Images;const u=fx.environment;class m extends d.ViewModel{constructor(){super(...arguments),this.avatarImage=(0,c.makeWritableComputation)(),this.contactInfoEnabled=ko.observable(!1),this.hideTenant=(0,c.makeWritableComputation)(),this.icons={contactInfo:r,feedback:i,launchCurrent:n,person:p.CustomImageWithOptions(a,{palette:99}),signout:l,switchDirectory:s},this.links=u.links,this.listOfTenants=(0,c.makeArrayComputation)(),this.showDiagnosticsDelay=2e3,this.text=o.AvatarMenu,this.userIdentity=(0,c.makeWritableComputation)(),this.userInfo=(0,c.makeWritableComputation)(),this.gitHubUserInfo=(0,c.makeWritableComputation)()}}t.ViewModel=m})),
define("MsPortalImpl/Widgets/Widgets.SimpleAvatarMenuFlyout",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Common","Weave"],(function(e,t,s,i,o,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=void 0;const a=s("div",{class:"fxs-avatarmenu-dropdown"},s("ul",{class:"fxs-avatarmenu-list-system fxs-portal-border fxs-dropmenu-line-separator",role:"presentation"},s("li",{class:"fxs-portal-hover",role:"presentation"},s("a",{href:"",class:"fxs-avatarmenu-signout fxs-avatarmenu-dropdown-item",role:"menuitem","data-bind":{attr:{title:"data.text.signOutLabel"}}},s("div",{class:"fxs-dropmenu-list-content fxs-portal-text","data-bind":{text:"data.text.signOutLabel"}}),s("div",{class:"fxs-dropmenu-image fxs-fill-error","data-bind":{image:"data.icons.signout"}})))),s("div",{class:"fxs-avatarmenu-scrollviewer"},s("div",{class:"fxs-avatarmenu-list-system"},s("ul",{role:"presentation"},s("li",{class:"fxs-portal-hover","data-bind":{visible:"changePasswordLink"},role:"presentation"},s("a",{tabindex:"-1",class:"fxs-avatarmenu-changepassword fxs-avatarmenu-dropdown-item",role:"menuitem",target:"_blank",rel:"noopener noreferrer","data-bind":{attr:{href:"changePasswordLink",title:"data.text.changePasswordLabel"}}},s("div",{class:"fxs-dropmenu-list-content fxs-portal-text","data-bind":{text:"data.text.changePasswordLabel"}}),s("div",{class:"fxs-dropmenu-image fxs-portal-svg","data-bind":{image:"data.icons.launchCurrent"}}))),s("li",{class:"fxs-portal-hover","data-bind":{visible:"data.contactInfoEnabled"},role:"presentation"},s("a",{tabindex:"-1",class:"fxs-avatarmenu-contactinfo fxs-avatarmenu-dropdown-item",role:"menuitem",href:""},s("div",{class:"fxs-dropmenu-list-content fxs-portal-text","data-bind":{text:"data.text.contactInfo"}}),s("div",{class:"fxs-dropmenu-image fxs-portal-svg","data-bind":{image:"data.icons.contactInfo"}}))),s("li",{class:"fxs-portal-hover",role:"presentation"},s("a",{tabindex:"-1",class:"fxs-avatarmenu-myaccess fxs-avatarmenu-dropdown-item",role:"menuitem",href:""},s("div",{class:"fxs-dropmenu-list-content fxs-portal-text","data-bind":{text:"data.text.myAccessLabel"}}),s("div",{class:"fxs-dropmenu-image fxs-portal-svg","data-bind":{image:"data.icons.person"}}))),s("li",{class:"fxs-portal-hover","data-bind":{visible:"!!data.links.submitAnIdea"},role:"presentation"},s("a",{tabindex:"-1",class:"fxs-avatarmenu-feedback fxs-avatarmenu-dropdown-item",role:"menuitem",href:"",target:"_blank",rel:"noopener noreferrer","data-bind":{attr:{href:"data.links.submitAnIdea",title:"data.text.feedbackLabel"}}},s("div",{class:"fxs-dropmenu-list-content fxs-portal-text","data-bind":{text:"data.text.feedbackLabel"}}),s("div",{class:"fxs-dropmenu-image fxs-portal-svg","data-bind":{image:"data.icons.feedback"}}))),s("li",{class:"fxs-portal-hover","data-bind":{visible:"data.links.accountPortal"},role:"presentation"},s("a",{tabindex:"-1",class:"fxs-avatarmenu-billing fxs-avatarmenu-dropdown-item",role:"menuitem",href:"",rel:"noopener noreferrer"},s("div",{class:"fxs-dropmenu-list-content fxs-portal-text","data-bind":{text:"data.text.billingLabel"}}),s("div",{class:"fxs-dropmenu-image fxs-portal-svg","data-bind":{visible:"data.links.accountPortal && data.links.accountPortal.startsWith('#')"}}))),s(i.KoIf,{condition:"showSwitchDirectoryOption"},s("li",{class:"fxs-portal-hover",role:"presentation"},s("a",{tabindex:"-1",class:"fxs-avatarmenu-switchdirectory fxs-avatarmenu-dropdown-item",role:"menuitem",href:""},s("div",{class:"fxs-dropmenu-list-content fxs-portal-text","data-bind":{text:"data.text.switchDirectoryLabel"}}),s("div",{class:"fxs-dropmenu-image fxs-portal-svg","data-bind":{image:"data.icons.switchDirectory"}}))))))));class l extends o.Widget{constructor(e,t){super(e,t);const s=this.ltm;e.html(a);const i=ko.observable();(0,r.subscribeAndRun)(s,[t.userIdentity],(e=>{e&&i(e.changePasswordUri)})),this._bindDescendants({changePasswordLink:i,showSwitchDirectoryOption:!MsPortalFx.isFeatureEnabled("hideswitchdiroption")}),this._attachEventHandlers()}dispose(){this._cleanElement("fxs-avatarmenu-dropdown"),super.dispose()}_attachEventHandlers(){const e=this.options,t=e.links,s=this.element,i="click";this.ltm.registerForDispose(s.setEvents([i,".fxs-avatarmenu-signout",t=>{e.signedOut(),t.preventDefault()}],[i,".fxs-avatarmenu-billing",s=>{e.openAccountPortal(),t.accountPortal.startsWith("#")&&s.preventDefault()}],[i,".fxs-avatarmenu-switchdirectory",t=>{t.preventDefault(),e.switchDirectory()}],[i,".fxs-avatarmenu-myaccess",t=>{t.preventDefault(),e.showMyAccessBlade()}],[i,".fxs-avatarmenu-contactinfo",t=>{t.preventDefault(),e.showContactInfoBlade()}]))}setFocus(){n.waitForBindings(this.element[0]).then((()=>{this.element.find(".fxs-avatarmenu-signout").focus()}))}}t.Widget=l})),
define("MsPortalImpl/Widgets/Widgets.AvatarMenu",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/ViewModels/AvatarMenuCommon","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.SimpleAvatarMenuFlyout","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.DropMenu","MsPortalImpl/Services/Services.FavoritesSettings","Weave","FxInternal/Weave/Util","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.AvatarMenu.css","MsPortalImpl/UI/UI.PassthroughUser"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.ViewModel=void 0,(0,p.injectCss)(u);var g=MsPortalFx.Base.Diagnostics,h=g.Telemetry;const f=fx.environment.meControl,x=g.createLog(e),b="TopBar",v=h.start,y=h.endTrace,M=h.completeTrace,I=s("div",{class:"fxs-flyout","data-bind":{stopBindings:"true"}}),C=s("div",{class:"fxs-avatarmenu-header","data-bind":{attr:{title:"tooltip"},css:{"fxs-avatarmenu-open":"isMenuOpen"}}},s("div",{class:"fxs-avatarmenu-tenant-container"},s("div",{class:"fxs-avatarmenu-username","data-bind":{text:"displayName"}}),s("div",{class:"fxs-avatarmenu-tenant","data-bind":{text:"currentTenantDisplayName"}})),s("div",{class:"fxs-avatarmenu-tenant-image-container"},s("img",{class:"fxs-avatarmenu-tenant-image","data-bind":{attr:{src:"avatarUri"}},alt:""})));function P(e){return(e||"").toLowerCase()}const w=/^(?:f(?:irst)?|l(?:ast)?)\s?name$/i;class _ extends i.ViewModel{constructor(){var e,t;super(),this.displayName=this.userIdentity.compose((e=>(e=e||{}).preferredUsername||e.emailAddress||function(e){const t=e.firstName||"",s=e.lastName||"";return!t&&!s||w.test(t)&&w.test(s)?"":o.AvatarMenu.displayNameFormat.format(t,s)}(e)||this.text.defaultDisplayName)),this.tenantDisplayName=(0,d.makeWritableComputation)(""),this.dropMenuOptions=new a.ViewModel(C,I,".fxs-avatarmenu-dropdown-item"),this.dropMenuOptions.buttonId="fxs-avatarmenu-button",this.dropMenuOptions.buttonClass="fxs-menu-account",this.tooltip=(e=this,t=this.dropMenuOptions.buttonTooltip,(0,d.composeComputation)([e.userIdentity,e.hideTenant,e.listOfTenants],((s,i,o)=>{if(!s)return"";const n=e.text.Tooltip,r=n.tenant,a=[];(s.firstName||s.lastName)&&a.push(n.name.format(s.firstName||"",s.lastName||""));const l=s.preferredUsername||s.emailAddress;if(l&&a.push(n.email.format(l)),!i){const e=MsPortalFx.find(o,(e=>s.tenantId===e.id));if(e&&!i){a.push(r.format(e.displayName,e.id));const t=e.domainName||"",i=s.tenantDomain;a.push(i&&P(t)!==P(i)?r.format(t,i):n.domain.format(t))}}const d=a.join("\n");return t(d),d})))}}t.ViewModel=_;class S extends r.Widget{constructor(e,t,s){super(e,t,!0),this._isMeControlOpen=ko.observable(!1),this.meControlState=0;const i=this.ltm,n=(0,c.hasValueAsync)(i,t.userIdentity);let r;!MsPortalFx.isFeatureEnabled("usesimpleavatarmenu")&&f.baseUri&&f.aadAuthority&&(this.meControlState=1);const p=t.dropMenuOptions;this._dropMenuWidget=new a.Widget(e,p,!0,!0),p.isMenuOpen.subscribe(i,(e=>{const t=this.element.findByClassName("fxs-flyout"),o=(e,s)=>{this.element.find("#mectrl_main_body").parent().parent().remove(),y(s,"failed",{message:e.message,stack:e.stack}),x.warning(MsPortalFx.getLogFriendlyMessage(e)),this.meControlState=2,r&&r.dispose(),this._loadSimpleAvatarMenu(t)};if(1===this.meControlState){if(!r&&e){const e=v({source:b,action:"MeControlAvatarMenuOpen"});n.then((o=>MsPortalFx.Base.Promises.cancelOnDispose(i,(()=>MsPortalFx.require("MsPortalImpl/Widgets/Widgets.MeControl"))).then((n=>(r=new n.Widget(t,this.options,s,o,this._isMeControlOpen),i.registerForDispose(r),r.getInitializedPromise().then((()=>{M(e)}))))))).catch((t=>{o(t,e)}))}}else this._loadSimpleAvatarMenu(t)}));const u=t.tenantDisplayName;Promise.all([(0,c.hasValueAsync)(i,t.userInfo),(0,m.checkPassthroughUserWithNoSubs)(s)]).then((([e,i])=>{const n=e.directoryId&&e.directoryId.toLowerCase(),r=e.uniqueDirectoryName||"";i?u(o.AvatarMenu.passthrough):t.hideTenant.value?u(""):r&&r.toLowerCase()!==n?u(r):s.getAsync(l.UserDirectorySettings).then((e=>{const t=e.userDefaultDirectory()||{};(t.id||"").toLowerCase()===n&&u(t.displayName)}))})),(0,d.subscribe)(this.ltm,[t.displayName,u],(()=>{this.trigger("fxavatartextchange")}))}_loadSimpleAvatarMenu(e){if(this.ltm&&!this.ltm.isDisposed()){const t=v({source:b,action:"SimpleAvatarMenuOpen"});this._simpleFlyout||(this._simpleFlyout=new n.Widget(e,this.options),this.ltm.registerForDispose(this._simpleFlyout)),this._dropMenuWidget.setFocus(),M(t)}}dispose(){this._dropMenuWidget.dispose(),this._cleanElementClasses(["fxs-avatarmenu"]),super.dispose()}getDropMenuOpenObservable(){return 1===this.meControlState?this._isMeControlOpen:this._dropMenuWidget.options.isMenuOpen}}t.Widget=S})),
define("_generated/MsPortalImpl/Svg/Startup/Chevron.svg",["require","exports"],(function(e,t){"use strict";return{type:158,data:"<svg viewBox='0 0 12 12' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='m8.2 6-5.5 5.5.6.5 6-6-6-6-.6.5z'/></g></svg>"}})),
define("MsPortalImpl/Widgets/Widgets.Search",["require","exports","_generated/MsPortalImpl/Svg/Startup/Hyperlink.svg","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/MsPortalImpl/Svg/Startup/Search.svg","_generated/MsPortalImpl/Svg/Startup/Close.svg","_generated/MsPortalImpl/Svg/Startup/Chevron.svg","Weave","Weave/Core/Computation","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css"],(function(e,t,s,i,o,n,r,a,l,d,c,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.ViewModel=t.searchBoxClass=t.searchClass=void 0,(0,c.injectCss)(p),t.searchClass="fxs-search",t.searchBoxClass="fxs-search-box";const u=i.Search;class m extends o.ViewModel{initOptions(e){this._initOptions=e}constructor(){super(),this._ltm=new FxImpl.TriggerableLifetimeManager,this._dropdownInitialized=Q.defer(),this.isExpanded=(0,l.makeWritableComputation)(!1),this.showMenu=ko.observable(!1),this.showResults=ko.observable(!1),this.showSearching=ko.observable(!1),this.showExternalColumn=ko.observable(!1),this.showAllSubscriptionsSearch=ko.observable(!1),this.showChangeSubscriptions=ko.observable(!1),this.icons={search:n,close:r,chevron:a,hyperlink:s},this.text=u,this.filter=ko.observable(),this.searchInFilterText=ko.observable(),this.subscriptionSummary=ko.observable(),this.mruItems=ko.observableArray(),this.results=ko.observableArray()}isDropdownInitialized(){return this._dropdownInitialized.promise}dispose(){this._ltm.dispose()}setFocus(){this._widget&&this._widget.setFocus()}setWidget(e){this._widget=e}getWidget(){return this._widget}getRootElement(){return this._widget.element}}t.ViewModel=m;class g extends o.Widget{constructor(e,s,i){super(e,s),s.setWidget(this),window.fx.environment.chrome.hideSearchBox&&e.addClass("fxs-display-none"),this._textField=$(e[0].querySelector(`.${t.searchBoxClass} input`));const o=t=>{e.off("focusin",o),s.showMenu(!0);const i=s._initOptions;(i&&i()||Q()).then((()=>{MsPortalFx.require("MsPortalImpl/Widgets/Widgets.SearchDefered").then((e=>{s._dropdownInitialized.resolve(),e.initialize(this.ltm,s,this._textField)}))}))};this.ltm.registerForDispose(e.setEvents(["focusin",o]))}setFocus(){this.options.isExpanded(!0);const e=document.activeElement;(0,d.invokeAfterChangePropagation)((()=>{e===document.activeElement&&this._textField.focus()}))}}t.Widget=g})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.TopbarActionsMenu.css",["module"],(function(e){"use strict";return{css:".fxs-topbaractions-item{display:flex}.fxs-topbaractions-item .fxs-dropmenu-image{padding-left:10px}.fxs-topbaractions-flyout{max-height:calc(100vh - 40px);overflow-x:hidden;overflow-y:auto}",moduleId:e.id}})),
define("MsPortalImpl/Widgets/Widgets.TopbarActionsMenu",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.DropMenu","_generated/MsPortalImpl/Svg/Startup/Ellipsis.svg","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.TopbarActionsMenu.css"],(function(e,t,s,i,o,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.ViewModel=void 0,(0,r.injectCss)(a);const l=s("div",{class:"fxs-topbaractions-dropmenu"}),d=s("div",{class:"fxs-topbaractions-button fxs-topbar-button","data-bind":{image:"ellipsis",css:{"fxs-topbar-active":"isMenuOpen"}}}),c=s("div",{class:"fxs-topbaractions-flyout"},s("ul",{class:"fxs-topbaractions-list-commands",role:"presentation","data-bind":{foreach:"topbarActions"}},s("li",{class:"fxs-portal-hover",role:"presentation"},s("a",{href:"#",class:"fxs-topbaractions-item",role:"menuitem","data-bind":{attr:{"aria-label":"name",title:"name"},css:"classNames",click:"clickHandler"}},s("div",{class:"fxs-dropmenu-list-content fxs-portal-text","data-bind":{text:"name"}}),s("div",{class:"fxs-dropmenu-image fxs-portal-svg","data-bind":{image:"menuIcon"}})))));class p extends i.ViewModel{constructor(e){super(),this.ariaLabel=ko.observable(),this.dropMenuOptions=new o.ViewModel(d,c,".fxs-topbaractions-item"),this.topbarActions=e||[]}}t.ViewModel=p;class u extends i.Widget{constructor(e,t){super(e,t);const s=this.element;s.html(l),t.dropMenuOptions.setItemFocusWhenOpen=!0,t.dropMenuOptions.buttonTooltip(t.ariaLabel()),t.dropMenuOptions.buttonLabel(t.ariaLabel()),this.ltm.registerForDispose(new o.Widget(e.findByClassName("fxs-topbaractions-dropmenu"),t.dropMenuOptions,!1,!0)),ko.applyBindingsToDescendants({topbarActions:t.topbarActions,ellipsis:n,isMenuOpen:t.dropMenuOptions.isMenuOpen},s[0])}openMenu(e=!0){this.element.hasClass("fxs-display-none")||(e||(this.options.dropMenuOptions.autoDismissMenu=!1),this.options.dropMenuOptions.open(),e||(this.options.dropMenuOptions.autoDismissMenu=!0))}closeMenu(){this.options.dropMenuOptions.close()}}t.Widget=u})),
define("_generated/MsPortalImpl/Svg/Library/Gear.svg",["require","exports"],(function(e,t){"use strict";return{type:103,data:"<svg viewBox='0 0 15.9 15.9' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M13.9 7.7V8l2 1.3-1.2 3-2.4-.3-.3.3.5 2.4-3 1.2-1.3-2h-.5l-1.3 2-3-1.2.6-2.4-.4-.3-2.4.5-1.2-3 2-1.3v-.4L0 6.4l1.2-3 2.4.6a.8.8 0 0 1 .4-.4l-.6-2.4 3-1.2 1.3 2h.5l1.3-2 3 1.2-.5 2.4.3.4 2.4-.6 1.2 3zm-.9 1V7.2l1.8-1.1-.7-1.7-2.1.5a1.2 1.2 0 0 0-.5-.5 1.2 1.2 0 0 0-.5-.5l.5-2.1-1.7-.7-1.1 1.8H7.2L6.1 1.1l-1.7.7.5 2.1a1.2 1.2 0 0 0-.5.5 1.2 1.2 0 0 0-.5.5l-2.1-.5-.7 1.7 1.8 1.1v1.5L1.1 9.8l.7 1.7 2.1-.5.5.5.5.5-.5 2.1 1.7.7L7.2 13h1.5l1.1 1.8 1.7-.7L11 12l.5-.5.5-.5 2.1.5.7-1.7zM8 5l1.1.2a2.2 2.2 0 0 1 .9.7 3.1 3.1 0 0 1 .7.9 4.3 4.3 0 0 1 .2 1.2 4.3 4.3 0 0 1-.2 1.1 2.2 2.2 0 0 1-.7.9 2.2 2.2 0 0 1-.9.7l-1.1.2-1.2-.2a3.1 3.1 0 0 1-.9-.7 2.2 2.2 0 0 1-.7-.9A4.3 4.3 0 0 1 5 8a4.3 4.3 0 0 1 .2-1.2 3.1 3.1 0 0 1 .7-.9 3.1 3.1 0 0 1 .9-.7zm0 5h.8l.6-.5.5-.6A2.5 2.5 0 0 0 10 8a2.8 2.8 0 0 0-.1-.9l-.5-.6-.6-.4a1.3 1.3 0 0 0-.8-.2 1.5 1.5 0 0 0-.9.2l-.6.4-.4.6a1.5 1.5 0 0 0-.2.9 1.3 1.3 0 0 0 .2.8l.4.6.6.5z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/Console.svg",["require","exports"],(function(e,t){"use strict";return{type:333,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M15 2v12H1V2h14m1-1H0v14h16V1z'/><path d='M12.5 12h-4c-.3 0-.5-.2-.5-.5s.2-.5.5-.5h4c.3 0 .5.2.5.5s-.2.5-.5.5zM7.8 8.1s0-.1 0 0v-.5L3.7 4.3c-.2-.2-.5-.2-.7 0-.2.3-.1.6.1.7l3.5 3-3.5 3c-.2.2-.2.5-.1.7.1.1.2.2.4.2.1 0 .2 0 .3-.1l3.9-3.3v-.1c.2-.2.2-.2.2-.3 0 .1 0 0 0 0z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/DirectoryFilteredSet.svg",["require","exports"],(function(e,t){"use strict";return{type:393,data:"<svg viewBox='0 0 19.723 20' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M19.514 8.63H8.826v1.894l.061.061 3.454 4.442V20h3.867v-4.973l3.454-4.442.061-.061V8.63zm-4.637 5.755-.061.061v4.164h-1.085v-4.168l-.061-.061-3.376-4.364h7.961z'/><path d='m13.67 14.381.061.061v4.168h1.086v-4.164l.06-.061 3.378-4.369h-7.962l3.377 4.365z' class='msportalfx-svg-c33'/><path d='M3.578 0a1.766 1.766 0 0 0-.744.166A2.153 2.153 0 0 0 2.217.6a2.13 2.13 0 0 0-.433.621 1.762 1.762 0 0 0-.165.739V4H0v1.418h1.619v6.589H0v1.415h1.619v2.044a1.893 1.893 0 0 0 .154.762 1.969 1.969 0 0 0 .42.623 1.944 1.944 0 0 0 .625.421 1.91 1.91 0 0 0 .75.152h7.459v-1.415H6.485V1.416h9.13v6h1.415V0zm1.5 16.009H3.7a.645.645 0 0 1-.26-.051.686.686 0 0 1-.212-.144.711.711 0 0 1-.145-.214 1.861 1.861 0 0 1-.047-.387v-1.791h.7v-1.415h-.7V5.418h.7V4h-.7V2.084a.493.493 0 0 1 .054-.22.88.88 0 0 1 .39-.391.5.5 0 0 1 .22-.057h1.382z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/Feedback.svg",["require","exports"],(function(e,t){"use strict";return{type:1,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M7.484 10.375a5.6 5.6 0 0 1 1.438.828 5.376 5.376 0 0 1 1.109 1.2 5.682 5.682 0 0 1 .711 1.461A5.5 5.5 0 0 1 11 15.5v.5h-1v-.5a4.385 4.385 0 0 0-.352-1.75 4.459 4.459 0 0 0-.968-1.43 4.654 4.654 0 0 0-1.43-.961A4.458 4.458 0 0 0 5.5 11a4.385 4.385 0 0 0-1.75.352 4.459 4.459 0 0 0-1.43.968 4.654 4.654 0 0 0-.961 1.43A4.458 4.458 0 0 0 1 15.5v.5H0v-.5a5.391 5.391 0 0 1 .969-3.1 5.7 5.7 0 0 1 1.109-1.187 5.614 5.614 0 0 1 1.438-.836 3.359 3.359 0 0 1-.633-.563 3.551 3.551 0 0 1-.477-.687 3.387 3.387 0 0 1-.3-.781A3.858 3.858 0 0 1 2 7.5a3.391 3.391 0 0 1 .273-1.359 3.525 3.525 0 0 1 1.86-1.86A3.5 3.5 0 0 1 5.5 4a3.391 3.391 0 0 1 1.359.273 3.525 3.525 0 0 1 1.86 1.86A3.5 3.5 0 0 1 9 7.5a3.424 3.424 0 0 1-.1.836 3.311 3.311 0 0 1-.3.781 4.035 4.035 0 0 1-.477.695 3.076 3.076 0 0 1-.639.563ZM5.5 10a2.424 2.424 0 0 0 .969-.2 2.523 2.523 0 0 0 .789-.532 2.6 2.6 0 0 0 .539-.8 2.478 2.478 0 0 0 .008-1.946 2.46 2.46 0 0 0-.539-.789 2.746 2.746 0 0 0-.8-.539A2.348 2.348 0 0 0 5.5 5a2.424 2.424 0 0 0-.969.2A2.537 2.537 0 0 0 3.2 6.531a2.505 2.505 0 0 0 0 1.938 2.631 2.631 0 0 0 .532.8 2.436 2.436 0 0 0 .8.539A2.484 2.484 0 0 0 5.5 10ZM16 0v8h-2l-3 3V8h-1V7h2v1.586L13.586 7H15V1H5v1.8a8.641 8.641 0 0 0-.5.078 2.926 2.926 0 0 0-.5.141V0Z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/Help.svg",["require","exports"],(function(e,t){"use strict";return{type:130,data:"<svg viewBox='2 2 12 12' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M8 2a6 6 0 1 1 0 12A6 6 0 0 1 8 2Zm0 1a5 5 0 1 0 0 10A5 5 0 0 0 8 3Zm0 7.5A.75.75 0 1 1 8 12a.75.75 0 0 1 0-1.5Zm0-6a2 2 0 0 1 2 2c0 .73-.212 1.14-.754 1.708l-.264.27C8.605 8.87 8.5 9.082 8.5 9.5a.5.5 0 0 1-1 0c0-.73.212-1.14.754-1.708l.264-.27C8.895 7.13 9 6.918 9 6.5a1 1 0 0 0-2 0 .5.5 0 0 1-1 0 2 2 0 0 1 2-2Z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/HelpMin.svg",["require","exports"],(function(e,t){"use strict";return{type:1,data:"<svg viewBox='0 0 24 24' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><circle cx='17.75' cy='6.611' r='6'/><circle cx='10' cy='18.86' r='.75'/><path d='M10 10.11a2.5 2.5 0 0 1 1.651 4.378l-.154.125-.219.163-.087.072a1.968 1.968 0 0 0-.156.148 2.216 2.216 0 0 0-.535 1.614.5.5 0 0 1-1 0 3.2 3.2 0 0 1 .805-2.298 3.107 3.107 0 0 1 .356-.323l.247-.184.118-.1A1.5 1.5 0 1 0 8.5 12.61a.5.5 0 1 1-1 0 2.5 2.5 0 0 1 2.5-2.5Z'/><path d='M17.75 13.61a7.04 7.04 0 0 1-.838-.054 7.037 7.037 0 1 1-6.074-5.89 7.023 7.023 0 0 1-.086-1.017A8.087 8.087 0 0 0 10 6.61a8.056 8.056 0 1 0 7.93 6.99c-.06.002-.12.01-.18.01Z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/Notifications.svg",["require","exports"],(function(e,t){"use strict";return{type:342,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M14 12v1h-4a2.4 2.4 0 0 1-.2.8l-.4.6-.6.4-.8.2-.8-.2-.6-.4-.4-.6A2.4 2.4 0 0 1 6 13H2v-1h1V6a5.9 5.9 0 0 1 .2-1.3 6.1 6.1 0 0 1 .5-1.2 3.9 3.9 0 0 1 .8-1 3.9 3.9 0 0 1 1-.8l1.2-.5L8 1l1.3.2 1.2.5a3.9 3.9 0 0 1 1 .8 3.9 3.9 0 0 1 .8 1 6.1 6.1 0 0 1 .5 1.2A5.9 5.9 0 0 1 13 6v6zm-2 0V6a4.5 4.5 0 0 0-.3-1.6 2.7 2.7 0 0 0-.9-1.2 2.7 2.7 0 0 0-1.2-.9 4.4 4.4 0 0 0-3.2 0 2.7 2.7 0 0 0-1.2.9 2.7 2.7 0 0 0-.9 1.2A4.5 4.5 0 0 0 4 6v6zm-4 2h.4l.3-.2.2-.3A.7.7 0 0 0 9 13H7a.6.6 0 0 0 .1.4l.2.3.3.2z'/></g></svg>"}})),
define("MsPortalImpl/Widgets/Widgets.TopBar",["require","exports","Fx/DependencyInjection","Fx/Experimentation","FxInternal/AsyncLoader","Weave","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.AvatarMenu","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Search","MsPortalImpl/Widgets/Widgets.AsyncSearch","MsPortalImpl/Widgets/Widgets.TopbarActionsMenu","_generated/MsPortalImpl/Svg/Library/Gear.svg","_generated/MsPortalImpl/Svg/Startup/Console.svg","_generated/MsPortalImpl/Svg/Startup/DirectoryFilter.svg","_generated/MsPortalImpl/Svg/Startup/DirectoryFilteredSet.svg","_generated/MsPortalImpl/Svg/Startup/Feedback.svg","_generated/MsPortalImpl/Svg/Startup/Help.svg","_generated/MsPortalImpl/Svg/Startup/HelpMin.svg","_generated/MsPortalImpl/Svg/Startup/Notifications.svg","MsPortalImpl/Base/Base.Timers","MsPortalImpl/Base/Base.Events","MsPortalImpl/UI/Commands/Base.PortalFunctions","MsPortalImpl/Services/Services.Subscriptions","FxInternal/Weave","MsPortalImpl/Widgets/Widgets.Portal.State","MsPortalImpl/Widgets/Widgets.ToastViewModel","Viva.Controls/Util/Viva.Resize","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.TopBar.css"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g,h,f,x,b,v,y,M,I,C,P,w,_,S,F,k){"use strict";var T,D;Object.defineProperty(t,"__esModule",{value:!0}),t.HelpAction=t.Widget=t.ViewModel=void 0,(0,F.injectCss)(k);const E=window.fx.environment,B="fxs-topbar-avatarmenu",A="fxs-avatarmenu-imageonly",N="fxs-display-none",O=MsPortalFx.isFeatureEnabled,R=r.TopBar,L=O("azureconsole"),z=O("feedback"),H=O("asyncSearch")||(null===(D=null===(T=E.globalSearch)||void 0===T?void 0:T.pills)||void 0===D?void 0:D.length);let U=class extends l.ViewModel{constructor(e,t,s){super(),this.toastViewModel=e,this.reportBug=$.noop,this.exitDevMode=$.noop,this.directoryFilterIcon=ko.observable(g),this.newDashboardSaveEnabled=(0,n.makeWritableComputation)(!1),this.dashboardChanged=(0,n.makeWritableComputation)(!1),this.dashboardWritable=(0,n.makeWritableComputation)(!1),this.dashboardVisible=(0,n.makeWritableComputation)(!1),this.exitOrganizeMode=$.noop,this.finishDashboardEdit=$.noop,this.settingsButtonClick=$.noop,this.loadingIdList=(0,n.makeArrayComputation)(),this.searchViewModel=H?new c.ViewModel:new d.ViewModel,this.avatarMenuVM=new a.ViewModel,this.consoleButtonClick=MsPortalFx.noop,this.canUpgradeSubscription=(0,n.makeWritableComputation)(!1),this.upgradeableSubscription=(0,n.makeWritableComputation)(),this.displayMode=s.displayMode,this.isInOrganizeMode=s.inOrganizeMode,this.settingsFlyoutState=s.settingsFlyoutState,this.actionDefinitions=function(e,t){const s=[];L&&s.push({name:R.console,icon:m,classNames:"fxs-topbar-console",ariaExpanded:!1,ariaControls:"consoleRegionId",clickHandler:()=>{t.settingsFlyoutState(0),t.consoleButtonClick()}});O("hidedirectorypanebutton")||E.chrome.hideDirectoryPaneButton||s.push({name:r.UiSettings.Flyout.directoriesTitle,icon:t.directoryFilterIcon,classNames:"fxs-topbar-directory fxs-menu-directory",clickHandler:()=>{t.settingsFlyoutState(0),t.directoryButtonClick&&t.directoryButtonClick()}});E.chrome.hideNotificationButton||s.push({name:R.notifications,icon:v,classNames:"fxs-topbar-notifications",clickHandler:()=>{t.settingsFlyoutState(0),t.notificationButtonClick&&t.notificationButtonClick()},showNotification:ko.observable(!1)});s.push({name:R.settings,icon:u,classNames:["fxs-topbar-settings fxs-menu-settings",{"fxs-topbar-active":t.settingsFlyoutState}],clickHandler:()=>{t.settingsButtonClick&&t.settingsButtonClick()}}),E.chrome.hideHelpButton||s.push(e.get(V));z&&s.push({name:R.feedback,icon:f,classNames:"fxs-topbar-feedback fxs-menu-feedback",clickHandler:()=>{t.settingsFlyoutState(0),t.feedbackButtonClick&&t.feedbackButtonClick()}});return s.forEach((e=>{e.menuIcon=e.menuIcon||e.icon})),s}(t,this)}dispose(){this.searchViewModel.dispose()}setWidget(e){this._widget=e}getWidget(){return this._widget}getRootElement(){return this._widget&&this._widget.element}};U=__decorate([__metadata("fx:diagnostics",[e,"ViewModel"]),s.Class(),__metadata("design:paramtypes",[_.ViewModel,s.Container,w.PortalState])],U),t.ViewModel=U;class W extends l.Widget{constructor(e,t,s,o){super(e,t,!0),this._reactiveLayoutInitialized=!1;const l=this.ltm;if(t.setWidget(this),this.toggleConsole=MsPortalFx.noop,L&&(t.consoleButtonClick=this.toggleConsole=()=>{s.get(I.ToggleCloudShell).invoke(void 0)}),!O("hidedirectorypanebutton")&&!E.chrome.hideDirectoryPaneButton){const e=s.get(C.SubscriptionsUserContext);Q.spread([e.getAllSubscriptionsCount(),e.getGlobalSelectedSubscriptions(),e.useGlobalResourceFiltersPromise],((e,s,i)=>{if(i)return t.directoryFilterIcon(g);s.subscribeAndRun(l,(s=>{t.directoryFilterIcon(s.length===e.value?g:h)}))}))}s.get(i.Experimentation).getAssignments().then((e=>{t.newDashboardSaveEnabled(e.getBooleanValue("DashboardSaveExperience"))})),this._topbarActionsViewModel=new p.ViewModel(t.actionDefinitions),this._topbarActionsViewModel.ariaLabel(r.TopBar.actionsMenuButtonLabel);const u=new a.Widget(this._findByClassName(B),t.avatarMenuVM,s);let m;m=H?new c.Widget(this._findByClassName("fxs-topbar-search"),t.searchViewModel,s):new d.Widget(this._findByClassName("fxs-topbar-search"),t.searchViewModel,s),l.registerForDispose([u,m]),this.topBarHasExpandedItem=(0,n.composeComputation)([(0,P.toComputation)(t.searchViewModel.showMenu),(0,P.toComputation)(this._topbarActionsViewModel.dropMenuOptions.isMenuOpen),(0,P.toComputation)(u.getDropMenuOpenObservable()),this.options.settingsFlyoutState],((e,t,s,i)=>e||t||s||!!i))}_findByClassName(e){return $(this.element[0].querySelector("."+e))}initReactiveLayout(){if(this._reactiveLayoutInitialized)return;this._reactiveLayoutInitialized=!0;let e,t,s,i,o,n,r,a,l,d,c,u=!0;const m=this._findByClassName("fxs-topbar-search"),g=this._findByClassName("fxs-topbar-buttons-container"),h=this._findByClassName(B),f=this._findByClassName("fxs-internal-full"),x=this._findByClassName("fxs-topbar-exitdevmode"),b=this._findByClassName("fxs-topbar-reportbug"),v=this._findByClassName("fxs-topbar-reportbug-text"),I=this._findByClassName("fxs-internal-short"),C=this._findByClassName("fxs-topbar-sidebar-collapse-button"),P=y.throttleByAnimationFrame((()=>{var y;const M=this._findByClassName("fxs-topbar-upgradebutton"),P=this._findByClassName("fxs-topbar-upgradebutton-text");let w;u&&(u=!1,s=j(this.element,"fxs-avatarmenu-tenant-image-container"),t=j(g),i=j(this.element,"fxs-topbar-brand"),o=j(f),n=j(I),r=j(x),a=j(b),l=j(this.element,"fxs-topbar-reportbug-icon"),d=j(M),c=j(this.element,"fxs-topbar-upgradebutton-icon")),e?w=e:h.hasClass(A)?w=180+s:(w=h.width(),this._findByClassName("fxs-avatarmenu-tenant").text()&&this._findByClassName("fxs-avatarmenu-username").text()&&(e=w));const _=function(e){const{topbarWidth:t,commandIconsWidth:s,searchBarWidth:{min:i,max:o,collapsed:n,margin:r},avatarMenuWidth:{normal:a,imageOnly:l},others:{debugModeWidth:d,reportBugExpendedWidth:c,reportBugIconWidth:p,previewWidth:u,previewShortWidth:m,sidebarHamburgerWidth:g,upgradeIconWidth:h,upgradeExpandedWidth:f}}=e,x=800;let b=0;const v=c>0?c+7:0,y=p>0?33:0,M=f>0?f+7:0,I=h>0?33:0,C=g+e.logoWidth+e.others.previewWidth+d+v+M+7,P=r+s+a,w=r+40+l,_=C+x+P,S=_-v-M+y+I-x+i,F=S-P+w,k=F-i-r+40,T=k-u+m,D=T-y,E=D-I,B=t>=S?x:o;if(t>=F){let e=C,s=P;t<_&&(e=e-v+y-f+M),t<S&&(s=w);const i=(t-B)/2,o=i+B;b=i<e?Math.max(0,t-e-s-B,t-_):Math.max(0,t-o-s)}return{searchBar:{expanded:t>=F,width:t>=F?Math.min(B,Math.max(i,t-F+i)):n,rightToCommands:b+r},commandIconsVisible:t>=S,avatarMenuExpanded:t>=S,others:{reportABugVisible:t>=T,debugModeVisible:t>=D,previewExpanded:t>=k,reportBugExpanded:t>=_,upgradeVisible:t>=E,upgradeExpanded:t>=_}}}({topbarWidth:this.element.width(),logoWidth:i,searchBarWidth:{min:280,max:400,collapsed:40,margin:15},commandIconsWidth:t,avatarMenuWidth:{normal:w,imageOnly:s},others:{previewWidth:o,previewShortWidth:n,debugModeWidth:r,reportBugExpendedWidth:a,reportBugIconWidth:l,upgradeExpandedWidth:d,upgradeIconWidth:c,sidebarHamburgerWidth:j(C)}});this.element.toggleClass("fxs-topbar-state-searchcollapsed",!_.searchBar.expanded),m.css("margin-right",_.searchBar.expanded?_.searchBar.rightToCommands:""),m.css("max-width",_.commandIconsVisible?800:400),h.toggleClass(A,!_.avatarMenuExpanded),g.toggleClass(N,!_.commandIconsVisible),b.toggleClass(N,!_.others.reportABugVisible),x.toggleClass(N,!_.others.debugModeVisible),f.toggleClass(N,!_.others.previewExpanded),I.toggleClass(N,_.others.previewExpanded),v.toggleClass(N,!_.others.reportBugExpanded),M.toggleClass(N,!_.others.upgradeVisible),P.toggleClass(N,!_.others.upgradeExpanded),_.commandIconsVisible||this.options.dropMenuWidget||(this.options.dropMenuWidget=new p.Widget(this._findByClassName("fxs-topbar-actionsmenu"),this._topbarActionsViewModel),this.ltm.registerForDispose(this.options.dropMenuWidget));this._findByClassName("fxs-topbaractions-dropmenu").toggleClass(N,_.commandIconsVisible),null===(y=this.options.dropMenuWidget)||void 0===y||y.closeMenu()}));S.track(this.ltm,this.element,P),this.ltm.registerForDispose([this.element.setEvents(["fxavatartextchange",P]),$(document).setEvents([M.fullscreen,P])])}dispose(){this._cleanElement(),super.dispose()}}t.Widget=W;let V=class extends FxImpl.TriggerableLifetimeManager{constructor(e,t){super(),this.name=R.help,this.icon=x,this.menuIcon=ko.observable(x),this.classNames="fxs-topbar-helpmenu",this.showNotification=ko.observable(!1),this.active=ko.observable(!1),this.clickHandler=()=>{t.settingsFlyoutState(0),e.getAsync(o.get("MsPortalImpl/UI/UI.HelpPane","HelpPane")).then((e=>e.toggle()))},this.showNotification.subscribe(this,(e=>{this.menuIcon(e?b:x)}))}};function j(e,t){const s=(t?e.findByClassName(t):e)[0];return s?s.offsetWidth:0}V=__decorate([__metadata("fx:diagnostics",[e,"HelpAction"]),s.Class(),__metadata("design:paramtypes",[s.Container,w.PortalState])],V),t.HelpAction=V})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Portal.css",["module"],(function(e){"use strict";return{css:'.fxs-portal{position:fixed;left:0;right:0;top:0;bottom:0;overflow:hidden;z-index:0;display:flex;flex-direction:column;font-size:13px;line-height:normal}.fxs-portal-main{display:flex;flex-flow:row nowrap;align-items:stretch;position:relative;flex:1 1 auto;min-height:0;height:100%}.fxs-portal-content{flex:1 1 auto;position:relative;overflow:hidden;z-index:1}.fxs-portal-controlloadfailed>svg{vertical-align:bottom;height:18px}.fxs-portal-tip-content{max-width:400px}.fxs-portal-tip.azc-balloon .azc-balloon-content{padding:0}.fxs-portal-shield{position:fixed;width:100%;height:100%;background-color:rgba(0,0,0,.7);z-index:7;display:table}.fxs-portal-shield-middle{display:table-cell;vertical-align:middle}.fxs-portal-shield-icon{position:absolute;height:40px;width:40px;top:-20px;display:flex;justify-content:center;align-items:center}.fxs-portal-shield-icon>svg{width:20px;height:20px}.fxs-portal-shield-icon-warning{background-color:#ffdfb8}.fxs-portal-shield-icon-error{background-color:#fdd8db}.fxs-portal-shield-modaldialog{width:430px;max-width:100vw;margin:auto;padding:20px;position:relative}.fxs-panorama{position:relative}.fxs-panorama .fxs-startboard-target,.fxs-panorama .fxs-home-target,.fxs-panorama .fxs-journey-target,.fxs-panorama .fxs-sidebar-flyout{display:none;position:absolute;top:0;left:0;height:100%;width:100%;z-index:0}.fxs-panorama .fxs-settings-flyout{position:absolute;top:0;left:0;height:100%;width:100%;z-index:202}.fxs-panorama>div[data-popup="true"].azc-control{z-index:150}.fxs-home-target{overflow-y:auto}.fxs-show-startboard .fxs-startboard-target,.fxs-panorama .fxs-journey-target{display:flex}.fxs-journey-target{pointer-events:none}.fxs-show-journey .fxs-journey-target,.fxs-journey-target .fxs-part-frame{pointer-events:all}.fxs-show-home .fxs-home-target,.fxs-show-allservices .fxs-sidebar-flyout,.fxs-show-settings .fxs-settings-flyout{display:block}.fxs-input{padding:0;margin:0;box-sizing:border-box;border-width:1px;border-style:solid;outline:none;height:24px;text-indent:10px}.fxs-button.fxt-button:focus,.azc-button.fxt-button:focus{outline:none}.fxt-button{min-width:80px;border-radius:2px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.fxs-button{position:relative;box-sizing:border-box;height:24px;font-size:13px;line-height:20px;font-weight:600;cursor:pointer;border-width:1px;border-style:solid;padding:0 20px;margin:0}.fxs-button.fxs-button-disabled{cursor:default}.fxs-inner-solid-border{position:relative}.fxs-inner-solid-border:focus::after{content:"";position:absolute;top:1px;left:1px;right:1px;bottom:1px;display:block;border-width:1px;border-style:solid;pointer-events:none}.fxs-inner-solid-border:focus::after.fxs-button-default{border-color:#605e5c}.fxs-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-full-height{height:100%}.fxs-full-width{width:100%}@keyframes fxs-progress-animatedEllipses{0%{transform:scale(1);opacity:.3}36.1%{transform:scale(1.06);opacity:1}50%{transform:scale(1.06);opacity:1}86.1%{transform:scale(1);opacity:.3}}@keyframes fxs-progress-animatedEllipsesShadow{0%{transform:scale(1);opacity:0}36.1%{transform:scale(1.06);opacity:.4}50%{transform:scale(1.06);opacity:.4}86.1%{transform:scale(1);opacity:0}}fxs-progress,.fxs-progress{position:absolute;width:100%;height:100%;top:0;z-index:194}.fxs-progress-nozindex{z-index:initial}.fxs-progress-dots{position:absolute;top:calc(50% - 10px/2);width:100%;line-height:0;justify-content:center;display:grid}.fxs-progress-dots-dot,.fxs-progress-dots-dot-shadow{height:10px;width:10px;margin:0 5px;border-radius:5px;grid-row-start:1}.fxs-progress-dots-dot:nth-child(1),.fxs-progress-dots-dot-shadow:nth-child(1),.fxs-progress-dots-dot:nth-child(4),.fxs-progress-dots-dot-shadow:nth-child(4){grid-column-start:1;animation-delay:0s}.fxs-progress-dots-dot:nth-child(2),.fxs-progress-dots-dot-shadow:nth-child(2),.fxs-progress-dots-dot:nth-child(5),.fxs-progress-dots-dot-shadow:nth-child(5){grid-column-start:2;animation-delay:.125s}.fxs-progress-dots-dot:nth-child(3),.fxs-progress-dots-dot-shadow:nth-child(3),.fxs-progress-dots-dot:nth-child(6),.fxs-progress-dots-dot-shadow:nth-child(6){grid-column-start:3;animation-delay:.25s}.fxs-progress-dots-dot{animation:fxs-progress-animatedEllipses 1.8s infinite;background-color:#3471ff;opacity:.3}.fxs-progress-dots-dot-shadow{animation:fxs-progress-animatedEllipsesShadow 1.8s infinite;background-color:transparent;opacity:0;box-shadow:0 3px 3px 0 #0078d4}.fxs-progress-small .fxs-progress-dots,.fxs-bladecontent-unlocked .fxs-tile .fxs-progress-dots,.fxs-startboard-layout .fxs-tile .fxs-progress-dots{top:calc(50% - 6px/2)}.fxs-progress-small .fxs-progress-dots-dot,.fxs-bladecontent-unlocked .fxs-tile .fxs-progress-dots-dot,.fxs-startboard-layout .fxs-tile .fxs-progress-dots-dot,.fxs-progress-small .fxs-progress-dots-dot-shadow,.fxs-bladecontent-unlocked .fxs-tile .fxs-progress-dots-dot-shadow,.fxs-startboard-layout .fxs-tile .fxs-progress-dots-dot-shadow{height:6px;width:6px;margin:0 3px;border-radius:3px}.fxs-progress-small .fxs-progress-dots-dot-shadow,.fxs-bladecontent-unlocked .fxs-tile .fxs-progress-dots-dot-shadow,.fxs-startboard-layout .fxs-tile .fxs-progress-dots-dot-shadow{box-shadow:0 2px 2px 0 #0078d4}.azc-fabric .azc-formControl{border-radius:2px !important}.azc-fabric .azc-textBox-wrapper .azc-input,.azc-fabric .azc-password-wrapper .azc-input,.azc-fabric .azc-numericTextBox-wrapper .azc-input{border-radius:2px}',moduleId:e.id}})),
define("MsPortalImpl/Widgets/Widgets.Portal",["require","exports","Fx/DependencyInjection","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/Interactions/Interactions.ContextMenuTouch","MsPortalImpl/Interactions/Interactions.FullScreenMode","MsPortalImpl/Interactions/Interactions.OverflowAutoTooltip","MsPortalImpl/Interactions/Interactions.KeyboardOnlyOutlines","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.ContextPane","MsPortalImpl/Widgets/Widgets.StartBoard","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Widgets/Widgets.Portal.State","MsPortalImpl/Widgets/Widgets.SideBar","MsPortalImpl/Widgets/Widgets.TopBar","MsPortalImpl/Base/Base.Events","MsPortalImpl/Widgets/ReactFrame.Prewarmer","MsPortalImpl/Widgets/Widgets.Portal.html","MsPortalImpl/Widgets/Widgets.ContextMenu","MsPortalImpl/Weave/DirectRender","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.Portal.css","Weave","Fx/Experimentation"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g,h,f,x,b,v,y,M,I,C,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.ViewModel=void 0,(0,M.injectCss)(I);const w=window,_=w.fx.environment,S=w.fx.getTimestamp,F=MsPortalFx.Base.Diagnostics,k=F.Telemetry,T=F.createLog(e),D="HomeScriptLoadStart",E="HomeScriptLoadEnd",B="AzureHomeLoad",A={start:"AzureHomeLoadStart",end:"AzureHomeLoadEnd"};let N=class extends u.ViewModel{constructor(e,t,s,i,o){super("fxsportalroot"),this.sideBar=e,this.topBar=t,this.customEvents=s,this._diContainer=i,this._widgetCreatePromise=Q.defer(),this.rightContextPane=new c.ViewModel(this._diContainer),this.shellContextPane=new c.ViewModel(this._diContainer),this.contextMenuViewModel=new v.ViewModel,this.startboardLoading=(0,C.makeWritableComputation)(!1),this.startboardNotFound=(0,C.makeWritableComputation)(!1),this.allServicesMenuInput={filter:(0,C.makeWritableComputation)(),category:""},this.displayMode=o.displayMode,this.inOrganizeMode=o.inOrganizeMode,this.settingsFlyoutState=o.settingsFlyoutState}getDisplayMode(){return this.displayMode.value}setRootPageDisplayType(e){this._rootPageDisplayType=e}getRootPageDisplayType(){let e=this._rootPageDisplayType;return"Home"!==e&&"Dashboard"!==e&&"AllServices"!==e&&(e=(0,l.isLandingPageDashboard)(this._diContainer)?"Dashboard":"Home"),e}showStartboard(){if("Dashboard"===this.displayMode.value)return;this.displayMode("Dashboard");const e=this.getStartBoardWidget();e&&e.setFocus()}getStartBoardArea(){return $(this._widget.element[0].querySelector(".fxs-startboard-target"))}getJourneyArea(){return $(this._widget.element[0].querySelector(".fxs-journey-target"))}getStartBoardWidget(){return d.Widget.getWidget(this.getStartBoardArea(),p.Widget)}getJourneyWidget(){const e=d.Widget.getWidgets(this.getJourneyArea());if(e.length>1)throw new Error("The journey target has been initialized with more than one widget.");return e[0]}async getAzureHomeWidget(e){return this.getWidget().getAzureHomeWidget(e)}setWidget(e){this._widget=e,this.customEvents.setElement(e.element),this._widgetCreatePromise.resolve(!0)}getWidget(){return this._widget}getRootElement(){return this._widget&&this._widget.element}onWidgetCreate(){return this._widgetCreatePromise.promise}};N=__decorate([__metadata("fx:diagnostics",[e,"ViewModel"]),s.Class(),__metadata("design:paramtypes",[g.ViewModel,h.ViewModel,f.PortalCustomEvents,s.Container,m.PortalState])],N),t.ViewModel=N;class O extends u.Widget{static create(e,t,s){return new O(e.portal,t,s)}constructor(e,t,s){super(e,t,!0),this._diContainer=s,t.setWidget(this),t.setRootPageDisplayType(t.displayMode.value);const i=t.displayMode;e.addClass("fxs-portal fxs-desktop-normal"),t.inOrganizeMode.subscribe(this.ltm,(t=>{e.toggleClass("fxs-desktop-organize",t),e.toggleClass("fxs-desktop-normal",!t)})),(0,b.renderPortal)(e[0],t,s,this.ltm);const d=s.get(l.GeneralSettings),p=this.ltm,u=t.sideBar;d.sideBarLayout.subscribeAndRun(p,(()=>{const t=!(0,l.isSideBarDocked)(s);e.toggleClass("fxs-sidebar-hamburger-mode",t).toggleClass("fxs-sidebar-docked-mode",!t)}));const m=this._findByClassName("fxs-sidebar");m.toggleClass("fxs-display-none",!!_.chrome.hideSidebarNav),new g.Widget(this.ltm,m,u,s);const f=t.topBar,v=this._findByClassName("fxs-topbar"),y=new h.Widget(v,f,s,this._findByClassName("fxs-portal-console"));s.get(x.FramePool).setFrameRoot(this.element[0].querySelector(".fxs-journey-layout"));const M=new c.Widget(this._findByClassName("fxs-portal-contextpane-right"),t.rightContextPane),I=new c.Widget(this._findByClassName("fxs-portal-contextpane-shell"),t.shellContextPane);o.register(e),r.register(e),a.register(),(0,C.subscribe)(p,[i],(e=>{"Journey"!==e&&(t.setRootPageDisplayType(e),s.get(n.FullScreenMode).exit()),this.element.toggleClass("fxs-show-journey","Journey"===e),this.element.toggleClass("fxs-show-startboard","Dashboard"===e),this.element.toggleClass("fxs-show-home","Home"===e),this.element.toggleClass("fxs-show-allservices","AllServices"===e),f.dashboardVisible("Dashboard"===e)})),this.ltm.registerForDispose([y,M,I,()=>{o.unregister(e),r.unregister(e),a.unregister()},this.element.setEvents(["fxloadingontopbar",(e,t)=>{t.cancel?f.loadingIdList.removeIf((e=>e===t.id)):f.loadingIdList.push(t.id);const s=this.options.getJourneyWidget();s&&s.loadingHint(t.id,!t.cancel)}],["fxtoggleconsole",()=>{y.toggleConsole()}],["fxtogglesidebar",(e,t)=>{var s;const i=null!==(s=null==t?void 0:t.collapse)&&void 0!==s?s:!u.isCollapsed.value;2===u.layoutMode.value&&(null==t?void 0:t.updateSettings)&&d.sideBarCollapsedKey(i),u.setCollapsed(i)}])])}async getAzureHomeWidget(e){if(!this._azureHomeWidget){const t=FxImpl.features.isNativePerf&&w.performance,s=S();t&&(t.mark(A.start),t.mark(D)),this._azureHomeWidget=await Q.all([MsPortalFx.require("MsPortalImpl/Widgets/Widgets.AzureHome"),MsPortalFx.require("MsPortalImpl/Widgets/Widgets.AzureHome.Component"),this._diContainer.get(P.Experimentation).getAssignments()]).spread(((i,o,n)=>{t&&(t.mark(E),t.measure("HomeScriptLoad",D,E));const r=S(),a=this._findByClassName("fxs-home-target"),l=new i.ViewModel(this.options.sideBar.launchBlade,this._diContainer,n),d=S();(0,y.applyToElement)({element:a[0],ltm:this.ltm,weaveNode:o.AzureHomeInner({vm:l}),weaveContext:{diContainer:this._diContainer},opName:"AzureHome"});const c=new i.Widget(a,l,this._diContainer);this.ltm.registerForDispose(c);const p=S();return c.setFocus(),c.getFirstLoadPerfIndicators().then((i=>{t&&(t.mark(A.end),t.measure(B,A.start,A.end));const o=i.assetsLoadedTs-i.startLoadingTs,n=i.recentsLoadedTs-i.startLoadingTs,a=i.favoritesLoadedTs-i.startLoadingTs;k.trace({source:"Shell",action:"AzureHomeLoad",data:{assets:o,recents:n,favorites:a,render:p-d,scripts:r-s,fullyReady:Math.max(o,n),endAzureHomeRender:p}}),e&&k.trace({source:"Shell",action:"TotalTimeToInitialRoute",name:"Home",duration:S(),data:{startScriptLoadTime:s,scriptsLoadedTime:r,assetsLoadedTime:i.assetsLoadedTs,recentsLoadedTime:i.recentsLoadedTs,favoritesLoadedTime:i.favoritesLoadedTs}})})),c})).catch((e=>{T.error("failed to load and initialize azure-home",null,MsPortalFx.getLogFriendlyMessage(e))}))}return this._azureHomeWidget}_findByClassName(e){return $(this.element[0].querySelector("."+e))}}__decorate([__metadata("fx:diagnostics",[e,"Widget"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[i.RootElements,N,s.Container]),__metadata("design:returntype",O)],O,"create",null),t.Widget=O})),
define("MsPortalImpl/Widgets/Widgets.Portal.init",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Widgets/Widgets.Portal"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPortalViewModel=void 0,ko.components.register("fxs-progress",{template:s("div",{class:"fxs-progress-dots"},s("div",{class:"fxs-progress-dots-dot"}),s("div",{class:"fxs-progress-dots-dot"}),s("div",{class:"fxs-progress-dots-dot"}),s("div",{class:"fxs-progress-dots-dot-shadow"}),s("div",{class:"fxs-progress-dots-dot-shadow"}),s("div",{class:"fxs-progress-dots-dot-shadow"}))}),t.getPortalViewModel=function(e){return e.get(i.ViewModel)}})),
define("MsPortalImpl/UI/UI.ContextPane",["require","exports","Fx/DependencyInjection","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Portal.init","Weave"],(function(e,t,s,i,o,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShellContextPane=t.RightContextPane=t.ContextPaneImpl=t.ContextPane=void 0;class l{}t.ContextPane=l;class d{constructor(e,t){this._viewModel=t,this._onMinimizeCallbacks=$.Callbacks(),this.opened=this._viewModel.opened,this.loading=this._viewModel.loading;const s={dismissFn:()=>{this.close()},logName:"contextPane"},o=(0,r.getPortalViewModel)(e);MsPortalFx.tryImmediateResolve(o.onWidgetCreate(),(()=>{const e=this._containerLifetime=t.getWidget().ltm;this._contentLifetime=e.createChildLifetime(),(0,a.subscribeAndRun)(e,[t.opened],(e=>{e?i.register(s):i.unregister(s)}))})),t.close=e=>{e.stopPropagation(),this.close()},t.getWidget()&&t.getRootElement().on("minimized",(()=>{this._onMinimizeCallbacks.fire()}))}hasContent(e){return this._contentProvider===e}getContent(){return this._contentProvider}get contentLifetime(){return this._contentLifetime}tryOpen(e,t){if(this._contentProvider===e)return this._viewModel.getWidget().setFocus(),Q(!0);const s=!!t||this._tryRemoveContent();if(s){this._contentProvider=e,t?this._contentProviderStack.push(e):this._contentProviderStack=[e],this._previouslyFocusedElement=document.activeElement;const i=this._viewModel;return i.opened(!0),i.loading(!0),e.onAddingContent(this._viewModel,t).finally((()=>o.waitForBindings(this._viewModel.getRootElement()[0]).finally((()=>{i.loading(!1)})))).then((()=>(this._viewModel.getWidget().setFocus(),s)))}return Q(s)}close(e){if(!this._contentProvider)return!0;let t=!0;if(e?this._clearContent():t=this._tryRemoveContent(),t){const e=this._viewModel;0===e.childElementCount.value&&e.opened(!1),e.loading(!1),this._restoreFocus()}return t}onMinimized(e){this._onMinimizeCallbacks.add(e)}_clearContent(){const e=this._contentProvider;e&&e.onRemovingContent(this._viewModel),this._contentProviderStack.pop(),0===this._contentProviderStack.length?this._contentProvider=null:this._contentProvider=MsPortalFx.last(this._contentProviderStack);const t=this._contentLifetime;t&&(t.dispose(),this._contentLifetime=this._containerLifetime.createChildLifetime())}_tryRemoveContent(){const e=this._contentProvider;if(!e)return!0;const t=!e.canRemoveContent||e.canRemoveContent();return t&&this._clearContent(),t}_restoreFocus(){const e=this._previouslyFocusedElement;if(e){let t=$(e).closest(".fxs-blade");if(t.length){t=t.parent().children(".fxs-blade").last();const e=n.Widget.getWidgets(t),s=e.length&&e[0];if(s&&s.setFocus)return void s.setFocus()}(document.activeElement===document.body||$.contains(this._viewModel.getRootElement()[0],document.activeElement))&&e.focus()}}}t.ContextPaneImpl=d;class c extends l{static create(e){const t=(0,r.getPortalViewModel)(e);return new d(e,t.rightContextPane)}}__decorate([__metadata("fx:diagnostics",[e,"RightContextPane"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s.Container]),__metadata("design:returntype",c)],c,"create",null),t.RightContextPane=c;class p extends l{static create(e){const t=(0,r.getPortalViewModel)(e);return new d(e,t.shellContextPane)}}__decorate([__metadata("fx:diagnostics",[e,"ShellContextPane"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s.Container]),__metadata("design:returntype",p)],p,"create",null),t.ShellContextPane=p})),
define("MsPortalImpl/Base/Telemetry",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDesktopTraceEnabled=void 0,t.isDesktopTraceEnabled=!!MsPortalFx.trace.desktop})),
define("MsPortalImpl/Services/Services.EditScopeManagement",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","MsPortalImpl/Extension/ExtensionManager"],(function(e,t,s,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateEditScopeIsSavingState=t.saveSerializedEditScope=t.loadSerializedEditScope=t.EditScopeManager=t.EditScopeManagerImpl=void 0;var n=FxImpl.Data,r=FxImpl.Rpc;class a{constructor(e,t){this._editScopes={},this._extensionManager=e,this._rpcClient=t,e.onUnload((e=>(this._onExtensionUnloaded(e),!0)))}onEditScopeCreated(e){this._ensureEditScope(e,!0)}onEditScopeDisposed(e){this._getDirtyExtensionSettings(e).forEach((t=>{const s=this._extensionManager.getExtension(d(t.key).extension);s&&s.isLoaded()&&n.onEditScopeDiscardedEndPoint.invoke(this._rpcClient,s.name,e)})),this._deleteEditScope(e)}getStateObservable(e){const t=this._ensureEditScope(e);if(!t.stateObservable){const s=ko.observable();t.stateObservable=ko.pureComputed((()=>{s();return this._getDirtyExtensionSettings(e).length>0?t.savingRefCount()>0?2:1:0})),this._loadEditScope(e).then((()=>{s(!0)}))}return t.stateObservable}logEditsToConsole(e){const t=this._editScopes[e]&&this._editScopes[e].settings;t&&t.extensionSettings().forEach((e=>{const t=d(e.key);console.debug('Edits for editScopeId: {0}, extension: "{1}"'.format(t.editScopeId,t.extension)),n.logEditsToConsole(e.settings)}))}loadEditScopeForExtension(e,t){return this._loadEditScope(e).then((()=>{const s=this._editScopes[e];if(!s)return null;const i=s.settings;if(i){const s=l(e,t),o=MsPortalFx.find(i.extensionSettings(),(e=>e.key===s));return o?o.settings:null}return null}))}saveEditScopeForExtension(e,t,s){const i=this._editScopes[e];let o;if(!this._canEditScopeBeUpdated(i))return;const n=l(e,t),r=MsPortalFx.findIndex(i.settings.extensionSettings(),(e=>e.key===n));r<0?i.settings.extensionSettings.push({key:n,settings:s}):(o=i.settings.extensionSettings()[r],o.settings=s,i.settings.extensionSettings.splice(r,1,o)),i.settings.keys.indexOf(n)<0&&i.settings.keys.push(n)}updateEditScopeIsSavingStateForExtension(e,t,s){const i=this._editScopes[e];if(!i)return;const o=i.savingRefCount()||0;s?i.savingRefCount(o+1):o>0&&i.savingRefCount(o-1)}trackingEditScope(e){return!!this._editScopes[e]}_canEditScopeBeUpdated(e){return!!e&&!!e.loadPromise}_deleteEditScope(e){delete this._editScopes[e]}_loadEditScope(e){const t=this._ensureEditScope(e);return t.justCreated&&(t.settings={keys:[],extensionSettings:ko.observableArray()},t.loadPromise=Q(),t.justCreated=!1),t.loadPromise||(t.loadPromise=this._getAndProcessSettings(e)),t.loadPromise}_getAndProcessSettings(e){return this._editScopes[e].settings={keys:[],extensionSettings:ko.observableArray()},Q()}_getDirtyExtensionSettings(e){const t=this._editScopes[e]&&this._editScopes[e].settings;return t&&t.extensionSettings().filter((e=>{const t=e.settings;return t&&t.edits.length>0}))||[]}_onExtensionUnloaded(e){for(const t in this._editScopes){const s=this._editScopes[t];if(s.savingRefCount()>0){s.settings&&s.settings.extensionSettings().some((t=>e===d(t.key).extension&&t.settings.edits.length>0))&&(this._clearEditScopeEdits(t),s.savingRefCount(0))}}}_clearEditScopeEdits(e){const t=this._editScopes[e];if(!this._canEditScopeBeUpdated(t))return;const s=t.settings&&t.settings.extensionSettings;s().forEach((e=>{e.settings=null})),s(s())}_ensureEditScope(e,t=!1){let s=this._editScopes[e];return s||(s=this._editScopes[e]={savingRefCount:ko.observable(0),justCreated:t}),s}}function l(e,t){return"{0}-{1}-{2}".format("editScopes",e,t)}function d(e){const t=e.split("-");return{editScopeId:t.slice(1,t.length-1).join("-"),extension:t[t.length-1]}}t.EditScopeManagerImpl=a;class c{static create(e,t){return new a(e,t)}}__decorate([__metadata("fx:diagnostics",[e,"EditScopeManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[o.ExtensionManager,r.Client]),__metadata("design:returntype",c)],c,"create",null),t.EditScopeManager=c,t.loadSerializedEditScope=i.defineHandler(n.loadSerializedEditScopeEndPoint,(e=>e.diContainer.get(c).loadEditScopeForExtension(e.messageArg,e.messageContext.srcWindowId))),t.saveSerializedEditScope=i.defineHandler(n.saveSerializedEditScopeEndPoint,(e=>{e.diContainer.get(c).saveEditScopeForExtension(e.messageArg.editScopeId,e.messageContext.srcWindowId,e.messageArg.edits)})),t.updateEditScopeIsSavingState=i.defineHandler(n.updateEditScopeIsSavingStateEndPoint,(e=>{e.diContainer.get(c).updateEditScopeIsSavingStateForExtension(e.messageArg.editScopeId,e.messageContext.srcWindowId,e.messageArg.isSaving)}))})),
define("MsPortalImpl/UI/Compositions/UI.Composition.Graph",["require","exports","Fx/DependencyInjection","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition"],(function(e,t,s,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompositionGraph=void 0;let n=class{constructor(){this._entries=new Map,this._idIndex=new Map}getStartBoard(){return this._startBoard}find(e){return this._idIndex.get(e)}findBlades(e,t){let s=[];if(e instanceof i.Locator)this._entries.forEach(((t,i)=>{i.getCompositionType()===o.CompositionType.Blade&&i.locator.equals(e)&&s.push(i)}));else{const t=this._entries.get(e);s=(null==t?void 0:t.opened.slice())||[]}return s.filter((e=>!(256&e.flags)&&32&(t?e.flags:~e.flags)))}setStartBoard(e){if(!this._entries.has(e)){const t={instance:e,opened:[]};this._addEntry(t),this._startBoard=e}}addBlade(e,t){let s=this._entries.get(e);if(s||(s={instance:e,openedBy:t,opened:[]},this._addEntry(s)),t.getCompositionType()===o.CompositionType.Part||t.getCompositionType()===o.CompositionType.StartboardPart){const s=this._entries.get(t);s&&s.opened.push(e)}let i=t.getCompositionType()===o.CompositionType.StartboardPart||t.getCompositionType()===o.CompositionType.Part?t.parent:t;i&&i.getCompositionType()===o.CompositionType.Lens&&(i=i.parent),i&&(s=this._entries.get(i),s||(s={instance:i,opened:[]},this._addEntry(s)),s.opened.push(e),s.instance.getCompositionType()===o.CompositionType.Blade&&s.instance.onDetailContainersChanged())}addPart(e){let t=this._entries.get(e);t||(t={instance:e,opened:[]},this._addEntry(t)),e.registerForDispose((()=>this.removePart(e)))}removeBlade(e,t=!0){this.findBlades(e,!!(32&e.flags)).forEach((e=>this.removeBlade(e,!1))),this._deleteEntry(e),this._entries.forEach((s=>{if(MsPortalFx.remove(s.opened,e).length&&t){const e=s.instance.getCompositionType()===o.CompositionType.Blade&&s.instance;e&&!e.isDisposed()&&e.onDetailContainersChanged()}}))}removeAllBlades(e){const t=this._entries.get(e);if(t){t.opened.slice().forEach((e=>{32&~e.flags&&this.removeBlade(e)}))}}removePart(e){this._deleteEntry(e)}_addEntry(e){this._entries.set(e.instance,e),this._idIndex.set(e.instance.id,e.instance)}_deleteEntry(e){this._entries.delete(e),this._idIndex.delete(e.id)}};n=__decorate([__metadata("fx:diagnostics",[e,"CompositionGraph"]),s.Class()],n),t.CompositionGraph=n})),
define("MsPortalImpl/UI/Compositions/UI.Composition.Finder",["require","exports","Fx/DependencyInjection","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Graph"],(function(e,t,s,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Finder=void 0;let n=class{constructor(e){this._graph=e}find(e){return this._graph.find(e)}findPart(e,t){let s=MsPortalFx.find(t.children,(t=>t.id===e));if(!s)for(const i of t.children)if(s=MsPortalFx.find(i.children,(t=>t.id===e)),s)break;return s}findBlades(e,t=!1){return this._graph.findBlades(e,t)}findSiblingBlades(e,t=!1){return this._graph.findBlades(this.findPartsContainer(e),t)}findPartsContainer(e){if(!e)return this._graph.getStartBoard();for(;e&&!r(e);)e=e.parent;return e}};function r(e){return e.getCompositionType()===i.CompositionType.Startboard||e.getCompositionType()===i.CompositionType.Blade}n=__decorate([__metadata("fx:diagnostics",[e,"Finder"]),s.Class(),__metadata("design:paramtypes",[o.CompositionGraph])],n),t.Finder=n})),
define("MsPortalImpl/UI/UI.DesktopManagerView",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/Widgets/Widgets.Portal.init"],(function(e,t,s,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DesktopManagerView=void 0;var r=MsPortalFx.Base.Diagnostics;const a=r.createLog(e);function l(e,t){i.isDesktopTraceEnabled&&a.verbose("[DesktopManager] {0}\n  {1}\n  Model: {2}.".format(e,t.toString(),ko.toJSON(t.getInputsOnlyViewModel())))}let d=class{constructor(e,t){this._contextPane=t,this._portal=(0,n.getPortalViewModel)(e)}composeStartBoard(e){e&&e.compose(this._portal.getWidget())}addPartToStartBoard(e){e.compose(this._portal.getStartBoardWidget())}addBlade(e,t){l("Adding blade to desktop.",e);const s=e.parent,i=s.children;return r.Telemetry.trace({action:"JourneyLength",source:"Desktop",data:{count:i.length,blades:i.map((e=>{const t=e.locator;return{bladeName:t.name,extension:t.getExtensionName()}}))},journeyId:s&&s.id}),1&e.flags?this._contextPane.tryOpen(e,0!=(16&e.flags)).then(MsPortalFx.noop):(e.compose(this._portal.getJourneyWidget(),t),Q())}removeBlade(e){l("Removing blade from desktop.",e);const t=this._contextPane;if(t.hasContent(e))t.close(!0);else{const t=this._portal.getJourneyWidget();t&&t.removeChild(e.id)}}removeAllBlades(e){const t=this._portal.getJourneyWidget();t&&t.removeChildren(e)}};d=__decorate([__metadata("fx:diagnostics",[e,"DesktopManagerView"]),s.Class(),__metadata("design:paramtypes",[s.Container,o.RightContextPane])],d),t.DesktopManagerView=d})),
define("MsPortalImpl/UI/UI.JourneyManager",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.Events","MsPortalImpl/Base/Telemetry","MsPortalImpl/Services/Services.EditScopeManagement","MsPortalImpl/UI/Compositions/UI.Composition.Finder","MsPortalImpl/UI/Compositions/UI.Composition.Graph","MsPortalImpl/UI/UI.DesktopManagerView","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/Widgets/Widgets.Portal.init"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JourneyManager=t.getLastResourceIdInJourney=void 0;const m=o.Desktop,g=MsPortalFx.Base.Diagnostics.createLog(e);var h=MsPortalFx.deepEquals;const f={noActiveJourney:"Desktop has no active journey.",noBladeInJourney:"Blade '{0}' does not exist in the current journey.",noTileInDesktop:"Tile with id '{0}' was not found on the desktop."};var x=MsPortalFx.getUniqueId,b=MsPortalFx.Base.Diagnostics.Telemetry;t.getLastResourceIdInJourney=i.defineHandler(FxImpl.Extension.getLastResourceIdInJourneyEndPoint,(e=>{const t=e.diContainer.get(v).activeJourney();return t&&t.getCurrentResourceId()}));let v=class{constructor(e,t,s,i,o){let n;this._diContainer=e,this._browser=t,this._finder=s,this._compositionGraph=i,this._view=o,this.activeJourney=ko.observable(null),this._loadingJourneyGuid=null,this._portal=(0,u.getPortalViewModel)(e);let r,a=!1,l=0,d=!1;const c=()=>{const e=this._portal;this._moveMenuBladeWidget(e),e.customEvents.trigger("fxjourneychanged",{openedAsHome:d,wasCtxPaneRoot:a})},p=e=>{l++||(n=this.activeJourney(),r=n&&n.children&&n.children.length,a=n&&n.isStartedWithContextBlade()),d=e},m=e=>{if(!--l){const t=n&&n.children&&n.children.length;e||n===this.activeJourney()&&r===t||c(),n=void 0,a=!1,d=!1}};this._changeJourney=(e,t,s)=>{p(t);try{return e()}finally{m(s)}}}configure(e){this._startBoard=e}setActiveJourney(e){this.activeJourney(e),e&&n.isFullscreen()&&n.exitFullscreen()}async openBlade(e,t){var s;const i=0===e.containerType,o=!!MsPortalFx.find((null===(s=this._sideBarJourney)||void 0===s?void 0:s.children)||[],(t=>t.id===e.id));this._createJourney||await this._loadModules(),this._finder.findBlades(e).forEach(((e,s)=>{if(e.locator.equals(t.locator)&&e.masterPartId===t.masterPartId&&e.masterInvocationProperty===t.masterInvocationProperty&&0===s&&e.locator.equals(t.locator)){const s=e.containerWidget;return s&&s.setFocus(),r.isDesktopTraceEnabled&&g.verbose("[DesktopManager] Found a previously opened detail blade."+"\n  Existing blade: {0}. Model: {1}.".format(e.toString(),ko.toJSON(e.getInputsOnlyViewModel()))+"\n  Requested Descriptor: {0}.".format(ko.toJSON(t))),Q(e)}}));try{this._createNewJourneyPromise&&await this._createNewJourneyPromise}catch(e){}return i&&0===this._finder.findBlades(e).length||o||32&t.flags||256&t.flags?this.createJourney(!o&&t.masterPartId,t).then((e=>{if(e&&e.children&&e.children.length>0)return e.children[0];throw new MsPortalFx.Errors.Error("Failed to create new journey")})):this._changeJourney((()=>{const s=this._createBlade(this._diContainer,t,e),n=this._finder.findPart(t.masterPartId,e);this._compositionGraph.addBlade(s,n||e);const r=i||o?0:1+this._findFirstItemIndex(this.activeJourney().children,e.id,f.noBladeInJourney.format(e.id));return this.activeJourney().addChild(s,r),this._view.addBlade(s,{assetType:t.originAssetType,index:r,focus:!0}).catch((e=>{g.error(e)})),s}))}async createJourney(e,t,s){let i,o;const n=!!(32&(null==t?void 0:t.flags)),r=!!(256&(null==t?void 0:t.flags));if(this._createJourney||await this._loadModules(),o||(i=this._startBoard,o=MsPortalFx.find(i.children,(t=>t.id===e))),!o&&e)throw g.error(f.noTileInDesktop.format(e)),g.verbose(ko.toJSON(this.getDiagnosticsData(),null,2)),new MsPortalFx.Errors.Error(f.noTileInDesktop.format(e));const a=Q.defer();if(s||(s=x(),this._loadingJourneyGuid=s,this._createNewJourneyPromise=a.promise),a.promise.finally((()=>{this._loadingJourneyGuid===s&&(this._loadingJourneyGuid=null,this._createNewJourneyPromise=null)})),!1===(null==o?void 0:o.isComposed)&&await o.await(7),n||r||this.tryDeactivateJourney(s))try{const e=this._createJourney(this._diContainer,o),s=y("Desktop","JourneyOpened",M(o),void 0,e.id);n?this._helpPaneJourney=e:r?this._sideBarJourney=e:this.setActiveJourney(e);const l=t.openedByContext,d=l&&l.openedAsHome;this._changeJourney((()=>{const s=this._createBlade(this._diContainer,t,i);e.addChild(s),e.compose(this._portal.getWidget()),this._compositionGraph.addBlade(s,o||i),this._view.addBlade(s,{assetType:t.originAssetType,focus:!0}).catch((e=>{g.error(e)})),a.resolve(e)}),d),b.completeTrace(s)}catch(e){a.reject(e)}else a.reject(new MsPortalFx.Errors.Error("tryDeactivateJourney returned false"));return a.promise}getDiagnosticsData(){const e=this._startBoard,t=this.activeJourney();return{startboard:e&&e.getDiagnosticsData(),activeJourney:t&&t.getDiagnosticsData()}}tryDeactivateJourney(e){const t=this.activeJourney();if(t){if(!this.confirmBladesCanClose(t.children))return!1;const e=t.children.filter((e=>!e.isRestorable()));for(let t=e.length-1;t>=0;t--)this.forceCloseBlade(e[t]);const s=y("Desktop","JourneyDeactivated",M(t.originTile),void 0,t.id);this._closeActiveJourney(!0),b.completeTrace(s)}else this._startBoard&&this._compositionGraph.removeAllBlades(this._startBoard);return this._loadingJourneyGuid=e||null,!0}closeChildBlades(e){const t=this.discardEditsOfBlade(e,{includeSelf:!1,includeDescendants:!0});if(t.successful){const t=this._finder.findBlades(e);for(let e=t.length-1;e>=0;e--)this.forceCloseBlade(t[e],1)}return t}tryCloseBlade(e,t){var s;if(32&e.flags||MsPortalFx.findIndex(null===(s=this.activeJourney())||void 0===s?void 0:s.children,(t=>t.id===e.id))>=0){const s=this.confirmBladesCanClose([e]);return s&&this.forceCloseBlade(e,t),s}return!0}confirmBladesCanClose(e,t,s){const i=t||this.activeJourney();if(!MsPortalFx.find(e,(e=>!this.canCloseBlade(e,{bladeJourney:i,validateHidden:s}))))return!0;e.forEach((e=>{if(!this._compositionGraph.find(e.id))throw new Error(f.noBladeInJourney.format(e.id))}));const o=[];return MsPortalFx.pushUnique(o,MsPortalFx.mapMany(e,(e=>this._getAlertMessageRecursive(e)))),this._browser.confirm(o.join("\n")||m.confirmEditScopeDiscard)}forceCloseBlade(e,t,s){if(!this.activeJourney()&&!this._helpPaneJourney)throw new Error(f.noActiveJourney);const i=s&&s.openBlade;this._changeJourney((()=>{const s=e.parent,i=this._findFirstItemIndex(s.children,e.id,f.noBladeInJourney.format(e.id)),o=this._finder.findBlades(this._startBoard);1===o.length&&o[0].id===e.id?this.forceDiscardJourney(s.id,t):(0===i?this.forceDiscardJourney(s.id,t):this._closeBladeRecursive(e,i,t),this._compositionGraph.removeBlade(e))}),void 0,i)}canCloseBlade(e,t){const s=(null==t?void 0:t.bladeJourney)||this.activeJourney();if(!s)return!0;const i=e=>{const o=!(!e.bladeDefinition||!e.bladeDefinition.actionBar);if(!ko.unwrap(e.editScopeId)&&e.shouldAlertOnClose({legacyMode:o,validateHidden:null==t?void 0:t.validateHidden}))return!0;if(e.isInitialized&&!e.children.some((e=>e.children.some((e=>e.suppressAlert()))))&&s.ambientSettings.getItemsInPath(e.journeyPath).some((e=>{const t=e.value,s=t&&t.editScope;return s&&s.dirty&&!s.saving})))return!0;const n=this._finder.findBlades(e);return 0!==n.length&&n.some((e=>i(e)))};return!i(e)}forceDiscardJourney(e,t){var s,i;(null===(s=this.activeJourney())||void 0===s?void 0:s.id)===e?this._changeJourney((()=>{this._closeActiveJourney(!1,t)})):e===(null===(i=this._helpPaneJourney)||void 0===i?void 0:i.id)&&this._helpPaneJourney.children.slice(0).forEach((e=>{this._compositionGraph.removeBlade(e),e.isDisposed()||this._closeBladeRecursive(e,0,t,!1)}))}tryDiscardJourney(e){let t=!1;return(this.canDiscardJourney(e)||this._browser.confirm(m.confirmEditScopeDiscard))&&(this.forceDiscardJourney(e),t=!0),t}canDiscardJourney(e){var t;const s=(null===(t=this.activeJourney())||void 0===t?void 0:t.id)===e&&this.activeJourney(),i=s&&s.ambientSettings.getObservable().peek().some((e=>{const t=e.value,s=t&&t.editScope;return s&&s.dirty&&!s.saving&&s.disposeOnJourneyDiscard}));return!s||!i}discardEditsOfBlade(e,t){return this._discardEditsOfContainer(e,t.force,(s=>{const i=s.value,o=s.path,n=e.journeyPath,r=h(o,n),a=!r&&(1===i.type||o.length>=n.length+2);return i&&i.editScope&&(t.includeSelf&&r||t.includeDescendants&&a)}))}dispose(){this.activeJourney()&&(this.activeJourney().dispose(!0),this.activeJourney(null)),this._helpPaneJourney&&(this._helpPaneJourney.dispose(),this._helpPaneJourney=null),this._sideBarJourney&&(this._sideBarJourney.dispose(),this._sideBarJourney=null)}getJourneyIdForTile(e){const t=this.activeJourney();let s;return t&&t.originTile.id===e&&(s=t.id),s}_discardEditsOfContainer(e,t,s){let i=[];const o={confirmationRequired:!1,successful:!1},n=this.activeJourney();if(!n)throw new Error(f.noActiveJourney);const r=n.ambientSettings;return(0===e.containerType||e.isInitialized)&&(i=r.getItemsInPath(e.journeyPath).filter(s)),o.confirmationRequired=!t&&i.filter((e=>{const t=e.value.editScope;return t.dirty&&!t.saving})).length>0,o.confirmationRequired&&!this._browser.confirm(m.confirmEditScopeDiscard)||(o.successful=!0,i.forEach((e=>{r.removeItem(e.path),this._diContainer.get(a.EditScopeManager).onEditScopeDisposed(e.value.editScope.editScopeId)}))),o}_closeActiveJourney(e,t){const s=this.activeJourney();this.setActiveJourney(null),this._compositionGraph.removeAllBlades(this._startBoard),s&&(s.children.slice(0).reverse().forEach((s=>{s.isDisposed()||this._closeBladeRecursive(s,0,t,e)})),s.dispose(e)),this._view.removeAllBlades((e=>{g.error("DesktopManager: Found un-tracked blade '{0}' in view after closing active journey. It will be forcefully removed.".format(e))}));const i=this._portal.sideBar;i&&(i.menuBladePartContainer(null),i.menuBladeId(null))}_closeBladeRecursive(e,t,s,i){this._removeBladesFromUIRecursive(e),this._disposeBladesRecursive(e,t,i),i||(e.parent.save(),this._portal.customEvents.trigger("fxbladeclosed",{id:e.id,reason:s,masterPartId:e.masterPartId}))}_removeBladesFromUIRecursive(e){const t=this._finder.findBlades(e);for(let e=t.length-1;e>=0;e--)this._removeBladesFromUIRecursive(t[e]);this._view.removeBlade(e)}_disposeBladesRecursive(e,t,s){const i=e.parent.children.indexOf(e,t);s?e.dispose(!0):e.parent.removeChildAt(i,void 0),this._finder.findBlades(e).forEach((e=>{this._disposeBladesRecursive(e,i,s)}))}_getAlertMessageRecursive(e){return(e=>{const t=MsPortalFx.mapMany(this._finder.findBlades(e),(e=>e.getAlertOnCloseMessages()));return MsPortalFx.union(e.getAlertOnCloseMessages(),t)})(e)}_findFirstItemIndex(e,t,s){const i=MsPortalFx.findIndex(e,(e=>e.id===t));if(-1===i)throw g.verbose(ko.toJSON(this.getDiagnosticsData(),null,2)),new Error(s);return i}getJourneyWidget(){return this._portal.getJourneyWidget()}_masterIsMenuBlade(e){const t=e&&e.masterContainer,s=t&&t.bladeDefinition;return!(!s||!s.menuBlade)}_moveMenuBladeWidget(e){const t=this.activeJourney(),s=t&&t.children,i=e.sideBar,o=i.menuBladeId,n=i.layoutMode.value,r=i.getRootElement().findByClassName("fxs-sidebar-menu-container"),a=i.menuBladePartContainer,l=(e,t)=>{a(t),o(e)};if(s&&s.length){const e=s[s.length-1],t=e.bladeDefinition;if(t&&t.menuBlade)return;const i=3&e.flags,d=this._masterIsMenuBlade(e.masterContainer),c=this._masterIsMenuBlade(e),p=i?e.masterContainer&&e.masterContainer.masterContainer:e.masterContainer;if(c){const e=p.getMenuWidget(),t=$(e.element);if(0===n&&o.value!==p.id){const e=r.findByClassName("fxc-menu");e.length&&(e.detach(),a.value&&e.appendTo(a.value)),t.appendTo(r)}return void l(p.id,e.getPartContainer())}if(d&&0===n){const e=r.findByClassName("fxc-menu");e.length&&e.detach(),a.value&&e.appendTo(a.value)}}l()}async _loadModules(){if(!this._createJourney){const[e,t]=await Promise.all([i.get("MsPortalImpl/UI/Compositions/UI.Composition.Journey","create"),i.get("MsPortalImpl/UI/Compositions/UI.Composition.Blade","create")]);this._createJourney=e,this._createBlade=t}}};function y(e,t,s,i,o){return b.startTrace({source:e,action:t,name:s,assetType:i,journeyId:o})}function M(e){return e&&e.locator&&e.locator.toFriendlyString()}v=__decorate([__metadata("fx:diagnostics",[e,"JourneyManager"]),s.Class(),__metadata("design:paramtypes",[s.Container,p.Browser,l.Finder,d.CompositionGraph,c.DesktopManagerView])],v),t.JourneyManager=v})),
define("MsPortalImpl/Base/Base.Router",["require","exports","Fx/ResourceManagement","Fx/DependencyInjection","FxInternal/AsyncLoader","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/Base/Base.HistoryManager","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.Subscriptions","MsPortalImpl/UI/Commands/Base.PortalFunctions","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Widgets/Widgets.Portal.init","Weave","FxInternal/Utils/Promise","Fx"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g,h,f,x,b,v,y,M,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Router=t.Internal=void 0;var C=MsPortalFx.Base,P=C.Diagnostics;const w=window,_=P.createLog(e),S=n.Portal.defaultPageTitle.format(n.Dashboard.defaultTitle,w.fx.environment.branding.title);const F=FxImpl.getErrorMap({linkFormat:"",invalidLink:"",unfoundAsset:"",noResourceAsset:""});function k(e,t){const s=new Date;e.getAsync(o.get("MsPortalImpl/UI/Hubs/UI.NotificationManager","NotificationManager")).then((e=>{e.addClientNotification({title:n.Shell.deepLinkInvalidTitle,description:MsPortalFx.encodeHtml(t),status:MsPortalFx.Hubs.Notifications.NotificationStatus.Error,timestamp:s,correlationIds:[s.getTime().toString()]})}))}var T;function D(e,t,s,i,o,n){return MsPortalFx.extend({extensionName:e,assetType:t,assetId:s,detailBladeInputs:i,defaultMenuItemId:o},n)}function E(e){var t;return!(e.isEnabled("hidedirectorypanebutton")||(null===(t=null==w?void 0:w.chrome)||void 0===t?void 0:t.hideDirectoryPaneButton))}function B(e,t){const s=t.portal,i=t.baseRouter;return{navigateTo:(t,o)=>i.tryCleanupJourney()?(s.settingsFlyoutState(0),o.interactionSource||(o.interactionSource="Router"),P.Telemetry.trace({source:o.interactionSource||"Base.Router",action:"DashboardNavigation"}),MsPortalFx.isNullOrWhiteSpace(o.dashboardId)&&(o.dashboardId=t&&(0,r.getDashboardIdFromUri)(t)),Q(e.get(u.SwitchDashboardPortalFunc).invoke({id:o.dashboardId,title:o.dashboardId},o.interactionSource).then((()=>{i.updateTitle(),s.customEvents.trigger("fxdeeplinkchanged")})))):Q.reject()}}function A(e,t){const s=e.get(FxImpl.Features),i=t.portal,o=t.baseRouter;return{navigateTo:(e,t)=>{if(t=t||{},P.Telemetry.trace({source:"Base.Router",action:"AzureHomeNavigation"}),o.tryCleanupJourney()){o.ensureRouteInView("Home");const e=s.getValue("bladeashomedeeplink");if(e){const t=new l.Uri("#"+e),s={deepLink:t.hash,openedAsHome:!0};o.navigateWithRoute("blade",t,{openedByContext:s})}else i.getAzureHomeWidget(t.invokedByInitRoute).then((e=>{e&&(e.reloadRecents(),e.reloadFavorites(),!t.skipFocus&&e.setFocus())}));return o.updateTitle(),i.customEvents.trigger("fxdeeplinkchanged"),Q()}return Q.reject()}}}function N(e,t){const s=t.portal,i=t.baseRouter;return{navigateTo:e=>{if(i.tryCleanupJourney()){const t=e.getHashParts().rest.split("/");let o,n="";if(null==t?void 0:t.length){switch(t[0].toLowerCase()){case"category":o=t[3],n=t[1];break;case"filter":o=t[1],n=t[3]}}i.ensureRouteInView("AllServices");const l=o&&decodeURIComponent(o);s.allServicesMenuInput.filter(l),s.allServicesMenuInput.category=n&&decodeURIComponent(n),"allservices"!==(0,r.getCurrentUri)().getHashParts().category&&a.pushState({data:{},url:e.hash}),i.updateTitle()}return Q()}}}function O(e,t){const s=e.get(h.JourneyManager),i=t.portal,o=t.lifetime,n=t.baseRouter,l={2:"directory",3:"filters",6:"contact"};const d=(t,r)=>{const a=t.getHashParts().rest,l=e.get(FxImpl.Features),d=function(e,t){let s=1;if(t.enableOverview||(s=t.enableDirectorySettings?2:4),!e)return s;let i,o=e.toLowerCase();switch(0===e.indexOf("#settings")&&(o=e.split("/")[1]),o){case"directory":t.enableDirectorySettings&&(i=2);break;case"filters":t.enableGlobalResourceFilters&&(i=3);break;case"contact":t.enableContactInfo&&(i=6)}return MsPortalFx.isNullOrUndefined(i)&&(i=s),i}(a,{enableDirectorySettings:E(l),enableGlobalResourceFilters:r,enableContactInfo:l.isEnabled("contactinfo"),enableOverview:!l.isEnabled("hidesettingsoverview")});if(i.settingsFlyoutState(d),0!==i.settingsFlyoutState.value){e.get(m.RightContextPane).close(!0);const t=e.get(g.DialogManager);t.hasOpenDialog&&(P.Telemetry.trace({source:"Base.Router",action:"SettingsFlyoutClosedDialogsOnOpen"}),t.dismissOpenDialog())}const c=o.createChildLifetime();(0,y.subscribe)(c,[i.settingsFlyoutState],(async e=>{if(0===e){const e=s.activeJourney();e&&e.children.length||await n.goToLandingPage({interactionSource:"Router",replaceHistory:!1,invokedByInitRoute:!0,skipFocus:!0}),c.dispose()}}))};return(0,y.subscribe)(o,[i.settingsFlyoutState],(e=>{if(0===e){const e=(0,r.getCurrentUri)().getHashParts();return void(e.category&&"settings"===e.category&&(n.updateNavHistory(),n.updateTitle()))}const t=l[e];a.pushState({data:{},url:(0,r.getCurrentUri)().setHash("#settings"+(t?`/${t}`:"")).href}),i.customEvents.trigger("fxdeeplinkchanged"),n.updateTitle()})),{navigateTo:t=>Q(e.get(p.SubscriptionsUserContext).useGlobalResourceFiltersPromise).then((e=>d(t,e)))}}function R(e,t){function s(){return e.getAsync(o.get("MsPortalImpl/UI/UI.AzureConsole","AzureConsole"))}let i=!1;return{navigateTo:()=>(i=!0,s().then((e=>e.showFullscreen()))),onNavAway:()=>i?s().then((e=>e.minimizeIfOpen())):Q()}}function L(e,t){const s=(0,I.memoizePromise)((()=>Q(MsPortalFx.require("MsPortalImpl/Base/Base.Selectable2.Provisioning")))),i=t.baseRouter;return{navigateTo:(t,o)=>{const a=t&&t.getHashParts().rest,d=(a||"").split("/");if(!d.length)return k(e,n.Shell.deepLinkInvalid.format(a)),(0,M.QReject)(`Deep link ${a} should be #{routeTypes.create}/{package-id}.`);P.Telemetry.trace({source:"Gallery",action:"DeepLinkVisited",name:a});const c=d.shift(),p=(0,r.parseBladeInputs)(d,a);if("hub"!==c&&"Microsoft.Support"!==c)return s().then((s=>s.getDynamicCreateBladeReference(e,{galleryItemId:c,inputs:p}).then((e=>(e.defaultMenuItemId=d[2],o.route=e,i.navigateWithRoute("blade",t,o))))));{const e="{0}/{1}/package/{2}/additionalConfig/{3}/selectedMenuItemId/undefined/createLanding/undefined".format(MsPortalFx.Base.Constants.ExtensionNames.Marketplace,MsPortalFx.Base.Constants.BladeNames.Hubs.CreateHubBlade,encodeURIComponent(c),encodeURIComponent(JSON.stringify(p)));return i.navigateWithRoute("blade",new l.Uri("#blade/"+e),o)}}}}function z(e,t){const s=/^[\w-]+$/,i=t.portal,o=t.baseRouter,n=e=>{const t=new l.Uri(e.toString());return t.setHash("#settings"),o.navigateWithRoute("settings",t,{})};return{navigateTo:t=>{const r=t.getHashParts().rest;return s.test(r)||F.linkFormat(r),Q(e.get(p.SubscriptionsUserContext).useGlobalResourceFiltersPromise).then((s=>{let a=r.toLowerCase();if("directory"===a&&E(e.get(FxImpl.Features)))return n(t);if("subscriptions"===a){if(s)return n(t);a="directory"}const l="fxs-menu-"+a;let d=i.getRootElement().findByClassName(l);d.length>1&&(d=b.filterVisible(i.getRootElement()[0],"."+l)),1!==d.length&&F.invalidLink(r),o.updateNavHistory({skipFocus:!0}),d[0].click()}))}}}function H(e,t){const i=e.get(d.ManifestCache);return{navigateTo:(t,o)=>{const r=t.getHashParts().rest,a=r.match(/([^/]+)\/([^/]+)\/(.+)/);if(!a||a.length<4)return k(e,n.Shell.deepLinkInvalid.format(r)),(0,M.QReject)(`'${r}' is invalid. Correct format is #asset/{ExtensionName}/{AssetType}/{AssetId}`);const l=decodeURI(a[1]);let d=decodeURI(a[2]),c=decodeURI(a[3]);const p="string"==typeof c&&s.ArmId.parse("/"+c,!0);return p&&0!==p.kind&&(c="/"+c),MsPortalFx.tryImmediateResolve(i.getManifestAsync(l,"assetTypes"),(t=>{const s=d.toLowerCase(),i=MsPortalFx.find(t.assetTypes,(e=>e.name.toLowerCase()===s));return i||(k(e,n.Shell.deepLinkNotFound.format(d)),F.unfoundAsset(d)),d=i.name,P.Telemetry.trace({source:"Asset",action:"DeepLinkVisited",name:l,data:d}),e.get(u.CreateJourneyForAssetFunc).invoke(D(l,d,c,{},null,o))}),(t=>{throw k(e,n.Shell.deepLinkNotFound.format(l)),t}))}}}function U(e,t){const i=e.get(c.AssetTypeService);return{navigateTo:(t,o)=>{let r=t.getHashParts().rest;r="/"+r.replace(/^\//,""),r=decodeURI(r);const a=r.split("/");let l=null;return a.length%2==0&&(l=a[a.length-1],r=r.slice(0,r.length-l.length-1)),MsPortalFx.tryImmediateResolve(Q(),(()=>MsPortalFx.tryImmediateResolve(i.assetTypesComplete,(()=>{const t=i.getAssetTypeByResourceType(s.ArmId.parse(r,!0).resourceType)||i.getAssetTypeByResourceTypeWithFallback(s.ArmId.parse(r).resourceType),a=t.assetTypeManifest,d=a.name,c=t.extension,p=a.resourceType.resourceTypeName;return d||(k(e,n.Shell.deepLinkNotFound.format(p)),F.noResourceAsset(p)),P.Telemetry.trace({source:"Resource",action:"DeepLinkVisited",name:c,data:p||MsPortalFx.Base.Constants.AssetNames.NonAssetResource}),e.get(u.CreateJourneyForAssetFunc).invoke(D(c,d,r,{},l,o))}))),(t=>{throw k(e,n.Shell.deepLinkErrorLoading.format(r)),t}))}}}!function(e){e.RouterImpl=class{constructor(e,t,s){this._diContainer=e,this._portal=s,this._ltm=new FxImpl.TriggerableLifetimeManager,this._journeyManager=e.get(h.JourneyManager),this._features=e.get(FxImpl.Features);const i={portal:s,lifetime:this._ltm,baseRouter:{goToLandingPage:e=>this.goToLandingPage(e),tryCleanupJourney:()=>this._tryCleanupJourney(),ensureRouteInView:e=>this.ensureRouteInView(e),updateTitle:()=>this._updateTitle(),updateNavHistory:e=>this._updateNavHistory(e),navigateWithRoute:(e,t,s)=>this.navigateWithRoute(e,t,s)}},o=function(e,t){const s=e.get(c.AssetTypeService),i=e.get(h.JourneyManager),o=t.portal,d=t.baseRouter,p={["MyAccessBlade".toLowerCase()]:"MyAccess.ReactView",["RPStatusBlade".toLowerCase()]:"RPStatus.ReactView"};function m(e,t){const s=(e||"").split("/"),i=s.length;if(i<2)return null;if(!s[1])return null;let o,n=0;t?"~"===s[2]&&(n=2,o=decodeURI(s[3])):(n=i%2,1===n&&(o=decodeURI(s[2])));const a=(0,r.parseBladeInputs)(s.slice(2+n),e,{parseJSON:!0,v2DeepLink:t});return{extension:s[0],detailBlade:s[1],detailBladeInputs:a,defaultMenuItemId:o}}return{navigateTo:(t,g)=>{const h="view"===t.getHashParts().category,f=t.getHashParts().rest;let x=g&&g.route||m(f,h);x.openedByContext=g&&g.openedByContext,o.settingsFlyoutState(0);let b=Q();if(x.extension&&x.extension.toLowerCase()==="HubsExtension".toLowerCase()){const i=(x.detailBlade||"").toLowerCase(),n=e.get(FxImpl.Features);if("contactinfoblade"===i&&n.isEnabled("contactinfo"))return void o.settingsFlyoutState(6);if("settingsblade"===i)return P.Telemetry.trace({source:"Base.Router",action:"SettingsFlyoutRedirect"}),a.pushState({data:{},url:(0,r.getCurrentUri)().setHash("#menu/settings").href}),o.customEvents.trigger("fxdeeplinkchanged"),d.navigateWithRoute("menu",new l.Uri("#menu/settings"),{});const u=(i,o)=>{b=Q(MsPortalFx.tryImmediateResolve(s.assetTypesComplete,(()=>{let n,r="";if(i===C.Constants.ResourceTypes.AllResources?r=c.lowerCaseAllResourcesId:(n=s.getAssetTypeByResourceType(i),n&&(r=n.id.toLowerCase())),r)return(0,c.getBrowseBladeUri)(e,r,t.hash,n,o).then((e=>{if(t.hash!==e){const s=m((t=new l.Uri(e)).getHashParts().rest,"view"===t.getHashParts().category);x=s}}))})))};if("browseallresourcesblade"===i)u(C.Constants.ResourceTypes.AllResources);else if("browseresourceblade"===i){const e=x.detailBladeInputs||{};u(e.resourceType,e.kind)}else"browseresourcegroupblade"===i?u(C.Constants.ResourceTypes.ResourceGroups):-1!==Object.keys(p).indexOf(i)&&(x.detailBlade=p[i])}const v=i.activeJourney();return b.then((()=>Q.fcall((()=>v&&v.getDeepLink()||Q(""))).catch((()=>"")).then((s=>{if(t.hash!==s)return e.get(u.CreateJourneyForBladeFunc).invoke(x).then(MsPortalFx.identity,(t=>{throw k(e,n.Shell.deepLinkErrorLoading.format(f)),t}))}))))}}}(e,i);this._routeConfigMapping={allservices:N(e,i),asset:H(e,i),blade:o,view:o,cloudshell:this._features.isEnabled("azureconsole")?R(e,i):void 0,create:L(e,i),dashboard:B(e,i),menu:z(e,i),home:this._features.isEnabled("azurehome")?A(e,i):void 0,resource:U(e,i),settings:O(e,i)},MsPortalFx.ViewModels.navigateToDashboardEndPoint.register(t,null,(([e,t])=>{this.navigateWithRoute("dashboard",null,{interactionSource:e,dashboardId:t})}))}navigateWithRoute(e,t,s){const i=this._routeConfigMapping[e];return i?i.navigateTo(t,s):Q.reject("Invalid route type")}_getRouteConfig(e){const t=e.getHashParts().category;return this._routeConfigMapping[t]}ensureRouteInView(e){this._portal.settingsFlyoutState(0),this._portal.displayMode.value!==e&&this._portal.displayMode(e)}route(e,t){return this._route(new l.Uri(e),{openedByContext:t})}_route(e,t={}){const s=MsPortalFx.extend(t.openedByContext||{},{deepLink:e.hash});return MsPortalFx.tryImmediateResolve(Q(),(()=>{if(this._features.isEnabled("azureconsole")&&this._routeConfigMapping.cloudshell.onNavAway(),"Dashboard"===this._portal.displayMode.value){const e=this._portal.getStartBoardWidget();if(this._portal.inOrganizeMode()||e.options.dashboardChanged.value){if(!this._diContainer.get(f.Browser).confirm(n.Desktop.confirmEditScopeDiscard))return;this._portal.topBar.finishDashboardEdit(3)}}this._features.isEnabled("clarity")&&w.clarity&&w.clarity("stop"),e.isHashEmpty()&&(e.setHash((0,x.isLandingPageDashboard)(this._diContainer)?"dashboard":"home"),a.replaceState({data:{},url:e.href}),e=(0,r.getCurrentUri)());const i=this._getRouteConfig(e);return i?i.navigateTo(e,{skipFocus:t.skipFocus,openedByContext:s,invokedByInitRoute:t.invokedByInitRoute}):(0,M.QReject)("{0} is not a valid deep link".format(e.hashWithHashQueryString))})).then((()=>this._portal.customEvents.trigger("fxdeeplinkchanged"))).finally((()=>{this._features.isEnabled("clarity")&&w.clarity&&w.clarity("start")}))}initialRoute(e,t){const s=(0,r.getCurrentUri)();let i;return i=this._getRouteConfig(s)?this._route(s,t).catch(e):e(),this.startListening(),i.catch((e=>(_.warning(e,1,"Unable to load initial route."),this.goToLandingPage(t))))}startListening(){let e=this._isListening;e&&e.dispose(),e=this._isListening=this._ltm.createChildLifetime(),this._portal.customEvents.addHandler(e,"fxjourneychanged",((e,t)=>{(t=t||{openedAsHome:!1}).wasCtxPaneRoot||this._updateNavHistory({addToHistory:!0,openedAsHome:t.openedAsHome})})),this._portal.customEvents.addHandler(e,"fxbladerebound",(()=>{this._updateNavHistory()})),e.registerForDispose([$(window).setEvents(["hashchange",()=>{const e=(0,r.getCurrentUri)(),t=(0,r.getCurrentUri)();this._route(t,{skipFocus:!1}).catch((s=>{this._updateNavHistory(),P.Telemetry.trace({source:"Base.Router",action:"UriHashChange",data:{originalUri:e,replacedUri:t,reason:s}})}))}])])}stopListening(){const e=this._isListening;e&&e.dispose(),this._isListening=null}dispose(){this.stopListening(),this._ltm.dispose(),window.location.hash=""}goToLandingPage(e){const t=(0,x.isLandingPageDashboard)(this._diContainer);P.Telemetry.trace({source:e.interactionSource||"Base.Router",action:"LandingPageNavigation"});const s=(0,r.getCurrentUri)().setHash(t?"dashboard":"home");return(e.replaceHistory?a.replaceState:a.pushState)({data:{},url:s.href}),this.navigateWithRoute(t?"dashboard":"home",null,e)}_tryCleanupJourney(){if(this._journeyManager.tryDeactivateJourney()){if(!this._getActiveJourneyId()){const e=this._portal.getJourneyWidget();e&&e.close()}return!0}return!1}_updateTitle(){const e=this._journeyManager.activeJourney();this._titleLifetime&&this._titleLifetime.dispose(),this._titleLifetime=null;const t=e=>n.Portal.windowTitleFormat.format(e,w.fx.environment.branding.title);if(0!==this._portal.settingsFlyoutState.value)w.document.title=t(n.TopBar.settings);else if(e&&e.children.length>0){this._titleLifetime=this._ltm.createChildLifetime();const s=e.children[e.children.length-1].containerWidget,i=s&&s.options;i&&i.crumb.subscribeAndRun(this._titleLifetime,(e=>{MsPortalFx.isNullOrUndefined(e)||(w.document.title=t(e))}))}else new Promise((e=>{switch(this._portal.getDisplayMode()){case"Home":e(t(n.AzureHome.home));break;case"Dashboard":MsPortalFx.require("MsPortalImpl/UI/UI.DesktopManagerImpl").then((({DesktopManagerImpl:s})=>{const i=this._diContainer.get(s).startBoard,o=i&&i.getDashboard()||{};o.title?e(t(o.title)):e(S)}));break;default:e(t(n.SideBar.allServices))}})).then((e=>w.document.title=e))}_getActiveJourneyId(){const e=this._journeyManager.activeJourney();return!e||e.isStartedWithContextBlade()?"":e.id}_updateNavHistory(e){const t=e&&e.addToHistory?a.pushState:a.replaceState,s=e&&e.skipFocus,i=this._journeyManager.activeJourney();let o=!0;if(!i){let e;switch(this._portal.getRootPageDisplayType()){case"Dashboard":e="dashboard";break;case"Home":e="home";break;default:e="allservices"}const i=(0,r.getCurrentUri)(),o=i.getHashParts().category;return MsPortalFx.localeCompareIgnoreCase(o,"dashboard")&&MsPortalFx.localeCompareIgnoreCase(o,"home")&&MsPortalFx.localeCompareIgnoreCase(o,"allservices")&&t({data:null,url:i.setHash(e).href}),this._route((0,r.getCurrentUri)(),{skipFocus:s})}return MsPortalFx.tryImmediateResolve(i.getDeepLink(),(s=>{if(!this._getActiveJourneyId())return;const n=i.children,a=n[n.length-1],l=a&&a.bladeDefinition;if(l&&(l.menuBlade||l.tabMenuBlade))return void(o=!1);const d=(0,r.getCurrentUri)();e&&e.openedAsHome?d.setHash("#home"):d.setHash(s),d.href.toLowerCase()!==location.href.toLowerCase()&&(t({data:{},url:d.href}),this._portal.customEvents.trigger("fxdeeplinkchanged"))}),(e=>{_.warning(new MsPortalFx.Errors.Error({message:"Failed to update address bar.",data:{id:this._getActiveJourneyId(),key:i.templateKey},innerErrors:e}))})).finally((()=>{o&&this._updateTitle()}))}}}(T=t.Internal||(t.Internal={}));class W{static create(e,t){return new T.RouterImpl(e,t,(0,v.getPortalViewModel)(e))}}__decorate([__metadata("fx:diagnostics",[e,"Router"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[i.Container,FxImpl.Rpc.Client]),__metadata("design:returntype",W)],W,"create",null),t.Router=W})),
define("MsPortalImpl/Base/Base.Selectable2.Common",["require","exports","Fx/DependencyInjection"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpenBladeTaskArgs=t.OpenBladeConfig=t.OpenBladeResources=void 0;let i=class{};i=__decorate([__metadata("fx:diagnostics",[e,"OpenBladeResources"]),s.Class("pipeline")],i),t.OpenBladeResources=i;let o=class{};o=__decorate([__metadata("fx:diagnostics",[e,"OpenBladeConfig"]),s.Class("pipeline")],o),t.OpenBladeConfig=o;let n=class{};n=__decorate([__metadata("fx:diagnostics",[e,"OpenBladeTaskArgs"]),s.Class("pipeline")],n),t.OpenBladeTaskArgs=n})),
define("MsPortalImpl/Base/Base.Selectable2",["require","exports","Fx/Composition/Selectable","MsPortalImpl/Base/Base.Events","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/Base/Base.ItemCache","MsPortalImpl/Base/Base.Selectable2.Common","MsPortalImpl/Base/Base.Pipeline","MsPortalImpl/UI/UI.BladeOpener"],(function(e,t,s,i,o,n,r,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOrCreateOpenBladeSelectable=t.getOrCreateCachedFxElement=t.getFxClickSelectable=t.isProvisioningBladeReference=t.findExtensionViewModel=t.setSelectableContext=t.getOrCreate=t.createListSelectable=void 0;var d=MsPortalFx.Base.ProxiedObservables,c=FxImpl.shellInterface;let p=1;const u=a.createDescriptor(r.OpenBladeConfig,r.OpenBladeResources,r.OpenBladeTaskArgs);u.registerAsync("MsPortalImpl/Base/Base.Selectable2.Pipeline","OpenBladeRequestHandler",(()=>!0)),u.registerAsync("MsPortalImpl/Base/Base.Selectable2.SupplyBladeReference","SupplyBladeReferenceHandler",((e,t,s)=>!s.bladeRequest)),u.registerAsync("MsPortalImpl/Base/Base.Selectable2.PPV3","ParameterProviderV3SelectableHandler",((e,t,s)=>function(e){const t=c(e);return t&&20560===t.type}(s.bladeRequest.bladeReference)),2),u.registerAsync("MsPortalImpl/Base/Base.Selectable2.Provisioning","OpenBladeHandler",((e,t,s)=>x(s.bladeRequest.bladeReference)),2);class m extends FxImpl.TriggerableLifetimeManager{isClickable(){return!0}constructor(e,t){super(),this.id=p++,this.isCanceled=!1,this.callbacks=ko.observableArray();const s=ko.observable(),i=FxImpl.shellInterface(t),o=ko.observable(!1),n={selectable:this,selectedValue:s,extensionVm:i,callbacks:this.callbacks},r=u.createPipeline(e,this,{},n);let a,l,d,c=0;this.setLifetimeReference=(e,t)=>{e===(c&e)&&(c|=e,t.registerForDispose({dispose:()=>{c^=e,c||this.dispose()}}))},this.value=ko.computed(this,{read:()=>{const e=o()?s():void 0;return void 0!==e?(d&&d!==l&&(d=l),l=a):l&&(d=l,l=void 0),e},write:e=>{void 0===e&&(o(!1),s(void 0))}}),this.processRequest=e=>{let t;if(a=e,e){if(3!==e.reason&&4!==e.reason||o(!0),4===e.reason)return void m(e.operationId,!!(2&e.flags),e.initialWidth);if(2===e.reason||3===e.reason){let s;t=new Promise((e=>s=e)),r.startTask({bladeRequest:e,notifyBladeOpenCompleted:t=>s({operationId:e.operationId,success:t})})}}return t};const m=(e,t,i)=>{const n=this.createChildLifetime(),r=setTimeout((function(){let o=16;o|=t?8:0,s({operationId:e||MsPortalFx.getUniqueId(),flags:o,initialWidth:i})}),500),a=()=>{n.dispose()};s.subscribe(n,a),o.subscribe(n,a),n.registerForDispose((()=>{clearTimeout(r)}))};this.isSelected=ko.computed(this,{read:()=>o(),write:e=>{if(o()!==e)if(o(e),!0===e){const e=MsPortalFx.getUniqueId();m(e),this.isCanceled=!1,r.startTask({operationId:e,notifyBladeOpenCompleted:e=>{e||(this.isCanceled=!0)}})}else s(void 0)}}),this.onClick=()=>{this.isSelected(!0)},this.invokeClickCallback=(e,s,i,o,n,r,a,l)=>{s.invokeClickHandler(e,i,o,t,n,r,a,l)};const g=e=>e?{item:e.selectedItem,metadata:e.controlMetadata}:void 0;this.activationState=ko.computed(this,(()=>{this.value();return{previous:g(d),current:g(l)}})),this.refresh=()=>{const e=MsPortalFx.getUniqueId();m(e),r.startTask({operationId:e,notifyBladeOpenCompleted:MsPortalFx.noop})},i.requestOpenBlade((e=>this.processRequest(e)))}}function g(e,t){const s="Selectable";let i=d.disposableData(t,s);if(!i){i=function(e){const t=new FxImpl.TriggerableLifetimeManager;return e.setLifetimeReference(1,t),{selectable:e,dispose:()=>{t.dispose()}}}(new m(e,t)),d.disposableData(t,s,i)}return i.selectable}t.createListSelectable=function(e,t){return g(e,t)},t.getOrCreate=g;const h="data-fxselectable";function f(e){const t=(e=$(e[0].closest("[data-fxselectable]"))).attr(h);return n.rotFind(t)}function x(e){const t=c(e);return t&&19792===t.type}function b(e,t,i,o){if(!i)return;const n=FxImpl.shellInterface(i.container),r=n.selectables();let a=r[t];const l=!a;if(l){const e=$.extend(!1,r);a=e[t]=new s.Selectable2({supplyBladeReference:MsPortalFx.noop}),n.selectables(e)}const d=g(e,a);return l&&o&&o(d),d}t.setSelectableContext=function(e,t,s){const i=n.rotAdd(e,t);s.attr(h,i),e.registerForDispose((()=>{s.removeAttr(h)}))},t.findExtensionViewModel=f,t.isProvisioningBladeReference=x,t.getFxClickSelectable=function(e,t,s,n,r){const a=n+"idmap",d=f(s);let c=MsPortalFx.Base.ProxiedObservables.data(d,a);c||(c=d?MsPortalFx.Base.ProxiedObservables.data(d,a,{}):{});const p=r;c[p]||(c[p]=ko.observable(),t.registerForDispose((()=>delete c[p])));const u=c[p],m=b(e,n,d,(e=>{const i=s.closest(".fxs-tile").data(o.CompositionInstanceDataName)||t.createChildLifetime(),n=e;ko.reactor(i,(()=>{const t=n.activationState();if(t){const s=t.previous&&t.previous.item,i=t.current&&t.current.item;s&&c[s]&&c[s](void 0),i&&c[i]&&c[i](e.value())}}))}));return{activated:u,invokeClick:(e,t,o)=>{if(m){const n=(null==o?void 0:o.target)||s[0];m.invokeClickCallback(2,d,e,t,(0,i.getOrCreateFxElement)(n,d.internal.elements),p)}else t(null)},openBlade:m?async(t,s)=>{e.get(l.BladeOpener).openBlade(t,{selectable:m,telemetryName:s})}:(e,t)=>{},openContextPane:m?async(t,s)=>{e.get(l.BladeOpener).openBlade(t,{selectable:m,flags:1,telemetryName:s})}:(e,t)=>{}}},t.getOrCreateCachedFxElement=function(e){var t;if(e){const s=$(e),o=f(s),n=(null===(t=null==o?void 0:o.internal)||void 0===t?void 0:t.elements)||ko.observableArray();return(0,i.getOrCreateFxElement)(s[0],n)}return null},t.getOrCreateOpenBladeSelectable=b})),
define("MsPortalImpl/Base/Base.Selectable2.ClickContext",["require","exports"],(function(e,t){"use strict";function s(){return MsPortalFx.require("../UI/Compositions/UI.Composition.Selectable2Registrar",e)}Object.defineProperty(t,"__esModule",{value:!0}),t.getSelectableWithClickHandler=t.getListSelectableWithClickHandler=void 0,t.getListSelectableWithClickHandler=function(e,t,i,o){const n=ko.observable();return{onClick:r=>{n()?n().onClick(r):s().then((s=>{n()||n(s.getListSelectableWithClickHandler(e,t,i,o)),n().onClick(r)}))},activationState:ko.pureComputed((()=>n()?n().activationState():{previous:void 0,current:void 0}))}},t.getSelectableWithClickHandler=function(e,t,i,o){const n=new FxImpl.TriggerableLifetimeManager,r=ko.observable();let a,l;function d(){s().then((s=>{if(!r()){const a=s.getSelectableWithClickHandler(e,ko.unwrap(t),i,o);a&&(a.registerForDispose(n),r(a))}r()&&(a&&(a=!1,r().onClick()),l&&(l=!1,r().isSelected(!0)))}))}return ko.isObservable(t)&&t.subscribe(n,(()=>{r(void 0)})),{isSelected:ko.computed(n,{read:()=>r()?r().isSelected():l,write:e=>{r()&&r().isSelected(e),e&&!l&&(l=!0,d())}}),isClickable:ko.pureComputed((()=>!!r()&&r().isClickable())),value:ko.pureComputed((()=>r()?r().value():void 0)),onClick:function(){r()?r().onClick():a||(a=!0,d())}}}})),
define("MsPortalImpl/Base/ClaimsIdentity",["require","exports","MsPortalImpl/Services/Services.Storage"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAvatarImage=void 0;var i=MsPortalFx.Base,o=i.Diagnostics,n=i.Net2;const r=o.createLog(e);t.getAvatarImage=function(e,t,i,o,a){let l=i;if(t){const d=s.ComponentName.Avatar,c=0;if(l=!a&&o.getValue(d,e,c),!l)return Q(n.ajax({uri:t,type:"GET",dataType:"binary",responseType:"arraybuffer",isBackgroundTask:!0,setAuthorizationHeader:{resourceName:"graph"}})).then((e=>function(e){const t=Q.defer(),s=new FileReader,i="data:image/jpeg;base64,";return s.onload=e=>{let s=e.target.result,o="";const n=new Uint8Array(s);for(let e=0;e<n.byteLength;e++)o+=String.fromCharCode(n[e]);try{atob(o),s=i+o}catch(e){if(5!==e.code)return void t.reject(e);s=i+btoa(o)}t.resolve(s)},s.onerror=e=>t.reject(FxImpl.createError("Error reading thumbnail photo. Error:"+s.error)),s.readAsArrayBuffer(e),t.promise}(e)),(e=>{const t=e.jqXHR&&e.jqXHR.status;return 404!==t&&403!==t&&r.warning(`Failed to get user's profile image. Status code: ${t}. Error: \n${e}`),i})).then((t=>(o.setValue(d,e,t,c),t)))}return Q(l)}})),
define("MsPortalImpl/Base/JQueryExtensions",["require","exports","MsPortalImpl/Base/JQueryHelper"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.focusableSelector=void 0;var i=s.findByClassName;const o=window.document,n=$.fn;function r(e){return function(i){return[t.focusableSelector].reduce(((t,o)=>t&&t.length?t:function(e,t,i){const o=MsPortalFx.find(e,(e=>{const t=$(e);return!t.hasClass("msportalfx-skip-initial-focus")&&!t.hasClass("fxs-display-none")&&!MsPortalFx.startsWith(t.attr("tabindex"),"-")&&s.isVisible(t)&&(!i||i(t))}),t?-1:0);return o?$(o):$([])}(this.find(o).toArray(),e,i)),null)}}t.focusableSelector="a[href], select, button, input, textarea, [tabindex]:not([tabindex='-1'])",n.setEvents=function(...e){let t=this;const s=function(s){const i=function(){return t[s].apply(t,arguments)};e.forEach((e=>{const t=e[0],s=e[1];if("function"==typeof s)i(t,s);else{const o=e[2];o&&i(t,s,o)}}))};return s("on"),{dispose:function(){t&&(s("off"),t=null)}}},n.findByClassName=function(e){return i(this,e)},n.findFirstTabbable=r(),n.findLastTabbable=r(!0),n.isInScrollView=function(e){let t;const s=e?this.closest("."+e):t=this.scrollParent();if(!s.length||!s[0].offsetParent||!s.is(t||this.scrollParent())&&!this.isInScrollView())return!1;const i=s.offset().top,o=i+s.height(),n=this.offset().top,r=n+this.height();return n>=i&&n<=o&&(r<=o&&r>=i)},n.handleTransitionEndOnce=function(e,t,s){let i,o=!1;this.on("transitionend",i=(t,...n)=>{const r=t&&t.originalEvent;r&&r.propertyName!==e||o||(o=!0,this.off("transitionend",i),s.apply(this,[t].concat(n)))});const n=function(){const t=$.Event("transitionend",{originalEvent:{propertyName:e}});i(t)};return $.fx.off?n():setTimeout(n,t),this},$.enableAnimations=function(e){const t="fxs-transition-off-style-head-marker",s=$(FxImpl.createElement("style")).addClass(t).text("* {transition: none !important;animation-iteration-count: .5 !important;animation-duration: 0s !important;animation-delay: 0s !important;}"),o=$.querySelectorAll("head");$.fx.off=!e,e?i(o,t).remove():0===i(o,t).length&&o.append(s)},$.querySelectorAll=function(e){return $(o.querySelectorAll(e))}})),
define("MsPortalImpl/Base/Languages",["require","exports","MsPortalImpl/Services/Services.Storage","MsPortalImpl/Services/Services.GeneralSettings"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initialize=t.currentLocaleContext=t.createLocaleContext=t.getCultureSpecificLanguage=t.getLocalizedName=t.localeDelimiter=t.redirectQueryKey=void 0;const o=window,n=MsPortalFx.forEachKey;t.redirectQueryKey="LocaleQuery",t.localeDelimiter=".";const r=s.ComponentName.Redirect;function a(e){const t=MsPortalFx.convertArrayToMap(e,(e=>e.locale.split("-")[0]));return n(FxImpl.knownCulturesMap,((e,s,i)=>{const o=e.split("-");o.length>1&&!s.neutralCulture&&t[o[0]]&&i.push(s)}),[])}function l(e){const t=e.displayLanguage,s=(i=e.selectableLanguages,o=FxImpl.knownCulturesMap,i.map((e=>o[e])).filter(MsPortalFx.identity));var i,o,n,r;return{selectableDisplayLanguages:s,selectedDisplayLanguage:t,selectedFormatCulture:(n=e.rawLocaleSetting,r=e.formatCulture,n?n.split(".")[1]:r),selectableFormatCultures:a(s)}}function d(e){const t=MsPortalImpl.sanitizeLanguage(e,o.fx.environment.supportedLanguages).split("."),s=t[0];return`${s}.${FxImpl.sanitizeFormatCulture(t[1],s)}`}t.getLocalizedName=function(e){const t=FxImpl.knownCulturesMap[e];return t?t.localizedName:null},t.getCultureSpecificLanguage=function(){const e=MsPortalFx.find(t.currentLocaleContext.selectableDisplayLanguages,(e=>!MsPortalFx.localeCompareIgnoreCase(e.locale,t.currentLocaleContext.selectedDisplayLanguage)));return e&&(e.specificCulture||e.locale)||"en-us"},t.createLocaleContext=l,t.initialize=function(e,n,a,c){const p={requireRedirect:!1,userSettingLocale:void 0,portalQueryLocale:void 0,desiredLocale:void 0,localeFromQuery:void 0},u=n.get(s.StorageService),m=n.get(i.GeneralSettings).rawLocale;return m.subscribeAndRun(e,(e=>{const s=(o.fx.bootParameters.portalQuery||{}).l,i=d(e||s),n=JSON.parse(u.getValue(r,t.redirectQueryKey,0)||"{}");n.l=i,u.setValue(r,"LastUsedLocale",i,0),c||i===d(a)||(p.requireRedirect=!0,p.userSettingLocale=e,p.portalQueryLocale=s,p.desiredLocale=i,p.localeFromQuery=d(a)),u.setValue(r,t.redirectQueryKey,JSON.stringify(n),0)})),t.currentLocaleContext=l({selectableLanguages:o.fx.environment.supportedLanguages.filter((e=>"qps-ploc"!==e)),displayLanguage:FxImpl.Intl.displayLanguage,formatCulture:FxImpl.Intl.formatCulture,rawLocaleSetting:m()}),p}})),
define("MsPortalImpl/Controls/ControlBindings.Async",["require","exports","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Controls/ControlBindings"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initialize=t.portalControlBindings=void 0;const i=[];function o(e,t,s,o){i.push({name:t,moduleId:e+s,initOptions:o})}function n(e,t,s){o("MsPortalImpl.Controls/",e,t,s)}function r(e,t,s){o("MsPortalImpl/Controls/",e,t,s)}const a={controlsDescendantBindings:!1};n("pcAccordion","Controls/Accordion"),n("pcButton","Controls/SimpleButton"),n("pcChart","Controls/Visualization/Chart"),n("pcCheckBoxField","Fields/CheckBoxField"),n("pcClipboardButton","Controls/ClipboardButton"),n("pcConsole","Controls/Console"),n("pcCopyableLabel","Controls/Forms/CopyableLabel"),n("pcCreatorAndSelectorV2","Fields/CreatorAndSelectorFieldV2"),n("pcCustomHtmlField","Fields/CustomHtmlField"),n("pcCustomValueSlider","Fields/CustomValueSliderField"),n("pcCustomRangeSlider","Fields/CustomRangeSlider"),n("pcDatePickerField","Fields/DatePickerField"),n("pcDateTimePickerField","Fields/DateTimePickerField"),n("pcDateTimeRangePickerField","Fields/DateTimeRangePickerField"),n("pcDayPickerField","Fields/DayPickerField"),n("pcDiffEditor","Controls/Documents/DiffEditor"),n("pcDockedBalloon","Controls/DockedBalloon"),n("pcDonut","Controls/Visualization/Donut"),n("pcDropDownField","Fields/DropDownField"),n("pcDurationPickerField","Fields/DurationPickerField"),n("pcEditor","Controls/Documents/Editor"),n("pcFilterComboField","Fields/FilterComboField"),n("pcFormSection","Fields/SectionField",a),n("pcGraph","Controls/Visualization/Graph"),n("pcGrid","Controls/Lists/Grid1/Grid1"),n("pcEditableGrid","Controls/Lists/Grid2/Grid2.EditableGrid.ctl"),n("pcArrayGrid","Controls/Lists/Grid2/Grid2.ArrayGrid.ctl"),n("pcDataGrid","Controls/Lists/Grid2/Grid2.DataGrid.ctl"),n("pcDocsControl","Controls/DocsControl"),n("pcPagedDataGrid","Controls/Lists/Grid2/Grid2.PagedDataGrid.ctl"),n("pcSequentialDataGrid","Controls/Lists/Grid2/Grid2.SequentialDataGrid.ctl"),n("pcPager","Controls/Pager"),n("pcPager2","Controls/Pager2"),n("pcHeatMap","Controls/HeatMap"),n("pcIFrame","Controls/IFrame"),n("pcIFrame2","Controls/IFrameV2"),n("pcLegend","Controls/Visualization/Legend"),n("pcList2","Controls/Lists/List2/ListView"),n("pcObsoleteListView1","Controls/Lists/List1/ListView1"),n("pcLogStream","Controls/LogStream"),n("pcMap","Controls/Visualization/Map"),n("pcMediaPlayer","Controls/AzureMediaPlayer"),n("pcMenu","Controls/Lists/Menu"),n("pcMetrics","Controls/Visualization/Metrics"),n("pcMonitorChart","Controls/Visualization/MonitorChartV2/MonitorChartV2"),n("pcMonitorChartV2","Controls/Visualization/MonitorChartV2/MonitorChartV2"),n("pcMetricGrid","Controls/Visualization/MonitorChartV2/MetricGrid"),n("pcMultiLineTextField","Fields/MultiLineTextField"),n("pcNumericTextBoxField","Fields/NumericTextBoxField"),n("pcOAuthButtonField","Fields/OAuthButtonField"),n("pcOptionsGroupField","Fields/OptionsGroupField"),n("pcPairedTimeline","Controls/Visualization/PairedTimeline"),n("pcPairedTimelineBadges","Controls/Visualization/PairedTimelineBadges"),n("pcPartPinner","Controls/PartPinner"),n("pcPasswordField","Fields/PasswordField"),n("pcPricingControl","Controls/PricingControl"),n("pcPreviewTag","Controls/PreviewTag"),n("pcProgressBar","Controls/Visualization/ProgressBar"),n("pcQuotaGauge","Controls/Visualization/QuotaGauge"),n("pcRangeSliderField","Fields/RangeSliderField"),n("pcSearchBox","Controls/SearchBox"),n("pcResourceFilter","Controls/ResourceFilter"),n("pcSection","Fields/Section"),n("pcSelectorField","Fields/SelectorField"),n("pcSimpleButton","Controls/SimpleButton"),n("pcSingleValueGauge","Controls/Visualization/SingleValueGauge"),n("pcSliderField","Fields/SliderField"),n("pcSpecComparisonTable","Controls/SpecComparisonTable"),n("pcSplitter","Fields/Splitter",a),n("pcSplitter2","Fields/Splitter2"),n("pcSummary","Controls/Summary"),n("pcTextBlock","Controls/TextBlock"),n("pcTextBox","Fields/TextField"),n("pcTextField","Fields/TextField"),n("pcTimePickerField","Fields/TimePickerField"),n("pcToolbar","Controls/Toolbars/Toolbar"),n("pcTreeView","Controls/Lists/Tree1/TreeView"),n("pcTriStateCheckBox","Fields/TriStateCheckBox"),n("pcMarkdown","Controls/Markdown"),n("pcVideo","Controls/Video"),n("pcRecommendations","Controls/Recommendations/Recommendations"),r("pcAsyncFileUpload","Forms/AsyncFileUpload"),r("pcDeleteAssetConfirmation","Controls.DeleteAssetConfirmation"),r("pcEssentials","Controls.Essentials"),r("pcFileDownloadButton","Controls.FileDownloadButton"),r("pcResourceDropDown","Forms/ResourceDropDown"),r("pcHeroBanner","Controls.HeroBanner"),r("pcHotSpot","Controls.HotSpot",a),r("pcInfoBox","Controls.InfoBox"),r("pcNotice","Controls.Notice"),r("pcPickerV3","Controls.PickerV3"),r("pcPill","Controls.Pill"),r("pcPillCollection","Controls.PillCollection"),r("pcPillList","Controls.PillList"),r("pcTagsByResource","Controls.TagsByResource"),r("pcWizard","Controls.Wizard"),r("pcIntuneAppFileUpload","Forms/IntuneAppFileUpload"),r("pcFileShareDropDown","Storage/FileShareDropDown"),r("pcArmErrorList","ArmErrorList/Controls.ArmErrorList"),r("pcStorageAccountDropDown","Storage/StorageAccountDropDown"),r("pcToggle","Controls.Toggle"),r("pcBlobContainerDropDown","Storage/BlobContainerDropDown"),r("pcGroupDropDownField","Forms/DropDown"),r("pcManagementGroupDropDown","Forms/HierarchicalDropDown"),n("pcTabMenu","Controls/Lists/TabMenu"),t.portalControlBindings=i,t.initialize=function(){t.portalControlBindings.forEach((e=>{ko.bindingHandlers[e.name]=s.getAsyncBindingHandler(e.moduleId,e.initOptions)}))}})),
define("MsPortalImpl/InitShellWorker",["require","exports","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Extension/Extension","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/Services/LazyUserData/LazyUserDataHelpers","MsPortalImpl/Services/Services.Subscriptions","MsPortalImpl/Services/Services.AssetTypes","ShellWorker/ExtensionWorkerPrewarmer","ShellWorker/IFrameExtensionLoader","ShellWorker/AuthorizationState","ShellWorker/Browse","ShellWorker/Locations","ShellWorker/Subscriptions","ShellWorker/GlobalResourceFilters","ShellWorker/UserInfo","ShellWorker/AssetTypes","ShellWorker/FeatureCards","ShellWorker/PreloadData"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g,h,f,x,b,v,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pushShellState=t.pushShellStateFromContainer=t.initWorker=t.initWorkerFromContainer=t.init=void 0;var M=MsPortalEarly.ExtensionLoader.getLoadType;function I(e,t){const a=new MessageChannel;FxImpl.localRpcPort=a.port1;const l=a.port2;return Promise.all([e.getAsync(r.AuthStateManager),e.getAsync(o.ExtensionManagerOptions),e.getAsync(n.InitializedManifestCache),e.getAsync(i.ManifestCache),e.getAsync(FxImpl.Rpc.Client),e.getAsync(s.ExtensionManager)]).then((([e,s,i,o,n])=>{const r=e.getCurrentUser();C({extensions:s.extensionsAsMap,manifests:FxImpl.mapValues(s.extensionsAsMap,(e=>o.getManifest(e.name,"assetTypes"))),extensionRedirectMap:s.extensionRedirectMap,authState:MsPortalFx.extend2(e,{userObjectId:r.objectId,userTenantId:r.tenantId})},l,t),function(e,t,s){null==s||s.registerForDispose((()=>{e=null})),t.onTokensUpdated((t=>{const{bootstrapState:s,tokenCache:i}=t,o=null==s?void 0:s.oAuthToken;e&&u.pushShellAuthTokensEndPoint.invoke(e,"fxw",{portalToken:o&&{header:o.authHeader,expiresAt:o.expiresInMs+s.createdOn},extensionTokens:i})})),(()=>{const t=Object.create(null);p.loadExtensionInIFrameEndPoint.register(e,"fxw",(s=>{let i;const o=new Promise((e=>{i=t=>{e({telemetry:MsPortalFx.extend2(r.telemetry,{loadType:0}),error:t})}})),n=e.detachPort("fxw",s.portId),r=new MsPortalEarly.ExtensionLoader.IFrameLoadContext(Object.assign(Object.assign({},s),{errorHandler:i,port:n}));return r.initializeReceived.then((()=>{i()})),r.startLoad(),t[s.iframeId]=()=>{r.cleanup(),delete t[s.iframeId]},o})),p.disposeExtensionIFrameEndPoint.register(e,"fxw",(({iframeId:e})=>{const s=t[e];null==s||s()}))})(),(()=>{const t=Object.create(null);null==s||s.registerForDispose((()=>{MsPortalFx.forEachKey(t,(e=>{t[e].terminate()}))}));const i=s?MsPortalEarly.ExtensionLoader.createPrewarmer():MsPortalEarly.ExtensionLoader.prewarmer;i.setListener({onCreated:({workerId:s,bootstrapPort:i,terminate:o})=>{let n;if(t[s]={terminate:()=>{null==n||n(),o()}},e){const t=e.acquireWindow("fxw",0,i);n=()=>{t.dispose()},c.pushNewWorkerEndPoint.invoke(e,"fxw",{workerId:s,portId:t.value})}},onBootComplete:(s,i)=>{e&&t[s]&&c.onWorkerBootCompleteEndPoint.invoke(e,"fxw",{workerId:s,error:i}),i&&delete t[s]}}),c.terminateWorkerEndPoint.register(e,"fxw",(({workerId:e})=>{const s=t[e];delete t[e],null==s||s.terminate()})),c.onGetWorkerCalledEndPoint.register(e,"fxw",(()=>{i.onGetWorkerCalled()}))})()}(n,e,t)}))}function C(e,t,s){const i={onBootstrapError:e=>{MsPortalFx.Base.Diagnostics.Log.writeEntry2(2,"InitShellWorker",e.error||"unknown error from worker",9999,e.message&&[e.message])},uploadDiagnostics:e=>{const{telemetryEvent:t,logEntry:s,flush:i}=e;t&&MsPortalFx.Base.Diagnostics.Telemetry.trace(t),s&&MsPortalFx.Base.Diagnostics.Log.writeEntry2(s.level,s.area,s.message,s.code,s.args),1&i&&MsPortalFx.Base.Diagnostics.Telemetry.flush(),2&i&&MsPortalFx.Base.Diagnostics.Upload.flush()}};MsPortalEarly.ShellWorkerLoader.initWorker(function(e){var t;const{extensions:s,manifests:i,extensionRedirectMap:o,authState:n}=e,r=Object.keys(s).reduce(((e,t)=>(256&s[t].flags||(e[t]=s[t]),e)),{}),a=Object.keys(r).reduce(((e,t)=>(e[t]=i[t],e)),{}),{host:l,protocol:d,origin:c,pathname:p}=location,{bootstrapState:u,tokenCache:m,userObjectId:g,userTenantId:h}=n,f=-1!==((null===(t=null===fx||void 0===fx?void 0:fx.environment)||void 0===t?void 0:t.writesDisallowedTenants)||[]).indexOf(h),x=null==u?void 0:u.oAuthToken,b={portalToken:x&&{header:x.authHeader,expiresAt:x.expiresInMs+u.createdOn},extensionTokens:m||{},userObjectId:g,isWritesDisallowedTenant:f},v=fx.internalEnv,y=fx.environment;return{internalEnv:v,environment:MsPortalFx.extend2(y,{requireConfig:MsPortalFx.extend2(v.fxRequireConfig,{deps:[]})}),location:{host:l,protocol:d,origin:c,pathname:p},shellFeatures:FxImpl.features.shellFeatures,initOptions:{extensions:r,manifests:FxImpl.mapValues(a,(({pageVersion:e,prewarmerScript:t,weaveBladesMap:s,enableExperimentation:i})=>({pageVersion:e,prewarmerScript:t,weaveBladesMap:s,enableExperimentation:i}))),loadTypes:FxImpl.mapValues(a,(({flags:e},t)=>M(r[t],e))),extensionRedirectMap:o,authorizationState:b,effectiveLocale:FxImpl.Intl.effectiveLocale},userQuery:MsPortalEarly.userQuery}}(e),t,i,s)}function P(e,t){const s=e.getAsync(l.SubscriptionsUserContext),i=e.getAsync(l.ServicesSubscriptions);w(e.get(FxImpl.Rpc.Client),{locations:(0,a.lazyUserDataMemo)(e).then((({locations:e})=>e.value)),preloadedData:MsPortalEarly.preload,startupSubscriptionsInfo:i.then((e=>e.startupSubscriptionsInfoMemo())).then((({subscriptionsMap:e})=>({subscriptions:FxImpl.mapValues(e,(({subscription:e})=>e))}))),subscriptionsCount:s.then((e=>e.getAllSubscriptionsCount())),inSessionSelectedSubscriptions:s.then((e=>e.getInSessionSelectedSubscriptions())),userInfo:e.getAsync(r.AuthStateManager).then((e=>e.getUserInfo())),assetTypes:e.getAsync(d.AssetTypeService).then((e=>(0,d.assetTypesMemo)(e))),globalSelectedSubscriptions:s.then((e=>e.useGlobalResourceFiltersPromise)).then((e=>e?i.then((e=>e.globalSelectedSubscriptionsObservable)):void 0)),globalResourceFilter:(async()=>{const t=await s;if(await t.useGlobalResourceFiltersPromise)return MsPortalFx.require("MsPortalImpl/Services/Services.GlobalResourceFilters").then((t=>e.getAsync(t.ResourceFilterManager))).then((e=>e.currentFilterObservable))})(),featureCards:e.getAsync(d.AssetTypeService).then((e=>(0,d.featureCardsMemo)(e)))},t)}function w(e,t,s){var i,o,n,r,a,l,d,c,p;null==s||s.registerForDispose((()=>{e=null}));const{preloadedData:u}=t;if(u){const t=MsPortalFx.require("MsPortalImpl/Services/Services.Settings");u.then((async s=>{var i,o,n;e&&y.pushPreloadDataEndPoint.invoke(e,"fxw",{variants:null==s?void 0:s.variants});const r=null==s?void 0:s.settings,{Internal:a,SettingStore:l}=await t,d=a.getSettingStoreName(15),c={15:null===(i=null==r?void 0:r[d])||void 0===i?void 0:i.browse_columns,6:null===(o=null==r?void 0:r[a.getSettingStoreName(6)])||void 0===o?void 0:o.browse_columns},p=null===(n=null==r?void 0:r[d])||void 0===n?void 0:n.favorite_views;e&&m.pushBrowseMetadataEndPoint.invoke(e,"fxw",{columns:c,favoriteViewIds:p,browseManifestsUri:MsPortalEarly.siteRelUriToAbsolute(MsPortalEarly.getCachedManifestUri("assetTypesBrowse"))})}))}null===(i=t.locations)||void 0===i||i.then((t=>{const s=MsPortalFx.extendArrayIntoMap(Object.create(null),t,(e=>e.name),(e=>{const t=e.metadata||{};return{displayName:e.displayName,latitude:t.latitude,longitude:t.longitude}}));e&&g.pushLocationsEndPoint.invoke(e,"fxw",s)})),null===(o=t.inSessionSelectedSubscriptions)||void 0===o||o.then((t=>{t.subscribeAndRun(new FxImpl.TriggerableLifetimeManager,(t=>{e&&t&&h.pushSelectedSubscriptionsEndpoint.invoke(e,"fxw",{inSession:t})}))})),null===(n=t.globalSelectedSubscriptions)||void 0===n||n.then((t=>{null==t||t.subscribe(new FxImpl.TriggerableLifetimeManager,(t=>{e&&h.pushGlobalFilterSubscriptionsEndpoint.invoke(e,"fxw",t)}))})),null===(r=t.globalResourceFilter)||void 0===r||r.then((t=>{null==t||t.subscribeAndRun(new FxImpl.TriggerableLifetimeManager,(t=>{e&&t&&f.pushActiveGlobalResourceFilterEndPoint.invoke(e,"fxw",t)}))})),null===(a=t.startupSubscriptionsInfo)||void 0===a||a.then((t=>{e&&h.pushStartupSubscriptionsEndpoint.invoke(e,"fxw",t)})),null===(l=t.subscriptionsCount)||void 0===l||l.then((t=>{e&&h.pushSubscriptionsCountEndpoint.invoke(e,"fxw",t)})),null===(d=t.userInfo)||void 0===d||d.then((t=>{e&&x.pushUserInfoEndpoint.invoke(e,"fxw",t)})),null===(c=t.assetTypes)||void 0===c||c.then((t=>{e&&b.pushAssetTypesEndPoint.invoke(e,"fxw",t)})),null===(p=t.featureCards)||void 0===p||p.then((t=>{const s=Object.create(null);t.forEach(((e,t)=>s[t]=e)),e&&v.pushFeatureCardsEndPoint.invoke(e,"fxw",s)}))}t.init=function(e,t){I(e,t).then((()=>{P(e,t)}))},t.initWorkerFromContainer=I,t.initWorker=C,t.pushShellStateFromContainer=P,t.pushShellState=w})),
define("_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler.css",["module"],(function(e){"use strict";return{css:".fxs-keyboardshortcuts{width:355px;height:100%;max-width:100%}.fxs-keyboardshortcuts-scrollcontent{padding-top:10px;overflow:auto;height:100%}.fxs-keyboardshortcuts-category{margin-top:20px}.fxs-keyboardshortcuts-shortcut{display:flex}.fxs-keyboardshortcuts-key{flex:0 0 auto;width:113px}",moduleId:e.id}})),
define("MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler",["require","exports","Fx/DependencyInjection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/UI/Commands/Base.PortalFunctions","MsPortalImpl/Widgets/Widgets.Portal","MsPortalImpl/Base/Base.Router","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Base/Base.DeepLink","FxInternal/Css","_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler.css"],(function(e,t,s,i,o,n,r,a,l,d,c,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fakeMacOS=t.setup=t.KeyboardShortcutHandler=void 0,(0,c.injectCss)(p);var u=MsPortalFx.Base.Diagnostics,m=u.Telemetry;const g=window,h="#blade/HubsExtension/BrowseAllResourcesBlade/resourceType/Microsoft.Resources%2Fresources",f="#blade/HubsExtension/BrowseResourceGroupBlade/resourceType/Microsoft.Resources%2Fsubscriptions%2FresourceGroups";let x=l.isMac;const b=i.KeyboardShortcuts,v=b.GoTo,y=u.createLog(e),M=m.trace,I=[49,50,51,52,53,54,55,56,57,48],C=[97,98,99,100,101,102,103,104,105,96];function P(e){const t=function(e){return"Journey"===e.getDisplayMode()&&e.getJourneyWidget()}(e);let s=t&&t.getFocusedBlade();return s=s||t&&MsPortalFx.last(t.getBlades()),s}let w=class{static create(e,t,s,i,o){return _(e,t,(()=>s.invoke()),(()=>i.invoke()),(()=>o.invoke()),null,g.fx.environment.chrome.hideShortcuts)}};function _(e,t,s,i,o,n,r){return new S(e,t,s,i,o,n,r)}__decorate([__metadata("fx:diagnostics",[e,"KeyboardShortcutHandler"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[r.ViewModel,a.Router,n.DownloadDiagnosticsJson,n.ShowDebugTools,n.ShowTelemetryInsights]),__metadata("design:returntype",w)],w,"create",null),w=__decorate([__metadata("fx:diagnostics",[e,"KeyboardShortcutHandler"]),s.Class()],w),t.KeyboardShortcutHandler=w,t.setup=_,t.fakeMacOS=function(){x=!0};class S{constructor(e,t,s,i,o,n,r){this._keyShortcuts={},this._goToShortcuts={},this._eventHandlers=[],this._errorLoggingFunc=n||(e=>{y.error(e)}),this._registerShortcut(b.showDiagnostics,s,65,9),this._registerShortcut(b.showDebugHelper,i,68,9),MsPortalFx.isFeatureEnabled("telemetryinsights")&&this._registerShortcut(b.showTelemetryOverlay,o,84,9),r||(this._addKeyShortcuts(e),this._addGoToShortcuts(t,e),this._registerShortcut(b.moveFavoritesUp,(()=>{e.sideBar.reorderFavorites(38)}),38,5),this._registerShortcut(b.moveFavoritesDown,(()=>{e.sideBar.reorderFavorites(40)}),40,5)),this._attachEventHandlers()}dispose(){this._removeEventHandlers()}_attachEventHandlers(){this._removeEventHandlers();let e=!1;const t=this._eventHandlers;t.push({eventType:"keydown",handler:t=>{if(t.repeat)return;const s=o.getModifierKeys(t),i=t.keyCode;if(71===i&&0===s)return void(e=!0);const n=e?this._goToShortcuts[i]:this._keyShortcuts[i],r=n&&n[s];if(!r)return;const a=$(document.activeElement);a.length>0&&0===s&&(a.is("input")||a.is("textarea")||["azc-editableControl","fxc-editor","fxc-console"].some((e=>a.closest("."+e).length>0)))||(r.handler(),M({source:"KeyboardShortcuts",action:"KeyboardShortcutExecuted",name:r.id}),t.preventDefault())}},{eventType:"keyup",handler:t=>{71===t.keyCode&&(e=!1)}}),t.forEach((e=>{g.document.addEventListener(e.eventType,e.handler)}))}_removeEventHandlers(){this._eventHandlers.forEach((e=>{g.document.removeEventListener(e.eventType,e.handler)}))}_registerShortcut(e,t,s,i=0){const o=this._keyShortcuts[s];let n=i;x&&8&n&&e!==b.showDebugHelper&&(n=8^n|2);const r=this._generateIdForKeyboardShortcut(s,n),a={description:e,handler:t,id:r};o?o[n]&&this._errorLoggingFunc("Duplicate shortcut: "+r):this._keyShortcuts[s]=[],this._keyShortcuts[s][n]=a}_addKeyShortcuts(e){this._registerGotoShortcut(b.toggleFocusSideAndTopBar,(()=>{const e=$(document).findByClassName("fxs-topbar-home")[0],t=$(document).findByClassName("fxs-topbar-sidebar-collapse-button")[0];$(document.activeElement)[0]===e?$(t).is(":visible")?t.focus():$(document).findByClassName("fxs-sidebar-collapse-button")[0].focus():e.focus()}),190),this._registerGotoShortcut(b.moveFocusToCommandBar,(()=>{const t=P(e),s=t&&t.getContentWidget();s&&s.setFocusOnCommandBar()}),188),this._registerShortcut(b.bladeSearch,(()=>{const t=P(e);t&&t.focusSearchBox()}),191,8),this._registerShortcut(b.bladeSearch,(()=>{const t=P(e);t&&t.focusSearchBox()}),55,12)}_registerGotoShortcut(e,t,s){const i=this._goToShortcuts[s],o=this._generateIdForKeyboardShortcut(s,0,!0),n={description:e,handler:t,id:o};i?i[0]&&this._errorLoggingFunc("Duplicate goto shortcut: "+o):this._goToShortcuts[s]=[],this._goToShortcuts[s][0]=n}_addGoToShortcuts(e,t){this._registerGotoShortcut(b.browse,(()=>{g.location.href=(0,d.getAllServicesDeeplink)()}),66),this._registerGotoShortcut(b.new,(()=>{t.sideBar.openCreate()}),78),this._registerGotoShortcut(b.search,(()=>{t.topBar.searchViewModel.setFocus()}),191),[[v.allResources,h,65],[v.resourceGroups,f,82]].forEach((t=>{this._registerGotoShortcut(t[0],(()=>{e.route(t[1],{openedBy:8})}),t[2])})),this._registerGotoShortcut(v.dashboard,(()=>{e.navigateWithRoute("dashboard",null,{interactionSource:"KeyboardShortcuts"})}),68);const s=(e,s)=>{const i=s+1;this._registerGotoShortcut(v.sideBarItem+i,(()=>{t.sideBar.openFavorite(s)}),e)};I.forEach(s),C.forEach(s)}_generateIdForKeyboardShortcut(e,t,s=!1){let i=s?"G+":"";return t>15&&this._errorLoggingFunc("Not allowed modifier!"),8&t&&(i+="CTRL+"),1&t&&(i+=x?"OPT+":"ALT+"),2&t&&(i+=x?"CMD+":"WIN+"),i+=o.mapKeyCodeToString(4==(4&t),e),i}getShortcuts(){return{key:this._keyShortcuts,goTo:this._goToShortcuts}}}})),
define("_generated/Less/MsPortalImpl/Interactions/Interactions.PrintHandler.css",["module"],(function(e){"use strict";return{css:'@media print{html,#web-container{-webkit-print-color-adjust:exact;color-adjust:exact}body{color-adjust:economy;background:none !important}@page{margin:.4in .2in}.fxs-show-startboard{background-color:inherit}pre,blockquote,tr,img,svg,[role="row"],[role="figure"],[role="img"],.fxc-chart{break-inside:avoid}p,h2,h3,h4,h5,h6{orphans:3;widows:3}h2,h3,h4,h5,h6{break-after:avoid}.fxs-blade,.fxs-blade-content-container,.fxs-blade-content-wrapper{display:block !important}.fxs-journey-target,.fxs-journey-layout,.fxs-bladecontent{display:block !important}.fxs-blade-content-container-default,.fxs-blade-content-container-details{width:100% !important}.fxs-portal-main,.fxs-portal-content{flex:0 0 auto;display:block !important}.fxs-panorama{width:100%}#web-container,.fxs-home-target,.fxs-startboard-target,.fxs-sidebar-flyout,.fxs-journey-target{position:static !important}body,#web-container,.fxs-panorama,.fxs-home-target,.fxs-startboard-target,.fxs-sidebar-flyout,.fxs-journey-target,.fxs-journey-layout,.fxs-blade-content-wrapper{overflow:visible !important}.fxs-menublade .fxs-blade-content-container-default{display:none !important}.fxs-tabmenublade .fxs-blade-content-container-default{display:none !important}.fxs-blade{box-shadow:none !important;width:100% !important}.fxs-blade:not(:last-of-type){display:none !important}.fxs-bladecontent-unlocked{background-color:transparent !important}html.fxs-printbladerequest .fxs-blade:not(.fxs-bladetoprint){display:none !important}html.fxs-printbladerequest .fxs-blade.fxs-bladetoprint{display:block !important}.fxs-startboard-layout{padding:25px}}.fxs-printmaxwidth{max-width:750px}',moduleId:e.id}})),
define("MsPortalImpl/Interactions/Interactions.PrintHandler",["require","exports","Fx/DependencyInjection","MsPortalImpl/Widgets/Widgets.Portal","FxInternal/Css","_generated/Less/MsPortalImpl/Interactions/Interactions.PrintHandler.css"],(function(e,t,s,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PrintHandler=void 0,(0,o.injectCss)(n);const r=window,a=MsPortalFx.Base.Diagnostics.Telemetry,l=r.document.documentElement;let d=class{constructor(e){this._portalVm=e}init(e){const t=this._portalVm,s=()=>{const e=t.displayMode.value;let s=this._telemetryName||`Shell/${e}`;const i=this._telemetrySource||"BrowserCommand";let o=this._menuBladeCtx;if("Shell/Journey"===s){const e=MsPortalFx.last(t.getJourneyWidget().getBlades());e&&(s=e.getContentWidget().options.getTelemetryName(),o=e.options.isMenuBlade.peek()?e.options.getTelemetryName():null)}const n={action:"PrintRequest",source:i,name:s,data:{displayMode:e,menuBladeCtx:o}};return this._telemetryName=null,this._telemetrySource=null,this._menuBladeCtx=null,n},i=()=>{$.querySelectorAll(".fxs-bladetoprint").removeClass("fxs-bladetoprint"),l.classList.remove("fxs-printbladerequest"),$.querySelectorAll(".fxs-vivaresize:not(.fxs-journey):not(.fxs-blade):not(.fxs-bladecontent):not(.fxs-blade-content)").removeClass("fxs-printmaxwidth"),t.getJourneyArea().trigger("fxbladerepos")},o=()=>{a.trace(s()),"Dashboard"!==this._portalVm.getDisplayMode()&&c()};r.addEventListener("beforeprint",o),r.addEventListener("afterprint",i),e.registerForDispose((()=>{r.removeEventListener("afterprint",i),r.removeEventListener("beforeprint",o)}))}printBlade(e,t){this._telemetryName=t.name,this._telemetrySource=t.source,this._menuBladeCtx=t.menuBladeCtx,l.classList.add("fxs-printbladerequest"),e.classList.add("fxs-bladetoprint"),c(),Q.delay(333).then(r.print)}printDashboard(){this._telemetryName="Shell/Dashboard",this._telemetrySource="Dashboard",r.print()}};function c(){$.querySelectorAll(".fxs-vivaresize:not(.fxs-journey):not(.fxs-blade):not(.fxs-bladecontent):not(.fxs-blade-content)").addClass("fxs-printmaxwidth")}d=__decorate([__metadata("fx:diagnostics",[e,"PrintHandler"]),s.Class(),__metadata("design:paramtypes",[i.ViewModel])],d),t.PrintHandler=d})),
define("MsPortalImpl/Interactions/Interactions.Command",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CommandImpl=t.FileInputOptions=t.CommandContext=void 0;t.CommandContext=class{constructor(e,t){this.target=e,this.getFormTarget=t}};t.FileInputOptions=class{constructor(e,t){this.accept=e,this.maxFiles=t,this.files=ko.observable(null)}};t.CommandImpl=class{constructor(e,t,s){this._ariaLabel=ko.observable(),this._inheritIcon=ko.observable(),this.fxEnabled=ko.observable(!0),this.hasPopup=ko.observable(!1),this.ariaLabel=this._ariaLabel,this.enabled=ko.observable(!0),this.visible=ko.observable(!0),this.unauthorized=ko.observable(!1),this.pressed=ko.observable(),this.fileInputOptions=ko.observable(null),this.tooltip=ko.observable(),this.isShellCommand=!1;const i=this._ltm=e.createChildLifetime();this.text=ko.isObservable(t)?t:ko.observable(t||""),this.enabled(void 0===s||s),this.icon=ko.computed(i,{read:this._inheritIcon,write:e=>this._inheritIcon(e&&MsPortalFx.extend2(e,{options:$.extend({palette:99},e.options)}))})}get canRebind(){return!0}activate(){}execute(e){}bind(e){const t=e&&e.getFormTarget;e.getFormTarget=()=>t().then((t=>{if(t&&"function"!=typeof t.showForm)throw new Error("invalid context"+JSON.stringify(e,((e,t)=>e+typeof t)));return t})),this._currentContext=e}dispose(){this._ltm.dispose()}}})),
define("MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDynamicBindingWithNonLocalSource=t.isOverridesOrContainerModelSourceReference=t.inferredReferenceType=t.extractTraceOptions=t.mapSourceModelToTargetModel=t.PropertyBindings=t.setModelValue=t.getModelValue=t.PropertyBinding=t.PropertyTransformerArgs=t.ObservableChangeArgs=t.ReferenceCardinality=t.ReferenceScope=void 0;var s=FxImpl.TriggerableLifetimeManager;const i=MsPortalFx.Base.Diagnostics.createLog(e),o=MsPortalFx.trace.inputsset,n=Array.prototype.splice,r=FxImpl.quickApplyArrayEdits,a=MsPortalFx.applyCall;function l(e,t,...s){return a(n,this,[e,t].concat(s.map(ko.toJS)))}var d;!function(e){e[e.CurrentContainer=0]="CurrentContainer",e[e.MasterContainer=1]="MasterContainer",e[e.DetailsContainer=2]="DetailsContainer"}(d=t.ReferenceScope||(t.ReferenceScope={})),function(e){e[e.OneToOne=0]="OneToOne",e[e.OneToMany=1]="OneToMany",e[e.ManyToOne=2]="ManyToOne"}(t.ReferenceCardinality||(t.ReferenceCardinality={}));class c{constructor(e,t){this.kind=e,this.propertyName=t}static forObject(e,t,s){const i=new c(0,e);return i.propertyValue=t,i.propertyOldValue=s,i}static forArray(e,t){const s=new c(1,e);return s.propertyArrayEdits=t||[],s}static forNewArray(e,t){const s=new c(1,e);return s.propertyValue=t,s}}t.ObservableChangeArgs=c;class p{constructor(e,t,s,i,o){this.cancel=!1,this.propertyChanges=[],this.sourceModelId=e,this.sourceModel=t,this.sourceProperty=s,this.targetModel=i,this.targetProperty=o}}t.PropertyTransformerArgs=p;class u{constructor(e,t,s,i,n,r){this.transformers=[],this.compositionBindingDefinition=null,this._callbacks=$.Callbacks(),this._errCallbacks=$.Callbacks(),this._awaitBound=Q.defer(),this._tgtHasValue=!1,this.sourceProperty=e,this.targetProperty=t,this.targetModel=s,this._tgtModelName=i,this.transformers=n,this._tgtPropExists=r,this._traceOptions=f(i,o)}sourceModelName(){return this._srcModelName}get sourceModel(){return this._srcModel}get isBound(){return!!this._srcModel}get awaitBound(){return this._awaitBound.promise}get targetHasValue(){return this._tgtHasValue}addValueChangedHandler(e){e&&this._callbacks.add(e)}removeValueChangedHandler(e){this._callbacks.remove(e)}addErrorHandler(e){e&&this._errCallbacks.add(e)}bind(e,t,i=!0,o,n){if(!this.isBound){if(this.addValueChangedHandler(o),this.addErrorHandler(n),this._validateBinding(e,t)){this._srcModelName=e,this._srcModel=t;const o=this._getSrcValue(),n=ko.utils.peekObservable(o);let r;if(i&&void 0!==n&&this._changeTgtModel(c.forObject(this.targetProperty,n)),ko.isObservable(o)){let e;r=o,this._bindingLifetime=new s,r.subscribe(this._bindingLifetime,(t=>{let s,i,o;Array.isArray(t)?(i=t,s=t.slice(0)):s=t,(r.splice||r.map)&&(o="arrayChange"),e&&e.dispose(),e=this._bindingLifetime.createChildLifetime(),r.subscribe(e,(t=>{let n;if(e.dispose(),e=void 0,"arrayChange"===o&&(n=t,t=r()),Array.isArray(s)&&Array.isArray(t))if(i===t){n=n||ko.utils.compareArrays(s,t,{sparse:!0});const e=c.forArray(this.targetProperty);e.propertyArrayEdits=ko.utils.adjustArrayEdits(n),this._changeTgtModel(e)}else this._changeTgtModel(c.forNewArray(this.targetProperty,t));else this._changeTgtModel(c.forObject(this.targetProperty,r(),s))}),null,o)}),null,"beforeChange")}else i||this._err("Error when binding. The value is not an observable and importInitialValue is false.");this._awaitBound.resolve()}else this._awaitBound.reject();return this}this._err("Property binding is already bound.")}unbind(){this._bindingLifetime&&this._bindingLifetime.dispose(),this._srcModel=null,this._srcModelName=null,this._callbacks.empty(),this._errCallbacks.empty()}toString(){return"\n\nDetails:\nSource model id: '{0}'.\nSource property: '{1}'.\nTarget model id: '{2}'.\nTarget property: '{3}'.\nSource model: '{4}'.\nTarget model: '{5}'.".format(this._srcModelName||"<UNBOUND>",this.sourceProperty,this._tgtModelName,this.targetProperty||"<DYNAMIC>",this._srcModel?h(this._srcModel):"<UNBOUND>",h(this.targetModel))}_changeTgtModel(e){const t=new p(this._srcModelName,this._srcModel,this.sourceProperty,this.targetModel,this.targetProperty);let s,i;e&&t.propertyChanges.push(e),this._processTransformers(t)&&((t.propertyChanges||[]).forEach((e=>{if(e.propertyName){const t=this._traceOptions;if(0===e.kind)this._tgtHasValue=void 0!==e.propertyValue,x(t,e.propertyName,e.propertyValue),g(this.targetModel,e.propertyName,ko.toJS(e.propertyValue));else{s=m(this.targetModel,e.propertyName).value,i=ko.unwrap(s);const o=e.propertyArrayEdits;if(Array.isArray(i)){if(o)t&&t.verbose&&o.forEach((s=>{"added"===s.status&&x(t,e.propertyName,s.value)})),ko.isObservable(s)&&s.valueWillMutate(),this._tgtHasValue=!0,r(i,o,{inplaceFixup:!1,spliceFunc:l}),ko.isObservable(s)&&s.valueHasMutated();else if(e.propertyValue){this._tgtHasValue=!0;const t=e.propertyValue;s.splice?s.splice.apply(s,[0,i.length].concat(t)):s(t)}}else this._err("[Property Binding] Array change detected on source property, but target property is not an array.")}}})),this._callbacks.fire(t.propertyChanges))}_processTransformers(e){return this.transformers.some((t=>(t(e),e.cancel))),!e.cancel}_getSrcValue(){return m(this._srcModel,this.sourceProperty).value}_validateBinding(e,t){let s;const i=this.compositionBindingDefinition,o=!(i&&i.optional);return this._validateModel(e,t,this.sourceProperty,o,(e=>{s=e}))?this.sourceProperty?this._validateModel(this._tgtModelName,this.targetModel,this.targetProperty,this._tgtPropExists,(e=>{s=e}))||(s="[Property Binding] Invalid target model - {0}".format(s)):s="[Property Binding] Invalid source model - Source property must be defined.":s="[Property Binding] Invalid source model - {0}".format(s),s&&this._err(s),!s}_validateModel(e,t,s,i,o){let n;return e?t?s&&i&&!m(t,s).exists&&(n="Model is missing property '{0}'.".format(s)):n="Model is undefined.":n="Model is missing an identifier.",n&&o&&o(n+"\nModel id: '{0}'.".format(e||"N/A")),!n}_err(e){this.isBound&&(e+=""+this);const t=MsPortalFx.trace;(MsPortalFx.isDevelopmentMode||t&&t.diagnostics)&&i.error(e),this._errCallbacks.fire(e)}}function m(e,t,s){const i=t?t.split("."):[],o={exists:e&&i.length>0,value:void 0};let n=e,r=0;const a=s?ko.utils.peekObservable:ko.unwrap;for(;o.exists&&r<i.length;)n=a(n),n&&n.hasOwnProperty(i[r])?n=n[i[r]]:o.exists=!1,r++;return o.exists&&(o.value=n),o}function g(e,t,s){const i=s=>{if(!s||"object"!=typeof s)throw new Error(function(e,t){const s=h(t);return s?"{0}\nModel: '{1}'".format(e,s):e}("A property in model hierarchy is not an object. Path: '{0}'.".format(t),e));return s},o=t.split(".");let n,r=i(e);for(let e=0;e<o.length-1;e++)n=o[e],MsPortalFx.isNullOrUndefined(r[n])&&(r[n]={}),r=i(ko.unwrap(r[n]));n=MsPortalFx.last(o),r[n]&&ko.isObservable(r[n])?r[n](s):r[n]=s}function h(e){let t;try{t=ko.toJSON(e)}catch(e){return e.message}return t}t.PropertyBinding=u,t.getModelValue=m,t.setModelValue=g;function f(e,t){if(!t)return;const s=e.toLowerCase(),i=e=>!(!MsPortalFx.isPlainObject(e)||MsPortalFx.isEmptyObject(e))&&Object.keys(e).every((e=>s.indexOf(e.toLowerCase())>=0)),o=i(t.debug),n=i(t.log),r=i(t.verbose);let a;return(n||o||r)&&(a={debugId:e,breakOnInputsSet:o,verbose:r}),a}function x(e,t,s){e&&e.verbose&&!MsPortalFx.canSendThroughPostMessage(s)&&i.verbose("Inputs should be simple data objects without functions/observables: {0} | {1} | {2}".format(e.debugId,t,ko.toJSON(s)))}function b(e){return e&&e.modelType===t.inferredReferenceType}t.PropertyBindings=class{constructor(e,t,s){this._properties=[],this._propertyChangedCallbacks=$.Callbacks(),this._aggregatePropertyChangedHandler=e=>{this._propertyChangedCallbacks.fire(e)},this._targetModel=t,this._targetModelName=e,this._validateTargetPropertiesExist=!1!==s}get properties(){return this._properties.slice(0)}get targetModelName(){return this._targetModelName}get targetModel(){return this._targetModel}get awaitAllBound(){const e=this._properties.map((e=>e.awaitBound));return Q.all(e)}get allBound(){return this.properties.every((e=>e.isBound))}addPropertyChangedHandler(e){this._propertyChangedCallbacks.add(e)}addProperty(e,...t){const s=new u(e,e,this._targetModel,this._targetModelName,t,this._validateTargetPropertiesExist);return s.addValueChangedHandler(this._aggregatePropertyChangedHandler),this._properties.push(s),s}mapProperty(e,t,...s){const i=new u(e,t,this._targetModel,this._targetModelName,s,this._validateTargetPropertiesExist);return i.addValueChangedHandler(this._aggregatePropertyChangedHandler),this._properties.push(i),i}removeProperty(e){const t=this._properties.indexOf(e);t>=0&&(this._properties[t].unbind(),this._properties[t].removeValueChangedHandler(this._aggregatePropertyChangedHandler),this._properties.splice(t,1))}getProperty(e){return MsPortalFx.find(this._properties,(t=>t.targetProperty===e))}unbind(){this._properties.forEach((function(e){e.unbind()})),this._propertyChangedCallbacks.empty()}toString(){let e="";const t=this.properties,s=this.properties.length;for(let i=0;i<s;++i)e+="properties[{0}]: {1}".format(i,t[i].toString());return e}},t.mapSourceModelToTargetModel=function(e,t,s,i){const n=f(i,o),r={};return Array.isArray(t)&&t.forEach((t=>{const i=t.source,o=t&&i&&i.scope===d.CurrentContainer&&i.modelType===s&&m(e,i.property);o&&o.exists&&(x(n,t.targetProperty,o.value),g(r,t.targetProperty,ko.toJS(o.value)))})),r},t.extractTraceOptions=f,t.inferredReferenceType=-999,t.isOverridesOrContainerModelSourceReference=b,t.isDynamicBindingWithNonLocalSource=function(e){return e.isDynamicBinding&&!b(e.source)}})),
define("MsPortalImpl/UI/Compositions/UI.Composition.BladeOpenerBase",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Base.ImplUtils","FxHubs/ResourceManagement","MsPortalImpl/Base/Telemetry","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition.Finder","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding"],(function(e,t,s,i,o,n,r,a,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.traceInvocationChange=t.bindOutputsToSelectable2=t.detailsIsPartContainer=t.getAssociatedDetailDefinition=t.mapDynamicSelectionToBladeLocator=t.validateDetailsDefinition=t.needContainerSelectable=t.getSelectablePath=t.isSelectableLocked=t.isSelectableSet=t.isSelectable=t.Resources=t.OpenerConfiguration=t.Configuration=t.DefaultConfiguration=t.PartContainerSelectableValue_ViewModelPath=t.PartContainerSelectable_ViewModelPath=void 0;var c=MsPortalFx.Base.Constants;MsPortalFx.Base.Diagnostics;function p(t,s,o,n,r){const a=`Error invoking detail blade for master '${n}'. ${o} Selection model: '${JSON.stringify(r)}'`;(0,i.logToExtension)(e,s,2,a,{rpcClient:t})}t.PartContainerSelectable_ViewModelPath="container.selectable",t.PartContainerSelectableValue_ViewModelPath=t.PartContainerSelectable_ViewModelPath+".value";const u=d.getModelValue;t.DefaultConfiguration={masterModelId:null,masterModel:null,referenceComposition:null,referenceExtension:null,isBladeOpenedByMaster:null,invocationThrottleDuration:25,configureBladeDescriptor:MsPortalFx.noop,onBladesOpening:MsPortalFx.noop,onBladeOpened:MsPortalFx.noop,addOutputBindings:MsPortalFx.noop,removeOutputBindings:MsPortalFx.noop,getCloseOwnedDetailBladesHandler:MsPortalFx.wrap(null),getCloseOtherDetailBladesHandler:MsPortalFx.wrap(null)};let m=class{};m=__decorate([__metadata("fx:diagnostics",[e,"Configuration"]),s.Class("pipeline")],m),t.Configuration=m;let g=class extends m{};g=__decorate([__metadata("fx:diagnostics",[e,"OpenerConfiguration"]),s.Class("composition")],g),t.OpenerConfiguration=g;let h=class{};function f(e){const t=e&&e.invocationInputArguments,s=t&&t[0],i=s&&s.valuesFrom,o=i&&i[0];return o&&o.property}function x(e){const s=f(e),i=e.selectablePath;let o=!0;return s?o=s===t.PartContainerSelectableValue_ViewModelPath:i&&(o=i===t.PartContainerSelectable_ViewModelPath),o}function b(e,t){if(!t)return null;const s=t.contracts;return(0,o.supportsContract)(s,8)?a.Locator.forExtension("HubsExtension").withBlade(c.BladeNames.Hubs.ResourceMenuBlade):a.Locator.forExtension(t.bladeExtensionName||e).withBlade(t.bladeName)}h=__decorate([__metadata("fx:diagnostics",[e,"Resources"]),s.Class("pipeline")],h),t.Resources=h,t.isSelectable=function(e,t){const s=2===arguments.length?u(e,t).value:e;if(s){return[s.selectedValue,s.value,s.isSelected,s.isActivated,s.isCommandSelected,s.hasChildEdits].every(ko.isObservable)}return!1},t.isSelectableSet=function(e,t){const s=2===arguments.length?u(e,t).value:e;if(s){return[s.selectableItems,s.selectedItems,s.activatedItems,s.itemsWithChildEdits].every(ko.isObservable)}return!1},t.isSelectableLocked=function(e){return!!e.isLocked()},t.getSelectablePath=function(e){return e.blade?e.selectablePath||"container.selectable":function(e){const t=f(e);if(t){let e=t.split(".");const s=e.length;if(s>1){const t=e[s-1];return["value","activatedItems","selectedItems","selectedItem"].some((e=>e===t))&&(e=e.slice(0,s-1)),e.join(".")}}return null}(e)},t.needContainerSelectable=function(e){if(e){if(!e.filter((e=>e&&!e.selectablePath&&!e.invocationInputArguments)).length){if(!e.filter((e=>e&&"container.selectable"===e.selectablePath)).length){if(!e.filter((e=>{const t=f(e);return"container.selectable.value"===t||!e.blade&&"container.selectable"===t})).length)return!1}}return!0}return!1},t.validateDetailsDefinition=function(e,t,s){let i;const o=e.invocationInputArguments,n=o&&1!==o.length,r=o&&!n&&o[0].valuesFrom,a=e.outputArguments;return n?i="Invocation arguments must exist and have only one element.":r&&r.length>1?i="Multiple 'valuesFrom' not supported for invocation arguments.":!e.blade&&o[0].property?i="Static invocation property is not supported when omitting the details blade name.":r&&void 0!==r[0].constantValue?i="Constants are not allowed on invocation argument.":a&&a.length>0&&(a.some((e=>!e.property))?i="Output arguments must specify a target property.":a.some((e=>1!==e.valuesFrom.length))?i="Output arguments support only one valueFrom property.":a.some((e=>void 0!==e.valuesFrom[0].constantValue))?i="Constants are not allowed on output arguments.":a.some((e=>1!==e.valuesFrom[0].referenceType))&&(i="Output arguments only support source ReferenceType.BladeInput.")),!i&&s&&(i=s(e)),!i||(t.push(i),!1)},t.mapDynamicSelectionToBladeLocator=function(e,t,s,i){const o=t,n=t,l=t;let d;const c={};if(function(e,t,s,i){let o;const n=i,r=i,a=i;i?n.detailBlade||r.assetType||a.resourceId?n.detailBlade&&r.assetType?o="'detailBlade' and 'assetType' cannot be specified at the same time.":n.detailBlade&&a.resourceId?o="'detailBlade' and 'resourceId' cannot be specified at the same time.":r.assetType&&a.resourceId?o="'assetType' and 'resourceId' cannot be specified at the same time.":i.detailBladeInputs||(o="Model must define a 'detailBladeInputs' property."):o="Either 'detailBlade', 'assetType' or 'resourceId' must be specified on the model. ":o="Dynamic selection must be specified. ";o&&p(e.get(FxImpl.Rpc.Client),t,o,s,i);return!o}(e,s.name,i,t)){if(t.extension){let i=t.extension;i=e.get(r.ExtensionManagerOptions).resolveExtensionName(i),s=a.Locator.forExtension(i)}const u=e.get(a.DefinitionFinder);o.detailBlade?d=s.withBlade(o.detailBlade):n.assetType&&u.tryLocate(s.withAssetType(n.assetType),c)?d=b(s.name,c.value):l.resourceId&&e.get(a.LocatorContext).tryLocateAssetDefinitionFromResourceId(l.resourceId,c)?d=b(c.extensionName,c.value):p(e.get(FxImpl.Rpc.Client),s.name,"Unable to locate asset. Error: '{0}'. ".format(c.error),i,t)}return d||(d=s.withBlade("##NOT_SPECIFIED##")),d},t.getAssociatedDetailDefinition=function(e,t,s){const i=t&&t.container,o=s.details;return i&&i.selectable===e?MsPortalFx.find(o,(e=>x(e))):e?MsPortalFx.find(o,(s=>{const i=s.invocationInputArguments,o=s.selectablePath;return i?i.some((s=>s.valuesFrom.some((s=>{const i=[];return s.property.split(".").some((s=>(i.push(s),u(t,i.join(".")).value===e)))})))):!!o&&u(t,o).value===e})):null},t.detailsIsPartContainer=x,t.bindOutputsToSelectable2=function(e,t,s,i,o){let n;t.setLifetimeReference(8,s);const r=()=>{if(i.length||(i=s.bladeDefinition&&s.bladeDefinition.outputs||[]),i.length){const t={};n=new d.PropertyBindings(s.id+"-"+e,t,!1);const r=s.getViewModel(1);let a;n.addPropertyChangedHandler((()=>{a=MsPortalFx.clone(t,!0)})),i.forEach((e=>{n.mapProperty(e,e).bind(s.id,r,!0)})),a&&o&&o(a),n.addPropertyChangedHandler((()=>{const e=MsPortalFx.clone(t,!0);o&&o(e)}))}};(i.length||o)&&(s.isComposed?r():s.await(7).then(r),s.onDispose((()=>{n&&(n.unbind(),n=null)})))},t.traceInvocationChange=function(e,t,s,i,o,r){n.isDesktopTraceEnabled&&e.verbose(`[BladeOpener] ${t}\n Master Identifier: ${i.masterModelId}.\n  Master Property: ${o.source.property}\n  Master Value: ${void 0!==r?ko.toJSON(r):"<undefined>"}.\n  Current Detail Blades from Container: ${s.get(l.Finder).findSiblingBlades(i.referenceComposition).map((e=>`\n    ${e.toString()}. Model: ${ko.toJSON(e.getInputsOnlyViewModel())}`)).join("")||"<None>"}`)}})),
define("MsPortalImpl/UI/Compositions/UI.Composition.PropertyTransformers",["require","exports","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding"],(function(e,t,s){"use strict";var i;return function(t){const i=MsPortalFx.Base.Diagnostics.createLog(e);let o;!function(e){const t={invalidNewValue:"[DynamicSelectionTransformer] [{0}] Source value does not implement MsPortalFx.ViewModels.DynamicSelection. Transformer Args: '{1}'"},o={invalidNewValue:"[ManyToOneTransformer] [{0}]: Source value '{1}' must be an array."},n={invalidPropertyChange:"[OneToManyMergeTransformer] [{0}]: No property change detected on source. Transformer Args: '{1}'.",invalidNewValue:"[OneToManyMergeTransformer] [{0}]: Source cannot be an array. Transformer args: '{1}'",invalidCurrentValue:"[OneToManyMergeTransformer] [{0}]: Target value '{1}' must be an array."};e.getDynamicSelectionMapper=function(){return e=>{if(function(e){const s=e.propertyChanges||[],o=1===s.length&&s[0].propertyValue,n=(o||{}).hasOwnProperty("detailBladeInputs");return o&&!n&&i.error(t.invalidNewValue.format(e.sourceModelId,JSON.stringify(e))),n}(e)){const t=e.propertyChanges[0],s=t.propertyValue;t.propertyValue=s.detailBladeInputs}}},e.getModelToPropertyMapper=function(){return e=>{let t,i;const o=e.propertyChanges||[];if(1===o.length&&MsPortalFx.isPlainObject(o[0].propertyValue))for(i in t=e.propertyChanges[0].propertyValue,e.propertyChanges=[],t)t.hasOwnProperty(i)&&e.propertyChanges.push(s.ObservableChangeArgs.forObject(i,t[i]))}},e.getManyToOne=function(){return e=>{const t=ko.unwrap(s.getModelValue(e.sourceModel,e.sourceProperty).value)||[];let n;!function(e,t){let s=!0;return Array.isArray(t)?1!==t.length&&(s=!1):(i.error(o.invalidNewValue.format(e.sourceModelId,JSON.stringify(t))),s=!1),s}(e,t)?e.cancel=!0:(n=e.propertyChanges[0],n.kind=0,n.propertyValue=t[0],n.propertyArrayEdits=null)}},e.getOneToManyMerge=function(){let e=null;return t=>{const o=ko.unwrap(s.getModelValue(t.targetModel,t.targetProperty).value);let r,a,l;const d=function(e,t){return MsPortalFx.findIndex(e,(e=>MsPortalFx.deepEquals(e,t)))};(function(e,t){let s=!0;return!t||!t.propertyChanges||t.propertyChanges.length<1?(i.error(n.invalidPropertyChange.format(t.sourceModelId,JSON.stringify(t))),s=!1):Array.isArray(t.propertyChanges[0].propertyValue)||t.propertyChanges[0].propertyArrayEdits&&t.propertyChanges[0].propertyArrayEdits.length>0?(i.error(n.invalidNewValue.format(t.sourceModelId,JSON.stringify(t))),s=!1):Array.isArray(e)||(i.error(n.invalidCurrentValue.format(t.sourceModelId,e)),s=!1),s})(o,t)&&(a=void 0===e?-1:d(o,e),r=t.propertyChanges[0],l=ko.unwrap(r.propertyValue),r.propertyArrayEdits=[],r.kind=1,a>=0&&e!==l&&r.propertyArrayEdits.push({status:"deleted",index:a,moved:null,value:e}),void 0!==l&&-1===d(o,l)&&r.propertyArrayEdits.push({status:"added",index:0,moved:null,value:l}),e=l),t.cancel=!r||!r.propertyArrayEdits||!r.propertyArrayEdits.length}}}(o=t.PropertyTransformers||(t.PropertyTransformers={}))}(i||(i={})),i})),
define("MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder",["require","exports","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition.Finder","MsPortalImpl/UI/Compositions/UI.Composition.PropertyTransformers"],(function(e,t,s,i,o,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompositionBinder=t.onInputsSetTimeout=void 0;var a=FxImpl.TelemetryContext,l=MsPortalFx.Base.Diagnostics,d=s.ReferenceScope;t.onInputsSetTimeout=5e3;const c=MsPortalFx.trace,p=c.inputsset,u=c.shellinputsset,m=l.createLog(e),g=s.extractTraceOptions,h=s.ReferenceCardinality;function f(e){let t=Q();return{getStateAsyncSequenced:()=>(t=t.then(e,e),t)}}!function(e){function l(e,t,i,o,n){const a=(s,o)=>{const n=i.mapProperty(s.source.property,s.targetProperty);n.transformers=function(e){const t=[];e.source.cardinality===h.OneToMany?t.push(r.PropertyTransformers.getOneToManyMerge()):e.source.cardinality===h.ManyToOne&&t.push(r.PropertyTransformers.getManyToOne());e.opensDynamicBlades&&t.push(r.PropertyTransformers.getDynamicSelectionMapper());e.targetProperty||t.push(r.PropertyTransformers.getModelToPropertyMapper());return t}(s),n.compositionBindingDefinition=s,o?n.bind(o.sourceModelName,o.sourceModel):T(e,t,n)};o&&o.forEach((e=>{const t=n&&n(e),o=e.source.constantValue;if(t&&t.overridesConstantBindings)a(e,t);else if(void 0!==o){const t="[Constant: {0}]".format(ko.toJSON(o)),n={};s.setModelValue(n,e.source.property,o);const r=i.mapProperty(e.source.property,e.targetProperty);r.compositionBindingDefinition=e,r.bind(t,n)}else a(e,t)}))}function c(e,t,s){return MsPortalFx.mapMany(e,(e=>(e.valuesFrom||[]).map((o=>{const n={property:o.property,modelType:o.referenceType,constantValue:o.constantValue,scope:d.CurrentContainer,cardinality:e.valuesFrom.length>1?h.OneToMany:h.OneToOne},r={targetProperty:e.property,source:n,optional:!!e.optional,isIdentityInput:!!e.isIdentityInput},a=o.part,l=t.locator.name;return(0===o.referenceType||o.partCommand)&&(n.partLocator=t.locator.getExtensionLocator().withPartInstance(a||l),!(0,i.isPartComposition)(t)||a&&a!==l||(n.id=t.id)),4===o.referenceType&&(n.modelId=o.bladeCommand||o.partCommand),s&&s(r,o),r}))))}function x(e,t){let s=!1;return(0,i.isPartComposition)(e)&&!e.isDisposed()&&(s=t.id?e.id===t.id:e.eligibleForBinding&&e.locator.getExtensionLocator().withPartInstance(e.locator.name).equals(t.partLocator)),s}function b(e,t){const i=[],o={allInputsSet:ko.observable(!1),calledOnInputsSet:ko.observable(!1),failedOnInputsSet:ko.observable(!1),definitionBindings:[],propertyBindings:new s.PropertyBindings(t.bindableTarget.viewModelName,{},!1)};return M(t.referenceComposition,t.inputs,i,t.customInputBindingValidator)?(o.definitionBindings=c(t.inputs,t.referenceComposition),l(e,t.referenceComposition,o.propertyBindings,o.definitionBindings,t.customBindHandler),o.inputsWatcherConfig=v({bindableTarget:t.bindableTarget,allInputsSet:o.allInputsSet,calledOnInputsSet:o.calledOnInputsSet,failedOnInputsSet:o.failedOnInputsSet,propertyBindings:o.propertyBindings,referenceComposition:t.referenceComposition,referenceCompositionIsContainer:t.referenceCompositionIsContainer,notifyWhenInputsChangeWithSameValues:!1,beforeViewModelPropertyUpdate:t.beforeViewModelPropertyUpdate,inputsSetCalled:t.inputsSetCalled})):m.error("{0} Reference: {1}.".format(JSON.stringify(i),t.bindableTarget.viewModelName)),o}function v(e){return MsPortalFx.extend2(e,{propertyBindingsState:void 0,inputsSetTrace:p,shellInputsSetTrace:u,stateReader:!!e.getStateAsync&&f(e.getStateAsync)})}function y(e){let s;C(e,null,e.calledOnInputsSet()),e.allInputsSet()||(s=function(e){const s={handle:setTimeout((()=>{k(s);const t=[],i=[];e.properties.forEach((e=>{const s=F(e),o="Target Input Name: {0} \nSource Model Name: {1} \nSource Property Name: {2} \nOptional: {3}".format(e.targetProperty,e.isBound?e.sourceModelName():"<UNBOUND>",e.isBound?e.sourceProperty:"<UNBOUND>",s);e.targetHasValue||s?i.push(o):t.push(o)}));const o="onInputsSet is taking more time than expected for target model: {0}\n=== Missing Required Properties === \n{1}\n\n=== All Other Properties === \n{2}";m.warning(o.format(e.targetModelName,t.join("\n\n"),i.join("\n\n")))}),t.onInputsSetTimeout)};return s}(e.propertyBindings),e.referenceComposition.onDispose((()=>{k(s)})));const i=e;i.onInputsSetDiagnosticsHandle=s,e.propertyBindings.addPropertyChangedHandler((()=>{i.onInputsSetCallsSuppressed||C(e,s)}))}function M(e,t,s,o){let n;const r=(0,i.isPartComposition)(e);return t&&t.some((e=>(e.property?e.valuesFrom&&1===e.valuesFrom.length?r||0!==e.valuesFrom[0].referenceType||e.valuesFrom[0].part?5===e.valuesFrom[0].referenceType&&void 0===e.valuesFrom[0].constantValue?n="'constantValue' must be defined if using 'Constant' reference type.":void 0!==e.valuesFrom[0].constantValue&&5!==e.valuesFrom[0].referenceType?n="'constantValue' can only be be defined when using 'Constant' reference type.":o&&(n=o(e)):n="Input binding that reference a Part must specify the source part name.":n="Input binding must define one and only one source valueFrom property.":n="Input binding must define a target property.",n||4!==e.valuesFrom[0].referenceType||(e.valuesFrom[0].bladeCommand||e.valuesFrom[0].partCommand?e.valuesFrom[0].bladeCommand&&e.valuesFrom[0].partCommand?n="Only one, 'bladeCommand' or 'partCommand' is allowed when using 'Command' reference type.":e.valuesFrom[0].part&&(n="'part' is not allowed when using 'Command' reference type."):n="'bladeCommand' or 'partCommand' is required if using 'Command' reference type."),!!n))),!n||(s.push(n),!1)}function I(e,t){const i=(...e)=>"| "+e.map((e=>(e.toString()+"                    ").slice(0,15))).join("");let o=["┌-----------",i("Optional","isBound","hasValue","Input: Value")];const n=t.properties.map((e=>"{0}{1}: {2}".format(i(F(e),e.isBound,e.targetHasValue),e.targetProperty,ko.toJSON(e.targetHasValue?s.getModelValue(t.targetModel,e.targetProperty).value:void 0))));o=o.concat(n),o.push("└-----------"),m.verbose("{0} Target Model: {1}\n{2}".format(e,t.targetModelName,o.join("\n")))}function C(e,t,s,i,o,n){return P(e,t,s,!0,i).then((function(t){let s;return t&&(t.dontCallViewModelOnInputsSet=o,a.usingState((()=>{s=function(e,t){const s=e.bindableTarget.viewModel,{inputs:i,settings:o,traceOptions:n,viewModelName:r,inputsMetadata:a,dontCallViewModelOnInputsSet:l,dashboardFilters:d,partFilters:c}=t,p=s.updatePartInputValues(i,o,n,r,a,l,{dashboard:d||{},part:c});return _(e,t,p),p}(e,t)}),e.referenceComposition.getCreationState())),n?s:void 0}))}function P(e,t,s,i,o){const n=!e.propertyBindings.properties.some(S),r=g(e.bindableTarget.viewModelName,e.inputsSetTrace),a=r&&r.verbose;if(!n)return a&&I("onInputsSet not called, missing required properties.",e.propertyBindings),e.propertyBindingsState=void 0,Q(null);const l=ko.toJS(e.propertyBindings.targetModel);if(!i&&!MsPortalFx.canSendThroughPostMessage(l))return e.propertyBindingsState=void 0,Q(null);if(k(t),!s&&e.notifyWhenInputsChangeWithSameValues||o||!MsPortalFx.deepEquals(l,e.propertyBindingsState)){let t;return e.allInputsSet(!0),e.propertyBindingsState=l,t=e.beforeViewModelPropertyUpdate?Q(MsPortalFx.tryImmediateResolve(e.beforeViewModelPropertyUpdate(l),(t=>{if(t)return w(e,r);a&&I("onInputsSet not called, RBAC check failed.",e.propertyBindings)}))):w(e,r),Q(MsPortalFx.tryImmediateResolve(e.getInputsMetadata&&e.getInputsMetadata()||Q({}),(s=>MsPortalFx.tryImmediateResolve(t,(t=>{const i={inputs:l,settings:t,traceOptions:r,viewModelName:e.bindableTarget.viewModelName,inputsMetadata:s,dontCallViewModelOnInputsSet:void 0,dashboardFilters:e.getDashboardFilters&&e.getDashboardFilters(),partFilters:e.getPartFilters&&e.getPartFilters()};return function(e,t){const{inputs:s,settings:i}=t,o=t.traceOptions;if(i&&(!e.referenceComposition||!e.referenceComposition.isDisposed())){const t=e.bindableTarget.viewModelName,n=g(t,e.shellInputsSetTrace);return o&&o.verbose&&I("onInputsSet will be called, all required properties are set.",e.propertyBindings),n&&(m.verbose("Invoking onInputsSet of view model '{0}'.\nInputs: {1}.\nSettings: {2}".format(t,ko.toJSON(s),ko.toJSON(i))),n.breakOnInputsSet),!0}return!1}(e,i)?i:null})))))}return a&&I("onInputsSet not called, new values are the same as current values.",e.propertyBindings),Q(null)}function w(e,t){const s=e.referenceComposition;if(!s||!s.isDisposed()){const s=e.bindableTarget;if(!s.viewModel||s.viewModel.updatePartInputValues){const s=e.stateReader;return s?s.getStateAsyncSequenced().then((e=>e||{}),(()=>{t&&t.verbose&&I("onInputsSet not called, failed to retrieve part settings.",e.propertyBindings),e.failedOnInputsSet(!0)})):Q({})}}return Q(null)}function _(e,t,s){e.calledOnInputsSet(!0),e.inputsSetCalled&&e.inputsSetCalled(t.inputs,s||Q({}))}function S(e){return!e.targetHasValue&&!F(e)}function F(e){const t=e.compositionBindingDefinition,s=t&&t.optional,i=t&&t.source,o=i&&i.scope===d.DetailsContainer;return!!(s||o)}function k(e){e&&e.handle&&(clearTimeout(e.handle),e.handle=null)}function T(e,t,s){if(t&&!t.isDisposed()){const i=function(e,t,s){const i=e.get(n.Finder),o=i.findPartsContainer(t);let r;switch(s.scope){case d.MasterContainer:r=o.masterContainer;break;case d.DetailsContainer:{const e=i.findBlades(o).filter((e=>e&&!(2&e.flags)));e.length>1?m.error("Unable to bind composition to detail blade, multiple detail blades found. Reference Composition: '{0}', Detail Blades: '{1}'.".format(t.toString(),e.map((e=>e.toString())).join(","))):r=e[0];break}default:r=o}return r}(e,t,s.compositionBindingDefinition.source);D(i,s,s.compositionBindingDefinition.source)(e,t,i,s,s.compositionBindingDefinition.source)}}function D(e,t,s){return e?s.partLocator?4===s.modelType&&t.compositionBindingDefinition.source.scope!==d.MasterContainer?A:B:N:E}function E(e,t,s,i,o){const r=e.get(n.Finder).findPartsContainer(t);MsPortalFx.tryImmediateResolve(r.awaitContainer(t,(e=>function(e,t,s){const i=t.masterContainer;if(t.isDisposed())return!1;if(1!==t.locator.type)return!1;if(s.scope===d.MasterContainer)return e.masterContainer&&e.masterContainer.id===t.id;if(s.scope===d.DetailsContainer){const t=e.diContainer.get(n.Finder);return i&&i.id===e.id&&1===t.findBlades(e).length}return i&&i.id===e.id}(r,e,i.compositionBindingDefinition.source))),(s=>{D(s,i,i.compositionBindingDefinition.source)(e,t,s,i,i.compositionBindingDefinition.source)}))}function B(e,t,s,i,o){MsPortalFx.tryImmediateResolve(s.awaitComposedPart(t,(e=>x(e,o))),(s=>{O(e,t,s,i)}))}function A(e,t,s,i,o){O(e,t,t,i)}function N(e,t,s,i,o){O(e,t,s.getBindableContainer(),i)}function O(e,t,o,n){const r=n.compositionBindingDefinition.source,a=r.modelType,l=r.modelId,d="[Composition: {0}, ModelType:{1}, ModelId:{2}]".format(o.toString(),a,l||"<null>");if(1===a||8===a){const e=o.getViewModel(a,l);n.bind(d,e)}else{const e=e=>{o.isDisposed()||n.bind(d,e)};try{const t=o.getViewModel(a,l);s.getModelValue(t,n.sourceProperty).exists&&e(t)}catch(e){}n.isBound||o.getViewModelAsync(a,l).then(e,(()=>{t.isDisposed()||m.error("Failed to retrieve view model type '{0}' with id '{1}' from composition '{2}' to bind source property '{3}'.".format(i.referenceTypeMap[a]||a,l||"<none>",o.toString(),n.sourceProperty))}))}const c=()=>{n.unbind(),o.offDispose(p)},p=()=>{n.unbind(),n.compositionBindingDefinition.autoRebindWhenSourceDisposes&&T(e,t,n),t.offDispose(c)};o.onDispose(p),t.onDispose(c)}e.setupPropertyBindings=l,e.modelHasProperties=function(e,t,i){const o=(t||[]).every((e=>i&&s.getModelValue(i,e).exists));return o||m.error("Model '{0}' is missing properties. Expected properties:'{1}', model:'{2}'".format(e,JSON.stringify(t)||"<null>",JSON.stringify(ko.toJS(i))||"<null>")),o},e.modelHasPropertiesWithValue=function(e,t,i){const o=(t||[]).every((e=>{const t=i&&s.getModelValue(i,e);return t&&t.exists&&void 0!==ko.unwrap(t.value)}));return o||m.error("Model '{0}' is missing required properties or has them set to undefined. Required properties:'{1}', model:'{2}'".format(e,JSON.stringify(t)||"<null>",JSON.stringify(ko.toJS(i))||"<null>")),o},e.createObservableModel=function(e){const t={};for(const s in e)if(e.hasOwnProperty(s)){const i=ko.toJS(e[s]);t[s]=Array.isArray(i)?ko.observableArray(i):ko.observable(i)}return t},e.mapInputBindingDefinitions=c,e.bindingsFromJSON=function(e,t){return(t||[]).forEach((t=>{const s=t.source,i=s&&s.partLocator;i&&(s.partLocator=o.Locator.fromJSON(e,i))})),t},e.mapBindingsToFriendlyObjects=function(e){return(e||[]).map((e=>{const t={targetProperty:e.targetProperty};return e.source&&(t.sourceProperty=e.source.property,t.sourcePartLocator=e.source.partLocator&&e.source.partLocator.toString(),t.sourceType=i.referenceTypeMap[e.source.modelType]||e.source.modelType,t.sourceScope=d[e.source.scope],t.sourceCardinality=h[e.source.cardinality]),t}))},e.isSourcePart=x,e.bindViewModelInputs=function(e,t){const s=b(e,t);return s.inputsWatcherConfig&&y(s.inputsWatcherConfig),s},e.createBindViewModelResult=b,e.setupAllInputsSetWatcher=function(e){y(v(e))},e.createAllInputsSetWatcherConfigExtended=v,e.setupAllInputsSetWatcherFromExtendedConfig=y,e.validateInputBindings=M,e.callOnInputsSetIfNeeded=C,e.turnOnInputsSetSuppressionOn=function(e){e.onInputsSetCallsSuppressed=!0},e.turnOnInputsSetSuppressionOff=function(e,t=1,s=!1){const i=e;return i.onInputsSetCallsSuppressed=!1,C(e,i.onInputsSetDiagnosticsHandle,!!(1&t),!!(2&t),!!(4&t),s)},e.loadOnInputsSetParameters=P,e.notifyOnInputsSetCalled=_}(t.CompositionBinder||(t.CompositionBinder={}))})),
define("MsPortalImpl/UI/Commands/UI.ExtensionCommands",["require","exports","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/UI/Hubs/UI.NotificationManager","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpenerBase","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/UI/UI.JourneyManager"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setBladeOpenerModule=t.ExtensionCommandImplOptions=t.CompositionInstanceCommandContext=t.getCommandSourceTelemetryContext=t.createExtensionCommand=void 0;var f=MsPortalFx.Base,x=f.Diagnostics,b=x.Telemetry,v=FxImpl.TelemetryContext,y=f.Resources,M=MsPortalFx.Hubs.Notifications.NotificationStatus,I=MsPortalFx.ViewModels.Dialogs,C=l.CompositionType,P=c.CompositionBinder,w=p.ReferenceScope,_=f.Net2;const S=window,F=x.createLog(e),k=MsPortalFx.isNullOrUndefined,T=MsPortalFx.uncurryThis(Array.prototype.forEach);let D=null;const E={invocationInputArguments:[{valuesFrom:[{referenceType:4,property:"container.selectable"}]}]},B=n.FileDownloadCommand,A=n.UriCallbackCommand,N=412;function O(e,t,s,i){let o;return t.lc2?o=new Y(e,s,i):t.viewModel?o=new J(e,s,i):t.execute?o=new H(e,s,i):t.navigateUriCallback?o=new q(e,s,i):t.navigateUri?o=new U(e,s,i):t.listItems?o=new $(e,s,i):t.targetUri&&t.httpMethod?o=new K(e,s,i):(i.commandItem.commandDefinition.details||t.bladeName)&&(o=new X(e,s,i)),o}function R(e){const t=e;let s=null;if(!(e instanceof L))throw new Error("Command context was not an instance of CompositionInstanceCommandContext. All context objects are expected to be of that type.");const i=t.compositionInstance,o=i&&i.locator;return o&&(s={id:o.toFriendlyString(),instanceId:i.instanceId}),s}t.createExtensionCommand=O,t.getCommandSourceTelemetryContext=R;class L extends r.CommandContext{constructor(e,t,s){super(e,t),this.compositionInstance=s}}t.CompositionInstanceCommandContext=L;t.ExtensionCommandImplOptions=class{};class z{constructor(e,t,s){this._extension=s.extension,this._viewModelName=s.viewModelName,this.viewModel=t,this.commandItem=s.commandItem,this._commandContainer=s.container;const i=this._ltm=e.createChildLifetime();this._propertyBindings=s.propertyBindings,this._diContainer=s.diContainer;const n=s.diContainer.get(o.ViewModelManager);i.registerForDispose((()=>{this.viewModel&&(n.releaseViewModel(this.viewModel),this.viewModel=null),this._propertyBindings&&(this._propertyBindings.unbind(),this._propertyBindings=null)}))}init(){}execute(e,t){const s=this._diContainer.get(h.JourneyManager).activeJourney(),i=R(this._context());v.setContextValue(v.ContextType.Blade,i),b.trace({extension:this._extension.name,source:i&&i.id,action:"CommandExecuted",name:this._viewModelName,data:e,journeyId:s&&s.id})}dispose(){this._ltm.dispose()}_context(){return this.commandItem.getCommandContext()}_getFormTarget(){return this._context().getFormTarget()}_target(){const e=this._context();return e&&e.target}}class H extends z{constructor(e,t,s){super(e,t,s),this._viewModel=t.content(),this._diContainer.get(m.DesktopManagerMode).value.subscribe(this._ltm,(e=>{this._getFormTarget().then((t=>{1===e&&t&&t.hideForm()}))}))}execute(e,t){super.execute(e,t);const s=this._viewModel;1===s.status()?Promise.all([this._diContainer.getAsync(g.DialogManager),this._getFormTarget()]).then((([e,t])=>{this._loadDialog(t,e,ko.unwrap(s.dialog))})):s.status(1),s.execute(t)}init(){const e=this._viewModel,t=this._ltm,s=(e,t,s)=>{0===s?e.hideForm():1===s&&this._loadDialog(e,t,ko.unwrap(this._viewModel.dialog))},i=(e,t,s)=>{1===this._viewModel.status()&&this._loadDialog(e,t,s)};this._diContainer.getAsync(g.DialogManager).then((o=>{e.status.subscribe(t,(e=>{this._context()&&this._getFormTarget().then((t=>{s(t,o,e)}))})),ko.isObservable(e.dialog)&&e.dialog.subscribe(t,(e=>{this._getFormTarget().then((t=>{i(t,o,e)}))}))}))}_loadDialog(e,t,s){if(e&&!(MsPortalFx.deepEquals(this._currentDialogOptions,s)&&t.hasOpenDialog||(t.hasOpenDialog||(this._previouslyFocusedElement=document.activeElement),this._currentDialogOptions=s,k(s)))){if(!this._target())return;const i=this._commandContainer.locator,o=i&&i.withCommand(this.commandItem.commandName),n=t.hasOpenDialog&&this._previouslyFocusedElement?this._previouslyFocusedElement.contains(this._target())?this._target():this._previouslyFocusedElement:this._target();this.commandItem.pressed(!0),t.showDialog(s,e,n,{locator:o}).then((e=>{this.commandItem.pressed(!1);const t=this._viewModel,s=t&&t.dialogClick;"function"==typeof s&&s.call(t,e)}))}}}class U extends z{constructor(e,t,s){super(e,t,s),this._viewModel=t.content(),this.canSkipBladeValidation=!0}execute(e){const t=this._viewModel,s=t.navigateTarget?t.navigateTarget():"_blank";super.execute(e),S.open(t.navigateUri(),s)}}class W extends z{constructor(e,t,s){super(e,t,s),this.canSkipBladeValidation=!0}_getLocator(){const e=this._commandContainer.locator;return e&&e.withCommand(this.commandItem.commandName)}_showUriCbProgressDlg(e,t,s){this._showProgressDlg(e,t,this._uriCbProgressTitle,this._uriCbProgressText,s)}_showDownloadProgressDlg(e,t,s){this._showProgressDlg(e,t,this._progressTitle,this._progressText,s)}_showProgressDlg(e,t,s,i,o){const n=new I.ProgressBox(s,i);t.showDialog(n,e,this._target(),{locator:this._getLocator()})}_getResources(e){const t=e.uriCallbackConfirmationDialogOptions||{},s=e.downloadProgressDialogOptions||{};this._uriCbProgressTitle=t.uriCallbackProgressTitle||B.uriCallbackProgressTitle,this._uriCbProgressText=t.uriCallbackProgressText||B.uriCallbackProgressText,this._dnldTitle=t.downloadTitle||B.downloadTitle,this._dnldText=t.downloadText||B.downloadText,this._defaultBtnText=t.defaultButtonText||B.defaultButtonText,this._cancelBtnText=t.cancelButtonText||B.cancelButtonText,this._progressTitle=s.downloadProgressTitle||B.downloadProgressTitle,this._progressText=s.downloadProgressText||B.downloadProgressText}}function V(e){const t=e&&e.title,s=e&&e.description;a&&a.getNotificationManager()&&a.getNotificationManager().addClientNotification({title:t||A.uriCallbackCommandError,description:s||A.error,status:M.Error,timestamp:new Date})}function j(e,t,i){const o=s.sanitizeLinkUri(e,i);o?S.open(o,t):(F.error(A.invalidUri.format(e)),V())}class q extends W{constructor(e,t,s){super(e,t,s),this._viewModel=t.content(),this._getResources(this._viewModel),this.canSkipBladeValidation=!0}execute(t){super.execute(t);const i=this._viewModel.navigateTarget?this._viewModel.navigateTarget():"_blank",o=this._viewModel,n=o.navigateUriCallback&&o.navigateUriCallback(),r=this.commandItem.fxEnabled,a=o.showUriCallbackConfirmationDialog&&o.showUriCallbackConfirmationDialog(),l=e=>{e.hideForm(),r(!0)};let d,c=!0;const p={localRequire:e,windowContext:this._extension.name,diContainer:this._diContainer};n&&a?(r(!1),Promise.all([this._diContainer.getAsync(g.DialogManager),this._getFormTarget()]).then((([e,s])=>(this._dlgMgr=e,this._showUriCbProgressDlg(s,e,t),Promise.resolve(o.navigateUriCallback()()).then((t=>{c=!1;const o=new g.MessageBox(this._dnldTitle,this._dnldText,2);o.defaultButtonText=this._defaultBtnText,o.cancelButtonText=this._cancelBtnText,e.showDialog(o,s,this._context().target,{locator:this._getLocator(),syncCallback:e=>{4===e&&j(t,i,p),l(s)}}),s.showForm(this._target())}),(e=>{V(e)})).finally((()=>{c&&(F.error(A.callbackError.format("navigateUriCallback failed.")),d&&d.close(),this._dlgMgr&&this._dlgMgr.dismissOpenDialog(),l(s))}))))).catch((e=>{F.error(e)}))):n?(r(!1),d=S.open("about:blank",i),Promise.resolve(n()).then((e=>{c=!1,s.sanitizeUri(e,null,p)?d.location.href=e:(F.error(A.invalidUri.format(e)),V(),d.close())}),(e=>{V(e)})).finally((()=>{c&&(F.error(A.callbackError.format("navigateUriCallback failed.")),d.close()),this._getFormTarget().then((e=>{l(e)}))}))):j(o.navigateUri(),i,p)}}class $ extends z{constructor(e,t,s){super(e,t,s);const i=this._ltm,o=this.commandItem,n=t.content(),r=o.widgetViewModel.dialogOptions;ko.reactor(i,(()=>{r.listItems(n.listItems())})),n.selectedItem.subscribe(i,(e=>{r.selectedItem(e)})),r.selectedItem(n.selectedItem()),o.hasPopup(!0),r.selectedItem.subscribe(i,(e=>{n.selectedItem(e)})),this.canSkipBladeValidation=!0}execute(e){super.execute(e)}}function G(e,t,s,i){k(e)||"function"!=typeof e||!i&&k(e())||function(e,t){F.warning("The '"+e+"' property of a command viewModel contains a value. This value will be ignored when passing to '"+t+"' dynamic command viewModel.")}(t,s)}class K extends W{constructor(e,t,s){super(e,t,s),this._viewModel=t.content(),this._getResources(this._viewModel),i.isSafari&&i.webKitVersion<i.safari_11_webKitVersion&&(this.commandItem.fxEnabled(!1),this.commandItem.tooltip(n.FileDownloadCommand.safariDownload)),this.canSkipBladeValidation=!0}execute(e){super.execute(e);let t=null;const s=this.commandItem.fxEnabled;s()&&f.Promises.cancelOnDispose(this._ltm,MsPortalFx.require("MsPortalImpl/Commands/FileDownloadUtil")).then((i=>{const o=this._viewModel,n=i.getHttpMethod(o),r=e=>{e.hideForm(),s(!0)};if(!n)return i.notifyError(o,N,B.typeError),void this._getFormTarget().then((e=>{r(e)}));s(!1),o.downloadStatus(null);const a=this._diContainer.getAsync(g.DialogManager),l=this._getFormTarget(),d=Promise.all([a,l]).then((([t,s])=>this._getUri(s,t,e)));return Promise.all([a,d,l]).then((([s,r,a])=>{const l=r&&r.startsWith("data:");if(!y.isUriAbsolute(r)&&!l)return void i.notifyError(o,N,B.absoluteUriError);o.showDownloadProgressDialog&&o.showDownloadProgressDialog()&&this._showDownloadProgressDlg(a,s,e);const d=R(this._context());if(t=b.startTrace({extension:this._extension.name,source:d&&d.id,action:"StartFileDownload",name:this._viewModelName,data:e}),!l)return _.ajaxExtended(i.getAjaxOptions(o,r,n)).then((e=>{if(this.viewModel){const n=e.content,r=n&&n.length?n.length:0;return i.onSuccess(o,s,n,e.textStatus,e.jqXHR).then((()=>{b.completeTrace(t,r)}))}}),(e=>(i.onError(o,s,e.textStatus,e.jqXHR.status,e.errorThrown),b.cancelTrace(t),Promise.reject(e.errorThrown))));i.dataUriHandler(o,s,r)})).catch((e=>{e&&F.error(e),b.cancelTrace(t)})).finally((()=>{l.then((e=>{r(e)}))}))})).catch((e=>{e&&F.error(e)}))}_getUri(e,t,s){const i=this._viewModel,o=i.targetUriCallback&&i.targetUriCallback(),n=i.showUriCallbackConfirmationDialog&&i.showUriCallbackConfirmationDialog();return f.Promises.cancelOnDispose(this._ltm,MsPortalFx.require("MsPortalImpl/Commands/FileDownloadUtil")).then((r=>{if(o)return n&&this._showUriCbProgressDlg(e,t,s),Promise.resolve(o()).then((s=>{if(!s)return Promise.reject(B.uriError);if(n){const i=new g.MessageBox(this._dnldTitle,this._dnldText,2);i.defaultButtonText=this._defaultBtnText,i.cancelButtonText=this._cancelBtnText;return t.showDialog(i,e,this._target(),{locator:this._getLocator()}).then((e=>4===e?s:Promise.reject()))}return r.dismissDialog(t,i),s})).catch((e=>{r.dismissDialog(t,i);let s=null;return e&&(s=i.errorMessage()||"{0} {1}".format(B.downloadTargetUriCallbackFailed,e),r.notifyError(i,N,s)),Promise.reject(s)}));{const e=i.targetUri&&i.targetUri();return e||(r.notifyError(i,N,B.uriError),Promise.reject(B.uriError))}}))}}class J extends z{constructor(e,t,s){super(e,t,s),this._container=s.container,this._viewModel=t.content(),this._selectionInList=s.selectionInList;const i=this._ltm;let o;this._viewModel.viewModel.subscribeAndRun(i,(e=>{o&&o.dispose(),o=i.createChildLifetime();let t=this._nestedCommand;if(t&&(t.dispose(),this._nestedCommand=void 0),e){const s=this.viewModel,i={container:this._container,extension:this._extension,viewModelName:this._viewModelName,commandItem:this.commandItem,propertyBindings:null,diContainer:this._diContainer,selectionInList:this._selectionInList};this.commandItem.commandDefinition.details=E,function(e,t){const s=e;T(["text","icon","enabled"],(e=>{G(s[e],e,t)})),G(s.onInputsSet,"onInputSet",t,!0)}(e,this._viewModelName);const n=MsPortalFx.clone(s);n.content=ko.observable(e);const r=e;r.bladeName&&n.container.selectable.selectedValue({detailBlade:r.bladeName,detailBladeInputs:r.bladeInputs}),t=this._nestedCommand=O(o,e,n,i),t.init(),this.canSkipBladeValidation=t.canSkipBladeValidation}}))}execute(e){super.execute(e),this._nestedCommand?this._nestedCommand.execute(e):F.error("The nested command is missed for the {0} dynamic command.".format(this._viewModelName))}dispose(){this._nestedCommand&&this._nestedCommand.dispose()}}class X extends z{getBladeOpener(){if(this._ltm){const e=this._ltm;return this._bladeOpenerPromise||(D=D||MsPortalFx.require("MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener"),this._bladeOpenerPromise=D.then((t=>{const s=this._options,i=new t.BladeOpener(this._diContainer,this._getBladeOpenerConfig(s.container,s.extension));return i.registerInvocationProperty(this.commandItem.commandDefinition.details),e.registerForDispose(i),i}))),this._bladeOpenerPromise}return Promise.reject(new MsPortalFx.Errors.DisposedCanceledError)}constructor(e,t,s){super(e,t,s),this._addedOutputPropertyBindings=[],this._outputBindingDefinitions=[],this._viewModel=t,this._containerViewModel=t.container,this._options=s;const i=this.commandItem.commandDefinition;this._commandInstanceId=s.selectionInList?MsPortalFx.newGuid():void 0;const o=function(e){let t;return e.name?e.details||(t="OpenBladeCommand must provide a details blade definition."):t="OpenBladeCommand must provide a command name.",t&&F.error("{0} Command: '{1}'. CommandDefinition: '{2}'.".format(t,e.name,JSON.stringify(e))),!t}(i),n=i.details,r=this._validateDetailsDefinition(n);o&&r?(this._outputBindingDefinitions=P.mapInputBindingDefinitions(n.outputArguments||[],s.container,(e=>{e.source.scope=w.DetailsContainer})),this.getBladeOpener()):s.commandItem.setEnabled(!1),this.canSkipBladeValidation=!0}execute(e){super.execute(e),this.getBladeOpener().then((e=>{if(!e||this._ltm&&!this._ltm.isDisposed()){const e=this._containerViewModel,t=e&&e.selectable;t?t.isSelected(!0):F.error("OpenBladeCommand '{0}' from extension '{1}' was not initialized with a Selectable.".format(this.commandItem.commandDefinition.name,this._extension.name))}}))}_getBladeOpenerConfig(e,t){const s=this.commandItem.commandDefinition.details,i=!!s&&!!s.parameterCollector,o=this._diContainer;return{diContainer:o,masterModelId:"{0}-[{1}-{2}]".format(e.toString(),"OpenBladeCommand",this.commandItem.commandDefinition.name),masterModel:this._viewModel,referenceComposition:e,referenceExtension:t,isBladeOpenedByMaster:t=>t.masterCommandName===this.commandItem.commandDefinition.name&&t.masterPartId===e.id&&t.masterCommandId===this._commandInstanceId,configureBindings:t=>{T(t,(t=>{const s=t.source;4===(s&&s.modelType)&&(s.modelId=this.commandItem.commandDefinition.name,l.isPartComposition(e)&&(s.partLocator=e.locator,s.id=e.id))}))},configureBladeDescriptor:t=>{t.masterCommandName=this.commandItem.commandDefinition.name,t.masterCommandId=this._commandInstanceId,t.masterCommandExtension=this._extension,t.masterPartId=e.id;const s=t.bindings;if(Array.isArray(s))for(let e=s.length-1;e>=0;e--){const o=s[e],n=o.source;if(4===(n&&n.modelType)){t.model[o.targetProperty]=ko.toJS(p.getModelValue(this._viewModel,n.property).value);const r=this.commandItem.sourceBindableContainer;!i&&r&&r.isPartListItem&&s.splice(e,1)}}},onBladeOpened:e=>{this._setCmdActivated(!0),e.onDispose((()=>{this._disposeOutputBindings(),this._setCmdActivated(!1)})),e.await(7).then((()=>{this._createOutputBindings(e)}))},getCloseOtherDetailBladesHandler:(t,s)=>{if(s.openInContextPane){const t=o.get(h.JourneyManager);if(e.getCompositionType()===C.StartboardPart){const e=t.activeJourney();return!e||e.isStartedWithContextBlade()?null:()=>t.tryDeactivateJourney()}if(!o.get(u.RightContextPane).opened.value)return()=>!0}return null}}}_createOutputBindings(e){T(this._outputBindingDefinitions,(t=>{const s=this._propertyBindings;if(s){const i=s.mapProperty(t.source.property,t.targetProperty).bind(e.toString()+"LaunchCommandOutputBinding",e.getViewModel());i.compositionBindingDefinition=t,this._addedOutputPropertyBindings.push(i)}}))}_disposeOutputBindings(){this._propertyBindings&&T(this._addedOutputPropertyBindings,(e=>{this._propertyBindings.removeProperty(e)})),this._addedOutputPropertyBindings.length=0}_validateDetailsDefinition(e){const t=[],s=d.validateDetailsDefinition(e,t,(e=>{let t;const s=e.invocationInputArguments;return e.isMultiple?t="Command cannot open multiple blades. isMultiple value must be false.":s&&4!==s[0].valuesFrom[0].referenceType&&(t="Command invocation argument reference type can only be of type Command."),t}));return t.length&&F.error("{0} Command: '{1}'. Details: '{2}'.".format(t[0],this.commandItem.commandDefinition.name,JSON.stringify(e))),s}_setCmdActivated(e){const t=this._commandContainer.getViewModel(),s=t&&t.container,i=s&&s.selectable;i&&i.isCommandSelected(e),this.commandItem.pressed(e)}}class Y extends X{constructor(e,t,s){super(e,t,s);const i=this._ltm,o=this.commandItem,n=t.content(),r=o.widgetViewModel.dialogOptions;ko.reactor(i,(()=>{r.listItems(n.listItems())})),n.selectedItem.subscribe(i,(e=>{r.selectedItem(e)})),r.selectedItem(n.selectedItem()),o.hasPopup(!0),r.selectedItem.subscribe(i,(e=>{n.selectedItem(e)}))}execute(e){super.execute(e)}}t.setBladeOpenerModule=function(e){D=Q(e)}})),
define("MsPortalImpl/UI/Compositions/UI.Composition.Security",["require","exports","Fx/ResourceManagement","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Services/Services.Permissions","FxInternal/Utils/Promise"],(function(e,t,s,i,o,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkPermission=t.checkPermissions=void 0;var a=FxImpl.TriggerableLifetimeManager,l=MsPortalFx.Base,d=l.Diagnostics,c=MsPortalFx.Extension.SetRequirement;const p=d.createLog(e),u=MsPortalFx.xor;function m(e,t,i,o,r,a){if(!e)return Q(!1);let d;switch(e.assetId.sourceType){case 0:d=Q(t[e.assetId.property]);break;case 1:d=g(e,t,i,o,r);break;case 2:d=g(e,t,e.assetType||i,e.extensionName||o,r)}return d.then((t=>{if(t=ko.unwrap(t),(d=s.ArmId.parse(t,!0))&&h[d.kind])return a=t,r.get(n.PermissionsManager).hasPermission(a,[e.action],l.Constants.Shell);throw l.Diagnostics.createIgnoreUnhandledRejectionError(`Asset ID not a resource ID, permissions not checked. Extension <${o}> : AssetType <${i}> : ID _REDACTED_`);var a,d}))}function g(e,t,s,n,r){const l="[getAssetIdFromPropertyProvider]:";return r.get(o.ManifestCache).getManifestAsync(n,"assetTypes").then((o=>{const d=MsPortalFx.find(o.assetTypes,(e=>e.name===s));if(!d)throw new Error(l+"Unknown extension Asset Type : "+s);const c=r.get(i.ViewModelManager);return c.getViewModel(n,d.propertyProviderServiceViewModelLocator||d.propertyProviderServiceViewModel,11).then((s=>{const i=new a;return i.registerForDispose((()=>{c.releaseViewModel(s)})),Q.fcall((()=>{const i=s.content(),o=i&&i.onInputsSet;if("function"==typeof o){const s=$.extend({providerKey:e.assetId.providerKey},t);return(o.call(i,s)||Q()).then((()=>{const t=i.properties(),s=e.assetId.property,o=MsPortalFx.find(t,(e=>e.property===s));if(o)return o.value;throw new Error(l+"Can not find propertyDefinition for assetIdProperty: "+s)}))}throw new Error(l+"ViewModel.content.onInputsSet is not a function.")})).finally((()=>{i.dispose()}))}))}))}t.checkPermissions=function e(t,s,i,o,n,a,l){if(t&&t.length){if(void 0===c[s])return(0,r.QReject)("checkPermission: unexpected requirement: "+s);{const r=s===c.All;return t.reduce(((t,s)=>t.then((d=>{if(u(r,d))return t;{let t;if(0===s.permissionType){t=m(s,i,o,n,a,l)}else{if(1!==s.permissionType)throw new Error("unexpected permission.permissionType: "+s.permissionType);{const r=s;t=e(r.permissions,r.requirement,i,o,n,a,l)}}return t.catch((e=>(p.warning.call(p,e,1,["Failed check permissions:","compositionInfo:"+l,"reason: "+e].join("\n")),Q(!0))))}}))),Q(r))}}return Q(!0)},t.checkPermission=m;const h={4:!0,6:!0,8:!0,3:!0,1:!0}})),
define("MsPortalImpl/Widgets/Widgets.CommandBarBase",["require","exports","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/UI/UI.DialogManager"],(function(e,t,s,i){"use strict";var o;return function(e){var t=MsPortalFx.Base.Diagnostics.Telemetry;class o extends s.CommandImpl{constructor(e,t,s,i){const o=i&&i.commandName;super(e,t.label);const n=this._ltm;this._executeLifetime=i&&i.executeLifetime||n,this._model=t,this._locator=s,this.icon=ko.computed(n,{read:()=>{const e=ko.unwrap(this._model.icon);return e&&MsPortalFx.extend2(e,{options:$.extend({palette:99},e.options)})},write:this._model.icon}),this.commandName=o||MsPortalFx.getUniqueId(),this.enabled=ko.computed(this._executeLifetime,(()=>{const e=t,s=!t.disabled(),i=!e.command||e.command.canExecute();return s&&i})),ko.computed(n,(()=>{this.unauthorized(!!ko.unwrap(t.unauthorizedMessage))})),ko.computed(n,(()=>{let e=ko.unwrap(t.unauthorizedMessage);if(!e){const s=ko.unwrap(t.disabled);e="string"==typeof s?s:null}e=e||ko.unwrap(t.tooltip),this.tooltip(e)})),this.isSeparator=ko.observable(12===t.type)}get model(){return this._model}get type(){return this._model&&this._model.type}execute(e){t.trace({source:this._locator&&this._locator.toFriendlyString(),action:"CommandExecuted",name:this.model.name||"Toolbar name not specified",extension:this._locator&&this._locator.getExtensionName()}),super.execute(e)}}e.ItemViewModel=o;e.DialogButton=class extends o{constructor(e,t,s,i,o){super(e,t,s,o),this.hasOpenDialog=ko.observable(!1),this._diContainer=i;const n=t.dialogOptions;this.hasPopup(!!n&&4===n.type)}get dialogOptions(){return this._model.dialogOptions}execute(e){MsPortalFx.Base.Promises.cancelOnDispose(this._executeLifetime,Q.all([this._diContainer.getAsync(i.DialogManager),this._currentContext.getFormTarget()]).spread(((t,s)=>{if(this.hasOpenDialog())t.dismissOpenDialog(),this.hasOpenDialog(!1);else{const e=this._currentContext,i=e&&e.target,o=this._model;this.hasOpenDialog(!0),MsPortalFx.Base.Promises.cancelOnDispose(this._executeLifetime,t.showDialog(this.dialogOptions,s,i,{locator:this._locator})).then((e=>{this.hasOpenDialog(!1),o.command&&o.command.execute(e)}),(()=>{this.hasOpenDialog(!1)}))}super.execute(e)})))}}}(o||(o={})),o})),
define("MsPortalImpl/UI/Commands/UI.Commands",["require","exports","Fx/DependencyInjection","FxInternal","FxInternal/Composition/ViewModelComposer","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Extension/DefinitionCache","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.Security","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/UI/Commands/UI.ExtensionCommands","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.CommandBarBase","MsPortalImpl/Extension/ExtensionManager"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g,h,f,x,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createOpenLinkCommand=t.createOpenBladeCommand=t.ExtensionCommandMenuItemImpl=t.ExtensionMultiselectCommandMenuItemImpl=t.ExtensionCommandMenuItemBase=t.getCommandGroupForDefinitionItem=t.getBladeContainerWidget=t.getBladeContentWidget=t.getCommandSourceTelemetryContext=t.CompositionInstanceCommandContext=t.CommandState=void 0;var v=MsPortalFx.Base,y=v.Diagnostics,M=v.Images,I=MsPortalFx.Extension.SetRequirement,C=MsPortalFx.ViewModels,P=C.Dialogs,w=C.Toolbars,_=p.CompositionBinder;const S=y.createLog(e),F=d.Commands,k=MsPortalFx.uncurryThis(Array.prototype.forEach);let T=class{constructor(){this.commandsEnabled=ko.observable(!0)}};T=__decorate([__metadata("fx:diagnostics",[e,"CommandState"]),s.Class()],T),t.CommandState=T,t.CompositionInstanceCommandContext=h.CompositionInstanceCommandContext,t.getCommandSourceTelemetryContext=function(e){return h.getCommandSourceTelemetryContext(e)},t.getBladeContentWidget=function(e){const t=f.Widget.getWidget(e,null);if(e.hasClass("fxs-bladecontent"))return t},t.getBladeContainerWidget=function(e){const t=f.Widget.getWidget(e,null);if(e.hasClass("fxs-blade"))return t},t.getCommandGroupForDefinitionItem=function(e,t,s){const i=s.commandGroupReference,o=i?i.name:s.commandGroup;return e.getCommandGroup(t,o)};class D extends c.CommandImpl{constructor(e,t,s,i,o){super(e,s),this.diContainer=o;const n=ko.observable(!1);this.commandName=t,this._compositionContainer=i;const r=this._overrideEnabled=ko.observable();this.enabled=ko.computed(e,{read:()=>{let e=r();return void 0===e&&(e=n()),e},write:e=>{n(e)}}),this._init(o)}get container(){return this._compositionContainer}get sourceBindableContainer(){return null}_init(e){ko.reactor(this._ltm,(()=>{e.get(T).commandsEnabled()&&1!==this.diContainer.get(m.DesktopManagerMode).value()?this._overrideEnabled(void 0):this._overrideEnabled(!1)}))}}t.ExtensionCommandMenuItemBase=D;t.ExtensionMultiselectCommandMenuItemImpl=class extends D{constructor(e,t,s,i,o,n,r){const a=i.name;super(e,a,i.text,s,n);const l=this._ltm,d=s+"[Command: "+a||i.text+"]",c=(p=r)&&p.selectableItems().filter((e=>e.isSelected()))||[];var p;this._subcommands=c.map((e=>{const r={viewModel:e.data,viewModelName:d,isPartListItem:!0};return new E(l,t,s,i,o,n,r)})),ko.reactor(l,(()=>{const e=this._subcommands.reduce(((e,t)=>t.enabled()&&e),!0);this.enabled(e)}))}bind(e){k(this._subcommands,(t=>{t.bind(e)}))}activate(){k(this._subcommands,(e=>{e.activate()}))}execute(e){k(this._subcommands,(t=>{t.execute(e)}))}};class E extends D{constructor(e,t,s,i,o,n,r,l){super(e,i.name,i.text,s,n),this._viewModelManager=n.get(a.ViewModelManager),this._extension=t,this._commandDefinition=i,this._commandContainerDefinition=o,this._sourceBindableContainer=r,this._selectionInList=l}extensionName(){return this._extension&&this._extension.name}get commandDefinition(){return S.assert(!this._commandDefinition.reference,"External CommandDefinition not resolved."),this._commandDefinition}getInputBindingsFromDefinition(e){let t;const s=this._getCommandReference(e);return s&&Array.isArray(s.bindings)&&s.bindings.length>0?t=s.bindings:e&&(t=e.bindings),t||[]}get widgetViewModel(){return this._widgetViewModel}get sourceBindableContainer(){return this._sourceBindableContainer}activate(){this._loadViewModel()}execute(e){const t=this.widgetViewModel,s=t&&t.dialogOptions;s&&s.type&&5===t.type?this._getFormTarget().then((t=>{const i=this.container.locator,o=i&&i.withCommand(this.commandName);this.diContainer.getAsync(g.DialogManager).then((e=>e.showDialog(s,t,this._target(),{locator:o}))).then((t=>{this._execute(e)}))})):this._execute(e)}getCommandContext(){return this._currentContext}_getFormTarget(){return this._currentContext&&this._currentContext.getFormTarget()}_target(){return this._currentContext&&this._currentContext.target}_getCommandReference(e){const t=this._commandContainerDefinition&&this._commandContainerDefinition.commandGroupReference;let s=null;return t&&t.commands&&e.name&&(s=MsPortalFx.find(t.commands,(function(t){return t.name===e.name}))),s}_execute(e){const t=this._currentContext.compositionInstance;if(!this._extensionCommand)return void this._loadViewModel();const s=t&&t.widget;s&&!this._extensionCommand.canSkipBladeValidation?(this._overrideEnabledPropertyWith(!1),l.ensureFormFieldValidation(s.element).then((t=>{super.execute(e),this._extensionCommand.execute(e,t)})).finally((()=>{this._clearEnabledPropertyOverride()}))):(super.execute(e),this._extensionCommand.execute(e))}dispose(){const e=this._viewModelLoadedPromise,t=()=>{super.dispose()};e&&(e.then(t),this._viewModelLoadedPromise=null),t()}setEnabled(e){this._extensionEnabledProperty=e,this._overrideEnabledProperty||this.enabled(e)}getViewModel(e,t){const s=this._extensionCommand;return s&&s.viewModel}getViewModelAsync(e){return this._loadViewModel(),this._viewModelLoadedPromise}get canRebind(){const e=this._getContentViewModel();return 1!==(e&&ko.unwrap(e.status))}_getContentViewModel(){const e=this.getViewModel();return e&&e.content()}_overrideEnabledPropertyWith(e){this._overrideEnabledProperty=!0,this.enabled(e)}_clearEnabledPropertyOverride(){this._overrideEnabledProperty&&(this._overrideEnabledProperty=!1,this.enabled(this._extensionEnabledProperty))}_resolveCommandDefinition(){return(0,i.fcall)((()=>{const t=this._commandDefinition;if(t.reference){const s=t.reference.extension||this._extension.name,i=t.reference.commandType;return this.icon(M.Loading.EllipsisSquare()),this.text(F.loading),this.diContainer.get(r.DefinitionCache).getCommand(s,i).then((o=>{MsPortalFx.isNullOrUndefined(o)&&(0,n.logToExtension)(e,this._extension.name,2,"Could not resolve the command reference for extension {0} and command name {1}".format(s,i)),this._extension=this.diContainer.get(b.ExtensionManager).getExtension(s);const r=this.getInputBindingsFromDefinition(t);this._commandDefinition=MsPortalFx.extend2(o,{name:t.name}),r.length>0&&(this._commandDefinition.bindings=r),this.text(this._commandDefinition.text)}))}}))}_logError(t){FxImpl.Rpc.client.log(this._extension.name,{level:2,code:0,area:e.normalize("."),message:`${MsPortalFx.getLogFriendlyMessage(t)} \nCommand name: ${this._commandDefinition.name} \nView model name: ${this._commandDefinition.viewModel}`})}_createExtensionCommandHandler(e){const t=this._ltm;if(t.isDisposed())return;const s=e.content,i=t.createChildLifetime(),o={container:this.container,extension:this._extension,viewModelName:this._commandDefinition.viewModel,commandItem:this,propertyBindings:null,diContainer:this.diContainer,selectionInList:this._selectionInList},n=new A(i,e,o);n.init(),o.propertyBindings=n.propertyBindings;const r=this._extensionCommand=h.createExtensionCommand(i,s(),e,o);r?(i.registerForDispose([r]),r.init()):this._logError(FxImpl.createError("Error loading command view model. Unknown view model type.")),e.container.unauthorizedMessage.subscribeAndRun(i,(t=>{this.unauthorized(!MsPortalFx.isNullOrUndefined(t)),this.tooltip(t||e.content().tooltip&&e.content().tooltip())}))}_loadViewModel(){if(!this._viewModelLoadedPromise){let e=this._ltm;if(!e)return;this._viewModelLoadedPromise=this._resolveCommandDefinition().then((()=>{if(e=this._ltm,!e)return;const t=this._extension,s=this._commandDefinition,i=4===s.commandKind;return s.commandKind&&!i||(this._widgetViewModel=B(this._ltm,s,this.diContainer,this.container,i)),this._viewModelManager.getViewModel(t.name,s.viewModelLocator||s.viewModel,7,{createSelectable:!0})})),this._viewModelLoadedPromise.then((t=>{e=this._ltm,e&&(t.content().lc2&&(this._widgetViewModel=B(e,this._commandDefinition,this.diContainer,this.container,!0)),this._createExtensionCommandHandler(t))})).catch((e=>{const t=MsPortalFx.getLogFriendlyMessage(e);this.icon(M.Blank()),this.text(F.failedToLoad),this._logError(FxImpl.createError("Error loading command view model.\nReason: {0}".format(t)))}))}}}function B(e,t,s,i,o){const n=new w.DialogButton;return n.dialogOptions=new P.ListPopup,n.dialogOptions.type=o?4:0,new x.DialogButton(e,n,i.locator.withCommand(t.name),s,{commandName:t.name})}t.ExtensionCommandMenuItemImpl=E;class A{constructor(e,t,s){this._onInputsSetPending=ko.observable(!1),this._hasPermissions=ko.observable(!0),this._extension=s.extension,this._viewModelName=s.viewModelName,this._composedViewModel=t,this._commandViewModel=t.content(),this._commandItem=s.commandItem,this._diContainer=s.diContainer;const i=this._ltm=e.createChildLifetime();this._initializeInputBindings(s.container,s.commandItem),i.registerForDispose((()=>{this._commandViewModel=null}))}init(){const e=this._commandViewModel,t=this._commandItem;ko.isObservable(e.icon)&&e.icon.subscribeAndRun(this._ltm,t.icon),ko.isObservable(e.text)&&e.text.subscribeAndRun(this._ltm,(e=>void 0!==e&&t.text(e))),ko.isObservable(e.ariaLabel)&&e.ariaLabel.subscribeAndRun(this._ltm,t.ariaLabel),ko.isObservable(e.tooltip)&&e.tooltip.subscribeAndRun(this._ltm,t.tooltip),ko.computed(this._ltm,[e.enabled,this._hasPermissions,this._onInputsSetPending],((e,s,i)=>t.setEnabled(e&&s&&!i)))}get propertyBindings(){return this._propertyBindings}dispose(){this._ltm.dispose()}_initializeInputBindings(e,t){const s=this._ltm;if(!s)return;const i=t.getInputBindingsFromDefinition(t.commandDefinition),o={bindableTarget:{viewModelName:e.toString()+"-["+this._viewModelName+"]",viewModel:this._composedViewModel},inputs:i,referenceComposition:e,referenceCompositionIsContainer:!0,customBindHandler:e=>{const s=t.sourceBindableContainer;if(s&&s.viewModel&&0!==e.source.modelType)return{sourceModelName:s.viewModelName,sourceModel:s.viewModel}},beforeViewModelPropertyUpdate:s=>{const i=t.commandDefinition;if(i&&i.permissions){this._hasPermissions(!1);let t=e&&e.locator&&e.locator.toString()+"-";return t=(t||"")+i.name,u.checkPermissions(i.permissions,I.All,s,i.assetType,this._extension.name,this._diContainer,t).then((e=>(this._updateForHasPermissions(e),e)))}return this._updateForHasPermissions(!0),Q(!0)}};o.inputs&&Array.isArray(o.inputs)&&o.inputs.length>0&&(this._onInputsSetPending(!0),o.inputsSetCalled=(s,i)=>{this._onInputsSetPending(!0),this._currentOnInputsSetPromise=i,i.then((()=>{this._currentOnInputsSetPromise===i&&this._onInputsSetPending(!1)}),(i=>{S.error("Command '{0}' on composition '{1}' rejected its onInputsSet promise.\nView Model Name: {2}\nInputs Provided: {3}\nReason: {4}".format(t.commandName,e.toString(),this._viewModelName,ko.toJSON(s),i||"N/A"))}))});const n=_.bindViewModelInputs(this._diContainer,o),r=this._propertyBindings=n.propertyBindings;s.registerForDispose((()=>{r&&(r.unbind(),this._propertyBindings=null)}))}_updateForHasPermissions(e){const t=this._composedViewModel&&this._composedViewModel.container;t&&(e?t.unauthorizedMessage(void 0):t.unauthorized()),this._hasPermissions(e)}}function N(e,s,i,n,r,a,l,d){const c="__{0}ViewModel__".format(d),p=o.composeViewModel(n,!0),u=new E(e,l,i,r,a,s),m={container:i,extension:l,viewModelName:c,commandItem:u,propertyBindings:null,diContainer:s,selectionInList:!1},g=h.createExtensionCommand(e,p.content(),p,m);return u.bind(new t.CompositionInstanceCommandContext(null,null,i)),e.registerForDispose([p.container,u,g]),g}t.createOpenBladeCommand=function(e,t,s,i,o,n){return N(e,t,s,(e=>new C.OpenBladeCommand(e)),{name:n,details:{invocationInputArguments:[{valuesFrom:[{property:"container.selectable",referenceType:4}]}]}},i,o,n)},t.createOpenLinkCommand=function(e,t,s,i,o,n,r){return N(e,t,s,(()=>{const e=new C.UriCommand;return e.navigateUri=r.uri,e.navigateTarget=r.target,e}),{name:n},i,o,n)}})),
define("MsPortalImpl/UI/Commands/UI.CommandManager",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/Widgets/Widgets.ContextMenu","MsPortalImpl/Widgets/Widgets.Portal.init","MsPortalImpl/Base/Base.KeyboardHelper"],(function(e,t,s,i,o,n,r,a,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PortalCommandManager=t.onContextMenu=t.AsyncPortalFormTarget=void 0;var c=FxImpl.TriggerableLifetimeManager;const p=window;class u{static create(e){return e.getAsync(i.get("MsPortalImpl/UI/UI.PortalFormTarget","PortalFormTarget"))}}function m(e){if(d.isCtrlOrCommandOnly(e))return!0;const t=p.getSelection();if(t.rangeCount&&!t.getRangeAt(0).collapsed)return!0;const s=$(e.target);if(s.filter("input,textarea").length)return!0;if(s.add($(e.target).parents("a")).filter("a[href]:not([href='#']):not([href=''])").length)return!0;e.preventDefault(),e.stopPropagation();const i=$.Event("fxcontextmenurequest",{target:e.target,pageX:e.pageX,pageY:e.pageY,clientX:e.clientX,clientY:e.clientY});s.trigger(i)}__decorate([__metadata("fx:diagnostics",[e,"AsyncPortalFormTarget"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s.Container]),__metadata("design:returntype",Promise)],u,"create",null),t.AsyncPortalFormTarget=u,t.onContextMenu=m;let g=class{constructor(e,t,s){this._desktopManagerMode=e,this._previouslyFocusedElement=t,this._diContainer=s,this._ltm=new c,this._ltm.registerForDispose($.querySelectorAll("body").setEvents(["fxcontextmenu",(e,t)=>{this._showContextMenu(e,t)}],["contextmenu",e=>{m(e)}]))}dispose(){this._ltm.dispose()}getFormTarget(){return this._diContainer.getAsync(u)}_showContextMenu(e,t){if(!this._contextMenu){const e=(0,l.getPortalViewModel)(this._diContainer);this._contextMenu=new a.Widget(e.getRootElement().find(".fxs-commands-contextMenu"),e.contextMenuViewModel,!0)}const s=t.contextMenu?t.contextMenu:this._contextMenu,i=s.options.menuItems;let r,d,c,p=e.clientX,u=e.clientY;if(t.commands&&0!==t.commands.length){if(t.srcElement){const e=t.srcElement;let s=e;for($(e).hasClass("fxs-tile")&&(s=$(e).find(".fxs-part")[0]);s&&"function"!=typeof s.focus;)s=$(s).closest("[tabindex]")[0];this._previouslyFocusedElement.value(s)}c=t.formTarget&&t.formTarget.length>0?()=>Q(o.getBladeContentWidget(t.formTarget)):()=>this.getFormTarget(),s.hide(),i.splice(0,i().length);do{d=d?d.parentNode:e.target,r=$(d).data(n.CompositionInstanceDataName)}while(!r&&d.parentNode);if(n.isContextMenuContainer(r)&&r.beforeActivateCommandMenuItems(t),t.commands.forEach((t=>{this._shouldShowCommand(t)&&(t.activate(),t.bind(new o.CompositionInstanceCommandContext(e.target,c,r)),i.push(t))})),s.options.hasVisibleCommands()){if(!p&&!u){const t=e.target.getClientRects()[0];p=t&&t.left||p,u=t&&t.bottom||u}s.show(p,u,t&&t.forceLeft)}}}_shouldShowCommand(e){return 1!==this._desktopManagerMode.value()||!this._isExtensionCommand(e)}_isExtensionCommand(e){return!!e._extension}};g=__decorate([__metadata("fx:diagnostics",[e,"PortalCommandManager"]),s.Class(),__metadata("design:paramtypes",[r.DesktopManagerMode,r.PreviouslyFocusedElement,s.Container])],g),t.PortalCommandManager=g})),
define("MsPortalImpl/Services/Services.AssetManagement",["require","exports","Fx/ResourceManagement","FxHubs/RpcEndPoints","Fx/DependencyInjection","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.ArmEvents","FxInternal/AsyncLoader"],(function(e,t,s,i,o,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.notifyAssetDeletedHandler=t.AssetManager=void 0;const l=MsPortalFx.Base.Diagnostics.createLog(e);let d=class{constructor(e){this.assetTypeService=e,this._assetDeletedCallbacks=$.Callbacks(),this.handleAssetDeletedLocal=(e,t,i,o)=>{o.reason=o.reason||`Received asset deletion notification from the extension '${t}'`;const a=o.assetId,d=o.assetType;if("*Impl_Resource*"===d){s.ArmId.parse(a,!0).resourceType&&this.assetTypeService.mapResourceIdToAssetId(a).then((t=>{this.handleAssetDeleted(t.extensionName,t.assetType,t.assetId,o.reason),e.get(r.ArmEvents).createResourceDeletedEvent([t])})).catch((e=>{0!==(e&&e.message||"").indexOf(n.failedToFindAssetTypePrefix)&&l.warning(e)}))}else this.handleAssetDeleted(i,d,a,o.reason),e.get(r.ArmEvents).createResourceDeletedEvent([{extensionName:i,assetType:d,assetId:a}])}}onAssetDeleted(e){this._assetDeletedCallbacks.add(e)}markAssetDeleted(e,t,s,i){this.handleAssetDeleted(e,t,s,i)}handleAssetDeleted(e,t,s,i){this._assetDeletedCallbacks.fire(e,t,s,i)}};d=__decorate([__metadata("fx:diagnostics",[e,"AssetManagerImpl"]),o.Class(),__metadata("design:paramtypes",[n.AssetTypeService])],d);class c{static create(e){return e}}__decorate([__metadata("fx:diagnostics",[e,"AssetManager"]),o.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[d]),__metadata("design:returntype",c)],c,"create",null),t.AssetManager=c,t.notifyAssetDeletedHandler=(0,a.defineHandler)(i.Events.notifyAssetDeletedDefinition,(e=>{const t=e.messageContext.srcWindowId,s=e.diContainer.get(c);MsPortalFx.makeArray(e.messageArg).forEach((i=>{s.handleAssetDeletedLocal(e.diContainer,t,t,i)}))}))})),
define("MsPortalImpl/Services/Services.Settings.Schema",["require","exports"],(function(e,t){"use strict";var s;return function(e){e.avatarKey="avatar_base64encoded",e.desktopSettingsKey="sprint2",e.startBoardSettingsKey="Startboard"}(s||(s={})),s})),
define("MsPortalImpl/UI/Compositions/UI.Composition.Base",["require","exports","Fx","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.Settings.Schema"],(function(e,t,s,i,o,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createContainerModel=t.Instance=t.compositionRequire=t.createIdentifier=void 0;var a=FxImpl.TriggerableLifetimeManager,l=MsPortalFx.Base.Diagnostics,d=o.CompositionType;const c=l.createLog(e),p=o.getIdMatchFunc;function u(e,t,i){i=i||(0,s.getUniqueId)();let o=d[e];return o+=t?"-"+t.name:"",o+="-"+i,o}t.createIdentifier=u,t.compositionRequire=function(e,t,s,i){return Q(MsPortalFx.tryImmediateResolve(MsPortalFx.require(t,i),(t=>{if(!e||!e.isDisposed())try{return s(t)}catch(e){return Q.reject(e)}})))};t.Instance=class extends a{constructor(e,t,i,o,r,a,l){super(),this._childObjects=ko.observableArray(),this._disposeCallbacks=$.Callbacks("memory once"),this._composedDeferred=(0,s.defer)(),this.isComposed=!1,this.diContainer=t,this._sharedSettings=t.get(n.SettingsManager),this.locator=i,this.id=a||u(this.getCompositionType(),i,l&&l.toString()),this.widgetState=ko.observable(r||{}),this._addChildrenInternal(o);const d=this._composedDeferred.resolve;this._composedDeferred.resolve=e=>{d.apply(this._composedDeferred,[e]),this.isComposed=!0},this._toStringPrefix=`{ Name: ${e||"<NOT SPECIFIED>"}, Type: `}get children(){return this._childObjects()}subscribeChildren(e){return this._childObjects.subscribe(this,e)}get templateKey(){return""+(this.locator||this.id)}getPerfData(){return{}}getCompositionType(){throw new Error("The getCompositionType method is not implemented.")}getCreationState(){return this._creationState}toString(){let e=this._toStringPrefix;const t=this._toStringPostfix||(this._toStringPostfix=`, Id: ${this.id} }`);return e+=this.locator||"<null>",e+=t,e}compose(e,...t){if(this._composeInvoked)throw new MsPortalFx.Errors.Error(`Composition '${this.id}' is already composed.`);this._composeInvoked=!0,this._compose(e,this._composedDeferred,...t)}_compose(e,t,...s){throw new Error("Not implemented.")}resetLayout(){const e=this.children;e&&e.forEach((e=>{e.resetLayout()}))}dispose(e){this.isDisposed()||(super.dispose(),this._disposeCallbacks.fire(),e||this._deleteSetting(),this.children.slice(0).forEach((t=>{t.dispose(e)})))}_deleteSetting(){if(void 0!==this._store)this._sharedSettings.deleteSettings({store:this._store,keys:[this.id]});else if(this.parent){const e=this.parent.children,t=MsPortalFx.find(e,p(this.id));t&&e.remove(t),this.parent.save()}}save(e){if(void 0!==this._store){const t=this._sharedSettings;if(t){const s=this.toJSON();t.setSetting(this._store,this.id,JSON.parse(JSON.stringify(s))),1===e&&t.flushSettings()}}else this.parent&&this.parent.save(e)}await(e){switch(e){case 0:return Promise.resolve(!1);case 3:return Promise.resolve(null);case 7:return this._composedDeferred.promise}throw new MsPortalFx.Errors.Error("Await reason not supported")}onDispose(e){this._disposeCallbacks.add(e)}offDispose(e){this._disposeCallbacks.remove(e)}addChild(e,t,s=!0){e&&this.addChildren([e],t,s)}addChildren(e,t,s=!0){this._addChildrenInternal(e,t),s&&this.save()}_addChildrenInternal(e,t=this.children.length){if(e&&e.length>0){const s=this._childObjects();e.forEach((e=>{s.splice(t,0,e),e.parent=this,t++,this.addChildWidget(e.widget)})),this._childObjects(s)}}removeChildren(e){for(let t=this.children.length-1;t>=0;t--)this.removeChildAt(t,e,!1);this.save()}removeChildAt(e,t,s=!0){if(e>=0){const i=this._childObjects.splice(e,1)[0];this.removeChildWidget(i.id,t),t||i.dispose(),s&&this.save()}}replaceChild(e,t){const s=this._childObjects;if(e&&t&&s){const i=s.indexOf(e);i>=0&&(s.splice(i,1,t),t.parent=this,this.save())}}removeChild(e,t,s=!0){if(e&&this._childObjects){const i=this._childObjects.indexOf(e);this.removeChildAt(i,t,s)}}addChildWidget(e){this.widget&&e&&this.widget.addChild(e)}removeChildWidget(e,t){this.widget&&this.widget.removeChild(e,t)}getChildById(e){return this._childObjects?MsPortalFx.find(this._childObjects(),p(e)):null}toJSON(e){const t={},s=this.children,i=e?s.filter(e):s;return this.id!==r.startBoardSettingsKey&&i.forEach((e=>{t[e.id]=e.toJSON()})),{id:this.id,locator:this.locator,widgetState:this.widgetState(),errorMessage:this.unrecoverableErrorMessage,children:i.map((e=>e.id)),childSettings:t}}loadFromJson(e){this.unrecoverableErrorMessage=e.errorMessage}getBindableContainer(){return this._bindableContainer||(this._bindableContainer=function(e,t){let s,i=e;for(;i;)(i.hasOwnProperty(t)||"function"==typeof i[t])&&(s=i),i=i.parent;s||c.error(`Could not locate container with property or function '${t}' for composition '${e}'.`);return s}(this,"getViewModel")),this._bindableContainer}getDiagnosticsData(){return $.extend(this.toJSON(),{id:this.id,locator:this.locator&&this.locator.toString(),errorMessage:this.unrecoverableErrorMessage,children:(this.children||[]).map((e=>e.getDiagnosticsData()))})}definitionExists(e){const t=this.diContainer.get(i.DefinitionFinder),s=this.locator;return t.tryLocate(s,{})?0:t.tryLocate(s.getExtensionLocator(),{})&&e?1:2}discardWidgetStateOfUnusedChildren(){if(this.widget){const e=this.widget.discardStateOfUnusedChildren();e&&e.stateDiscarded&&c.warning("Unused widget state was discarded for composition '{0}'. \n{1} \nCurrent Children: {2}\nCurrent Widget State: {3}".format(this,e.message,JSON.stringify((this.children||[]).map((e=>""+e))),JSON.stringify(this.widgetState())))}}_markAsComposed(){this._composedDeferred.resolve()}},t.createContainerModel=function(e){return FxImpl.isSerializedObject(e)?FxImpl.fromSerializableObject(e):{}}})),
define("MsPortalImpl/UI/Commands/UI.ShellCommands",["require","exports","Fx/DependencyInjection","Fx/ResourceManagement","FxInternal","FxInternal/AsyncLoader","FxInternal/Composition/Part","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/Interactions/Interactions.FullScreenMode","MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/UI/Commands/UI.CommandManager","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/Widgets/Widgets.TileActionBar","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/Widgets/Widgets.Portal.init","MsPortalImpl/UI/Commands/Base.PortalFunctions"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g,h,f,x,b,v,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClonePart=t.ExitOrganizeMode=t.EnterOrganizeMode=t.ResetStartBoardCommand=t.ReloadPart=t.GoToAssetBlade=t.CreatePartSizeCommandCollection=t.PartSizeCommand=t.PinToStartboard=t.OpenContextMenu=t.CustomizeTileData=t.UnpinFromStartboard=t.ControlCommand=t.ShellCommand=t.CommandNames=t.commandNamePrefix=void 0;var M=MsPortalFx.Base,I=M.Diagnostics.Telemetry,C=FxImpl.TelemetryContext,P=M.Images,w=MsPortalFx.Parts,_=c.CompositionInstanceCommandContext;t.commandNamePrefix="MsPortalImpl.UI.Commands.";function S(e){return h.Widget.getWidget(e.closest(".fxs-tile"),f.Widget)}t.CommandNames={BladeDisplayState:`${t.commandNamePrefix}BladeDisplayState`,ClonePart:`${t.commandNamePrefix}ClonePart`,CustomizeTileData:`${t.commandNamePrefix}CustomizeTileData`,DeleteListItem:`${t.commandNamePrefix}DeleteListItem`,EnterOrganizeMode:`${t.commandNamePrefix}EnterOrganizeMode`,ExitOrganizeMode:`${t.commandNamePrefix}ExitOrganizeMode`,GoToAssetBlade:`${t.commandNamePrefix}GoToAssetBlade`,OpenContextMenu:`${t.commandNamePrefix}OpenContextMenu`,PartSize:`${t.commandNamePrefix}PartSize`,PinBlade:`${t.commandNamePrefix}PinBlade`,EditBlade:`${t.commandNamePrefix}EditBlade`,PinListItem:`${t.commandNamePrefix}PinListItem`,PinToStartboard:`${t.commandNamePrefix}PinToStartboard`,ReloadPart:`${t.commandNamePrefix}ReloadPart`,ResetLayout:`${t.commandNamePrefix}ResetLayout`,ResetStartBoard:`${t.commandNamePrefix}ResetStartBoard`,UnnamedCommand:`${t.commandNamePrefix}UnnamedCommand`,UnpinFromStartboard:`${t.commandNamePrefix}UnpinFromStartboard`};class F extends l.CommandImpl{constructor(e,t,s,i){super(e,i.text,i.enabled),this._diContainer=t,this.commandName=s,this.icon(i.icon||P.Blank()),this.isShellCommand=!0}bind(e){e.getFormTarget||(e.getFormTarget=()=>this._diContainer.getAsync(p.AsyncPortalFormTarget)),super.bind(e)}execute(e){super.execute(e);const t=this._diContainer.get(g.JourneyManager).activeJourney(),s=c.getCommandSourceTelemetryContext(this._currentContext);C.setContextValue(C.ContextType.Blade,s),I.trace({source:s&&s.id,action:"CommandExecuted",name:this.commandName,data:{fromContextMenu:e,desktopMode:this._getDesktopMode()},journeyId:t&&t.id})}createAction(e){const t=new x.TileActionViewModel;return t.command=this,t.bindCommand=()=>{const t=e.widget;t?this.bind(new _(t.element[0],null,e)):this.enabled(!1)},this._setActionClassName(t),t}_getComposition(){return this._currentContext.compositionInstance}_getDesktopMode(){return this._diContainer.get(b.DesktopManagerMode).value()}_setActionClassName(e){const t=this._getActionClassIdentifier();this._actionClassName="fxs-tile-actionbar-command-"+t,e.className=this._actionClassName}_getActionClassIdentifier(){throw new Error("Not implemented.")}}t.ShellCommand=F;t.ControlCommand=class extends F{constructor(e,s,i){super(e,s,t.CommandNames.UnnamedCommand,{text:i.text}),this.command=i}execute(e){this.command.handler().execute(),super.execute(e)}};t.UnpinFromStartboard=class extends F{constructor(e,s){super(e,s,t.CommandNames.UnpinFromStartboard,{text:a.ShellCommands.unpinFromStartboard,icon:P.Delete()})}execute(e){const t=S($(this._currentContext.target));t&&t.trigger("fxunpin",{tileId:t.options.id}),super.execute(e)}_getActionClassIdentifier(){return"unpinfromstartboard"}};t.CustomizeTileData=class extends F{constructor(e,s){const i=MsPortalFx.isFeatureEnabled(r.partHeaderEnabledFeatureName);super(e,s,t.CommandNames.CustomizeTileData,{text:i?a.ShellCommands.configureTileSettings:a.ShellCommands.customizeTileData,icon:P.Gear()}),this._partSettingsEnabled=i}execute(e){this._getComposition().openPartSettingsBlade()}bind(e){super.bind(e),this.enabled(1!==this._getDesktopMode()||this._partSettingsEnabled)}_getActionClassIdentifier(){return"customizetiledata"}};t.OpenContextMenu=class extends F{constructor(e,s,i){super(e,s,t.CommandNames.OpenContextMenu,{text:i,icon:P.Ellipsis()})}bind(e){super.bind(e);const t=this._partWidget=S($(e.target)),s=t.options.commands.filter((t=>(t.bind(e),t.visible()&&t.enabled()))),i=this._diContainer.get(d.FullScreenMode);this.enabled(s.length>0&&!i.isActive()),ko.computed(this._ltm,(()=>{const e=t.actionBarWidget&&t.actionBarWidget.contextMenuWidget.options.visible();t.element.findByClassName(this._actionClassName).toggleClass("fxs-tile-actionbar-action-pressed",e)}))}execute(e){const t=this._partWidget,s=t.element,i=$.Event("fxcontextmenu"),o=s.offset();i.clientX=o.left+s.outerWidth(!1),i.clientY=o.top,s.trigger(i,{commands:t.options.commands,contextMenu:t.actionBarWidget.contextMenuWidget}),super.execute(e)}_getActionClassIdentifier(){return"opencontextmenu"}};t.PinToStartboard=class extends F{constructor(e,s,i){super(e,s,t.CommandNames.PinToStartboard,{text:a.ShellCommands.pinToStartboard,icon:P.Pin(),enabled:!1}),this.partComposition=i}bind(e){if(super.bind(e),!this.partComposition.allInputsSet())return void this.enabled(!1);const t=this.partComposition.widget;let s=!1;if(t){const e=m.isVariableSize(t.options.size()),i=ko.unwrap(t.options.supportedSizes);let o;t.element.parentsUntil(".fxs-blade",".fxs-blade-summary-container").length>0?s=!1:e?(o=MsPortalFx.find(i,(function(e){return m.isFixedSize(e)})),null!==o&&o>=0&&(s=!0)):s=!0}this.enabled(s)}execute(e){this._diContainer.get(y.PinTilePortalFunc).invoke(this.partComposition,"ShellCommands").finally((()=>{super.execute(e)}))}_getActionClassIdentifier(){return"pintostartboard"}};class k extends F{constructor(e,s,i,o,n){super(e,s,t.CommandNames.PartSize+w.InternalPartSize[i],{text:o,icon:n}),this.sizeTarget=i}execute(e){const t=S($(this._currentContext.target));let s;t&&(s=m.AllSizes[this.sizeTarget],t.element.trigger("fxsizechange",[t.options.id,s.size.width,s.size.height]),(0,o.fcall)((()=>{t.setFocus()}))),super.execute(e)}bind(e){const t=S($(e.target)),s=t&&t.options;t&&this.sizeTarget!==s.size()&&!m.isVariableSize(s.size())&&1===this._getDesktopMode()?(this.enabled(-1!==s.supportedSizes().indexOf(this.sizeTarget)),super.bind(e)):this.enabled(!1)}}let T;t.PartSizeCommand=k,t.CreatePartSizeCommandCollection=function(e,t){return T||(T=[{size:0,text:a.ShellCommands.partSizeMini},{size:1,text:a.ShellCommands.partSizeSmall},{size:2,text:a.ShellCommands.partSizeNormal},{size:3,text:a.ShellCommands.partSizeWide},{size:4,text:a.ShellCommands.partSizeTall},{size:10,text:a.ShellCommands.partSizeLarge},{size:5,text:a.ShellCommands.partSizeHeroWide},{size:6,text:a.ShellCommands.partSizeHeroTall},{size:11,text:a.ShellCommands.partSizeHero}],T.forEach((e=>{e.icon=P.Mini({customClass:"msportalfx-contextmenu-grid-"+w.InternalPartSize[e.size].toLowerCase()})}))),T.map((s=>new k(e,t,s.size,s.text,s.icon)))};t.GoToAssetBlade=class extends F{constructor(e,s,i){super(e,s,t.CommandNames.GoToAssetBlade,{text:a.ShellCommands.goToAsset,icon:P.Go(),enabled:!1}),this.assetWrapper=i}bind(e){super.bind(e),this.assetWrapper.getAssetId().then((e=>{this._assetId=e,this._diContainer.get(b.DesktopManagerMode).value.subscribeAndRun(this._ltm,(t=>{const s=0!==i.ArmId.parse(e,!0).kind,o=1!==t;this.enabled(s&&o)}))})).catch($.noop)}execute(e){super.execute(e),n.get("MsPortalImpl/UI/UI.DeepLink","getResourceDeepLink").then((e=>{const t=e(this._diContainer,this._assetId);this._diContainer.get(y.RoutePortalFunc).invoke({uri:t,openedByContext:{openedBy:4}},"ShellCommands")}))}};t.ReloadPart=class extends F{constructor(e,s,i){super(e,s,t.CommandNames.ReloadPart,{text:a.ShellCommands.reloadPart,icon:P.Refresh({palette:99})}),this.partComposition=i}bind(e){super.bind(e)}execute(e){super.execute(e);const t=this.partComposition,s=I.startTrace({action:"Refresh",source:"UI.ShellCommands",actionModifier:"mark",context:{content:t.locator&&t.locator.name,instanceId:t.id}});return this._diContainer.get(y.ReloadPartPortalFunc).invoke(t,"ShellCommands").then((e=>{const i={source:"Shell",action:"ErrorInteraction",actionModifier:"Refresh",context:{content:t.locator&&t.locator.name,instanceId:t.id}};return e.await(3).then((()=>{i.data={successful:!0}}),(()=>{i.data={successful:!1}})).finally((()=>{I.trace(i),I.completeTrace(s)})),e}))}};t.ResetStartBoardCommand=class extends F{constructor(e,s){super(e,s,t.CommandNames.ResetStartBoard,{text:a.ShellCommands.resetLayout})}execute(e){this._diContainer.get(y.ResetDashboardPortalFunc).invoke({duringPortalStartup:!1,force:!1},"ShellCommands"),super.execute(e)}bind(e){super.bind(e),this.enabled(1===this._getDesktopMode())}};t.EnterOrganizeMode=class extends F{constructor(e,s,i){super(e,s,t.CommandNames.EnterOrganizeMode,{text:a.ShellCommands.enterOrganizeMode,icon:P.Edit()}),this._expandTileGallery=!!i,s.get(b.DesktopManagerMode).value.subscribeAndRun(this._ltm,(e=>{const t=1!==e;this.enabled(t)}))}execute(e){const t=this._getComposition();t&&t.widget?t.widget.element.trigger("fxenterorganizemode",{trigger:1,openTileGallery:this._expandTileGallery}):this._diContainer.get(b.DesktopManagerMode).value(1),super.execute(e)}};t.ExitOrganizeMode=class extends F{constructor(e,s){super(e,s,t.CommandNames.ExitOrganizeMode,{text:a.ShellCommands.exitOrganizeMode})}execute(e){(0,v.getPortalViewModel)(this._diContainer).topBar.exitOrganizeMode(),super.execute(e)}bind(e){super.bind(e),this.enabled(1===this._getDesktopMode())}};let D=class extends F{constructor(e,s,i){super(e,s,t.CommandNames.ClonePart,{text:a.ShellCommands.copy,icon:P.Copy()}),this._partComposition=i}execute(e){super.execute(e),n.get("MsPortalImpl/UI/Dashboard/Common/DashboardPinHelper","copyPartWithDashboardSelection").then((e=>e(this._diContainer,"Dashboard",this._partComposition)))}};D=__decorate([__metadata("fx:diagnostics",[e,"ClonePart"]),s.Class(),__metadata("design:paramtypes",[Object,s.Container,Function])],D),t.ClonePart=D})),
define("WeaveDOM/SandboxRender/Serialize",["require","exports","WeaveDOM/Core/Sanitization","Weave/Core/InternalUtil","WeaveDOM/Core/InternalUtil","Weave/Core/Computation"],(function(e,t,s,i,o,n){"use strict";function r(e,t,s){switch(t=(t||"").trim(),e){case"aria-describedby":case"aria-controls":case"aria-labelledby":case"aria-owns":case"for":case"form":case"headers":case"id":case"list":return function(e,t){for(var s=new Array(e.length),i=0;i<e.length;++i)s[i]=t+e[i];return s}(t.split(" ").filter(n._identity),s).join(" ");default:return t}}function a(e,t,s,i,o,n,r,a,d){for(var c=!1,p=0,u=e;p<u.length;p++){c=l(u[p],t,s,i,o,n,r,a,d)||c}return c}function l(e,t,n,l,p,u,m,g,h){switch(e.type){case"element":return function(e,t,o,n,l,d,c,p,u){var m=e.tagName;!function(e){if(!(0,s.validateTagNameInSandboxMode)(e))throw new Error("TagName: ".concat(e," is not allowed"))}(m);var g="",h="",f=o.htmlFragments;f.push("<",m);for(var x=0,b=e.attributes;x<b.length;x++){var v=b[x],y=v.name,M=v.value;(0,s.ensureAllowedAttribute)(m,y);var I=(0,s.sanitizeAttributeValue)(y,M,c);if(I.valid)if("id"===y){if(!M)throw new Error("Empty element node id is not accepted.");if(g)throw new Error("Only one element id can be accepted, ".concat(g,", ").concat(M));g=I.value,h=(0,i.getUniqueElementId)(),f.push(' id="',h,'"')}else f.push(" ",y,'="',(0,i.encodeHtml)(r(y,I.value,l)),'"');else console.warn("Invalid attribute value will be ignored: ".concat(y,", ").concat(M))}p&&p.element.postSerialize({addAttribute:function(e,t){return f.push(" ",e,'="',t,'"')},getElementNodeId:function(){return g||(g=h=(0,i.getUniqueElementId)(),f.push(' id="',h,'"')),g},node:e,options:t,ltm:n.innerLtmRoot,hooksState:u});if((0,s.isSelfCloseTag)(m))f.push("/>");else{var C=-1;h||(C=f.length,f.push("")),f.push(">"),a(e.children,t,o,n,l,d,c,p,u)&&(h||(h=(0,i.getUniqueElementId)(),f[C]=' id="'.concat(h,'"')),o.commentContainers.push(h)),f.push("</",m,">")}g&&o.elementNodes.push({ltm:n,nodeId:g,domId:h});return!1}(e,t,n,l,p,u,m,g,h);case"dynamic":return function(e,t,s,n,r,l,p,u,m){var g=(0,o.getUniqueCommentIdPair)(),h=g.commentStartId,f=g.commentEndId;s.htmlFragments.push("\x3c!--",h,"--\x3e");var x=(0,i.createDynamicNodeLtms)(e.dynamicNodeType,n),b=x.selfLtm,v=x.contentLtm,y=v||b;if(a(e.children,t,s,y,r,l,p,u,m),s.htmlFragments.push("\x3c!--",f,"--\x3e"),"forEach"===e.dynamicNodeType&&!e.children.every(d))throw new Error("Only ForEachItem node is allowed as a children to ForEach node.");return s.dynamicNodes.push({nodeId:e.nodeId,nodeType:e.dynamicNodeType,commentStartId:h,commentEndId:f,initContentLtm:v,selfLtm:b,initItemsId:"forEach"===e.dynamicNodeType?e.children.map(c):void 0}),!0}(e,t,n,l,p,u,m,g,h);case"text":return function(e,t){e.text&&"string"==typeof e.text&&t.push((0,i.encodeHtml)(e.text));return!1}(e,n.htmlFragments);case"html":return function(e,t,s){return t.push(s(e.htmlData)),!1}(e,n.htmlFragments,u);default:(0,i.assertSwitchNever)(e)}}function d(e){return"dynamic"===e.type&&"forEachItem"===e.dynamicNodeType}function c(e){return e.nodeId}Object.defineProperty(t,"__esModule",{value:!0}),t.mapAttributeIdPointers=t.serializeRootNode=void 0,t.serializeRootNode=function(e,t,s,i,n,r,l,d){var c={commentContainers:[],dynamicNodes:[],elementNodes:[],htmlFragments:[]},p=d&&d();a(e.children,t,c,s,i,n,r,l,p);var u=(0,o.documentFragmentFromHtml)(c.htmlFragments.join(""));return{containerDoc:u,commentLookup:(0,o.collectCommentNodes)(c.commentContainers,u),dynamicNodes:c.dynamicNodes,elementNodes:c.elementNodes,hooksState:p}},t.mapAttributeIdPointers=r})),
define("WeaveDOM/SandboxRender/WeaveSandbox",["require","exports","WeaveDOM/Core/InternalUtil","WeaveDOM/SandboxRender/Serialize","Weave/Core/MemoryManager","WeaveDOM/DirectRender/ForEachNodeOperations","WeaveDOM/Core/Sanitization","Weave/Core/InternalUtil","WeaveDOM/Core/DomOperatorBase","Weave/Core/InternalUtil","Weave/Core/Computation"],(function(e,t,s,i,o,n,r,a,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SandboxModeRenderEngine=t.connect_internal=void 0,t.connect_internal=function(e,t){var s=null,i=!1,o=(0,d.makeMap)(p.concat(t.customInstructionHandlers||[]),(function(e){return e.name}),(function(e){return e.handler}));return t.registerOnReceive((function(n,r){if(!i&&n)if("setRoot"===n.type){if(s)throw new Error("Cannot have more than one setRoot instruction.");s=new u({rootElement:e,config:t,rootNode:n.rootNode,setRootInstructionOptions:r,idMapPrefix:"_wv_sandbox_idmap_".concat(f++,"_"),cssChanges:n.css})}else{var a=o.get(n.type);if(!a)throw new Error("Unknown Weave sandbox mode instruction: ".concat(JSON.stringify(n).slice(0,200)));a(n,s,r)}})),t.registerOnDispose((function(){s&&s.dispose(),i=!0})),function(){return s&&s.getMemoryDebugInfo()}};var p=[{name:"applyCss",handler:function(e,t){return t.applyCssChanges(e.css)}},{name:"clear",handler:function(e,t){return t.clear(e.dynamicNodeId)}},{name:"remove",handler:function(e,t){return t.remove(e.dynamicNodeId)}},{name:"removeAttribute",handler:function(e,t){return t.removeAttribute(e.elementNodeId,e.attributeName)}},{name:"toggleClass",handler:function(e,t){return t.toggleClass(e.elementNodeId,e.value.className,e.value.shouldAdd)}},{name:"setAttribute",handler:function(e,t){return t.setAttribute(e.elementNodeId,e.attributeName,e.attributeValue)}},{name:"setContent",handler:function(e,t,s){return t.setContent(e.dynamicNodeId,e.rootNode,s)}},{name:"setItems",handler:function(e,t,s){return t.setItems(e.dynamicNodeId,e.items,e.css,s)}},{name:"setStyle",handler:function(e,t){return t.setStyle(e.elementNodeId,e.styleName,e.styleValue)}},{name:"toggleDisplay",handler:function(e,t){return t.toggleDisplay(e.dynamicNodeId,e.shouldShow)}},{name:"setEventListener",handler:function(e,t){return t.addEventListener(e.elementNodeId,e.eventName,e.options)}},{name:"focus",handler:function(e,t){return t.focus(e.locatorClass,e.elemIndex)}},{name:"setLocatorClass",handler:function(e,t){return t.toggleClass(e.elementNodeId,t.getDomUniqueLocatorClass(e.locatorClass),!0)}},{name:"initTwoWayInputBinding",handler:function(e,t){t.initTwoWayInputBinding(e.elementNodeId,e.inputBindingName)}},{name:"initValuePushInputBinding",handler:function(e,t){t.initValuePushInputBinding(e.elementNodeId,e.inputBindingName)}},{name:"initValueSubscribeInputBinding",handler:function(e,t){t.initValueSubscribeInputBinding(e.elementNodeId,e.inputBindingName)}},{name:"twoWayInputBindingCommit",handler:function(e,t){t.twoWayInputBindingCommit(e.elementNodeId,e.inputBindingName,e.value)}},{name:"pushInputValue",handler:function(e,t){t.pushInputValue(e.elementNodeId,e.inputBindingName,e.value)}}],u=function(){function e(e){var t=this;this._options=e,this._memoryManager=new o.MemoryManager,this._domAgent=new l.DirectDomAgent,this._cssMap=new Map,this._attributeSanitizer=this._options.config.attributeSanitizer,this._getHtmlString=this._options.config.htmlElementDataSerializer,this._idMapPrefix=this._options.idMapPrefix,this._rootElement=this._options.rootElement,this._createHookState=this._options.config.createHookState,this._sendNotification=this._options.config.notificationCallback,this._serializeHooks=this._options.config.serializeHooks,this._postRender=this._options.config.postRender,this._getElement=function(e){return t._memoryManager.getAndEnsureElementNode(e).element},this._customEventHandlerMap=(0,d.makeMap)(e.config.customEventHandlers||[],(function(e){return e.eventName}),(function(e){return e.handler}));var n=(0,i.serializeRootNode)(e.rootNode,e.setRootInstructionOptions,this._memoryManager.outerLtmRoot,this._idMapPrefix,this._getHtmlString,this._attributeSanitizer,this._serializeHooks,this._createHookState),r=n.containerDoc;g(n.elementNodes,n.dynamicNodes,this._memoryManager,n.commentLookup,r),(0,s.removeAllChildren)(e.rootElement),this.applyCssChanges(e.cssChanges),e.rootElement.appendChild(r),this._postRender&&this._postRender({hooksState:n.hooksState,getElement:this._getElement})}return e.prototype.dispose=function(){this._memoryManager.dispose(),(0,s.removeAllChildren)(this._rootElement)},e.prototype.applyCssChanges=function(e){for(var t=e.newCssDefinition,s=0,i=Object.keys(t);s<i.length;s++){var o=i[s];this._cssMap.set(o,t[o])}for(var n=[],r=[],a=0,l=e.addedCss;a<l.length;a++){var d=l[a];n.push(this._cssMap.get(d))}for(var c=0,p=e.removedCss;c<p.length;c++){d=p[c];r.push(this._cssMap.get(d))}(n.length||r.length)&&this._options.config.cssLoader(n,r)},e.prototype.setAttribute=function(e,t,s){this._domAgent.setAttribute(this._memoryManager,this._attributeSanitizer,e,t,(0,i.mapAttributeIdPointers)(t,s,this._idMapPrefix))},e.prototype.removeAttribute=function(e,t){this._domAgent.removeAttribute(this._memoryManager,e,t)},e.prototype.toggleClass=function(e,t,s){this._domAgent.toggleClass(this._memoryManager,e,t,s)},e.prototype.setStyle=function(e,t,s){this._domAgent.setStyle(this._memoryManager,e,t,s)},e.prototype.clear=function(e){var t=this._memoryManager.getAndEnsureDynamicNode(e);this._memoryManager.ensureContentDisposed(t,null),this._domAgent.clear(t)},e.prototype.remove=function(e){this._domAgent.remove(this._memoryManager.releaseDynamicNode(e,null))},e.prototype.toggleDisplay=function(e,t){this._domAgent.toggleDisplay(this._memoryManager,e,t)},e.prototype.addEventListener=function(e,t,i){var o=this,n=this._memoryManager.getAndEnsureElementNode(e),r=n.eventNames;if(r||(r=n.eventNames=[]),r.indexOf(t)<0){r.push(t);var l=this._customEventHandlerMap.get(t);l?l({element:n.element,elementNodeId:e,ltm:n.ltm.innerLtmRoot,options:i}):(0,s.attachEventListener)(n.element,n.ltm.innerLtmRoot,t,(function(s){o._sendNotification({type:"event",elementNodeId:e,eventName:t,eventData:(0,a.getEventData)(s,t)})}))}},e.prototype.setContent=function(e,t,o){var n=this._memoryManager.getAndEnsureDynamicNode(e);(0,a.ensureDynamicNodeOperation)(n.type,4),(0,s.ensureNoContent)(this._memoryManager,n,!1,null);var r=n.selfLtm,l=1&(0,d.getDynamicNodeOperations)(n.type)?n.contentLtm=r.createChildNode():r,c=(0,i.serializeRootNode)(t,o,l,this._idMapPrefix,this._getHtmlString,this._attributeSanitizer,this._serializeHooks,this._createHookState);this._domAgent.setDisplayState(n.commentStart,c.containerDoc),this._renderAfterComment(c,n.commentStart),this._postRender&&this._postRender({hooksState:c.hooksState,getElement:this._getElement})},e.prototype.setItems=function(e,t,s,o){var l=this;this.applyCssChanges(s);var d=this._memoryManager.getAndEnsureDynamicNode(e);(0,a.ensureDynamicNodeOperation)(d.type,8);for(var p=d.itemNodesId,u=(0,r.arrayToSet)(p),g=0,f=t;g<f.length;g++){var x=f[g];if("number"==typeof x){if(!u.delete(x))throw new Error("The ForEachItem node ".concat(x," doesn't exists, state tracking is lost."))}else if("forEachItem"!==x.dynamicNodeType)throw new Error("Only ForEachItem is allowed as children of ForEach node.")}u.forEach((function(e){l._memoryManager.releaseDynamicNode(e,null)}));var b={created:0,deleted:0,skipped:0,moved:0},v=(0,n.processForEachItems)((function(e){return l._memoryManager.getAndEnsureDynamicNode(e)}),(function(e,t){var s=(0,i.serializeRootNode)({children:e},o,d.selfLtm,l._idMapPrefix,l._getHtmlString,l._attributeSanitizer,l._serializeHooks,l._createHookState);return l._domAgent.setDisplayState(d.commentStart,s.containerDoc),l._renderAfterComment(s,t),l._postRender&&l._postRender({hooksState:s.hooksState,getElement:l._getElement}),e.map(h)}),d,t,m,c._identity,b);return b.deleted=p.length-(v.length-b.created),d.itemNodesId=v,v},e.prototype.focus=function(e,t){var s=this._rootElement.getElementsByClassName(this.getDomUniqueLocatorClass(e))[t];s&&document.activeElement!==s&&s.focus()},e.prototype.getElementMetadata=function(e){return this._memoryManager.getAndEnsureElementNode(e)},e.prototype.getMemoryDebugInfo=function(){return this._memoryManager.getDebugInfo()},e.prototype.getDomUniqueLocatorClass=function(e){var t=this;return e.split(" ").filter(c._identity).map((function(e){return t._idMapPrefix+e})).join(" ")},e.prototype.initTwoWayInputBinding=function(e,t){var i=this,o=this._memoryManager.getAndEnsureElementNode(e),n=this._domAgent.prepareInitInputBinding(o,t),r={type:"twoWay",name:t,pendingCount:0};this._domAgent.inputBindingsMgr.createInputBinding(o,r);for(var a=0,l=n.eventsToListen;a<l.length;a++){var d=l[a];(0,s.attachEventListener)(o.element,o.ltm.innerLtmRoot,d,(function(s){i._sendNotification({type:"twoWayInputBinding",elementNodeId:e,inputBindingName:t,eventData:n.collectDataFromEvent(s)}),r.pendingCount++}))}},e.prototype.initValuePushInputBinding=function(e,t){var i=this._memoryManager.getAndEnsureElementNode(e),o=this._domAgent.prepareInitInputBinding(i,t),n={type:"valuePush",name:t,lastReceivedValue:void 0};this._domAgent.inputBindingsMgr.createInputBinding(i,n);for(var r=i.element,a=0,l=o.eventsToListen;a<l.length;a++){var d=l[a];(0,s.attachEventListener)(r,i.ltm.innerLtmRoot,d,(function(){o.writeValueToElement(r,n.lastReceivedValue)}))}},e.prototype.initValueSubscribeInputBinding=function(e,t){var i=this,o=this._memoryManager.getAndEnsureElementNode(e),n=this._domAgent.prepareInitInputBinding(o,t),r={type:"valueSubscribe",name:t};this._domAgent.inputBindingsMgr.createInputBinding(o,r);for(var a=o.element,l=0,d=n.eventsToListen;l<d.length;l++){var c=d[l];(0,s.attachEventListener)(a,o.ltm.innerLtmRoot,c,(function(s){i._sendNotification({type:"valueSubscribeInputBinding",elementNodeId:e,inputBindingName:t,eventData:n.collectDataFromEvent(s)})}))}},e.prototype.twoWayInputBindingCommit=function(e,t,s){var i=this._memoryManager.getAndEnsureElementNode(e),o=this._domAgent.inputBindingsMgr.resolveInputBinding(i,t,["twoWay"]),n=this._domAgent.ensureInputBindingMetadata(t);if(o.pendingCount<=0)throw new Error("Received more twoWayInputBindingCommit message than it should. ".concat(e,', "').concat(t,'", ').concat(o.pendingCount));o.pendingCount--,0===o.pendingCount&&n.writeValueToElement(i.element,s)},e.prototype.pushInputValue=function(e,t,s){var i=this._memoryManager.getAndEnsureElementNode(e),o=this._domAgent.inputBindingsMgr.resolveInputBinding(i,t,["twoWay","valuePush"]),n=this._domAgent.ensureInputBindingMetadata(t);"twoWay"===o.type?0===o.pendingCount&&n.writeValueToElement(i.element,s):(o.lastReceivedValue=s,n.writeValueToElement(i.element,s))},e.prototype._renderAfterComment=function(e,t){var i=t.nextSibling,o=e.containerDoc;g(e.elementNodes,e.dynamicNodes,this._memoryManager,e.commentLookup,o),(0,s.insertNodeBeforeNode)(i,o)},e}();function m(e){return"number"!=typeof e}function g(e,t,i,o,n){for(var r=0,a=e;r<a.length;r++){var l=a[r],d=(0,s.getElementByIdInDocumentFragment)(n,l.domId);i.setElementNode({nodeId:l.nodeId,element:d,ltm:l.ltm})}for(var c=0,p=t;c<p.length;c++){var u=p[c];i.setDynamicNode({nodeId:u.nodeId,type:u.nodeType,commentStart:o.get(u.commentStartId),commentEnd:o.get(u.commentEndId),contentLtm:u.initContentLtm,selfLtm:u.selfLtm,itemNodesId:u.initItemsId})}}function h(e){return e.nodeId}t.SandboxModeRenderEngine=u;var f=0})),
define("MsPortalImpl/Weave/SandboxRender",["require","exports","MsPortalImpl/Weave/InternalUtil","WeaveDOM/SandboxRender/WeaveSandbox","MsPortalImpl/Base/Base.KnockoutExtensions.Image","Viva.Controls/Util/Viva.Resize","MsPortalImpl/Weave/SandboxDomAgents/EntryPoint","MsPortalImpl/Base/Base.Timers","WeaveDOM/Core/InternalUtil","Weave/Core/InternalUtil"],(function(e,t,s,i,o,n,r,a,l,d){"use strict";function c(e,t,i){return{eventName:e,handler:({element:o,elementNodeId:n,ltm:r,options:a})=>{const c=a;(0,l.attachEventListener)(o,r,t,(o=>{(0,s.matchKeyCode)(null==c?void 0:c.stopPropagation,o.keyCode)&&o.stopPropagation(),(0,s.matchKeyCode)(null==c?void 0:c.preventDefault,o.keyCode)&&o.preventDefault(),i.postMessage({type:"event",elementNodeId:n,eventName:e,eventData:(0,d.getEventData)(o,t)})}))}}}Object.defineProperty(t,"__esModule",{value:!0}),t.connectWeaveShellPort=void 0,t.connectWeaveShellPort=function(t,d,p,u){let m=!1;return(0,i.connect_internal)(d,{cssLoader:u,registerOnReceive:e=>{if(m)throw new Error("onReceive can only be registered once.");m=!0,t.onObject((t=>{e(t.body,t.obj)}))},registerOnDispose:e=>t.onDispose(e),notificationCallback:e=>t.postMessage(e),attributeSanitizer:{href:t=>(0,s.sanitizeHref)(t,{diContainer:p,windowContext:d,localRequire:e}),src:s.sanitizeSrc},htmlElementDataSerializer:(0,s.makeHtmlDataHandler)(d,p,!1),customEventHandlers:[{eventName:"fxResize",handler:({element:e,elementNodeId:s,ltm:i})=>{(0,a.requestAnimationFrame)((()=>{i.isDisposed()||(0,n.track)(i.createChildLifetime(),$(e),((e,i)=>{t.postMessage({type:"event",elementNodeId:s,eventName:"fxResize",eventData:{height:i||0,width:e||0}})}),{notifyInitialSize:!0})}))}},{eventName:"fxCustomClick",handler:({element:e,elementNodeId:s,ltm:i,options:o})=>{const n=o;(0,l.attachEventListener)(e,i,"click",(e=>{!0===(null==n?void 0:n.stopPropagation)&&e.stopPropagation(),!0===(null==n?void 0:n.preventDefault)&&e.preventDefault(),t.postMessage({type:"event",elementNodeId:s,eventName:"fxCustomClick",eventData:null})}))}},c("fxCustomKeyDown","keydown",t),c("fxCustomKeyUp","keyup",t),c("fxCustomKeyPress","keypress",t)],customInstructionHandlers:[{name:"fxSetImage",handler:(e,t)=>(0,o.renderImage)(t.getElementMetadata(e.elementNodeId).element,e.value)},{name:"fxSetFocus",handler:(e,t)=>t.getElementMetadata(e.elementNodeId).element.focus()},{name:"fxRequestConfirm",handler:(e,s)=>{const i=window.confirm(e.value.content)?"ok":"cancel";t.postMessage({type:"fxAnswerConfirm",value:{reply:i,replyId:e.value.replyId}})}}],createHookState:()=>[],serializeHooks:{element:{postSerialize:({addAttribute:e,getElementNodeId:t,node:s,options:i,ltm:o,hooksState:n})=>{const r=s;r.proxiedDataIndexes&&r.proxiedDataIndexes.length>0&&(r.proxiedDataIndexes.some((e=>"pcControl"===i[e].type))&&e("data-bind","pcControl: __control_vm__"),n.push({ltm:o,nodeId:t(),proxiedDataList:r.proxiedDataIndexes.map((e=>i[e]))}))}}},postRender:({hooksState:e,getElement:t})=>{for(const i of e){const e=t(i.nodeId),o=i.ltm;let n=!1,a=!1,l=!1;for(const t of i.proxiedDataList)switch(t.type){case"pcControl":{if(n)throw new Error("Duplicate control vm associated to one element found.");n=!0;const s=t.data,i=new ko.bindingContext({__control_vm__:s.vm}).extend({$tabIndex:s.tabIndex,$disabled:s.disabled,$partName:s.partName,$extensionName:s.extensionName,$vm:s.vm,$dicontainer:p});ko.applyBindings(i,e),o.registerForDispose((()=>ko.cleanNode(e)));break}case"fxclick":{if(a)throw new Error("Duplicate fxclick associated to one element found.");a=!0;const i=t.data;(0,s.applyFxClickToElement)(e,o,i.data,{diContainer:p,disabled:i.disabled,tabIndex:i.tabIndex});break}case"domAgent":if(l)throw new Error("Duplicate attachWidget associated to one element found.");l=!0,(0,r.attachSandboxDomAgent)(e,o,p,t.data);break;default:throw new Error(`Unknown proxied data type: ${t.type}`)}}}})}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.PartError.css",["module"],(function(e){"use strict";return{css:".fxs-part-error-content{display:flex;flex-flow:column nowrap;height:100%;box-sizing:border-box;max-width:715px;font-size:13px;margin:0 auto}.fxs-part-error-reason,.fxs-part-error-detailslink{text-align:center;flex:0 0 auto;margin-bottom:4px}.fxs-part-error-healthlinkcontainer{margin:-10px 15px 0}.fxs-part-error-showdetailscontainer{display:flex;flex-flow:row nowrap;align-items:center;justify-content:center}.fxs-part-error-detailslink{display:none}.fxs-part .fxs-part-content.fxs-errorpart~.fxs-part-nodatamessage{display:none !important}.fxs-part-error-iconcontainer{display:flex;flex-flow:column nowrap;align-items:center;justify-content:center;flex:0 1 auto}.fxs-part-error-icon{flex:0 0 auto;display:block;height:50px;width:50px;padding:10px}.fxs-part-error-commandlist{display:flex;justify-content:center;flex:0 0 auto;margin:0 auto}.fxs-part-error-commandlist ul{display:inline-block}.fxs-part-error-summary{border-width:1px;border-style:solid;overflow-x:hidden;overflow-y:auto;flex:0 1 auto;margin:10px 0}.fxs-part-error-summaryheadercontainer{margin:15px;display:flex;align-items:center}.fxs-part-error-summaryheader{margin:0}.fxs-part-error-summaryfooter{margin:15px}.fxs-part-error-summarycopybutton{margin-left:15px}.fxs-part-error-summarylist{list-style-type:none;padding:0;margin:15px;display:flex;flex-flow:row wrap;align-content:flex-start}.fxs-part-error-summarylistitem{margin:0 10px 10px 0;width:calc(50% - 10px);min-width:225px}.fxs-part-error-summarylistitem-key,.fxs-part-error-summarylistitem-value{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.fxs-part-error-details{margin:15px}.fxs-tilesize-mini .fxs-part-error .fxs-part-error-icon,.fxs-tilesize-small .fxs-part-error .fxs-part-error-icon{margin-top:-15px}.fxs-tilesize-mini .fxs-part-error .fxs-part-error-detailslink,.fxs-tilesize-small .fxs-part-error .fxs-part-error-detailslink{padding:0;margin-top:-12px}.fxs-part-error-hidereason .fxs-part-error-reason{display:none}.fxs-part-error-hidecommandlist .fxs-part-error-commandlist{display:none}.fxs-part-error-hidecommandlist .fxs-part-error-detailslink{display:inline-block}.fxs-part-error-hidesummary .fxs-part-error-summary{display:none}.fxs-blade-errorcontent .fxs-part-error-icon{height:125px;width:125px}.fxs-blade-errorcontent .fxs-part-error-reason{font-size:18px}",moduleId:e.id}})),
define("MsPortalImpl/Widgets/Widgets.PartError",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Resources/ImplScriptResources","Fx/Controls/CopyableLabel","Fx/Controls/Toolbar","MsPortalImpl/Widgets/Widgets.WidgetBase","Viva.Controls/Util/Viva.Resize","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.PartError.css"],(function(e,t,s,i,o,n,r,a,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Widget=t.ViewModel=void 0,(0,d.injectCss)(c);var p=MsPortalFx.Base,u=p.Diagnostics.Telemetry;const m=window,g="fxs-errorpart",h=o.PartError,f=s("div",{class:"fxs-part-error-content","data-bind":{css:"responsiveClasses"}},s("div",{class:"fxs-part-error-iconcontainer"},s("div",{"data-bind":{image:"data.icon"},class:"fxs-part-error-icon"})),s("div",{"data-bind":{untrustedContent:"data.errorOptions.message"},class:"fxs-part-error-reason"}),s("div",{class:"fxs-part-error-showdetailscontainer"},s("a",{href:"#",role:"button","data-bind":{click:"$data.showdetails",clickBubble:"false",text:"$data.showdetailstext"},class:"fxs-part-error-detailslink"})),s("div",{"data-bind":{pcControl:"toolbar"},class:"fxs-part-error-commandlist"}),s("div",{class:"fxs-part-error-summary fxs-portal-bg-txt-br"},s("div",{class:"fxs-part-error-summaryheadercontainer"},s("h4",{class:"fxs-part-error-summaryheader msportalfx-font-semibold"},h.summary),s("div",{"data-bind":{pcControl:"copyBtn"},class:"fxs-part-error-summarycopybutton"})),s("ul",{"data-bind":{foreach:"data.summaryItems"},class:"fxs-part-error-summarylist"},s("li",{class:"fxs-part-error-summarylistitem"},s("label",{"data-bind":{text:"label"},class:"fxs-part-error-summarylistitem-key fxs-portal-subtext"}),s("div",{"data-bind":{text:"value"},class:"fxs-part-error-summarylistitem-value"}))),s("div",{"data-bind":{visible:"data.errorOptions.code >= 500"},class:"fxs-part-error-healthlinkcontainer"},s("a",{href:"#blade/Microsoft_Azure_Health/AzureHealthBrowseBlade/serviceIssues","data-bind":{text:"$data.azurehealth"}})),s(i.KoIf,{condition:"data.errorOptions.details"},s("div",{class:"fxs-part-error-details"},s("label",{class:"fxs-part-error-summarylistitem-key fxs-portal-subtext"},h.details),s("div",{"data-bind":{untrustedContent:"data.errorOptions.details"},class:"fxs-part-error-summarylistitem-details"})))));class x extends a.ViewModel{constructor(e,t,s){super(),this.commands=ko.observableArray([]),s=s||{};const i=MsPortalFx.extend({},e,!0);this.originalShellProps=t=t||{},i.message=i.message||h.title;const o="number"==typeof i.code?i.code:"number"==typeof t.code?t.code:Number.NaN;i.code=o;const n={title:h.title};switch(o){case 404:case 410:this.icon=p.Images.Polychromatic.ContentErrorNotFound(n);break;case 401:case 403:this.icon=p.Images.Polychromatic.ContentErrorUnauthorized(n);break;default:this.icon=p.Images.Polychromatic.ContentErrorGeneric(n)}const r=[{label:h.sessionId,value:t.sessionId||h.notAvailable},{label:h.resourceId,value:t.resourceId||h.notAvailable},{label:h.extName,value:t.extName||h.notAvailable},{label:h.contentName,value:t.contentName||h.notAvailable},{label:h.errorCode,value:isNaN(o)?"--":o+""}];i.summaryItems&&(i.summaryItems=i.summaryItems.filter(MsPortalFx.notNullOrUndefined).map((e=>({label:e.label||"",value:e.value||""}))),r.push(...i.summaryItems)),this.summaryItems=r,this.errorOptions=i,this.showDetailsCmd=s.showDetailsCmd||!1}cloneForDetailsPane(){const e=new x(this.errorOptions,this.originalShellProps);return e.commands.push(...this.commands.peek()||[]),e}}t.ViewModel=x;class b extends a.Widget{constructor(e,t,s){super(e,t),this._diContainer=s,e.html(f).addClass(g);const i=ko.observable("");l.track(this.ltm,this.element,((e,s)=>{const o=[];switch((e<145||s<145)&&o.push("fxs-part-error-hidereason"),(e<235||s<145)&&o.push("fxs-part-error-hidecommandlist"),(e<255||s<235)&&o.push("fxs-part-error-hidesummary"),t.errorOptions.code){case 404:case 410:o.push("fxs-part-notfoundmessage","fxs-part-notfound");break;case 401:case 403:o.push("fxs-part-noaccessmessage")}i(o.join(" "))}));const o=()=>(u.trace({source:"Shell",action:"ErrorInteraction",actionModifier:"DetailView",context:{content:t.originalShellProps.contentName}}),MsPortalFx.require("MsPortalImpl/UI/UI.Portal.Actions").then((e=>{e.showErrorContextPane(this._diContainer,this.ltm,t)})),!1);let a=[];t.showDetailsCmd&&a.push(r.ToolbarItems.createBasicButton(this.ltm,{label:h.errordetailsbtn,icon:p.Images.Gear(),onClick:o})),t.commands().length&&(a=t.commands().map((e=>r.ToolbarItems.createBasicButton(this.ltm,{label:e.text,icon:e.icon,onClick:()=>{e.execute(!1)}})))),MsPortalFx.isFeatureEnabled("parterrorshowprodbutton")&&a.push(r.ToolbarItems.createBasicButton(this.ltm,{label:h.openProductionUri,icon:p.Images.Hyperlink(),onClick:()=>{u.trace({source:"Shell",action:"ErrorInteraction",actionModifier:"LeavePreview",context:{content:t.originalShellProps.contentName}});const e=new p.UriBuilder(m.location.toString());e.path=e.path.replace("//rc.","//").replace("//ms.","//").replace("//preview.","//"),e.query.setParameter("feature.customportal","false"),m.open(e.toString())}})),401!==t.errorOptions.code&&403!==t.errorOptions.code&&(a.push(r.ToolbarItems.createBasicButton(this.ltm,{label:h.getsupportbtn,icon:p.Images.Help(),onClick:()=>{u.trace({source:"Shell",action:"ErrorInteraction",actionModifier:"NewSupportRequest",context:{content:t.originalShellProps.contentName}}),MsPortalFx.require("MsPortalImpl/UI/UI.Portal.Actions").then((e=>{e.openSubmitSupportCase(this._diContainer,{callerName:`${t.originalShellProps.extName} + ${t.originalShellProps.contentName||"##Content Unknown##"}`,assetId:t.originalShellProps.resourceId,issueType:"technical",issueContext:{shellProps:JSON.stringify(t.originalShellProps),error:JSON.stringify(t.errorOptions)}})}))}})),a.push(r.ToolbarItems.createBasicButton(this.ltm,{label:h.selfDiagnostics,icon:p.Images.Wrench(),onClick:()=>{u.trace({source:"Shell",action:"ErrorInteraction",actionModifier:"SelfDiagnostics",context:{content:t.originalShellProps.contentName}});const e=fx.environment.applicationPath+"/SelfHelp";window.open(e)}})));const d=r.create(this.ltm,{items:a,showLabels:!0}),c=n.create(this.ltm,{ariaLabel:h.copySummary,hideTextbox:!0,value:JSON.stringify({shellProps:t.originalShellProps,error:t.errorOptions},null,2)});this._bindDescendants({responsiveClasses:i,showdetails:o,showdetailstext:h.errordetailsbtn,azurehealth:h.azurehealthlink,toolbar:d,copyBtn:c})}dispose(){this._cleanElement(g),super.dispose()}}t.Widget=b})),
define("_generated/Less/MsPortalImpl/CssLibrary/AzureCompatibleOfficeLayoutGrid.css",["module"],(function(e){"use strict";return{css:'.ms-Grid{box-sizing:border-box;zoom:1;padding:0 8px}.ms-Grid::before,.ms-Grid::after{display:table;content:"";line-height:0}.ms-Grid::after{clear:both}.ms-Grid-row{margin:0 -8px;box-sizing:border-box;zoom:1}.ms-Grid-row::before,.ms-Grid-row::after{display:table;content:"";line-height:0}.ms-Grid-row::after{clear:both}.ms-Grid-col{position:relative;min-height:1px;padding-left:8px;padding-right:8px;box-sizing:border-box}.ms-Grid-col{float:left}.ms-Grid-col .ms-Grid{padding:0}.fxs-blade-layout-sm:not(.fxs-blade-layout-md) .ms-hiddenSm,.fxs-blade-layout-sm:not(.fxs-blade-layout-md) .ms-hiddenMdDown,.fxs-blade-layout-sm:not(.fxs-blade-layout-md) .ms-hiddenLgDown,.fxs-blade-layout-sm:not(.fxs-blade-layout-md) .ms-hiddenXlDown,.fxs-blade-layout-sm:not(.fxs-blade-layout-md) .ms-hiddenXxlDown{display:none !important}.fxs-blade-layout-md:not(.fxs-blade-layout-lg) .ms-hiddenMd,.fxs-blade-layout-md:not(.fxs-blade-layout-lg) .ms-hiddenMdUp,.fxs-blade-layout-md:not(.fxs-blade-layout-lg) .ms-hiddenMdDown,.fxs-blade-layout-md:not(.fxs-blade-layout-lg) .ms-hiddenLgDown,.fxs-blade-layout-md:not(.fxs-blade-layout-lg) .ms-hiddenXlDown,.fxs-blade-layout-md:not(.fxs-blade-layout-lg) .ms-hiddenXxlDown{display:none !important}.fxs-blade-layout-lg:not(.fxs-blade-layout-xl) .ms-hiddenMdUp,.fxs-blade-layout-lg:not(.fxs-blade-layout-xl) .ms-hiddenLg,.fxs-blade-layout-lg:not(.fxs-blade-layout-xl) .ms-hiddenLgUp,.fxs-blade-layout-lg:not(.fxs-blade-layout-xl) .ms-hiddenLgDown,.fxs-blade-layout-lg:not(.fxs-blade-layout-xl) .ms-hiddenXlDown,.fxs-blade-layout-lg:not(.fxs-blade-layout-xl) .ms-hiddenXxlDown{display:none !important}.fxs-blade-layout-xl:not(.fxs-blade-layout-xxl) .ms-hiddenMdUp,.fxs-blade-layout-xl:not(.fxs-blade-layout-xxl) .ms-hiddenLgUp,.fxs-blade-layout-xl:not(.fxs-blade-layout-xxl) .ms-hiddenXl,.fxs-blade-layout-xl:not(.fxs-blade-layout-xxl) .ms-hiddenXlUp,.fxs-blade-layout-xl:not(.fxs-blade-layout-xxl) .ms-hiddenXlDown,.fxs-blade-layout-xl:not(.fxs-blade-layout-xxl) .ms-hiddenXxlDown{display:none !important}.fxs-blade-layout-xxl:not(.fxs-blade-layout-xxxl) .ms-hiddenMdUp,.fxs-blade-layout-xxl:not(.fxs-blade-layout-xxxl) .ms-hiddenLgUp,.fxs-blade-layout-xxl:not(.fxs-blade-layout-xxxl) .ms-hiddenXlUp,.fxs-blade-layout-xxl:not(.fxs-blade-layout-xxxl) .ms-hiddenXxl,.fxs-blade-layout-xxl:not(.fxs-blade-layout-xxxl) .ms-hiddenXxlUp,.fxs-blade-layout-xxl:not(.fxs-blade-layout-xxxl) .ms-hiddenXxlDown{display:none !important}.fxs-blade-layout-xxxl .ms-hiddenMdUp,.fxs-blade-layout-xxxl .ms-hiddenLgUp,.fxs-blade-layout-xxxl .ms-hiddenXlUp,.fxs-blade-layout-xxxl .ms-hiddenXxlUp,.fxs-blade-layout-xxxl .ms-hiddenXxxl{display:none !important}.ms-sm12{width:100%}.ms-sm11{width:91.66666667%}.ms-sm10{width:83.33333333%}.ms-sm9{width:75%}.ms-sm8{width:66.66666667%}.ms-sm7{width:58.33333333%}.ms-sm6{width:50%}.ms-sm5{width:41.66666667%}.ms-sm4{width:33.33333333%}.ms-sm3{width:25%}.ms-sm2{width:16.66666667%}.ms-sm1{width:8.33333333%}.fxs-blade-layout-md .ms-md12{width:100%}.fxs-blade-layout-md .ms-md11{width:91.66666667%}.fxs-blade-layout-md .ms-md10{width:83.33333333%}.fxs-blade-layout-md .ms-md9{width:75%}.fxs-blade-layout-md .ms-md8{width:66.66666667%}.fxs-blade-layout-md .ms-md7{width:58.33333333%}.fxs-blade-layout-md .ms-md6{width:50%}.fxs-blade-layout-md .ms-md5{width:41.66666667%}.fxs-blade-layout-md .ms-md4{width:33.33333333%}.fxs-blade-layout-md .ms-md3{width:25%}.fxs-blade-layout-md .ms-md2{width:16.66666667%}.fxs-blade-layout-md .ms-md1{width:8.33333333%}.fxs-blade-layout-lg .ms-lg12{width:100%}.fxs-blade-layout-lg .ms-lg11{width:91.66666667%}.fxs-blade-layout-lg .ms-lg10{width:83.33333333%}.fxs-blade-layout-lg .ms-lg9{width:75%}.fxs-blade-layout-lg .ms-lg8{width:66.66666667%}.fxs-blade-layout-lg .ms-lg7{width:58.33333333%}.fxs-blade-layout-lg .ms-lg6{width:50%}.fxs-blade-layout-lg .ms-lg5{width:41.66666667%}.fxs-blade-layout-lg .ms-lg4{width:33.33333333%}.fxs-blade-layout-lg .ms-lg3{width:25%}.fxs-blade-layout-lg .ms-lg2{width:16.66666667%}.fxs-blade-layout-lg .ms-lg1{width:8.33333333%}.fxs-blade-layout-xl .ms-xl12{width:100%}.fxs-blade-layout-xl .ms-xl11{width:91.66666667%}.fxs-blade-layout-xl .ms-xl10{width:83.33333333%}.fxs-blade-layout-xl .ms-xl9{width:75%}.fxs-blade-layout-xl .ms-xl8{width:66.66666667%}.fxs-blade-layout-xl .ms-xl7{width:58.33333333%}.fxs-blade-layout-xl .ms-xl6{width:50%}.fxs-blade-layout-xl .ms-xl5{width:41.66666667%}.fxs-blade-layout-xl .ms-xl4{width:33.33333333%}.fxs-blade-layout-xl .ms-xl3{width:25%}.fxs-blade-layout-xl .ms-xl2{width:16.66666667%}.fxs-blade-layout-xl .ms-xl1{width:8.33333333%}.fxs-blade-layout-xxl .ms-xxl12{width:100%}.fxs-blade-layout-xxl .ms-xxl11{width:91.66666667%}.fxs-blade-layout-xxl .ms-xxl10{width:83.33333333%}.fxs-blade-layout-xxl .ms-xxl9{width:75%}.fxs-blade-layout-xxl .ms-xxl8{width:66.66666667%}.fxs-blade-layout-xxl .ms-xxl7{width:58.33333333%}.fxs-blade-layout-xxl .ms-xxl6{width:50%}.fxs-blade-layout-xxl .ms-xxl5{width:41.66666667%}.fxs-blade-layout-xxl .ms-xxl4{width:33.33333333%}.fxs-blade-layout-xxl .ms-xxl3{width:25%}.fxs-blade-layout-xxl .ms-xxl2{width:16.66666667%}.fxs-blade-layout-xxl .ms-xxl1{width:8.33333333%}.fxs-blade-layout-xxxl .ms-xxxl12{width:100%}.fxs-blade-layout-xxxl .ms-xxxl11{width:91.66666667%}.fxs-blade-layout-xxxl .ms-xxxl10{width:83.33333333%}.fxs-blade-layout-xxxl .ms-xxxl9{width:75%}.fxs-blade-layout-xxxl .ms-xxxl8{width:66.66666667%}.fxs-blade-layout-xxxl .ms-xxxl7{width:58.33333333%}.fxs-blade-layout-xxxl .ms-xxxl6{width:50%}.fxs-blade-layout-xxxl .ms-xxxl5{width:41.66666667%}.fxs-blade-layout-xxxl .ms-xxxl4{width:33.33333333%}.fxs-blade-layout-xxxl .ms-xxxl3{width:25%}.fxs-blade-layout-xxxl .ms-xxxl2{width:16.66666667%}.fxs-blade-layout-xxxl .ms-xxxl1{width:8.33333333%}',moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/CssLibrary/AzureDeprecatedChartingColor.css",["module"],(function(e){"use strict";return{css:".msportalfx-bgcolor-a1{background-color:#fcd116;color:#000}.msportalfx-bgcolor-b1{background-color:#eb3c00;color:#fff}.msportalfx-bgcolor-c1{background-color:#ba141a;color:#fff}.msportalfx-bgcolor-d1{background-color:#b4009e;color:#fff}.msportalfx-bgcolor-e1{background-color:#442359;color:#fff}.msportalfx-bgcolor-f1{background-color:#002050;color:#fff}.msportalfx-bgcolor-g1{background-color:#0072c6;color:#fff}.msportalfx-bgcolor-h1{background-color:#008272;color:#fff}.msportalfx-bgcolor-i1{background-color:#007233;color:#fff}.msportalfx-bgcolor-j1{background-color:#7fba00;color:#fff}.msportalfx-bgcolor-k1{background-color:#a0a5a8;color:#fff}.msportalfx-bgcolor-a0{background-color:#fff100;color:#000}.msportalfx-bgcolor-b0{background-color:#ff8c00;color:#fff}.msportalfx-bgcolor-c0{background-color:#e81123;color:#fff}.msportalfx-bgcolor-d0{background-color:#ec008c;color:#fff}.msportalfx-bgcolor-e0{background-color:#68217a;color:#fff}.msportalfx-bgcolor-f0{background-color:#00188f;color:#fff}.msportalfx-bgcolor-g0{background-color:#00bcf2;color:#fff}.msportalfx-bgcolor-h0{background-color:#00b294;color:#fff}.msportalfx-bgcolor-i0{background-color:#009e49;color:#fff}.msportalfx-bgcolor-j0{background-color:#bad80a;color:#000}.msportalfx-bgcolor-k0{background-color:#bbc2ca;color:#000}.msportalfx-bgcolor-a2{background-color:#fffc9e;color:#000}.msportalfx-bgcolor-b2{background-color:#ffb900;color:#000}.msportalfx-bgcolor-c2{background-color:#dd5900;color:#fff}.msportalfx-bgcolor-d2{background-color:#f472d0;color:#fff}.msportalfx-bgcolor-e2{background-color:#9b4f96;color:#fff}.msportalfx-bgcolor-f2{background-color:#4668c5;color:#fff}.msportalfx-bgcolor-g2{background-color:#6dc2e9;color:#000}.msportalfx-bgcolor-h2{background-color:#00d8cc;color:#000}.msportalfx-bgcolor-i2{background-color:#55d455;color:#000}.msportalfx-bgcolor-j2{background-color:#e2e584;color:#000}.msportalfx-bgcolor-k2{background-color:#d6d7d8;color:#000}.msportalfx-bgcolor-a0s2{background-color:#807900;color:#fff}.msportalfx-bgcolor-b0s2{background-color:#804600;color:#fff}.msportalfx-bgcolor-c0s2{background-color:#740912;color:#fff}.msportalfx-bgcolor-d0s2{background-color:#760046;color:#fff}.msportalfx-bgcolor-e0s2{background-color:#34113d;color:#fff}.msportalfx-bgcolor-f0s2{background-color:#000c48;color:#fff}.msportalfx-bgcolor-g0s2{background-color:#005e79;color:#fff}.msportalfx-bgcolor-h0s2{background-color:#084c41;color:#fff}.msportalfx-bgcolor-i0s2{background-color:#063d20;color:#fff}.msportalfx-bgcolor-j0s2{background-color:#3d460a;color:#fff}.msportalfx-bgcolor-k0s2{background-color:#32383f;color:#fff}.msportalfx-bgcolor-a0s1{background-color:#bfb500;color:#000}.msportalfx-bgcolor-b0s1{background-color:#bf6900;color:#fff}.msportalfx-bgcolor-c0s1{background-color:#ae0d1a;color:#fff}.msportalfx-bgcolor-d0s1{background-color:#b10069;color:#fff}.msportalfx-bgcolor-e0s1{background-color:#4e195c;color:#fff}.msportalfx-bgcolor-f0s1{background-color:#00126b;color:#fff}.msportalfx-bgcolor-g0s1{background-color:#008db5;color:#fff}.msportalfx-bgcolor-h0s1{background-color:#00856f;color:#fff}.msportalfx-bgcolor-i0s1{background-color:#0f5b2f;color:#fff}.msportalfx-bgcolor-j0s1{background-color:#8ba208;color:#fff}.msportalfx-bgcolor-k0s1{background-color:#464f59;color:#fff}.msportalfx-bgcolor-a0t1{background-color:#fcf37e;color:#000}.msportalfx-bgcolor-b0t1{background-color:#ffba66;color:#000}.msportalfx-bgcolor-c0t1{background-color:#f1707b;color:#fff}.msportalfx-bgcolor-d0t1{background-color:#f466ba;color:#fff}.msportalfx-bgcolor-e0t1{background-color:#a47aaf;color:#fff}.msportalfx-bgcolor-f0t1{background-color:#6674bc;color:#fff}.msportalfx-bgcolor-g0t1{background-color:#66d7f7;color:#000}.msportalfx-bgcolor-h0t1{background-color:#66d1bf;color:#000}.msportalfx-bgcolor-i0t1{background-color:#66c592;color:#000}.msportalfx-bgcolor-j0t1{background-color:#d6e86c;color:#000}.msportalfx-bgcolor-k0t1{background-color:#8f9ca8;color:#fff}.msportalfx-bgcolor-a0t2{background-color:#fffccc;color:#000}.msportalfx-bgcolor-b0t2{background-color:#ffe8cc;color:#000}.msportalfx-bgcolor-c0t2{background-color:#facfd3;color:#000}.msportalfx-bgcolor-d0t2{background-color:#fbcce8;color:#000}.msportalfx-bgcolor-e0t2{background-color:#e1d3e4;color:#000}.msportalfx-bgcolor-f0t2{background-color:#ccd1e9;color:#000}.msportalfx-bgcolor-g0t2{background-color:#ccf2fc;color:#000}.msportalfx-bgcolor-h0t2{background-color:#ccf0ea;color:#000}.msportalfx-bgcolor-i0t2{background-color:#ccecdb;color:#000}.msportalfx-bgcolor-j0t2{background-color:#f0f7b2;color:#000}.msportalfx-bgcolor-k0t2{background-color:#63707e;color:#fff}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/CssLibrary/AzureDeprecatedSemanticText.css",["module"],(function(e){"use strict";return{css:'.msportalfx-text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.msportalfx-font-regular{font-family:az_ea_font,"Segoe UI",az_font,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;font-weight:400}.msportalfx-font-bold{font-weight:700}.msportalfx-font-semibold{font-weight:600}.msportalfx-font-light,.msportalfx-font-semilight{font-weight:200}.msportalfx-font-monospace{font-family:Consolas,"Courier New",monospace;font-size:13px;line-height:normal}.msportalfx-text-header{font-size:14px;line-height:18px}.msportalfx-text-header-small,.msportalfx-text-label{font-size:13px;line-height:normal;text-transform:uppercase}.msportalfx-text-small{font-size:13px;line-height:normal}.msportalfx-text-subheader{font-size:10px;line-height:10px;padding-bottom:1px}html[lang^="ja"] .msportalfx-text-subheader,html[lang^="ko"] .msportalfx-text-subheader,html[lang^="zh"] .msportalfx-text-subheader{font-size:11px;line-height:11px}.msportalfx-text-header-regular{font-size:14px;line-height:18px}.msportalfx-text-regular{font-size:13px;line-height:normal}.msportalfx-text-preview{font-weight:600;font-size:11px;line-height:11px;text-transform:uppercase;color:#fff}.msportalfx-text-createsectionheader{font-weight:200;font-size:20px;line-height:normal}.msportalfx-number-jumbo{font-weight:600;font-size:60px;line-height:60px;letter-spacing:-.02em}.msportalfx-number-large{font-weight:600;font-size:43px;line-height:43px;letter-spacing:-.02em}.msportalfx-number-medium{font-weight:600;font-size:30px;line-height:30px;letter-spacing:-.025em}.msportalfx-number-small{font-weight:600;font-size:17px;line-height:17px;letter-spacing:-.02em}.msportalfx-number-jumbo-adorn{font-weight:700;font-size:20px;line-height:20px;letter-spacing:-.02em}.msportalfx-number-large-adorn{font-weight:700;font-size:15px;line-height:15px;letter-spacing:-.02em}.msportalfx-number-medium-adorn{font-weight:700;font-size:15px;line-height:15px;letter-spacing:-.02em}.msportalfx-number-small-adorn{font-weight:700;font-size:10px;line-height:10px;letter-spacing:-.05em}.msportalfx-lineheight-reset{line-height:normal}',moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/CssLibrary/AzureSemanticText.css",["module"],(function(e){"use strict";return{css:'.az-text-small{font-family:az_ea_font,"Segoe UI",az_font,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;font-weight:400;font-size:10px;line-height:1.4}.az-text-note{font-family:az_ea_font,"Segoe UI",az_font,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;font-weight:400;font-size:12px;line-height:1.33333}.az-text-body{font-family:az_ea_font,"Segoe UI",az_font,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;font-weight:400;font-size:13px;line-height:1.38462}.az-text-label{font-weight:600;font-size:13px;line-height:1.38462}.az-text-header3{font-weight:600;font-size:14px;line-height:1.42857}.az-text-header2{font-weight:600;font-size:16px;line-height:1.375}.az-text-header1{font-weight:600;font-size:18px;line-height:1.33333}.az-text-greeting{font-weight:600;font-size:20px;line-height:1.4}@media print{.az-text-header1,.az-text-header2,.az-text-header3,.az-text-label{break-after:avoid}}',moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/CssLibrary/AzureUtil.css",["module"],(function(e){"use strict";return{css:".az-display-none{display:none !important}@media print{.az-noprint{display:none !important}}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/CssLibrary/CustomForm.css",["module"],(function(e){"use strict";return{css:'.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.azc-formElementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.azc-formElementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.msportalfx-form-elementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.msportalfx-form-elementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.azc-formElementSubLabelContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.azc-formElementSubLabelContainer{display:inline-block;vertical-align:middle;width:68%}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement.msportalfx-form-fileUploadField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement.msportalfx-form-fileUploadField{height:80px}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.msportalfx-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.msportalfx-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.azc-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.azc-form-labelcontainer{width:32%;display:inline-block}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular .msportalfx-form-extralabel{display:block;width:68%;margin-left:33%;margin-right:0}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement:nth-child(odd),.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement:nth-child(odd){margin-right:1%}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement{min-height:43px;width:48.75% !important;display:inline-block;vertical-align:top;margin-top:0}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement:first-child,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement:first-child,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement:last-child,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement:last-child{margin-top:0}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement.azc-optionsGroupField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement.azc-optionsGroupField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement.azc-multiLineTextField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement.azc-multiLineTextField{height:auto;margin-right:1px}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement.msportalfx-form-fileUploadField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement.msportalfx-form-fileUploadField{height:100px}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement .msportalfx-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement .msportalfx-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement .azc-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement .azc-form-labelcontainer{display:block;margin-bottom:0;width:auto;min-height:20px}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement .msportalfx-form-elementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement .msportalfx-form-elementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement .azc-formElementSubLabelContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement .azc-formElementSubLabelContainer{display:block;width:100%;margin-left:0}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-extralabel>.msportalfx-form-extralabel{display:inline-block;width:47.75%;margin:43px 1% -49.75% !important}.msportalfx-form.msportalfx-form-custom .msportalfx-form-extralabel{margin-top:0}.fxs-bladestyle-create .msportalfx-form{margin-top:14px}.fxs-bladestyle-create .msportalfx-form .msportalfx-form{margin-top:0}.msportalfx-form:not(.msportalfx-form-custom)>div>.msportalfx-form-formelement,.msportalfx-form:not(.msportalfx-form-custom) .fxc-section>.msportalfx-form-formelement,.msportalfx-form:not(.msportalfx-form-custom)>.msportalfx-form-formelement{padding-bottom:15px;width:100%;min-height:23px}.msportalfx-form:not(.msportalfx-form-custom)>div>.msportalfx-form-formelement .msportalfx-form-formelement,.msportalfx-form:not(.msportalfx-form-custom) .fxc-section>.msportalfx-form-formelement .msportalfx-form-formelement,.msportalfx-form:not(.msportalfx-form-custom)>.msportalfx-form-formelement .msportalfx-form-formelement{padding-bottom:0}.msportalfx-form.msportalfx-vertical-compact>div>.msportalfx-form-formelement,.msportalfx-form.msportalfx-vertical-compact .fxc-section>.msportalfx-form-formelement,.msportalfx-form.msportalfx-vertical-compact>.msportalfx-form-formelement{padding-bottom:7px}.msportalfx-form .msportalfx-form-labelcontainer,.msportalfx-form .azc-form-labelcontainer,.msportalfx-form .azc-checkBoxField-inlineLabelContainer{box-sizing:border-box;min-height:17px}.msportalfx-form .msportalfx-form-labelcontainer label,.msportalfx-form .azc-form-labelcontainer label,.msportalfx-form .azc-checkBoxField-inlineLabelContainer label{max-width:calc(100% - 25px)}.msportalfx-form .azc-checkBoxField-inlineLabelContainer{width:calc(100% - 25px + 2px)}.msportalfx-form .azc-checkBoxField-inlineLabelContainer label{font-size:13px;line-height:normal}.msportalfx-form .azc-validatableControl-invalid+.azc-checkBoxField-inlineLabelContainer{width:calc(100% - 25px + 2px - 6px)}.msportalfx-form .msportalfx-form-labelcontainer label,.msportalfx-form .azc-form-labelcontainer label{font-size:13px;line-height:normal}.msportalfx-form.msportalfx-form-row{padding:0 20px;width:calc(100% - 40px)}.msportalfx-form .azc-multiLineTextField .azc-multiLineTextBox{height:100%}.azc-text-sublabel{float:right;margin-bottom:-1px}.fxc-has-sublabel-html>.azc-formElementSubLabelContainer>.azc-text-sublabel{float:none}.azc-formElementSubLabelContainer::after{content:"";display:table;clear:both}.msportalfx-form:not(.fxc-left-label-fixed) .fxc-left-label .azc-text-sublabel-neighbor{padding-bottom:16px}.msportalfx-form:not(.fxc-left-label-fixed) .fxc-left-label .azc-text-sublabel-neighbor.azc-form-labelcontainer{padding-bottom:calc(16px + 3px)}.msportalfx-form:not(.fxc-left-label-fixed) .fxc-left-label .azc-text-sublabel-neighbor.azc-checkBoxField-inlineLabelContainer{padding-bottom:0}.azc-required-balloon{display:inline-block}.msportalfx-form-extralabel{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:right;margin-top:-15px;padding-bottom:3px}.msportalfx-customHtml .msportalfx-form-extralabel{margin-top:0}.msportalfx-customHtml>.azc-formElementSubLabelContainer{height:100%}.msportalfx-customHtml>.azc-formElementSubLabelContainer>.azc-formElementContainer{height:100%}.msportalfx-form-formelement .azc-dockedballoon.azc-dockedballoon-info{height:15px;width:15px}.msportalfx-nested-control:not(.fxc-left-label){padding-left:45px;position:relative;box-sizing:border-box}.msportalfx-nested-control:not(.fxc-left-label)::before{display:block;content:"";border-left:1px solid #a9a9a9;border-bottom:1px solid #a9a9a9;position:absolute;top:-9px;left:3px;height:calc(50% + 7px);width:32px}.msportalfx-nested-control.fxc-left-label>.azc-form-labelcontainer{padding-left:45px;position:relative;box-sizing:border-box}.msportalfx-nested-control.fxc-left-label>.azc-form-labelcontainer::before{display:block;content:"";border-left:1px solid #a9a9a9;border-bottom:1px solid #a9a9a9;position:absolute;top:-13px;left:3px;height:22px;width:32px}.msportalfx-form-regular div.msportalfx-nested-control::before,.msportalfx-form-regular .msportalfx-nested-control::before{display:block;content:"";border-left:1px solid #a9a9a9;border-bottom:1px solid #a9a9a9;position:absolute;top:-13px;left:3px;height:22px;width:32px}.msportalfx-nested-control:not(.fxc-left-label)::before{display:block;content:"";border-left:1px solid #a9a9a9;border-bottom:1px solid #a9a9a9;position:absolute;top:-9px;left:3px;height:40px;width:32px}.fxc-left-label-fixed.fxc-smart-labels .msportalfx-nested-control .azc-form-labelcontainer{max-width:205px !important}',moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/CssLibrary/CustomPart.css",["module"],(function(e){"use strict";return{css:'.msportalfx-layoutChildren-horizontal-inlineblock{white-space:nowrap;line-height:0;font-size:0}.msportalfx-layoutChildren-horizontal-inlineblock>.msportalfx-layoutChildren-child{display:inline-block;box-sizing:border-box;white-space:normal;font-size:13px;line-height:normal}.msportalfx-layoutChildren-horizontal-float>.msportalfx-layoutChildren-child{float:left;box-sizing:border-box}.msportalfx-layoutChildren-horizontal-float::after{content:" ";clear:both;display:block;visibility:hidden;height:0;font-size:0;line-height:0}.msportalfx-bgcolor-themeMain{background-color:#00bcf2}.msportalfx-bgcolor-themeWarning{background-color:#db7500}.msportalfx-bgcolor-themeError{background-color:#e81123}.msportalfx-bgcolor-themeSuccess{background-color:#7fba00}.msportalfx-bgcolor-paletteDiffAdd{background-color:#c7f1c7}.msportalfx-bgcolor-paletteDiffDel{background-color:#fcd6f1}.msportalfx-bgcolor-white{background-color:#fff}.msportalfx-padding{padding:20px;box-sizing:border-box}.msportalfx-docking{display:flex;flex-direction:column;width:100%;height:100%}.msportalfx-docking-header{flex:0 0 auto}.msportalfx-docking-body{flex:1 1 auto;height:100%;min-height:0;overflow-x:hidden;overflow-y:auto}.msportalfx-docking-footer{flex:0 0 auto;border-top:1px solid}.msportalfx-vertical-center{display:flex;flex-flow:row nowrap;align-items:center}.msportalfx-removeTableBorders{border-spacing:0;border-collapse:collapse}.msportalfx-boxsizing-borderbox{box-sizing:border-box}.msportalfx-removeDefaultListStyle{list-style-type:none;padding:0;margin:0}.msportalfx-removeDefaultListStyle>li{margin:0;padding:0}.msportalfx-fill{height:100%;width:100%}.msportalfx-clearfix::after{content:" ";clear:both;display:block;visibility:hidden;height:0;font-size:0;line-height:0}.fxs-tilesize-fittocontainer .msportalfx-overflowY,.azc-graph-node-container .msportalfx-overflowY{overflow-x:hidden;overflow-y:auto}.msportalfx-unselectable{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.msportalfx-removepartpadding{height:calc(100% + 15px + 15px);width:calc(100% + 15px + 15px);margin:-15px -15px -15px -15px}.msportalfx-removepartpaddingside{width:calc(100% + 15px + 15px);margin:0 -15px 0 -15px}.fxs-blade-locked .msportalfx-removepartpadding{height:calc(100% + 15px);width:100%;margin:0 0 15px 0}.fxs-blade-locked .msportalfx-removepartpaddingside{width:100%;margin:0}.fxs-blade-locked .fxs-tilesize-fittocontainer .msportalfx-removepartpadding{height:100%;width:100%;margin:0}.msportalfx-partdivider::after{content:"";display:block;width:calc(100% + 15px + 15px);margin:0 -15px 0 -15px;border-bottom-width:1px;border-bottom-style:solid}.msportalfx-code{font-family:Consolas,"Courier New",monospace;font-size:13px;line-height:normal;background-color:#f1f1f8;color:#32383f;border:1px solid #dcdfe2;border-left:5px solid #dcdfe2;padding:10px 10px 10px 15px;margin:5px 0;overflow-x:auto}.msportalfx-gettingstarted-part{color:#fff}.msportalfx-refresh-icon img,.msportalfx-refresh-icon svg{height:12px;width:12px;vertical-align:baseline}.msportalfx-tile-status-icon img,.msportalfx-tile-status-icon svg{height:16px;width:16px;vertical-align:middle}.msportalfx-gridcolumn-asseticon img,.msportalfx-gridcolumn-asseticon svg{margin-top:4px;height:21px;width:21px}.msportalfx-gridcolumn-assetsvg-icon .fx-grid-formatters-svgicon{width:21px !important;height:21px !important}.msportalfx-gridcolumn-assetsvg-icon img,.msportalfx-gridcolumn-assetsvg-icon svg{height:21px;width:21px;vertical-align:middle}.msportalfx-gridcolumn-assetsvg-badge{margin-left:-21px;height:21px;width:21px;vertical-align:middle;display:inline-block}.msportalfx-gridcolumn-assetsvg-badge img,.msportalfx-gridcolumn-assetsvg-badge svg{height:10px;width:10px;margin-top:11px}.msportalfx-gridcolumn-assetsvg-text{margin-left:10px;vertical-align:middle}.msportalfx-gridcolumn-assetsvg-textbox{vertical-align:middle;display:inline-block;margin-left:20px}.msportalfx-gridcolumn-assetsvg-strongtext{vertical-align:middle;margin-left:0}.msportalfx-gridcolumn-assetsvg-linkicon{margin-left:10px;display:inline-block;vertical-align:middle}.msportalfx-gridcolumn-assetsvg-linkicon .msportalfx-gridcolumn-assetsvg-linkicon-icon{display:inline-block}.msportalfx-gridcolumn-assetsvg-linkicon .msportalfx-gridcolumn-assetsvg-linkicon-icon img,.msportalfx-gridcolumn-assetsvg-linkicon .msportalfx-gridcolumn-assetsvg-linkicon-icon svg{opacity:.4;height:10px;width:10px;vertical-align:middle}.msportalfx-iconcontainer{flex:0 0 auto;box-sizing:border-box}.msportalfx-iconcontainer>img,.msportalfx-iconcontainer>svg{height:50px;width:50px}.fxs-tilesize-mini .msportalfx-iconcontainer>img,.fxs-tilesize-small .msportalfx-iconcontainer>img,.fxs-tilesize-mini .msportalfx-iconcontainer>svg,.fxs-tilesize-small .msportalfx-iconcontainer>svg{height:30px;width:30px}.msportalfx-gridcolumn-statusicon{text-align:center}.msportalfx-gridcolumn-statusicon img,.msportalfx-gridcolumn-statusicon svg{text-align:center;height:15px;width:15px}.msportalfx-gridcolumn-statusicon svg{margin-top:4px}.msportalfx-grid-borderless .azc-grid table tbody tr td{border-top-width:0;border-bottom-width:0;border-color:transparent}.msportalfx-grid-borderless .azc-grid table tbody tr.azc-grid-row:first-of-type td{border-top-width:0;border-bottom-width:0;border-color:transparent}.msportalfx-grid-borderless .azc-grid table tbody:last-child tr:last-child td{border-top-width:0;border-bottom-width:0;border-color:transparent}.msportalfx-grid-borderless .azc-br-muted{border-top-width:0;border-bottom-width:0;border-color:transparent !important}.msportalfx-create-tab{max-width:700px}.msportalfx-create-tab .msportalfx-create-description{font-size:13px;line-height:normal}.msportalfx-create-tab .fxc-section{margin-bottom:15px}.msportalfx-create-section-label{font-weight:600;font-size:14px;line-height:normal}.msportalfx-create-footer .fxc-simplebutton{margin-right:12px}.msportalfx-create-footer a{margin-left:12px}.msportalfx-ext-link{padding-right:15px}.msportalfx-ext-link::after{content:" ";background-color:currentColor;-webkit-mask-image:url("data:image/svg+xml;utf8,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%2016%2015%22%3E%3Cpath%20d=%22M14.3%201H10V0h6v6h-1V1.7l-8%208-.7-.7z%22/%3E%3Cpath%20d=%22M11%208v5a.9.9%200%2001-1%201H2a.9.9%200%2001-1-1V6a.9.9%200%20011-1h6l1-1H2a2%202%200%2000-2%202v7a2%202%200%20002%202h8a2%202%200%20002-2V7z%22/%3E%3C/svg%3E");-webkit-mask-position:center;-webkit-mask-repeat:no-repeat;mask-image:url("data:image/svg+xml;utf8,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%2016%2015%22%3E%3Cpath%20d=%22M14.3%201H10V0h6v6h-1V1.7l-8%208-.7-.7z%22/%3E%3Cpath%20d=%22M11%208v5a.9.9%200%2001-1%201H2a.9.9%200%2001-1-1V6a.9.9%200%20011-1h6l1-1H2a2%202%200%2000-2%202v7a2%202%200%20002%202h8a2%202%200%20002-2V7z%22/%3E%3C/svg%3E");mask-position:center;mask-repeat:no-repeat;width:11px;height:11px;display:inline-block;margin-left:4px;margin-right:-15px;background-size:11px 11px}.fxs-mode-dark .msportalfx-ext-link::after{background-image:url("data:image/svg+xml;utf8,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%2016%2015%22%3E%3Cpath%20fill=%22%23ffffff%22%20d=%22M14.3%201H10V0h6v6h-1V1.7l-8%208-.7-.7z%22/%3E%3Cpath%20fill=%22%23ffffff%22%20d=%22M11%208v5a.9.9%200%2001-1%201H2a.9.9%200%2001-1-1V6a.9.9%200%20011-1h6l1-1H2a2%202%200%2000-2%202v7a2%202%200%20002%202h8a2%202%200%20002-2V7z%22/%3E%3C/svg%3E")}.msportalfx-inherit-color{color:inherit !important}.msportalfx-statuspart{position:relative;height:100%;width:100%}.msportalfx-statuspart>*{box-sizing:border-box}.msportalfx-statuspart .msportalfx-statuspart-statussection{height:calc(100% - 55px);padding-top:10px}.msportalfx-statuspart .msportalfx-statuspart-statussection>*{vertical-align:middle}.msportalfx-statuspart .msportalfx-statuspart-statussection>img{height:30px;width:30px}.msportalfx-statuspart .msportalfx-statuspart-statussection>span{font-weight:700;font-size:11px;text-transform:uppercase;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.msportalfx-statuspart .msportalfx-statuspart-messagesection{position:absolute;bottom:55px;margin-bottom:25px;height:40px;line-height:0;white-space:normal}.msportalfx-statuspart .msportalfx-statuspart-messagesection>span{font-size:13px;line-height:normal}.msportalfx-statuspart .msportalfx-statuspart-propertysection,.msportalfx-statuspart .msportalfx-statuspart-metricsection{position:absolute;bottom:0;width:100%;height:55px}.msportalfx-statuspart .msportalfx-statuspart-propertysection{padding-top:5px;font-size:13px;line-height:normal}.msportalfx-statuspart .msportalfx-statuspart-propertysection>span,.msportalfx-statuspart .msportalfx-statuspart-propertysection>div{display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.msportalfx-statuspart .msportalfx-statuspart-metricsection>div{float:left;width:calc(100%/3 - 3px);box-sizing:border-box;border-right:1px solid #8f9ca8;padding-left:7px}.msportalfx-statuspart .msportalfx-statuspart-metricsection>div:first-child{padding-left:0}.msportalfx-statuspart .msportalfx-statuspart-metricsection>div:last-child{border-right:none}.msportalfx-statuspart .msportalfx-statuspart-metricsection .msportalfx-statuspart-metrictitle{white-space:normal;height:30px;font-size:13px;line-height:normal;text-transform:uppercase}.msportalfx-property-text-icon,.msportalfx-property-callback-icon{width:27px}.msportalfx-property-text-icon svg,.msportalfx-property-callback-icon svg{height:25px;width:25px}.msportalfx-property{padding:5px 0;white-space:nowrap;line-height:0;font-size:0}.msportalfx-property>*{display:inline-block;vertical-align:middle;box-sizing:border-box;white-space:normal;font-size:medium;line-height:normal}.msportalfx-property .msportalfx-property-name{font-size:13px;line-height:normal;width:32%;white-space:normal;overflow:hidden;text-overflow:ellipsis}.msportalfx-property .msportalfx-property-label-wrapper{font-size:13px;line-height:normal;width:32%;margin-top:5px}.msportalfx-property .msportalfx-property-label-wrapper .msportalfx-property-name{max-width:100%;width:auto;white-space:normal;overflow:hidden;text-overflow:ellipsis;display:inline-block}.msportalfx-property .msportalfx-property-value{font-size:14px;line-height:normal;width:64%;margin-left:3%;margin-top:4px}.msportalfx-property .msportalfx-property-value.fxs-part-properties-text .msportalfx-tooltip-overflow,.msportalfx-property .msportalfx-property-value.fxs-part-properties-text .msportalfx-property-text-icon{display:inline-block;vertical-align:middle}.msportalfx-property .msportalfx-property-value.fxs-part-properties-text .msportalfx-property-text-icon+.msportalfx-tooltip-overflow{max-width:calc(100% - 27px)}.msportalfx-property .msportalfx-property-value.fxs-part-properties-copyfield{margin-top:4px}.msportalfx-property .msportalfx-property-value.fxs-part-properties-copyfield input{padding-left:9px}.msportalfx-property.msportalfx-property-compact>*{vertical-align:top}.msportalfx-property.msportalfx-property-compact .msportalfx-property-name{margin-top:4px;width:95px}.msportalfx-property.msportalfx-property-compact .msportalfx-property-value{font-size:13px;line-height:normal;max-width:calc(100% - 3% - 95px)}.msportalfx-property-callback-icon{float:left}.msportalfx-preview-text{font-weight:600;font-size:10px;line-height:normal;text-transform:uppercase;margin-top:3px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}',moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Parts/Parts.Part.css",["module"],(function(e){"use strict";return{css:'.fxs-part{width:100%;height:100%;position:relative;box-sizing:border-box;overflow:hidden;background-color:inherit;padding:15px 15px 15px 15px}.fxs-part-blockui-shield{position:absolute;top:0;left:0;bottom:0;right:0}.fxs-part-title{height:49px;position:relative;top:-4px;box-sizing:border-box}.fxs-part-titleText,.fxs-part-assetname{margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-part-titleText{font-weight:600;font-size:14px;line-height:17px;padding-bottom:1px}.fxs-part-assetname{font-size:10px;line-height:10px;padding-bottom:1px;margin-top:3px}.fxs-part-content{font-size:13px;line-height:normal;position:relative;width:100%;height:100%;box-sizing:border-box}.fxs-part-part-title-visible .fxs-part-content{height:calc(100% - 45px);top:-4px}.fxs-part[tabindex="0"]:focus,.fxs-part-clickable:focus{outline-offset:2px;outline-width:1px;outline-style:solid}.fxs-part[tabindex="0"]:hover,.fxs-part-clickable:hover{cursor:pointer}.fxs-part-unbound{z-index:1}.fxs-part{padding:15px 15px 15px 15px}.fxs-part.fxs-part-no-fx-content-padding{padding:0}.fxs-part.fxs-part-no-fx-content-padding.fxs-part-part-title-visible .fxs-part-title{padding:15px 15px 0 15px}.fxs-part.fxs-part-no-fx-content-padding.fxs-part-part-title-visible .fxs-part-content>.msportalfx-padding:first-child{padding:0 15px 15px 15px}.fxs-part.fxs-part-no-fx-content-padding .fxs-part-content>.msportalfx-padding{padding:15px 15px 15px 15px}.fxs-part.fxs-part-no-fx-content-padding.fxs-part-for-template-blade .fxs-part-content>.msportalfx-padding{padding:10px 20px 20px 20px}.fxs-part-nodata{filter:grayscale(100%);min-height:85px}.fxs-part-nodatamessage{position:absolute;left:0;top:0;height:100% !important;width:100%;text-align:left;padding:15px;box-sizing:border-box;z-index:1}.fxs-part-nodatamessage-text{position:absolute;top:50%;transform:translateY(-50%);margin-top:20px;padding:15px 10px;width:calc(100% - 30px);box-sizing:border-box;font-size:13px;line-height:normal;text-align:center;border-width:1px;border-style:solid}.fxs-tile.fxs-tilesize-mini .fxs-part{padding-left:3px;padding-right:3px}.fxs-tile.fxs-tilesize-mini .fxs-part .fxs-part-title{display:none !important}.fxs-tile.fxs-tilesize-mini .fxs-part .fxs-part-content{height:100% !important;top:0 !important}.fxs-blade .fxs-blade-locked .fxs-part{padding:0 0 15px 0}.fxs-blade .fxs-blade-locked .fxs-part .fxs-part-title{height:29px;top:0}.fxs-blade .fxs-blade-locked .fxs-tilesize-fittocontainer .fxs-part{padding:0}.fxs-part-filter-button{border:0;padding:0;width:26px;height:26px;cursor:pointer;z-index:2}.fxs-part-filter-button,.fxs-part-filter-button>svg{position:absolute;top:0;left:0}.fxs-part-frame.fxs-tile-floated-frame{top:11px;height:calc(100% - 11px);left:0}.fxs-part-part-title-visible .fxs-part-frame.fxs-tile-floated-frame{top:49px;height:calc(100% - 49px)}',moduleId:e.id}})),
define("_generated/MsPortalImpl/Svg/Startup/DashboardPartFilter.svg",["require","exports"],(function(e,t){"use strict";return{type:1,data:"<svg viewBox='0 0 26 26' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path fill='#8a8886' d='M26 0H0v26L26 0z'/><path d='M2 2v1.547l4 3.787V12h3V7.334l4-3.787V2zm1 1.253V3h9v.253L8 7v4H7V7z' class='msportalfx-svg-c01'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/DashboardPartFilterConflict.svg",["require","exports"],(function(e,t){"use strict";return{type:1,data:"<svg viewBox='0 0 26 26' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path fill='#8a8886' d='M26 0H0v26L26 0z'/><path d='M4 2v1.547l4 3.786V12h3V7.333l4-3.787V2z' class='msportalfx-svg-c33'/><path d='M7 8 3 4.035V2H2v2.421l4 3.965V12h1V8z' class='msportalfx-svg-c01'/><path d='M4 2v1.547l4 3.786V12h3V7.333l4-3.787V2zm1 1.253V3h9v.253L10 7v4H9V7z' class='msportalfx-svg-c01'/></g></svg>"}})),
define("MsPortalImpl/Parts/Parts",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Base/Base.CssSanitizer","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Base.Selectable2","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Widgets/Widgets.PartError","MsPortalImpl/Base/Base.Selectable2.ClickContext","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/Commands/UI.ExtensionCommands","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/Base/Base.KeyboardHelper","FxInternal/Composition/ViewModel","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Weave/SandboxRender","FxInternal/Composition/Part","Fx/Composition","_generated/MsPortalImpl/Svg/Startup/DashboardPartFilter.svg","_generated/MsPortalImpl/Svg/Startup/DashboardPartFilterConflict.svg","MsPortalImpl/UI/Commands/Base.PortalFunctions","FxInternal/Css","_generated/Less/MsPortalImpl/Parts/Parts.Part.css","_generated/Less/MsPortalImpl/CssLibrary/AzureCompatibleOfficeLayoutGrid.css","_generated/Less/MsPortalImpl/CssLibrary/AzureSemanticText.css","_generated/Less/MsPortalImpl/CssLibrary/AzureUtil.css","_generated/Less/MsPortalImpl/CssLibrary/AzureDeprecatedSemanticText.css","_generated/Less/MsPortalImpl/CssLibrary/AzureDeprecatedChartingColor.css","_generated/Less/MsPortalImpl/CssLibrary/CustomPart.css","_generated/Less/MsPortalImpl/CssLibrary/CustomForm.css"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g,h,f,x,b,v,y,M,I,C,P,w,_,S,F,k,T,D,E,B,A,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPartFactory=t.createAmdPartFactory=t.getPartFactory=t.getPartSizeOrDefault=t.getFactory=t.registerFactory=t.PartImpl=t.PartBase=t.InternalClickableLink=void 0,(0,S.injectCss)(F,k,T,D,E,B,A,N);var O=FxImpl.TriggerableLifetimeManager,R=MsPortalFx.Base,L=R.Diagnostics,z=R.Images,H=L.Telemetry,U=MsPortalFx.Parts,W=U.PartKind,V=U.PartState;const j=window,q=a.Dashboard.PartFilters,G=FxImpl.features.isNativePerf;let K=0;const J=L.createLog(e),X=a.Parts.partSettingNotReceivedErrorDescription,Y={},Z=s(i.Root,null,s(i.KoIf,{condition:"context.isFilterApplied"},s("div",{role:"button",class:"fxs-part-filter-button",tabindex:"0","data-bind":{image:"context.filterIcon",click:"context.openPartSettingsBlade",attr:{"aria-label":"context.filterButtonAriaLabel"}}})),s("div",{class:"fxs-part-title"},s("h3",{class:"fxs-part-titleText msportalfx-tooltip-overflow","data-bind":{text:"container.partTitle"}}),s("div",{class:"fxs-part-assetname fxs-portal-subtext msportalfx-tooltip-overflow","data-bind":{visible:"container.assetName() && !context.inContainerOfSameAsset()",text:"container.assetName"}})),s("div",{class:"fxs-part-content fxs-validationContainer"}),s(i.KoIf,{condition:"context.isUiBlocked"},s("div",{class:"fxs-part-blockui-shield"}),s(i.KoTemplate,{options:"{ name: context.uiBlockedTemplate }"}))),ee="emptyTemplate";c.registerKoTemplate(ee," ");const te="contentHasNoDataTemplate";c.registerKoTemplate(te,s("div",{class:"fxs-part-nodatamessage"},s("div",{class:"fxs-part-nodatamessage-text msportalfx-tooltip-overflow fxs-bg-overlay-dark fxs-text-white","data-bind":{text:"container.noDataMessage"}})));class se extends C.ClickableLink{}t.InternalClickableLink=se;class ie{constructor(){this._selectable=ko.observable(),this.inContainerOfSameAsset=ko.observable(!0),this.partSettingFailed=ko.observable(!1),this.notFoundMessage=ko.observable(),this.handledErrorMessage=ko.observable(),this.lockedUiContext=ko.observable(!0)}}t.PartBase=ie;const oe={1:"fxs-part-success",2:"fxs-part-warning",3:"fxs-part-error",4:"fxs-part-dirty",5:"fxs-part-info"};class ne extends ie{constructor(e,t,s,i){super(),this._diContainer=i,this.isFilterApplied=ko.observable(!1),this.filterIcon=ko.observable(),this.filterButtonAriaLabel=ko.observable(),this.partFilterState=ko.observable(0),this.openPartSettingsBlade=(e,t)=>$.noop,this.assetId=ko.observable(),this.ariaLabel=ko.observable(),this.onSizeChange=e=>{};const o=this._lifetime=new O;let n=t.container;this._onDashboard=1===s.partLocation;if(MsPortalFx.isFeatureEnabled(I.partHeaderEnabledFeatureName)&&this._onDashboard&&n.updatableHeader){n={},MsPortalFx.shallowCopyFromObject(n,t.container);const{updatedHeader:e}=n.updatableHeader,s=n.partTitle,i=n.assetName;n.partTitle=ko.computed(o,(()=>{const t=s(),i=e(),o=null==i?void 0:i.title;return t&&o?o:t})),n.assetName=ko.computed(o,(()=>{const t=e(),o=null==t?void 0:t.subtitle;return s()&&o?o:i()}))}if(!n)throw new Error("Cannot create a part without a container viewmodel.");const c=FxImpl.tryGetSelectableViewModelContract(n);let p;if(p=c&&c._msPortalFxSelectable2?d.getOrCreate(this._diContainer,c._msPortalFxSelectable2):void 0,p=p||n.selectable,!p){const s=t.content;s&&(ko.isObservable(s().onClick)?s().onClick.subscribeAndRun(this._lifetime,(t=>{"function"!=typeof t||this._selectable()||(p=u.getSelectableWithClickHandler(this._diContainer,s,$(e),t),this._selectable(p))})):"function"==typeof s().onClick&&(p=u.getSelectableWithClickHandler(this._diContainer,s,$(e),s().onClick)))}s.pinnedBladeDeeplink&&(p=p||{isClickable:()=>!0,isSelected:ko.observable(!1),value:ko.observable({}),onClick:MsPortalFx.noop},p.onClick=()=>{i.get(_.RoutePortalFunc).invoke({uri:s.pinnedBladeDeeplink,openedByContext:{openedBy:4}},this._onDashboard?"StartBoardPart":"Blade")}),this._selectable(p),this._viewModel=t,ko.cleanNode(e);const m=this._partContainer=$(e).attr("data-bind","attr: { 'role': context._computedRole, 'data-assetname': container.assetName },css: context._computedClasses,click: function (data, evt) { return context._onClick(data, evt); },event: {'keydown': function (data, evt) { return context._onKeyDown(data, evt); } }").html(Z);this._accessibility(),s.noFxContentPadding&&m.addClass("fxs-part-no-fx-content-padding"),s.isVirtualPartForTemplateBlade&&m.addClass("fxs-part-for-template-blade"),this._partContent=m.findByClassName("fxs-part-content")[0];const g=m.findByClassName("fxs-part-title");this.validateElements=ko.observableArray([]),this._options=s;const h=e=>!!e.noDataMessage();this.isUiBlocked=ko.pureComputed((()=>this._viewModel.internal.allowUiBlocking()&&(n.operations.blockingUi()||h(n)))),this.uiBlockedTemplate=ko.pureComputed((()=>{const e=this._viewModel.container,t=!!this.notFoundMessage(),s=!!e.noDataMessage(),i=!!e.unauthorizedMessage();return t||i?ee:s?te:ee}));const f=ko.pureComputed((()=>this._viewModel.internal.allowUiBlocking()&&h(n)));this._isPartClickable=ko.computed(o,(()=>!(n.operations.blockingUi()||n.partState&&n.partState()===V.Failed||this.notFoundMessage()||!MsPortalFx.isNullOrUndefined(n.unauthorizedMessage()))&&(!!n.clickableLink||n.isSelectable()&&!!this._selectable()))),n.partTitle.subscribe(o,(()=>{setTimeout((()=>{m.trigger("fxsizechanged")}),50)})),ko.computed(o,(()=>{this.lockedUiContext()?m.removeAttr("aria-label"):m.attr("aria-label",n.ariaLabel()||this.ariaLabel()||n.partTitle())}));const x=ko.computed(o,(()=>{const e=n.partTitle()&&n.partState()!==V.Failed;return l.toggle(g,e),e}));let b;this._computedClasses=ko.computed(o,(()=>{const e=[];x()&&e.push("fxs-part-part-title-visible"),this._isPartClickable()&&e.push("fxs-part-clickable"),n.noDataMessage()&&e.push("fxs-part-nodata");const t=this._selectable();t&&n.isSelectable()&&(t.isSelected()&&e.push("fxs-part-selected"),t.isCommandSelected&&t.isCommandSelected()&&e.push("fxs-part-selected-command")),this._viewModel.content()._msPortalFxUnboundPart&&e.push("fxs-part-unbound");const s=oe[n.contentState()];return s&&e.push(s),e.join(" ")})),this._computedRole=ko.computed(o,(()=>{const e=[];if(m.find(".fxs-part-clickdesc, .fxs-part-tabback").remove(),this.lockedUiContext())return m.removeAttr("aria-describedby"),null;const t=MsPortalFx.getUniqueId();if(m.append(FxImpl.createElement("div",{class:"fxs-part-tabback",id:t,style:"display:none;"},MsPortalFx.encodeHtml(a.Parts.tabbackcmds))),e.push(t),this._isPartClickable()){const t=MsPortalFx.getUniqueId();m.append(FxImpl.createElement("div",{class:"fxs-part-clickdesc",id:t,style:"display:none;"},MsPortalFx.encodeHtml(a.Parts.clickableAriaDesc))),e.push(t)}return m.attr("aria-describedby",e.join(" ")),"group"})),ko.applyBindings({container:n,context:this},m[0]),f.subscribeAndRun(o,(e=>{if(e){if(!b){b=o.createChildLifetime();const e=this._partContainer;b.registerForDispose([e.setEvents(["focus",this._onFocus=e=>{this._toggleDisableTabbableElements(f())}],["focusin",this._onFocusIn=t=>{f()&&e[0].focus()}]),()=>{this._onFocus=this._onFocusIn=null}])}m.find(document.activeElement).length>0&&m[0].focus()}else b&&b.dispose(),this._toggleDisableTabbableElements(e)})),ko.reactor(o,(()=>{this.lockedUiContext()||!this._isPartClickable()&&!this._onDashboard?m.removeAttr("tabindex"):m.attr("tabindex",0)}));FxImpl.shellInterface(n).triggerValidation(((e,t)=>r.ensureFormFieldValidation(m,!0,t).then((t=>(e&&r.focusOnFirstInvalidField(this._partContainer),t))))),1===n.location&&this.partFilterState.subscribeAndRun(o,(e=>{const t=4===e||3===e,s=2===e||1===e;this.isFilterApplied(t||s);const i=t?w:P;this.filterButtonAriaLabel(t?q.Conflicted.ariaLabel:q.Applied.ariaLabel);let o="";switch(e){case 1:o=q.Applied.dashboardTimeRange;break;case 0:case 2:o=q.Applied.dashboardFilters;break;case 3:o=q.Conflicted.timeRange;break;case 4:o=q.Conflicted.multiple}this.filterIcon(z.CustomImageWithOptions(i,{title:o}))}))}setupContent(e){const t=Q.defer(),s=b.isV2(this._viewModel.content()),i=ko.observable(s);if(s){this._viewModel.content()._msPortalFx_contentRevealedPromise.then((()=>i(!1)),(()=>t.resolve()))}const o=[this.partSettingFailed,this._viewModel.content,i,this._viewModel.container.partState,this.handledErrorMessage];return o.push(this.notFoundMessage),o.push(this._viewModel.container.unauthorizedMessage),ko.explicitComputed(this._lifetime,o,(()=>{if(this.partSettingFailed())J.error(X),ko.ignoreDependencies((()=>{this._bindErrorTemplate({message:a.PartError.titleSettings}),t.resolve()}));else{const s=this._viewModel.container.partState(),o=s!==V.Failed,n=MsPortalFx.isNullOrUndefined(this.handledErrorMessage()),r=MsPortalFx.isNullOrUndefined(this.notFoundMessage()),a=MsPortalFx.isNullOrUndefined(this._viewModel.container.unauthorizedMessage()),l=o&&n&&r&&a;if(i()&&l)return;ko.ignoreDependencies((()=>{this._bindContentTemplate(s,this.template,e),c.waitForBindings(this._partContent).then((()=>{this._setupFormValidationReactor(),t.resolve()})).catch((e=>t.reject(e)))}))}})).extend({deferred:!0}),t.promise}_setupFormValidationReactor(){const e=this._viewModel.container;1!==e.location&&this._onContentReady(0,(()=>{ko.computed(this._lifetime,(()=>{const t=this.validateElements(),s=r.gatherFormFieldsFromElements(t,null,!0),i=s.map((e=>{const t=e.viewmodel,s=e.field.validatableViewModel;if(!(t&&t.disabled&&ko.unwrap(t.disabled)||t.visible&&!ko.unwrap(t.visible)))return s&&(s.alwaysHasValidatorEquivalent||s.validators().length)?s.validationState():2})),o=s.some((e=>ko.unwrap(e.viewmodel&&e.viewmodel.dirty)));ko.ignoreDependencies((()=>{e.form.dirty(o);const t=e.form.validationState;i.includes(1)?t(1):i.includes(0)?t(0):i.includes(3)?t(3):t(2)}))})).extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}})}))}setFocus(e){const t=this._partContainer.closest(".fxs-blade"),s=t.length>0?t[0]:this._partContainer[0],i=document.activeElement;return i===document.body||i===s||s.contains(i)?Q(c.waitForBindings(s)).then((()=>{const t=$(s).find(e);let i=t.filter(":focusable").first();if(i.length<1&&(i=t.findFirstTabbable(),i.length<1)){const s=t.find(":focusable"),o=s.not("div");if(i=o.length?o.first():s.first(),i.length<1)return{success:!1,errorMsg:"No focusable element found on or within '{0}'".format(e)}}return i.focus(),{success:!0}})):Q({success:!1,errorMsg:"Requesting container does not own the focus."})}_onContentReady(e,t){(this.partComposition?Q(MsPortalFx.Base.Promises.cancelOnDispose(this._lifetime,Q(this.partComposition.await(e)).catch(MsPortalFx.noop))):Q()).then((()=>t(this._partContainer[0])))}_logClick(e){const t=this._diContainer.get(v.JourneyManager).activeJourney();H.trace({extension:this._options.locator.getExtensionLocator().name,source:this._onDashboard?"StartBoardPart":"Blade",action:"PartClick",name:this._options.locator.toFriendlyString(),data:e,journeyId:t&&t.id})}_onClick(e,t){return this._activatePart(e,t)}_onKeyDown(e,t){return t.target!==this._partContainer[0]||13!==t.keyCode||this._activatePart(e,t)}_activatePart(t,s){if(1===this._diContainer.get(g.DesktopManagerMode).value.peek()&&!this._viewModel.content()._msPortalFxUnboundPart)return!0;const i=this._viewModel.container,o=$(s.target);let r=!0;const a=j.getSelection(),l=a.rangeCount>0&&a.getRangeAt(0),d=i.clickableLink;if(!this._isPartClickable()||o.closest("a").length>0);else if(a.isCollapsed||!l||l.commonAncestorContainer.ownerSVGElement||"svg"===l.commonAncestorContainer.nodeName)if(d)if(d instanceof se&&$.isFunction(d.onClick))d.onClick();else{let t=d.target();const i=(0,n.sanitizeLinkUri)(String(d.uri()||""),{diContainer:this._diContainer,windowContext:o,localRequire:e})||"",r=MsPortalFx.startsWith(i,"#");let a=!1;"auto"===t&&(t=r?"_self":"_blank"),"_self"===t&&((0,x.isCtrlOrCommandOnly)(s)||s.shiftKey?t="_blank":r&&(this._diContainer.get(_.RoutePortalFunc).invoke({uri:i,openedByContext:{openedBy:4}},this._onDashboard?"StartBoardPart":"Blade"),a=!0)),a||window.open(i,t),this._logClick({effectiveTarget:t,target:d.target(),scrubbedUri:i.split("?")[0]})}else if(s.shiftKey||(0,x.isCtrlOrCommandOnly)(s)||2===s.which)o.trigger("fxopeninnewtab",{selectable:i.selectable});else{const e=this._selectable();e&&(e.isSelected()?o.trigger("fxensurebladevisible",{}):(e.onClick(),this._logClick())),r=!1}else;return r}_accessibility(){const e=this._partContainer.findByClassName("fxs-part-title");for(let t=0;t<e.length;t++){const s=MsPortalFx.getUniqueId(),i=$(e[t]);i.findByClassName("fxs-part-titleText").attr("aria-describedby",s),i.findByClassName("fxs-part-assetname").attr("id",s)}}_bindContent(e,t,s){const i=this._getExtensionName(),n=this._options.locator.name,r=[o.getScopeName(i)];this.scopeClass;const a=new Set,l=$(this._partContent);s&&s.styleSheets&&de.injectStyles(i,s.styleSheets,this._options.locator,a,r),this.scopeClass=r.join(" "),l.addClass(this.scopeClass),this.onSizeChange=e=>{a.forEach((t=>{const{mediaQuery:s,mediaClass:i}=t;"MINWIDTH"===s.type&&(e>=s.pixels?l.addClass(i):l.removeClass(i))}))};const d=this._diContainer.get(y.ViewModelManager).getWeaveShellPort(this._viewModel),c=K++;if(G&&j.performance.mark(`PartStart${c}`),d&&d.isChannelEnabled)(0,M.connectWeaveShellPort)(d,e,this._diContainer,(e=>{const t=[];for(const s of e)MsPortalFx.startsWith(s.moduleId,"FxInternal/_generated/Less/")?(0,S.injectCss)(s):t.push({content:s.css,file:s.moduleId});de.injectStyles(i,t,this._options.locator,a,r),this.scopeClass=r.join(" "),l.addClass(this.scopeClass),this.onSizeChange(this._viewModel.container.width.peek())}));else{$(e).html(t);const s=new ko.bindingContext(this._getContentForBinding(this._lifetime)).extend({$dicontainer:this._diContainer,$partName:n,$extensionName:i});ko.applyBindings(s,e),this._nodeToCleanup=e}G&&(j.performance.mark(`PartEnd${c}`),j.performance.measure(`PartRender(${d&&d.isChannelEnabled?"Weave":"KO"})`,`PartStart${c}`,`PartEnd${c}`))}dispose(){this._lifetime.dispose();const e=this._nodeToCleanup;e&&ko.cleanNode(e);const t=this._partContainer[0];t&&(ko.cleanNode(t),this._partContainer[0]=this._partContent=null),MsPortalFx.disposeViewModelProperties(this._viewModel)}_getContentForBinding(e){return this._viewModel.content}_getExtensionName(){return this._options.locator.getExtensionLocator().name}_bindContentTemplate(e,t,s){const i=this._viewModel.container;if(this.notFoundMessage())this._bindErrorTemplate(this.notFoundMessage(),404);else if(i.unauthorizedMessage())this._bindErrorTemplate(i.unauthorizedMessage(),401);else if(e===V.Ready)if(MsPortalFx.isNullOrUndefined(this.handledErrorMessage()))try{i.contentState(0),this._resetContentTemplateContainer(),this._bindContent(this._partContent,t,s)}catch(e){this._options.traceErrorTelemetry(e.message||"Failed to bind the knockout template",e),this._bindErrorTemplate({message:a.PartError.titleContent,details:MsPortalFx.getLogFriendlyMessage(e)})}else this._bindErrorTemplate(this.handledErrorMessage());else if(e===V.Failed){const e="string"==typeof i.failureMessage()?{message:i.failureMessage()}:i.failureMessage(),t="string"==typeof e.message?e.message:e.message&&e.message.htmlTemplate;this._options.traceErrorTelemetry(t,e.error),this._bindErrorTemplate(e)}}_bindErrorTemplate(e,t){let s;s="string"==typeof e?{message:e}:e,this._viewModel.container.contentState(3),this._resetContentTemplateContainer();const i=new p.ViewModel(s,{sessionId:MsPortalFx.sessionId,extName:this._getExtensionName(),contentName:this._options.locator.name,resourceId:this.assetId(),code:t},{showDetailsCmd:this._onDashboard}),o=this.partComposition;if(o){const e=new h.CompositionInstanceCommandContext($(this._partContent)[0],null,o),t=new f.ReloadPart(this._lifetime,this._diContainer,o);if(t.bind(e),i.commands.push(t),this._onDashboard){const t=new f.UnpinFromStartboard(this._lifetime,this._diContainer);t.bind(e),i.commands.push(t)}const s=new f.GoToAssetBlade(this._lifetime,this._diContainer,this.partComposition);s.bind(e),s.enabled()&&i.commands.push(s)}new p.Widget($(this._partContent),i,this._diContainer)}_resetContentTemplateContainer(){ko.cleanNode(this._partContent),$(this._partContent).html("")}_toggleDisableTabbableElements(e){let t,s,i,o;const n="tabindex",r="data-initialtabindex";if(e)for(t=this._partContainer.find(":tabbable"),o=0;o<t.length;++o)s=$(t[o]),i=s.attr(n),s.attr(n,"-1"),s.attr(r,i||"unset");else for(t=this._partContainer.find("[data-initialtabindex]"),o=0;o<t.length;++o)s=$(t[o]),i=s.attr(r),"unset"!==i?s.attr(n,i):s.removeAttr(n),s.removeAttr(r)}}function re(e){return Y[e]}function ae(e){const t=e&&e.initialSize;return void 0!==U.InternalPartSize[t]?t:2}t.PartImpl=ne,t.registerFactory=function(e,t){if(Y[e])throw new Error(`The part kind '${e}' has already been registered and cannot be registered again.`);Y[e]=t},t.getFactory=re,t.getPartSizeOrDefault=ae;class le{constructor(e){this._extensionName=e,this._metadata=new Map}injectStyles(e,t,s,i){const n=[],r=[];for(const a of e)if(a.content){const e=a.file,l=o.getScopeName(e);let d=this._metadata.get(e);if(!d){const s=[],i=[];this._metadata.set(e,d={file:e,mediaQueries:s,sanitizedCss:o.sanitizeStyleSheetText(a.content,`.${o.getScopeName(this._extensionName)}.${l}`,i,s)}),i.forEach((s=>{n.push(`\n${t} - ${e} - ${o.generateErrorMessage(s)}`)})),r.push(d)}i.push(l);for(const e of d.mediaQueries)s.add(e)}n.length&&FxImpl.Rpc.client.log(this._extensionName,{level:this._extensionName?2:1,code:1,area:"Parts",message:`Sanitization error found in following extension(${this._extensionName}) styleSheets:`+n});for(const e of r)(0,S.injectCss)({moduleId:this._extensionName+"_"+e.file,css:e.sanitizedCss})}}const de=new class{constructor(){this._cache={}}injectStyles(e,t,s,i,o){(this._cache[e]||(this._cache[e]=new le(e))).injectStyles(t,s,i,o)}};function ce(e,t,s,i,o){return new e.Part(t,s,i,o)}function pe(e,t,s){return{createPart:(s,i,o,n,r)=>Q(MsPortalFx.tryImmediateResolve(MsPortalFx.require(e),(e=>{const a=t(e,s,i,o,n);return a.partComposition=r,a}))),defaultSize:s.defaultSize,supportedSizes:s.supportedSizes,viewStateProperties:s.viewStateProperties,moduleId:e}}function ue(e,t={}){return{createPart:(s,i,o,n,r)=>{const a=new(t.partClass||ne)(s,i,o,n);return a.template=e,a.partComposition=r,Q(a)},defaultSize:t.defaultSize,supportedSizes:t.supportedSizes,viewStateProperties:t.viewStateProperties}}t.getPartFactory=function(e,t,s){const i=s.partKind;let o;if(i===W.Custom||i===W._Internal_App){const n=s.htmlTemplateInline,r=s.htmlTemplate&&t.getExtensionLocator().withHtmlTemplate(s.htmlTemplate),a=n||r&&e.locate(r);o=ue(a&&a.content,{supportedSizes:s.supportedSizes,partClass:i===W._Internal_App?me:null})}else o=i===W.Frame?pe("MsPortalImpl/Parts/Parts.Frame",ce,{supportedSizes:s.supportedSizes}):i===W._Internal_Az?pe("MsPortalImpl/AzFramework/Parts.Az",((e,t,i,o,n)=>{const{isBlade:r,bladeOrPartName:a}=s;return new e.Part(t,i,o,n,r,a)}),{supportedSizes:s.supportedSizes}):i===W._Internal_React?pe("MsPortalImpl/Parts/Parts.ReactFrame",((e,t,i,o,n)=>{const{isBlade:r,bladeOrPartName:a,extensionName:l}=s;return new e.Part(t,i,o,n,{name:a,extensionName:l,isTile:!r})}),{supportedSizes:s.supportedSizes}):re(W[i]);const n=o.supportedSizes;return n&&n.length||(o.supportedSizes=[ae(s)]),o},t.createAmdPartFactory=pe,t.createPartFactory=ue;class me extends ne{constructor(e,t,s,i){super(e,t,s,i)}_bindContent(e,t,s){super._bindContent(e,t,s),c.waitForBindings(e).then((()=>{const e=fx.getTimestamp();MsPortalFx.require("MsPortalImpl/Parts/Parts.Frame.Common").then((t=>{t.logFrameAddedTelemetry({isPart:this._onDashboard,journeyManager:this._diContainer.get(v.JourneyManager),locator:this._options.locator,telemetryContextState:this._options.getTelemetryContextState&&this._options.getTelemetryContextState(),timestamp:e})}))}))}}})),
define("MsPortalImpl/Parts/Parts.Error",["require","exports","MsPortalImpl/Parts/Parts","MsPortalImpl/Widgets/Widgets.PartError","MsPortalImpl/UI/Commands/UI.ExtensionCommands","MsPortalImpl/UI/Commands/UI.ShellCommands"],(function(e,t,s,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=MsPortalFx.Parts,a=r.PartKind;class l extends s.PartImpl{constructor(e,t,s,i){super(e,t,s,i),t.container.contentState(3),t.internal.allowUiBlocking(!1)}_bindContent(e,t){const s=this._viewModel.content.peek(),r=new i.ViewModel(s,{sessionId:MsPortalFx.sessionId,extName:this._getExtensionName(),resourceId:this.assetId(),contentName:this._options.locator.name},{showDetailsCmd:this._onDashboard}),a=this.partComposition,l=new o.CompositionInstanceCommandContext(e,null,a),d=a&&new n.ReloadPart(this._lifetime,this._diContainer,a);if(d&&(d.bind(l),r.commands.push(d)),this._onDashboard){const e=a&&new n.UnpinFromStartboard(this._lifetime,this._diContainer);e&&(e.bind(l),r.commands.push(e))}const c=a&&new n.GoToAssetBlade(this._lifetime,this._diContainer,this.partComposition);c&&(c.bind(l),c.enabled()&&r.commands.push(c)),this._lifetime.registerForDispose(new i.Widget($(e),r,this._diContainer))}}s.registerFactory(a[r.PartKind._Internal_Error],s.createPartFactory("",{partClass:l}))})),
define("_generated/Less/MsPortalImpl/Parts/Parts.Frame.css",["module"],(function(e){"use strict";return{css:".fxs-part.fxs-part-framepart{padding:0;overflow:hidden !important}.fxs-part.fxs-part-framepart.fxs-part-part-title-visible .fxs-part-title{padding:15px 15px 0 15px}.fxs-part-frame{width:100%;height:100%;border:0;overflow:auto;min-height:calc(100vh - 40px)}@media(min-height:500px){.fxs-part-frame{min-height:initial}}",moduleId:e.id}})),
define("MsPortalImpl/Parts/Parts.Frame.Common",["require","exports","FxInternal/Css","_generated/Less/MsPortalImpl/Parts/Parts.Frame.css"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeContentPadding=t.formMarkName=t.logFrameTelemetry=t.logFrameAddedTelemetry=t.createFrame=void 0,(0,s.injectCss)(i);var o=MsPortalFx.Base.Diagnostics.Telemetry;const n=window;function r(e){const{isPart:t,journeyManager:s,locator:i,action:n}=e,r=s.activeJourney();FxImpl.TelemetryContext.usingState((()=>{o.trace({extension:i.getExtensionName(),source:t?"StartBoardPart":"Blade",action:n,name:a(e),journeyId:r&&r.id})}),e.telemetryContextState)}function a({isPart:e,locator:t}){let s=t?t.toFriendlyString().toLowerCase():"";return e||(s=s.replace(/\/lens\/.*$/g,"")),s}t.createFrame=function(e){const{contentElement:t,onFatalError:s,trustedOrigin:i,messageSignature:o,onMessage:r,lifetime:a,uri:l,frameReadyDeferred:d,isReadyMessage:c}=e,p=l.toString(),u=FxImpl.createElement("div",{trustedInnerHTML:"<iframe />"}).firstElementChild;let m;u.classList.add("fxs-part-frame"),u.setAttribute("sandbox","allow-same-origin allow-scripts allow-popups allow-modals allow-forms allow-downloads"),u.setAttribute("allow","microphone *; encrypted-media *;clipboard-read;"),u.setAttribute("role","presentation"),u.setAttribute("src",p),u.setAttribute("allowfullscreen","true"),t.appendChild(u);const g=a.createChildLifetime(),h=e=>{if(g.isDisposed())return;if(!(e.source===(m||u.contentWindow)))return;const t=e.data;"###BOOT###"===t.signature&&s(new Error("Boot message received from iframe, disposing to prevent XSS.")),e.origin===i&&t&&t.signature===o&&(c(t)&&(clearTimeout(f),f=null,d.resolve(),m||(m=u.contentWindow)),r(t))};n.addEventListener("message",h,!1);let f=setTimeout((()=>{FxImpl.Diagnostics.getStatusCode(p,((e,t,s)=>{const i={postIFrameLoadFailurePingResponse:{uri:p,statusCode:e,statusText:s,responseText:t}};d.reject(i)})),f=null}),3e4);return g.registerForDispose({dispose:()=>{f&&clearTimeout(f)}}),g.registerForDispose((()=>{n.removeEventListener("message",h,!1),u.remove()})),{postMessage:(e,t)=>{m.postMessage(e,i,t)},contentWindow:m}},t.logFrameAddedTelemetry=function(e){r(Object.assign(Object.assign({},e),{action:"IFrameAddedToDom"}))},t.logFrameTelemetry=r,t.formMarkName=a,t.removeContentPadding=function(e){$(e).closest(".fxs-part").addClass("fxs-part-framepart")}})),
define("MsPortalImpl/Parts/Parts.ReactFrameProvider",["require","exports","MsPortalImpl/Widgets/ReactFrame.Prewarmer","MsPortalImpl/UI/Compositions/UI.Composition"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createFrameProvider=void 0;const o=window,n="fxs-display-none",r="fxs-bladesize-",a="data-react-id";t.createFrameProvider=function(e,t){return t.isTile?new d:1&e.container.flags?new p:16&e.container.flags?new u:new c};class l{setContentElement(e){this._contentElement=e,e.classList.add("fxs-part-reactframe")}getOptions(e){return this._lifetime=e,this._getFrameOptions(e)}bindToFrame(e,t){const s=this._contentElement;return s.setAttribute(a,t.id),this._configureFrameElement(t.element),this._sectionElement=s.closest(this._cssClasses.section),this._bindToFrame(e,t)}_configureFrameElement({classList:e}){e.add(this._cssClasses.frame),e.add("fxs-floated-frame"),e.remove("fxs-extension-frame")}_createObserver(e,t,s){const i=this._sectionElement,o=this._mutationObserver=new MutationObserver((()=>{null==s||s(),t.style.display="none"===getComputedStyle(i).display?"none":""}));e.registerForDispose((()=>{o.disconnect()})),o.observe(i,{attributes:!0,attributeFilter:["style","class"]})}_observeParentElement(){this._mutationObserver.observe(this._sectionElement.parentElement,{childList:!0})}_getFrameActions(e,t){const s=()=>{e.element.classList.add(n),e.element.classList.forEach((t=>t.startsWith(r)&&e.element.classList.remove(t))),e.inUse=!1,e.latestSet=!1};return this._lifetime.registerForDispose({dispose:s}),{showIFrame:()=>{e.element.classList.remove(n),null==t||t()},hideIFrame:s}}}class d extends l{constructor(){super(...arguments),this._cssClasses={frame:"fxs-tile-floated-frame",section:".fxs-part"}}getFrame(e,t,i,o){return e.get(s.FramePool).getFrame(2,t.closest(".fxs-part"),i,o)}_getFrameOptions(){return{reactFrameType:2}}_bindToFrame(e,t){return this._createObserver(e,t.element),this._getFrameActions(t)}}class c extends l{constructor(){super(...arguments),this._cssClasses={frame:"fxs-blade-floated-frame",section:".fxs-blade"}}getFrame(e,t,i,o){return e.get(s.FramePool).getFrame(0,null,i,o)}_getFrameOptions(){var e;const t=null===(e=this._contentElement.closest(".fxs-blade-content-container"))||void 0===e?void 0:e.querySelector(".fxs-bladesize-menu");return{reactFrameType:0,isMenuBlade:this._isMenuBlade=!!t}}_bindToFrame(e,t){const s=t.element;this._isMenuBlade&&s.classList.add("fxs-blade-floated-menuframe");const i=this._contentElement,n=document.getElementsByClassName("fxs-journey-layout")[0],r=i.closest(".fxs-blade-content-wrapper"),a=()=>{const e=s.parentElement&&s.parentElement.getBoundingClientRect(),t=(null==e?void 0:e.left)||0,o=(null==e?void 0:e.top)||0,a=i.getBoundingClientRect(),l=r.getBoundingClientRect();(l.height||l.width)&&s.setAttribute("style",`left: ${n.scrollLeft+a.left-t}px; top: ${n.scrollTop+a.top-o}px; height: ${l.height}px; width: ${l.width}px;`)};return i.onresize=a,a(),o.addEventListener("resize",a),o.addEventListener("visibilitychange",(()=>"visible"===o.document.visibilityState&&o.requestAnimationFrame(a))),e.registerForDispose((()=>{o.removeEventListener("resize",a)})),this._createObserver(e,s,a),this._observeParentElement(),this._getFrameActions(t,a)}}class p extends l{constructor(){super(...arguments),this._cssClasses={frame:"fxs-blade-floated-frame",section:".fxs-blade"}}getFrame(e,t,i,o){return e.get(s.FramePool).getFrame(1,document.querySelector(".fxs-portal-contextpane-right"),i,o)}_getFrameOptions(e){return{reactFrameType:1,contextPaneOptions:{setContextPaneWidth:t=>{if(!e.isDisposed()){const e=this._contentElement.closest(".fxs-blade"),s=$.data(e,i.CompositionInstanceDataName);s.bladeDefinition.contextPaneWidth=t,s.containerWidget.setContextPaneWidth(t)}}}}}_bindToFrame(e,t){return function(e){e.element.removeAttribute("style");const t=e.container.querySelector("[class*='fxs-bladesize-']");t.setAttribute(a,e.id);const s=()=>t.classList.forEach((t=>t.startsWith(r)&&e.element.classList.add(t)));s(),new MutationObserver(((e,t)=>{s(),t.disconnect()})).observe(t,{attributes:!0,attributeFilter:["class"]})}(t),this._createObserver(e,t.element),this._observeParentElement(),this._getFrameActions(t)}}class u extends l{constructor(){super(...arguments),this._cssClasses={frame:"fxs-blade-floated-frame",section:".fxs-blade"}}getFrame(e){return e.get(s.FramePool).getFrame(3,document.querySelector(".fxs-sidebar-content"),"",0)}_getFrameOptions(e){return{reactFrameType:3,inSideBar:!0}}_bindToFrame(e,t){return this._createObserver(e,t.element),this._getFrameActions(t)}}})),
define("MsPortalImpl/Parts/ReactDevTools/ReactDevTools",["require","exports","MsPortalImpl/Widgets/ReactFrame.Prewarmer","Fx"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toggleReactDevTools=t.initializeReactDevTools=void 0;const o="react-devtools",n=(0,i.memoizePromise)((()=>{const e=document.createElement("script");e.src=fx.environment.msPortalReactBundle;const t=new Promise(((t,s)=>{e.addEventListener("load",(()=>t())),e.addEventListener("error",s)}));return document.head.appendChild(e),t}));t.initializeReactDevTools=async function(){return await n(),new Promise(((e,t)=>{window.require(["react","react-dom","_oss/react-devtools-inline/frontend"],(()=>e()),t)}))},t.toggleReactDevTools=function(e){const t=document.getElementById(o)||function(){var e;const t=document.createElement("div");return t.id=o,t.style.display="none",t.style.height="450px",(null===(e=document.getElementsByClassName("fxs-journey-target"))||void 0===e?void 0:e[0]).append(t),t}();if(t.style.display){t.style.removeProperty("display");const i=window.require("react"),o=window.require("react-dom"),n=window.require("_oss/react-devtools-inline/frontend").initialize(e.contentWindow),r=()=>{const o="true"===window.sessionStorage.getItem(s.SESSION_STORAGE_DEVTOOLS_RELOAD_AND_PROFILE),[r,a]=i.useState(o?"profiler":"components"),[l,d]=i.useState(!1),c=i.useRef("auto");return i.createElement(i.Fragment,null,i.createElement("div",{id:"react-devtools-resizer",style:{height:"5px",cursor:"ns-resize",backgroundColor:"#eeeeee"},draggable:!0,onDragStart:t=>{e&&(c.current=e.style.pointerEvents,e.style.pointerEvents="none")},onDrag:e=>{if(e.clientY){const s=t.getBoundingClientRect().bottom-e.clientY;t.style.minHeight=`${s}px`}},onDragEnd:t=>{e&&(e.style.pointerEvents=c.current)}}),i.createElement("div",{id:"react-devtools-tab-bar",style:{flex:"0 0 auto",display:"flex",alignItems:"center",justifyContent:"flex-end"}},i.createElement("button",{id:"react-devtools-reload-profile",type:"button",className:"ms-Button",style:{border:"2px solid transparent",borderColor:o?"#06F":"#FFF",cursor:"pointer"},onClick:()=>{o?window.sessionStorage.removeItem(s.SESSION_STORAGE_DEVTOOLS_RELOAD_AND_PROFILE):window.sessionStorage.setItem(s.SESSION_STORAGE_DEVTOOLS_RELOAD_AND_PROFILE,"true"),d(!l)}},i.createElement("span",{role:"img","aria-label":"React Profiler tab button"}," ⚛️"),o?"Stop Profiling on Reload":"Profile on Reload"),i.createElement("button",{id:"react-devtools-components-tab",type:"button",className:"ms-Button",style:{border:"none",borderBottom:"2px solid transparent",borderColor:"components"===r?"#06F":"#FFF",cursor:"pointer"},onClick:()=>a("components")},i.createElement("span",{role:"img","aria-label":"React Components tab button"}," ⚛️"),"Components"),i.createElement("button",{id:"react-devtools-profiler-tab",type:"button",className:"ms-Button",style:{border:"none",borderBottom:"2px solid transparent",borderBottomColor:"profiler"===r?"#06F":"#FFF",cursor:"pointer"},onClick:()=>a("profiler")},i.createElement("span",{role:"img","aria-label":"React Profiler tab button"}," ⚛️"),"Profiler")),i.createElement(n,{overrideTab:r}))};o.render(i.createElement(r,null),t)}else t.style.display="none"}})),
define("MsPortalImpl/Parts/Parts.ReactFrame",["require","exports","Fx/Errors","MsPortalImpl/AzFramework/AzHost","MsPortalImpl/Parts/Parts","MsPortalImpl/Parts/Parts.Frame.Common","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/Widgets/ReactFrame.Prewarmer","MsPortalImpl/Base/Themes","MsPortalImpl/Services/Services.ExtensionTokensManager","MsPortalImpl/Services/Services.ExtensionStorageManager","MsPortalImpl/Extension/ExtensionManagerOptions","FxInternal/Utils/LinkSanitizer","FxInternal/Lifetime","Fx","MsPortalImpl/Parts/Parts.ReactFrameProvider","MsPortalImpl/Base/Base.Router","MsPortalImpl/Parts/ReactDevTools/ReactDevTools"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g,h,f,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadModelForView=t.loadModel=t.Part=void 0;var b=FxImpl.Extension,v=MsPortalFx.Base.Diagnostics.Telemetry,y=FxImpl.TelemetryContext;class M extends o.PartImpl{constructor(e,t,s,i,o){var n,r;super(e,t,s,i),this._contentRevealed=Q.defer(),this._initializationComplete=Q.defer(),this._frameReadyDeferred=Q.defer();const{extensionName:l,name:d}=o;this._bladeSequenceNumber=function(e){const t=e&&FxImpl.TelemetryContext.usingState((()=>{var e;return null===(e=MsPortalFx.Base.Diagnostics.Telemetry.Context.getBladeContext())||void 0===e?void 0:e.instanceId}),e),s=null==t?void 0:t.split("_").slice(-2)[0];return s&&parseInt(s)}(null===(r=(n=this._options).getTelemetryContextState)||void 0===r?void 0:r.call(n)),this._name=d,this._extensionName=l,this._frameProvider=(0,h.createFrameProvider)(t,o),this._getFrameVal=this._frameProvider.getFrame(i,e,l,this._bladeSequenceNumber),this._linkSanitizer=i.get(u.LinkSanitizer);const m=i.get(c.ExtensionStorageManager).getStorageForExtension(l);m.forceReady();const g=i.get(p.PostBootCache).get(l);this._contentOptions=g.then((e=>{const t=(0,a.getModuleIdAndUrl)(d,e.requireConfig).id,s=e.extensionEnvironment,i=e.features,o=e.requireConfig;return{viewModuleId:t,environment:s,features:i,extensionStorage:m,mergedConfig:o}}))}awaitReady(){return this._frameReadyDeferred.promise}awaitContentRevealed(){return this._contentRevealed.promise}awaitInitializationComplete(){return this._initializationComplete.promise}toggleDevTools(){Promise.all([this._getFrameVal.frame.then((({element:e})=>e)),(0,x.initializeReactDevTools)()]).then((([e])=>{var t;(0,x.toggleReactDevTools)(e),null===(t=this._host)||void 0===t||t.toggleDevTools()}))}togglePerfTools(){var e;return(null===(e=this._host)||void 0===e?void 0:e.togglePerfTools())||Promise.resolve()}toggleTelemetryInsights(e){var t;null===(t=this._host)||void 0===t||t.toggleTelemetryInsights(e)}async getFrameClientOptimizations(){const{frameClientOptimizations:e}=await(await this._getFrameVal).frame;return e}_bindContent(e){MsPortalFx.disposeDisposable(this._childLifetime),Promise.all([this._contentOptions,this._getFrameVal.frame]).then((()=>this._frameReadyDeferred.resolve()),(e=>this._frameReadyDeferred.reject(e))),this._contentOptions.then((t=>{const{viewModuleId:o,environment:c,features:p,extensionStorage:u,mergedConfig:h}=t;if(!o)return void this._viewModel.container.notFound();this._frameProvider.setContentElement(e);const x=this._childLifetime=this._lifetime.createChildLifetime(),b=new m.TriggerableLifetimeManager,M=this._diContainer.get(l.ThemeManager);let I;const P=Q.defer(),w=P.promise.then((({timestamp:e})=>{this._viewModel.internal.reactViewInitializeEnd(e),MsPortalFx.Base.Diagnostics.Telemetry.completeTrace(I)}));P.promise.catch((()=>{MsPortalFx.Base.Diagnostics.Telemetry.cancelTrace(I)}));const _=(0,g.defer)(),S=this._getFrameVal.frame.then((e=>{var t,s;if(y.usingState((()=>{v.trace({source:"Parts.ReactFrame",action:"FramePartSuccess",data:{frameId:e.id}})}),null===(s=(t=this._options).getTelemetryContextState)||void 0===s?void 0:s.call(t)),b.registerForDispose((()=>this._getFrameVal.dispose())),x.isDisposed())return this._getFrameVal.completed(),b.dispose(),null;const{isMenuBlade:i,contextPaneOptions:o,inSideBar:n}=this._frameProvider.getOptions(x),r=this._frameProvider.bindToFrame(b,e);_.promise.then((async t=>{I=await this._diContainer.get(a.FramePool).setLatest({extensionName:D,frame:e,isMenuBladeContent:i,inContextPane:!!o,inSideBar:n,viewName:this._name,diContainer:this._diContainer,parameters:t,bladeSequenceNumber:this._bladeSequenceNumber});const s=e.model||C(this._diContainer.get(FxImpl.Rpc.Client),h,D,this._name,t);b.registerForDispose((()=>{s.unloadModel()})),e.port.postMessage({signature:"Az",kind:3,data:{isMenuBlade:i,environment:!e.featured&&c,features:!e.featured&&p,serializedStorage:!e.featured&&u.serialize(),name:this._name,type:"init"}},[s.port]),e.featured=!0}));return{postMessage:(t,s)=>{e.port.postMessage({signature:"Az",kind:t,data:s})},setOnMessage:t=>e.setMessageListener(t,this._bladeSequenceNumber+""),reactViewOptions:{hide:r.hideIFrame,show:r.showIFrame,dispose:()=>{b.dispose()},onUnloaded:()=>{e.clearMessageListener()}},frameWindow:e.element.contentWindow,frameId:e.id}})).catch((e=>{P.reject(new s.FxError({message:"ReactView frame failed to load.",innerErrors:e,data:{extensionName:this._extensionName,reactView:this._name}}))})),F=this._viewModel.content(),k=F.hookOnInputsSet(w);w.finally((()=>{this._initializationComplete.resolve(),this._getFrameVal.completed()})),(0,n.logFrameAddedTelemetry)({isPart:this._onDashboard,journeyManager:this._diContainer.get(r.JourneyManager),locator:this._options.locator,telemetryContextState:this._options.getTelemetryContextState&&this._options.getTelemetryContextState()});const T=this._diContainer,D=this._extensionName,E=this._viewModel.container,B=T.get(d.ExtensionTokensManager).createAuthTokenCache(D).getToken;k.then((e=>{const t=e&&e.parameters||{},s=t._provisioningContext;delete t._provisioningContext,_.resolve(t);const{reactFrameType:o,contextPaneOptions:n}=this._frameProvider.getOptions(x);S.then((e=>{var r,a;const l={frameId:e&&e.frameId,lifetime:x,parameters:JSON.stringify(t),telemetryContextState:null===(a=(r=this._options).getTelemetryContextState)||void 0===a?void 0:a.call(r),initializedDeferred:P,viewModel:F,container:E,extensionName:D,getToken:B,diContainer:T,frameWindow:e&&e.frameWindow,contentRevealedDeferred:this._contentRevealed,features:T.get(FxImpl.Features).value,theme:M,provisioningContext:s,reactFrameType:o,defaultTokenPromise:T.get(d.ExtensionTokensManager).createAuthTokenCache(D).getToken(),extensionStorage:u,getSafeLink:(e,t)=>this._linkSanitizer.getSafeLink(e,t),inContextPane:!!n,setContextPaneWidth:null==n?void 0:n.setContextPaneWidth,router:T.get(f.Router)};this._host=(0,i.create)(l),e&&this._host.initialize(e)}))}))}))}}function I(e,t,s,i){const o=new MessageChannel,n=e.acquireWindow(t,-1,o.port1),r=n.value;return b.getReactModelEndPoint.invoke(e,t,{modelName:s,portId:r,parameters:i}),{unloadModel:i=>{b.disposeReactModelEndPoint.invoke(e,t,{modelName:s,portId:r,unrequire:i}),n.dispose()},port:o.port2}}function C(e,t,s,i,o){const n=`${i.substring(0,i.length-".ReactView".length)}.ReactModel`,r=(0,a.getModuleIdAndUrl)(n,t),l=I(e,s,r.id,o);if(r.id){let e=(0,g.getFeatureValue)("reactreload"),t=0;"true"===e&&(clearTimeout(t),t=setTimeout((async()=>{const e=e=>fetch(e).then((e=>e.text())),s=r.url.endsWith(".js")?r.url:r.url+".js",i=await e(s);for(;;){if(await e(s)!==i){l.unloadModel(!0),clearTimeout(t);const e=window.location.hash;window.location.hash="#dashboard",window.location.hash=e;break}await new Promise((e=>t=setTimeout(e,3e3)))}})))}return l}t.Part=M,t.loadModel=I,t.loadModelForView=C})),
define("MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuContainer",["require","exports","FxInternal/Composition/ViewModel","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Extension/ShellPart","Fx/Experimentation","MsPortalImpl/Extension/DefinitionCache","MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/UI/Compositions/UI.Composition"],(function(e,t,s,i,o,n,r,a,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createSelection=t.composeCommands=t.composePartCommands=t.composeShellCommands=void 0;var c=MsPortalFx.Base.Diagnostics,p=d.CompositionType;const u=c.createLog(e);t.composeShellCommands=function(e,t,s,i,o){if(function(e,t,s){e.filter((e=>t.getCompositionType()===p.StartboardPart&&s?e instanceof l.ShellCommand&&!(e instanceof l.CustomizeTileData):e instanceof l.ShellCommand)).forEach((t=>{MsPortalFx.remove(e,t),t.dispose()}))}(s,t,i),i){const i=function(e,t,s){const i=[];if(t.getCompositionType()===p.StartboardPart)i.push(new l.GoToAssetBlade(e,s,t)),i.push(new l.EnterOrganizeMode(e,s)),i.push(...l.CreatePartSizeCommandCollection(e,s)),i.push(new l.ReloadPart(e,s,t)),i.push(new l.ClonePart(e,s,t)),i.push(new l.UnpinFromStartboard(e,s),new l.ExitOrganizeMode(e,s));else{const o=t.instanceDefinition,n=o&&o.reference;n&&"HubsExtension"===n.extension&&"MonitorChartPart"===n.partTypeName||i.push(new l.PinToStartboard(e,s,t))}return i}(e,t,o);s.push(...i)}},t.composePartCommands=async function(t,r,a){var l,d;const c=a.getViewModel(),p=(await a.diContainer.get(n.Experimentation).getAssignments()).getBooleanValue("resourcetilecommands");if(s.isV2(c.content())||p&&(0,o.isShellPart)(a.locator))try{const e=await(null===(d=(l=c.content()).supplyCommands)||void 0===d?void 0:d.call(l,r));if(null==e?void 0:e.length){FxImpl.shellInterface(c.container).partCommands(e);const s=await MsPortalFx.require("MsPortalImpl/Widgets/Widgets.CommandBar"),i=a.diContainer,o=e.map((e=>s.createItem(r,e,a.locator,i,{executeLifetime:a})));t.unshift(...o)}}catch(t){const s=`supplyCommands failed.\r\n ${MsPortalFx.getLogFriendlyMessage(t)}`;(0,i.logToExtension)(e,a.extension.name,2,s)}},t.composeCommands=function(e,t){const s=t.diContainer,i=a.getCommandGroupForDefinitionItem(s.get(r.DefinitionCache),t.extension.name,t.partDefinition),o=[],n={viewModelName:t+"-[ContainerModel]",viewModel:t.containerModel};return i.then((i=>{i&&(i.commands.forEach((e=>{(function(e,t){const s=t.parent&&t.getPartsContainer();if(!s)return!0;if(e.details&&1&s.flags)return u.error(`Part '${t}' cannot have the open blade command '${e.name||e.text}', because it is inside the context blade.`),!1;return!0})(e,t)&&o.push(new a.ExtensionCommandMenuItemImpl(t,t.extension,t,e,t.partDefinition,s,n))})),e.unshift(...o))}))},t.createSelection=function(e,t){let s;return s=e._msPortalFxCreateSelectionAsync?e._msPortalFxCreateSelectionAsync(t):e.createSelection(t),Q(s)}})),
define("MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Services/Services.Settings"],(function(e,t,s,i,o,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartSettingsManager=t.buildIdentitySettingKey=t.partIdentityStatePrefix=void 0;var a=MsPortalFx.Base.Diagnostics,l=i.CompositionType,d=o.PropertyBindings;const c=a.createLog(e),p=Object.keys(MsPortalFx.trace.partsettings||{}),u=p.length>0;function m(e,s,o){let n=`${t.partIdentityStatePrefix}${e.toString()}`;if(o&&(n+="-"+o),s){const e=s.hasOwnProperty(i.PartContainerModelIdProperty)&&[i.PartContainerModelIdProperty];n+="-"+MsPortalFx.toSortedString(ko.toJS(s),e)}return n}function g(e){let t;try{t=JSON.parse(JSON.stringify(e))}catch(s){t=e}return t}t.partIdentityStatePrefix="[PartIdentityState]-",t.buildIdentitySettingKey=m;let h=class{constructor(e){this._sharedSettings=e,this._trace=!1}configure(e){this._options=e,this._settingsStore=e.part.getCompositionType()===l.StartboardPart?11:2}configureInstanceProperties(e){this._options.instanceProperties=e}initialize(){this.dispose(),this._registerPartIdentityStateChangeHandler(),this._registerPartSharedKeyChangeHandler(),this._registerPartInstanceChangedHandler(),u&&(this._trace=p.some((e=>this._options.partViewModelId.toLowerCase().indexOf(e)>=0)))}saveIdentityPartSettings(e,t){const s=this._options,{part:i}=s;let o=this.getKeyForIdentitySettings(e);if(i.getCompositionType()===l.StartboardPart&&(o=m(i.locator,e)),o){if(this._identityState){const e=FxImpl.toSerializableObject(this._identityState.targetModel);this._traceOperationWithSettings("Save identity part settings.",e,o),this._sharedSettings.setSetting(t?11:this._settingsStore,o,e)}this._options.part.notifySettingChanged()}}clearIdentityPartSettings(){const e=this._options;if(e){const{part:t}=e,{containerModel:s}=t;let i=[this.getKeyForIdentitySettings(s)];t.getCompositionType()===l.StartboardPart&&i.push(m(t.locator,s)),i=i.filter((e=>!!e)),i.length>0&&this._sharedSettings.deleteSettings({store:this._settingsStore,keys:i})}}getPartSettingsAsync(){if(this._options.part.getCompositionType()===l.StartboardPart)return this.getStartboardPartIdentitySettings();const e=this.getIdentityPartSettingsAsync(),t=this.getSharedPartSettingsAsync();return Q.all([e,t]).spread(((e,t)=>$.extend(!0,{},e,t)))}registerInstanceStateProperty(e,t,s=!0){const{part:i}=this._options,o=this._getOrCreateInstanceStatePropertyBindings(),n=o.targetModel,r=i.getSettingsModel();this._registerViewModelPropertyChangeHandler(t,r,n,o,(()=>{i.save()}),e),s&&i.save()}savePart(){const e=this._options;e&&e.part.save()}dispose(){const e=this._partInstanceState;e&&(e.unbind(),this._partInstanceState=null);const t=this._identityState;t&&(t.unbind(),this._identityState=null);const s=this._sharedKey;s&&(s.unbind(),this._sharedKey=null)}getKeyForIdentitySettings(e){let t=null;const s=this._options,{part:i,partStateDefinition:o,identityInputs:n}=s,r=i.getInputPropertyBindings(),a=o&&o.inputIdentityProperties;if(i.allInputsSet()&&a&&a.length>0){let s="";n&&n.length>0&&(s=MsPortalFx.toSortedString(ko.toJS(r.targetModel),n)),t=m(i.locator,e,s)}return t}_registerPartIdentityStateChangeHandler(){const e=this._options,{part:t,partStateDefinition:s}=e,i=s&&s.inputIdentityProperties;i&&i.length>0&&(this._identityState=new d(t.toString()+"-[PartIdentitySettings]",{}),this._registerViewModelChangeHandler(i,this._identityState,(e=>{e.some((e=>{const t=g(e.propertyValue),s=g(e.propertyOldValue);return!MsPortalFx.deepEquals(t,s)}))&&this.saveIdentityPartSettings(t.containerModel)})))}_registerPartSharedKeyChangeHandler(){const e=this._options,{part:t,partStateDefinition:s}=e,i=s&&s.sharedProperties;if(i&&i.length>0){const e=i.map((e=>e.property)),s={};this._sharedKey=new d(t.toString()+"-[PartSharedSettings]",s),this._registerViewModelChangeHandler(e,this._sharedKey,(()=>{const e={};i.forEach((t=>{const i=o.getModelValue(s,t.property).value;e[t.key]=FxImpl.toSerializableObject(i)}));const t={store:5,settings:e};this._traceOperationWithSettings("Save shared part settings.",e),this._sharedSettings.setSettings(t)}))}}_registerPartInstanceChangedHandler(){const e=this._options,t=e.instanceProperties;if(t&&t.length>0){const s=this._getOrCreateInstanceStatePropertyBindings();this._registerViewModelChangeHandler(t,s,(t=>{e.part.save(),(e=>e.some((e=>"content.pollingOptions"===e.propertyName)))(t)&&e.part.notifySettingChanged()}))}}_registerViewModelChangeHandler(e,t,s){const i=t.targetModel,o=this._options.part.getSettingsModel();e.forEach((e=>{this._registerViewModelPropertyChangeHandler(e,o,i,t,s)}))}_registerViewModelPropertyChangeHandler(t,s,i,r,a,l){o.getModelValue(i,t).exists||o.setModelValue(i,t,ko.toJS(o.getModelValue(s,t).value));const d=r.addProperty(t).bind(this._options.partViewModelId,s,!1,a,(t=>{(0,n.logToExtension)(e,this._options.part.locator.getExtensionName(),2,"[PartState] Failed to bind changes from viewmodel to part state. Error: "+t)}));l&&l.registerForDispose((()=>{r.removeProperty(d)}))}getIdentityPartSettingsAsync(){const e=this._options,{partStateDefinition:t}=e,{containerModel:s}=e.part,i=t&&t.inputIdentityProperties;if(!(i&&i.length>0))return Q.resolve(null);const o=this.getKeyForIdentitySettings(s),n={store:this._settingsStore,keys:[o]};return this._getPartSettingsAsync("Get identity part settings.",n,void 0).then((e=>{if(o===this.getKeyForIdentitySettings(s)){const t=this._identityState;return t&&$.extend(!0,t.targetModel,e),e}}))}getStartboardPartIdentitySettings(){const e=this._options,{part:t,partStateDefinition:s}=e,i=s&&s.inputIdentityProperties;if(!(i&&i.length>0))return Q.resolve(null);let o=2&t.flags?[m(t.previousLocator,t.containerModel)]:[];return o=o.concat([this.getKeyForIdentitySettings(t.containerModel),m(t.locator,t.containerModel)]),this._getPartSettingsAsync("Get identity part settings.",{store:this._settingsStore,keys:o},void 0)}getSharedPartSettingsAsync(){const e=this._options,{partStateDefinition:t}=e,s=t&&t.sharedProperties;if(!(s&&s.length>0))return Q.resolve(null);const i=[],o={};s.forEach((e=>{i.push(e.key),o[e.key]=e.property}));const n={store:5,keys:i};return this._getPartSettingsAsync("Get shared part settings.",n,o)}_traceOperationWithSettings(e,t,s){if(this._trace){if(s){const e={};e[s]=t,t=e}c.verbose("[PartSettingsManager] {0} Part: {1}.\nSettings: {2}".format(e,this._options.part.toString(),ko.toJSON(t,null,2)))}}_traceOperationWithKeys(e,t){this._trace&&c.verbose("[PartSettingsManager] {0} Part: {1}.\nKeys: {2}".format(e,this._options.part.toString(),ko.toJSON(t,null,2)))}_getPartSettingsAsync(e,t,s){this._traceOperationWithKeys("BEGIN - "+e,t.keys);const i=[this._sharedSettings.querySettings(t)];return Q.all(i).then((i=>{const n={},r=i[0]||{};return t.keys.forEach((e=>{const t=r[e],i=FxImpl.isSerializedObject(t)?FxImpl.fromSerializableObject(t):t;s?void 0!==r[e]&&s[e]&&o.setModelValue(n,s[e],i):$.extend(!0,n,i)})),this._traceOperationWithSettings("END - "+e,n),n}))}_getOrCreateInstanceStatePropertyBindings(){if(!this._partInstanceState){const e=this._options.part;this._partInstanceState=new d(e.toString()+"-[PartInstanceState]",e.partState)}return this._partInstanceState}};h=__decorate([__metadata("fx:diagnostics",[e,"PartSettingsManager"]),s.Class("composition"),__metadata("design:paramtypes",[r.SettingsManager])],h),t.PartSettingsManager=h})),
define("MsPortalImpl/UI/Compositions/UI.Composition.Part",["require","exports","Fx","FxInternal/Composition/ViewModel","FxInternal/AsyncLoader","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.Events","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/Base/Base.Selectable2","MsPortalImpl/Base/Base.Timers","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Interactions/Interactions.PortalReader","MsPortalImpl/Interactions/Interactions.PrintHandler","MsPortalImpl/Interactions/Interactions.FullScreenMode","MsPortalImpl/Parts/Parts","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.EditScopeManagement","MsPortalImpl/Base/Base.FeatureDetection","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpenerBase","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuContainer","MsPortalImpl/UI/Compositions/UI.Composition.Finder","MsPortalImpl/UI/Compositions/UI.Composition.Graph","MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition.Security","MsPortalImpl/UI/Commands/Base.PortalFunctions","MsPortalImpl/Base/Base.ElementWidgetMap","MsPortalImpl/Extension/ShellPart","MsPortalImpl/Widgets/Widgets.Portal.init","FxInternal/Composition/Part","FxInternal/Composition/ViewModelComposer","FxInternal/Utils/Promise","MsPortalImpl/Parts/Parts.Error","MsPortalImpl/Parts/Parts.ReactFrame"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g,h,f,x,b,v,y,M,I,C,P,w,_,S,F,k,T,D,E,B,A,N,O,R,L,z,H,U,W,V,j){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createOverridesOrContainerModelSourceReference=t.inferredReferenceType=t.setDynamicPartBinderModule=t.setBladeOpenerModule=t.create=t.getSerializableContainerModel=t.prepareContainerModel=t.tryGetParentMenuBlade=t.Instance=t.createCompositionFromJSON=t.OnInputsSetPromiseType=t.fxpartinputchanged=t.EmptyViewModel=t.fxpartsettingchanged=void 0;var q=MsPortalFx.Errors.Error,G=g.Locator,K=FxImpl.TelemetryContext,J=K.ContextType,X=FxImpl.shellInterface,Y=MsPortalFx.Base.Diagnostics,Z=Y.Telemetry.ActionModifier,ee=Y.Telemetry,te=MsPortalFx.Extension.SetRequirement,se=MsPortalFx.Parts,ie=se.PartKind,oe=S.CompositionType,ne=T.CompositionBinder,re=O.ReferenceScope,ae=O.PropertyBindings,le=F.compositionRequire;const{cancelOnDispose:de}=MsPortalFx.Base.Promises,{CanceledError:ce,DisposedCanceledError:pe,Error:ue}=MsPortalFx.Errors,me=window,ge=a.Asset,he=MsPortalFx.isNullOrUndefined,fe=Y.createLog(e),xe="fxs-part",be=(e,t,s)=>{fe.error(e+" "+"Part: '{0}'. Details: '{1}'.".format(t,JSON.stringify(s)))},ve=k.PartContainerSelectable_ViewModelPath,ye=[ve+".isSelected",ve+".isCommandSelected"],Me=ee,Ie="Shell",Ce=S.EditScopeIdPropertyName,Pe=ne.setupPropertyBindings,we=G.forExtension,_e=O.getModelValue,Se=ne.mapInputBindingDefinitions,Fe=ne.createAllInputsSetWatcherConfigExtended,ke=O.mapSourceModelToTargetModel,Te={isActivated:!0,isSelected:!0,itemsWithChildEdits:!0,selectedValue:!0,activatedItems:!0,selectedItems:!0},De="./UI.Composition.DynamicPartBinder",Ee="./UI.Composition.BladeOpener",Be={},Ae=30;function Ne(e){return e&&e.toFriendlyString()}let Oe=0;var Re;function Le(e,t,s,i){try{return s()}catch(s){const o="Error deserializing composition.";let n,r;try{n=JSON.stringify(t)}catch(e){n="<Invalid> {0}".format(e.toString())}try{r=G.fromJSON(e,t.locator)}catch(e){r=G.forExtension(o+"-"+e)}const a="{0}\nJSON: {1}\nException Message: {2}\nException StackTrace: {3}".format(o,n,s.message||"<N/A>",s.stack||s.toString());return fe.error(a),i(r,a)}}t.fxpartsettingchanged="fxpartsettingchanged",t.EmptyViewModel=(0,W.composePartViewModel)(MsPortalFx.noop),t.fxpartinputchanged="fxpartinputchanged",t.OnInputsSetPromiseType={0:"unknown",1:"Q",2:"jQuery"},function(e){e[e.OldInputsNotHandled=1]="OldInputsNotHandled",e[e.UnrecoverableError=2]="UnrecoverableError",e[e.CustomPartWithMissingTemplate=3]="CustomPartWithMissingTemplate",e[e.PartDefinitionNotFound=4]="PartDefinitionNotFound",e[e.IncorrectPartType=5]="IncorrectPartType",e[e.ErrorLocatingPartDefinition=6]="ErrorLocatingPartDefinition",e[e.ErrorAcquiringViewModel=7]="ErrorAcquiringViewModel",e[e.ViewModelMissing=8]="ViewModelMissing",e[e.ErrorLoadingControl=9]="ErrorLoadingControl",e[e.ErrorCreatingWidget=10]="ErrorCreatingWidget",e[e.TransitionedToErrorState=11]="TransitionedToErrorState"}(Re||(Re={})),t.createCompositionFromJSON=Le;class ze extends F.Instance{constructor(e,i,o,n,a,l,c,p){super(l||"Part",e,i,[],o,n,p),this._pinnedBladeDeeplink=c,this.bindings=[],this.editScopeId=ko.observable(),this.invocationThrottleDuration=25,this.allInputsSet=ko.observable(!1),this.calledOnInputsSet=ko.observable(!1),this.failedOnInputsSet=ko.observable(!1),this.assetId=ko.observable(),this.triggeringLockedBladeSpinner=ko.observable(!1),this.contentRevealed=!1,this.fullReadyTime=ko.observable(),this._earlyVmDeferred=(0,s.defer)(),this._viewStateProperties=[],this._partDefinitionDeferred=(0,s.defer)(),this._registrationDeferred=(0,s.defer)(),this._disabled=!1,this._restoredFromJson=!1,this._perfData={instanceExtensionLoad:0,referenceExtensionLoad:0,adapterViewModelLoad:0,partViewModelLoad:0,extenderViewModelLoad:0,checkPermissions:0,prepareViewModel:0,finalizePartCompose:0,allInputBindingsBoundPreprocess:0,allInputBindingsBound:0,srcExtension:"",contentRevealedCalled:!1,onInputsSetPromiseState:"",onInputsSetPromiseType:"",resourceId:void 0},this._showShellCommands=!0,this._allInputPropertyBindingsBound=(0,s.defer)(),this._frameInitialized=(0,s.defer)(),this._frameRevealed=(0,s.defer)(),this._frameBlockingUi=ko.observable(!1),this._contentInitializing=ko.observable(!0),this._getPartViewModelCalledDeferred=(0,s.defer)(),e.get(B.CompositionGraph).addPart(this),e.set(r.CompositionProvenance,new r.CompositionProvenance(i,this.id)),this._viewModelManager=e.get(d.ViewModelManager),this._finder=e.get(g.DefinitionFinder),this._setupPromises();const u=p||Oe++;let m=0;(this._updateRebindSequenceNumber=()=>{this.instanceId=`Part_${MsPortalFx.sessionId}_${u}_${m++}`})(),this._vm=a||t.EmptyViewModel,this.partState={},this.containerModel=null,this.overridesModel=$e({},!1),this._registrationDeferred.promise.catch((e=>{this._allInputPropertyBindingsBound.reject(e)})),this._partSettingsManager=this.diContainer.get(A.PartSettingsManager)}getPartsContainer(){return this._partContainer||(this._partsContainer=this.diContainer.get(E.Finder).findPartsContainer(this)),this._partsContainer}shouldAlertOnClose(e){const t=this._getContainer();if(!t)return!1;const s=ko.utils.peekObservable(t.suppressAlert),i=ko.utils.peekObservable(t.configureAlert);return!s&&(i?i.showAlert:!!this.widget&&n.gatherFormFields(this.widget.element,null==e?void 0:e.validateHidden).some((t=>{const s=t.viewmodel;return(s._msPortalFxViewModelValueChangesAreClean||s._msPortalFxOldControl&&!(null==e?void 0:e.legacyMode))&&s.dirty&&s.dirty()})))}getAlertMessage(){const e=this._getContainer(),t=ko.utils.peekObservable(e.configureAlert);return t&&t.showAlert?t.message:""}suppressAlert(){const e=this._getContainer();return!e||ko.utils.peekObservable(e.suppressAlert)}notifySettingChanged(){const e=this.widget;e&&e.element.trigger(t.fxpartsettingchanged,{part:this,isUserInteraction:this.hasUserInteractedRecently()})}getViewModel(e,s){let i=t.EmptyViewModel;const o=this.adapter;if(0===(e=e||0))i=this._vm;else if(4===e){const o=this._contextMenuViewModels;if(o)i=o.getViewModel(e,s);else{const e=this._getCommands(),o=S.findCommand(e,s,""+this);i=o&&o.getViewModel()||t.EmptyViewModel}}else if(7===e)i=o&&o.viewModel;else if(9===e){const e=o&&o.inputPropertyBindings;i=e&&e.targetModel}else fe.error(`Invalid model type '${e}' for part '${this.locator.toString()}'.`);return i}getViewModelAsync(e,t){return this._registrationDeferred.promise.then((()=>{if(4===e){const s=this._contextMenuViewModels;if(s)return s.getViewModelAsync(e,t);{const e=this._getCommands(),s=S.findCommand(e,t,""+this);return s&&s.getViewModelAsync()}}return this.getViewModel(e)}))}setViewModel(e){this._vm=e||t.EmptyViewModel}setBladeOpener(e){this.registerForDispose(this._bladeOpener=e)}getBladeOpener(){return this._bladeOpener}get isDisabled(){return this._disabled}get canClone(){const e=this.isComposed,t=this.getInputPropertyBindings().allBound,s=this.partDefinition.partKind===Ae;return e&&t&&!s}get eligibleForBinding(){return!this.containerModel}get templateKey(){let e=this.locator.toString();const t=this.containerModel;return t&&(e+="-"+MsPortalFx.toSortedString(ko.toJS(t))),e}get journeyPath(){return this.getPartsContainer().journeyPath.concat(this.templateKey)}get dirtyAndNotSaving(){return 1===this.diContainer.get(y.EditScopeManager).getStateObservable(this.editScopeId())()}get instanceDefinition(){return this._partInstanceDefinition}getCompositionType(){return oe.Part}getPartSettingsManager(){return this._partSettingsManager}getPerfData(){return this._perfData}getSettingsModel(){let e,t=this._settingsModel;if(!t&&(e=this.getViewModel())){const s=i.isV2(e.content()),o=this.partDefinition,n=o&&o.partState,r=MsPortalFx.unique((n?(n.inputIdentityProperties||[]).concat((n.sharedProperties||[]).map((e=>e.property))):[]).concat(!s&&this._viewStateProperties||[]));this._settingsModel=t=MsPortalFx.clone(e),t.content=ko.observable({}),r.forEach((i=>{if(i.startsWith("content.")){const o=s?ko.observable():_e(e,i).value;O.setModelValue(t,i,o)}}))}return t}hasUserInteractedRecently(){return!1}dispose(e){super.dispose(e),this._releaseResources(e),this._readyMarker&&K.usingState((()=>{He(this)||Me.trace({extension:rt(this),source:Ie,action:"PartReady",actionModifier:Z.Cancel,name:Ne(this.locator),data:this._perfData,journeyId:this._getTelemetryJourneyId()})}),this._creationState)}onBladeFullReady(e,t,s){5===s&&this._part.onReadyComplete(e,t)}_setExtension(e){this.extension=e,this._partContainer&&this._partContainer.attr("data-extensionname",this.extension?this.extension.name:null)}resourceLTM(){return this._ltm||(this._ltm=this.widget.ltm.createChildLifetime())}_releaseResources(e){this._ltm&&this._ltm.dispose(),this._clearLoadingReactor();const s=this._inputBindings;s&&(s.unbind(),this._inputBindings=null);const i=this._part;i&&(i.dispose(),this._part=null);const o=this._vm;this.extension&&o&&o!==t.EmptyViewModel&&this._viewModelManager.releaseViewModel(o,!0),this._releaseAdapter();const n=this._extenderVM,r=this._extenderVMExtn;n&&r&&this._viewModelManager.releaseViewModel(n),e||this._disposeEditScope(),this._journey=null,this._vm=t.EmptyViewModel}_clearLoadingReactor(){const e=this._loadingReactorLifetime;e&&e.dispose()}_releaseAdapter(){const e=this.adapter;if(!e)return;e.inputPropertyBindings.unbind();const t=e.viewModel;t&&this._viewModelManager.releaseViewModel(t),this.adapter=null}_getContainer(){return X(this.isDisposed()||!this._vm?{}:this._vm.container)}getInputPropertyBindings(){if(!this._inputBindings){const e={};this._inputBindings=new ae(Xe(this),e,!1)}return this._inputBindings}getAssetId(){const e=this.assetInstanceDefinition;if(!(e&&e.assetIdInputProperty))return Q.reject(0);const t=e=>{const t=Ze(this);t&&t.exists?e.resolve(ko.unwrap(t.value)):e.reject()},s=Q.defer(),i=this.adapter,o=i?i.allInputsSet:this.allInputsSet;return o()?t(s):o.subscribe(this,(e=>{e&&!s.promise.isFulfilled()&&t(s)})),s.promise}toJSON(){const e=super.toJSON();e.assetInstanceDefinition=this.assetInstanceDefinition,e.partState=FxImpl.toSerializableObject(this.partState||{}),e.initialSize=this.initialSize,e.bindingsInitialized=this._bindingsInitialized,e.savedContainerState=function(e){let t;if(e.isComposed){const s=e.getViewModel();if(s){const e=s.container;if(e){const s=e.partTitle&&e.partTitle(),i=e.assetName&&e.assetName();(s||i)&&(t={partTitle:s,assetName:i})}}}return t}(this),e.containerModel=Qe(this.containerModel,this.modelContainsSensitiveData),e.overridesModel=Qe(this.overridesModel,!1),e.originalPartLocator=this.previousLocator,e.flags=this.flags;const t=this.adapter,s=this.bindings;return e.adapterBindings=t&&t.bindings,e.bindings=t?s.filter((e=>e.source.scope===re.DetailsContainer)):s,e}cloneAs(e,t){let s;const i=this.widget?this.widget.options:null,o=[this.await(7),this.getInputPropertyBindings().awaitAllBound],n=this.adapter;return n&&o.push(n.inputPropertyBindings.awaitAllBound),Q.all(o).then((()=>{const o=this.getNonDetailsContainerPropertyBindings(),n={};o.forEach((e=>{const t=_e(e.targetModel,e.targetProperty).value;O.setModelValue(n,e.sourceProperty,ko.toJS(t))}));const r=ko.toJS(this.overridesModel);s=e(n,r),s.widgetState($.extend(!0,{},this.widgetState())),i&&i.size&&(s.initialSize=i.size(),99===s.initialSize&&(s.initialWidth=i.gridWidth(),s.initialHeight=i.gridHeight()));const a=this._partSettingsManager;return a&&a.saveIdentityPartSettings(s.containerModel,t),s}))}clone(){return this.cloneAs(((e,t)=>Ge(this.diContainer,this.locator,null,e,t)))}static fromJSON(e,t){const s=e.get(c.ExtensionManagerOptions);return Le(s,t,(()=>{const i=e.createChildContainer("composition"),o=new ze(i,G.fromJSON(s,t.locator),t.widgetState,t.id);return o.registerForDispose((()=>i.disposeAsync())),o.loadPropertiesFromJson(s,t),o}),((s,i)=>{const o=e.createChildContainer("composition"),n=new ze(o,s,null,t.id);return n.registerForDispose((()=>o.disposeAsync())),n.unrecoverableErrorMessage=i,n}))}getAssetInstanceMetadataAsync(){return Q(this._registrationDeferred.promise.then((()=>{if(!this.isDisabled&&!this.isDisposed())return this.getAssetId().then((e=>({id:e,type:this.assetType}))).catch($.noop)})))}get assetType(){const e=this.assetInstanceDefinition;return e&&e.assetType}addWidgetToUI(e){const t=this.widget;e.skipDOMAttach||e.parentElement.addChild(t),t.addChild(this._partContainer)}recompose(e){this._compose(e,(0,s.defer)(),!0)}_compose(e,t,s=!1,i){let o;const n=rt(this),r=Ne(this.locator),a=(e,t,s,i)=>function(e,t,s,i,o,n){const r=fx.getTimestamp()-t,a=()=>(o&&(i=MsPortalFx.extend2(i,o.getTelemetryInfo())),ee.trace({name:s.name,extension:s.extension,source:s.source,action:e,actionModifier:Z.Complete,data:i,duration:r,journeyId:s.journeyId}));return n?K.usingState(a,n):a()}(e,t,s,i,this._menu,this._creationState),l={extension:n,source:Ie,name:r,journeyId:this._getTelemetryJourneyId()};this.calledOnInputsSet.subscribe(this,(e=>{e&&(this._onInputsSetResolvedMarker=fx.getTimestamp())})),this._allOnInputsSet.then((()=>{const e=this._readyMarker;if(e){He(this)||a("PartReady",e,l,this._perfData),this._readyMarker=null}const t=this._onInputsSetResolvedMarker;t&&(this.fullReadyTime(fx.getTimestamp()-t),this._onInputsSetResolvedMarker=null)})),this.await(0).then((e=>{this._revealedMarker&&(this._perfData.contentRevealedCalled=e,this._revealedMarker=null)})),this._registrationDeferred.promise.then((()=>{t.resolve()}),(()=>{t.reject(),this._getPartViewModelCalledDeferred.reject()})),this._clearLoadingReactor(),this._ltm&&this._ltm.dispose();let d=this.widget;if(d&&s){this._partContainer=d.element.find(".fxs-part"),o=d.options;const e=o.commands.splice(0,o.commands.length),t=!!MsPortalFx.find(e,(e=>e instanceof P.CustomizeTileData));e.forEach(MsPortalFx.disposeDisposable),t&&o.commands.push(new P.CustomizeTileData(this,this.diContainer)),o.actionBarViewModel.update(),this._ltm=d.ltm.createChildLifetime()}else this._partContainer=$(FxImpl.createElement("div",{class:xe})),i?(o=i.options,d=this.widget=i):(o=this.createTileViewModel(e.options.locked()),d=this.widget=I.createTileWidget($(FxImpl.createElement("div")),o,this.diContainer,!1,(()=>this._getActions()))),this.widgetState(d.saveViewSettings()),this._ltm=d.ltm.createChildLifetime(),this.addWidgetToUI({parentElement:e,doNotSaveSettings:!0,skipDOMAttach:!!i});const c=d.element,p=this._ltm;if(e.options.locked()||o.isInBlockingLoadingState(!0),c.data(S.CompositionInstanceDataName,this),p.registerForDispose(c.setEvents(["fxregistermenu",(e,t)=>{this._menu=t}])),this._loadedMarker=fx.getTimestamp(),this._readyMarker=fx.getTimestamp(),this._revealedMarker=fx.getTimestamp(),this.unrecoverableErrorMessage&&this.unrecoverableErrorMessage.length>0)this._partDefinitionDeferred.reject(this.unrecoverableErrorMessage),this._createErrorPart(Re.UnrecoverableError,this.unrecoverableErrorMessage);else{this._locateDefinitionAndStartCompose(p,o),this._perfData.srcExtension=function(e,t){const s=e.locator,i=e.extension,o=s&&s.getExtensionName(),n=i&&i.name;if(o!==t)return o;if(n!==t)return n;return}(this,n),this._perfData.resourceId=this.assetId();const t=this.createChildLifetime();e.options.locked.subscribeAndRun(t,(e=>{(0,D.composeShellCommands)(t,this,o.commands,this._showShellCommands=!e,this.diContainer)}))}}createTileViewModel(e){const t=new I.ViewModel(this.id,this.widgetState());return t.inLockedContext=e,void 0===t.size()&&t.size(this.initialSize),99===this.initialSize&&(t.gridWidth(Math.max(1,this.initialWidth)),t.gridHeight(Math.max(1,this.initialHeight))),t}generateBindings(e){return Q.all([this._finder.locateAsync(this.locator).then((e=>this._processLocatedDefinitionAsync(e))),st()]).then((([t,s])=>{if(!e.isDisposed()&&t)return this._generateAndSaveBindings(t)}))}_locateDefinitionAndStartCompose(e,t){const i=(0,s.startTimer)();let o;const n=st();return this._finder.locateAsync(this.locator).then((e=>(this._perfData.instanceExtensionLoad=i(),o=(0,s.startTimer)(),this._processLocatedDefinitionAsync(e)))).then((e=>n.then((()=>e)))).then((s=>{if(!e.isDisposed())if(this._perfData.referenceExtensionLoad=o(),s){if(this._generateAndSaveBindings(s),this.partDefinition=s,this._partDefinitionDeferred.resolve(s),!function(e,t){const s=e.partDefinition;return s&&s.partKind===ie.Custom&&s.htmlTemplate&&!t.tryLocate(e.locator.getExtensionLocator().withHtmlTemplate(s.htmlTemplate),{})}(this,this._finder))return this._composeCommandsAndPart(t,this._partContainer);this._createErrorPart(Re.CustomPartWithMissingTemplate,a.UiCompositionPart.missingTemplateMessage)}else this._createErrorPart(Re.PartDefinitionNotFound,`Unable to find the definition for the part. Locator: ${this.locator}.`)})).then((()=>{e.isDisposed()||this._contentInitializing.fxAwaitAndRun(e,(e=>!e)).then((()=>{this._part&&this._vm.container.width.subscribeAndRun(e,this._part.onSizeChange)}))})).catch((t=>{this._partDefinitionDeferred.reject(t),e.isDisposed()||this._createErrorPart(Re.ErrorLocatingPartDefinition,t)}))}getInstanceBindings(){const e=this._partInstanceDefinition;if(e)return e.inline?e.inline.bindings:e.reference.bindings}_generateAndSaveBindings(e){if(this._isRestoredPartLackingBinding(e))if(this.eligibleForBinding)this._bindingsInitialized=!1,this.bindings=[];else if(!e.canUseOldInputVersions)return fe.warning(`[Definition Change] Bindings for part '${this}' have been changed in the definition in an incompatible way.`),void this._createErrorPart(Re.OldInputsNotHandled,`Bindings for part have been changed in the definition in an incompatible way. Locator: ${this.locator}.`);const t=this.adapter;if(this._restoredFromJson&&!1!==this._bindingsInitialized){const s=t?t.bindings:this.bindings,i=t?t.inputDefinitions:e.inputDefinitions,o=it().inferInitialBindingsForInputDefinitions(this,i).filter((e=>s.every((t=>t.targetProperty!==e.targetProperty))));return[].push.apply(s,o),s}{t?t.bindings=this._constructAdaptedBindings():this._setBindings(e),this.assetInstanceDefinition={assetType:e.assetType,assetIdInputProperty:e.assetIdInputProperty},t&&((t.assetType||t.adaptedPart.assetType)&&(this.assetInstanceDefinition.assetType=t.assetType||t.adaptedPart.assetType),t.assetIdInputProperty&&(this.assetInstanceDefinition.assetIdInputProperty=t.assetIdInputProperty));const s=this._partInstanceDefinition,i=s&&s.reference;return i&&i.assetType&&(this.assetInstanceDefinition.assetType=i.assetType),this._bindingsInitialized=!0,this.save(),t?t.bindings:this.bindings}}_setBindings(e){const t=function(e,t){const s={};e&&t&&(t.forEach((e=>{e.isIdentityInput&&e.property&&(s[e.property]=!0)})),e.forEach((e=>{e.isIdentityInput=!!s[e.property]})));if(e&&t){const s=e.slice(0);return t.forEach((t=>{const i=t.valuesFrom;i&&i.length&&5===i[0].referenceType&&(e.some((e=>e.property===t.property))||s.push(t))})),s}return e||t||[]}(this.getInstanceBindings(),e.bindings);if(function(e,t){const s=[],i=ne.validateInputBindings(e,t,s);s.length&&fe.error(`${s[0]} Part:'${e}'.`);return i}(this,t)&&(this.bindings=this.bindings.concat(Se(t,this))),this.bindings.length<=0&&6===this.locator.type){const t=it();this.bindings=this.bindings.concat(t.inferInitialBindingsForInputDefinitions(this,e.inputDefinitions))}}_constructAdaptedBindings(){const e=this.adapter;if(e.bindings.length<=0&&6===this.locator.type){return it().inferInitialBindingsForInputDefinitions(this,e.inputDefinitions)}return Se(e.adaptedPart.bindings,this)}_isRestoredPartLackingBinding(e){if(this._restoredFromJson){const t=this.adapter,s=t?this._constructAdaptedBindings():Se(e.bindings||[],this),i=t?t.bindings:this.bindings,o=e=>!e.optional&&MsPortalFx.findIndex(i,(t=>t.targetProperty===e.targetProperty))<0;return!!s.some(o)}return!1}_getActions(){const e=this.diContainer,t=[];return this.getCompositionType()===oe.StartboardPart&&t.push(new P.UnpinFromStartboard(this,e).createAction(this)),t.push(new P.OpenContextMenu(this,e,a.ContextMenu.ariaLabel).createAction(this)),t}resetLayout(){const e=this.initialSize,t=N.AllSizes[e>=0?e:N.getDefaultSize().name].size,s=this.widget;s.element.trigger("fxsizechange",[s.options.id,t.width,t.height])}clearIdentitySettings(){const e=this._partSettingsManager;e&&e.clearIdentityPartSettings()}_processLocatedDefinitionAsync(e){const t=this._finder;let s,i=e;switch(this.locator.type){case 5:case 7:this._partInstanceDefinition=e;break;case 6:s=e,s&&s.reference&&(this._partInstanceDefinition={reference:{partTypeName:s.name,bindings:s.bindings,assetType:s.assetType,initialSize:s.initialSize}})}const o=this._partInstanceDefinition;if(o){if(o.reference){const e=o.reference.extension||this.locator.getExtensionName(),s=we(e),i=s.withPartType(o.reference.partTypeName);return t.locateAsync(s).then((e=>(this._setExtension(e),t.locateAsync(i)))).then((t=>t&&t.reference?this._processAdapterAsync(t,e):t))}i=o.inline}return 99===this.initialSize&&(this.initialWidth=i.initialWidth,this.initialHeight=i.initialHeight),this._setExtension(t.locate(this.locator.getExtensionLocator())),Promise.resolve(i)}_processAdapterAsync(e,t){const s=we(e.reference.extension||t),i=s.withPartType(e.reference.partTypeName),o=this._finder;return o.locateAsync(s).then((t=>{const s=`${this} (AdapterPart. Extension: ${this.extension.name}, ViewModel: ${e.viewModel})`;this.adapter={extension:this.extension,viewModel:null,viewModelLocator:e.viewModelLocator,viewModelName:e.viewModel,viewModelId:s,bindings:this._adapterBindings||[],inputDefinitions:e.inputDefinitions,adaptedPart:this._partInstanceDefinition.reference,allInputsSet:ko.observable(!1),calledOnInputsSet:ko.observable(!1),failedOnInputsSet:ko.observable(!1),inputPropertyBindings:new ae(s,{},!1),assetType:e.assetType,assetIdInputProperty:e.assetIdInputProperty},this._partInstanceDefinition={name:this._partInstanceDefinition.name,reference:e.reference};const n=this.adapter.adaptedPart.assetType;return n&&(this._partInstanceDefinition.reference.assetType=n),this._setExtension(t),o.locateAsync(i)})).then((s=>{if(s&&s.reference){const i="Error processing the part defintion for part '{0}'. Adapted part definition '{0}:{1}' cannot reference another adapted part definition '{2}:{3}'.".format(this,this.adapter.extension.name,e.reference.partTypeName,s.reference.extension||t,s.reference.partTypeName);throw fe.error(i),FxImpl.createError(i)}return this._setBindings(s),"HubsExtension"===this.extension.name&&"MonitorChartPart"===s.name&&this.bindings.forEach((e=>{e.optional=!0})),s}))}getTitle(){const e=this.getViewModel();if(e){const t=e.container;if(t)return t.partTitle&&t.partTitle()||""}return""}disableForAssetDeleted(e,t){this._disabled=!0;const s=this._vm;s&&s.container&&this._vm.container.notFoundMessage({message:ge.deletedTitle});const i=this.widget;if(i&&i.options){const e=i.options.commands;e.splice(0,e.length,new P.UnpinFromStartboard(this,this.diContainer)).forEach(MsPortalFx.disposeDisposable)}this.save(),fe.warning("Part '{0}' disabled because asset was deleted. {1}".format(this,t))}_composeCommandsAndPart(e,t){return(0,D.composeCommands)(e.commands,this).then((()=>{this._composePart(t,e),this._attachEventHandlers(t)}))}_attachEventHandlers(e){this.resourceLTM().registerForDispose(this.widget.element.setEvents([C.Widget.viewSettingsChanged,(e,t)=>{this.widgetState(t),this.save(),e.stopPropagation()}],["fxsizechanged",(t,s)=>{const i=this.widget.options,o=!!se.InternalPartSize[s];s=o?s:i.size(),Je(this._vm,e,i,s,o,this.partDefinition),this.widgetState(this.widget.saveViewSettings())}],["rightclick",(e,t)=>{this._handleRightClick(e,t)}],["fxensurebladevisible",(e,t)=>{t.masterPartId=this.id}],[l.fxpinmultipleparts,(e,t)=>{e.stopPropagation();const s=this.locator.getExtensionLocator();this.diContainer.get(L.PinTilesPortalFunc).invoke({partReferences:t.partReferences,originExtension:s.name,notify:!0},Ie)}]))}_getPartContext(){const e=Ue(this)||{},t=this.getPartsContainer(),s=!MsPortalFx.isEmpty(e),i=t&&t.getCompositionType()===oe.Startboard;return{id:Ne(this.locator),instanceId:this.instanceId,bladeId:Ne(e.locator),bladeInstanceId:e.instanceId,onBlade:s,onStartBoard:i,bladeCustomized:!1}}_getPartViewModelAsync(t,n,a,l,d,c,p){const u=this.parent&&this.getPartsContainer(),m=function(t,s,i){const o=je(s,i);return o&&{switchItem:(s,i)=>{de(t,Promise.all([MsPortalFx.require("../../../MsPortalImpl.Controls/Controls/Lists/Menu",e),MsPortalFx.require("../../../MsPortalImpl.Controls/Controls/Lists/TabMenu",e)]).then((([e,t])=>{const n=o.widget.element.findByClassName("fxc-menu"),r=o.widget.element.findByClassName("fxc-tabmenu"),a=n.length&&(z.getAllMatch(n[0],e.Widget)||[])[0]||r.length&&(z.getAllMatch(r[0],t.Widget)||[])[0]||o.getMenuWidget();a&&a.switchItem(s,i)})))},internalGetAndSelectItem:s=>de(t,MsPortalFx.require("../../../MsPortalImpl.Controls/Controls/Lists/Menu",e)).then((e=>{const t=o.widget.element.findByClassName("fxc-menu"),i=t.length?(z.getAllMatch(t[0],e.Widget)||[])[0]:o.getMenuWidget();return i?i.internalGetAndSelectItem(s):Promise.resolve(null)}))}}(this,u,this._journey||this.diContainer.get(w.JourneyManager).activeJourney()),g=k.needContainerSelectable(this.partDefinition.details),b=(0,s.startTimer)();K.provideContext((()=>{this._creationState=K.getState()}),J.Part,this._getPartContext());const v=c&&(e=>{e&&!e.chrome&&e.content()&&c(e)}),y=Q(MsPortalFx.tryImmediateResolve(He(this)?MsPortalFx.tryImmediateResolve(Ue(this).tryGetVirtualPartViewModel(),(e=>(e&&v&&v(e),e))):Q(null),(e=>{if(this._getPartViewModelCalledDeferred.resolve(),e)return e;const s=qe(this),i=u&&u.bladeDefinition,o=(0,V.getViewModelType)(t,He(this)&&i);let r;r=u&&1&u.flags?1:0,r|=We(this)?2:0,r|=m?4:0,r|=u&&256&u.flags?16:0;const l=Ue(this),c=!nt(this.partDefinition)&&function(e,t){if(N.isFixedSize(e.size()))return Ke(e);{let e=0,s=0;const i=t.journeyWidget,o=t.blade;if(2===t.partLocation&&o&&i){const n=i.getBlades().length>1;e=me.innerHeight-113-(n?(0,M.getScrollbarWidth)():0);const r=t.inMenuBlade?o.masterContainer.id:o.id;s=i.getBladeDisplayWidth(r)-(t.inMenuBlade?265:0)-1}return{height:e,width:s}}}(p,{partLocation:s,blade:l,journeyWidget:(0,U.getPortalViewModel)(this.diContainer).getJourneyWidget(),inMenuBlade:!!m});return K.usingState((()=>this._viewModelManager.getPartViewModel(4&(null==i?void 0:i.attributes)?i.dxView.runtimeExtension:this.extension.name,t,o,{createSelectable:g,partSize:n,contentSize:c,partLocation:s,collapsed:a,onInputsSetParameters:d,onViewModelAcquired:v,locator:this.locator,flags:r,menuId:u&&u.defaultMenuItemId,bladeName:null==i?void 0:i.name})),this._creationState)})));return y.then(this._earlyVmDeferred.resolve,this._earlyVmDeferred.reject),y.then((t=>{let n,a;if(t&&t.chrome?(a=MsPortalFx.cloneAndRebindFunctions(t),a.content=ko.observable(i.markAsV2(t.chrome)),n=Q(t.content.fxAwaitAndRun(this)).then((e=>(c&&c(t),t))),this._setupLoadingReactor(p,t.container.operations)):n=Q.resolve(a=t),He(this)){const e=Ue(this);e.setViewModelForTemplateOrMenuBlade(a),e.setInputsSetPromise(Q(this._allOnInputsSet))}const l=t&&X(t.container);let d;return l&&(l.requestOpenBlade((async(e,t)=>(await this.diContainer.getAsync(o.get("MsPortalImpl/UI/UI.BladeOpenerImpl","BladeOpener"))).requestOpenBlade(e,void 0,t))),l.closeBlade(function(e){const t=e.diContainer.get(w.JourneyManager),s=t.tryCloseBlade.bind(t),i=e.getPartsContainer();return(t,o)=>{switch(t){case 1:case 2:{const o=e.diContainer.get(E.Finder).findBlades(i).filter((s=>{const i=!!(1&s.flags);return Ve(e,s)&&1===t?!i:i}));return 0!==o.length&&!o.some((e=>!s(e)))}default:{let e=i;const t=i.masterContainer,n=t&&t.bladeDefinition;return n&&n.menuBlade&&(e=t),e.returnValue=o,s(e,2)}}}}(this)),l.menu(m),l.openDialog(((e,s)=>o.get("MsPortalImpl/UI/Compositions/UI.Composition.Part.Dialog","openDialog").then((i=>i(this,t,e,s,this._contentInitializing,Ue(this),We(this)))))),l.setFocus((e=>Q(this._contentInitializing.fxAwaitAndRun(this,(e=>!1===e))).then((()=>this._part.setFocus(e))))),l.print((()=>{const e=Ue(this).containerWidget;this.diContainer.get(f.PrintHandler).printBlade(e.element[0],{name:e.getContentWidget().options.getTelemetryName(),source:"ExtensionCall",menuBladeCtx:e.options.isMenuBlade.peek()?e.options.getTelemetryName():null})})),l.executeInCloudShell((async(t,...i)=>{if(!(0,s.isFeatureEnabled)("azureconsole"))return(0,r.logToExtension)(e,rt(this),1,"Azure Console feature is not enabled in this environment."),!1;const n=Ue(this).getTelemetryContextState();try{return(await this.diContainer.getAsync(o.get("MsPortalImpl/UI/UI.AzureConsole","AzureConsole"))).executeInCloudShell({cliType:t,commands:i},n)}catch(e){return fe.error(FxImpl.createError("Failed to execute in CloudShell",{innerErrors:e})),!1}})),l.toggleFullScreen((()=>{this.diContainer.get(x.FullScreenMode).toggle()})),l.openHelpPane((async e=>{(await this.diContainer.getAsync(o.get("MsPortalImpl/UI/UI.HelpPane","HelpPane"))).open(e,this.getCreationState())}))),t&&t.container&&t.container._msPortalFxAnnounce((e=>{d||(d=new h.PortalReader(this._ltm,{idPrefix:this.locator.name})),d.read(e)})),n})).then((e=>{const t=this._finder,i=t.locate(this.locator),o=(0,s.startTimer)(),n=e&&e.content();return d&&ne.notifyOnInputsSetCalled(l,d,e&&e.onInputsSetPromise&&Q(e.onInputsSetPromise)),i&&i.reference&&(i.reference.extenderViewModelLocator||i.reference.extenderViewModel)?(this._extenderVMExtn=t.locate(this.locator.getExtensionLocator(),this.extension.name),this._viewModelManager.getViewModel(this._extenderVMExtn.name,i.reference.extenderViewModelLocator||i.reference.extenderViewModel,9).then((t=>{const s=i.reference.extenderViewModelLocator?i.reference.extenderViewModelLocator.name:i.reference.extenderViewModel;return t&&t.content()?n&&ko.isObservable(n.extenderViewModel)?(this._extenderVM=t,n.extenderViewModel(t.content())):fe.error(`Part '${this}' defines extender view model '${s}' but the referenced part is not marked as extensible.`):fe.error(`Extender view model '${s}' for part '${this}' must be an object.`),e})).finally((()=>{this._perfData.extenderViewModelLoad=o()}))):e})).finally((()=>{this._perfData.partViewModelLoad=b()}))}_getAdapterViewModelAsync(){if(!this.adapter)return Q(null);Ye(this);const e=Fe(this._getAdapterAllInputsSetWatcherConfig()),t=ne.loadOnInputsSetParameters(e),i=this.adapter;return t.then((t=>{this._earlyAdapterOnInputsSet=!!t,this._perfData.earlyOnInputsSetAdapter=this._earlyAdapterOnInputsSet;const o=(0,s.startTimer)();return this._viewModelManager.getViewModel(i.extension.name,i.viewModelLocator||i.viewModelName,10,{onInputsSetParameters:t}).then((s=>(i.viewModel=s,t&&ne.notifyOnInputsSetCalled(e,t,s&&s.onInputsSetPromise),e))).finally((()=>{this._perfData.adapterViewModelLoad=o()}))}))}_bindAssetNameFromAdapter(){const e=this.adapter;if(!e)return;const t=_e(e.viewModel,"content.assetName");let s;t.exists&&(ko.isObservable(t.value)?(s=t.value,ko.computed(this,(()=>{const e=s(),t=this._vm;!he(e)&&t&&t.container&&O.setModelValue(t,"container.assetName",e)}))):fe.error("Failed to bind the asset name from the adapter view model for Part '{0}', because the asset name needs to be an observable.".format(e.viewModelId)))}_composePart(e,o){if(this.isDisposed())return;const n=this.locator,r=this.partDefinition,l=r.partKind,d=b.getPartFactory(this._finder,n,r);let c,p,u;if(d){1!==r.resizeMode?o.supportedSizes(d.supportedSizes):o.supportedSizes([]),this._inputBindings=null,this.getInputPropertyBindings();const l=this._getAdapterViewModelAsync(),u=this._finder.locate(n),m=u&&u.reference&&u.reference.extenderViewModel,g=this.bindings||[],h=g.some((e=>e.source&&e.source.scope===re.DetailsContainer)),f=this.adapter&&g.some((e=>e.source&&7===e.source.modelType));if(m||h)p=Q(null);else{const e=()=>this.isDisposed()?Q(null):(this._registerInputPropertyBindings(),c=Fe(this._getAllInputsSetWatcherConfig()),ne.loadOnInputsSetParameters(c));p=f?l.then(e):e()}let x;p=function(e){const t=tt(Ee);return Q(MsPortalFx.tryImmediateResolve(t,(()=>e)))}(p),this._vmPromise=Q(MsPortalFx.tryImmediateResolve(p,(e=>{if(this.isDisposed())return this._releaseResources(),Q.reject(new pe);this._earlyOnInputsSet=!!e,this._perfData.earlyOnInputsSetPart=this._earlyOnInputsSet;const t=this.partDefinition,s=t.partKind===Ae?this._getSummaryPartViewModelState():null;x=o?o.size():this.initialSize;const i=this._getPartViewModelAsync(t.viewModelLocator||t.viewModel,x,s,c,e,c&&(e=>this._setupInvocationProperties(d.viewStateProperties,e)),o).then((e=>(0,D.composePartCommands)(o.commands,this.resourceLTM(),this).then((()=>e))));return Q.all([i,l])}))).spread(((n,l)=>{const p=(0,s.startTimer)();if(this.setViewModel(n),ko.reactor(this,(()=>{const e=this._vm.content()&&this._vm.onInputsSetPromiseState();e&&(this._perfData.onInputsSetPromiseState=e.state,this._perfData.onInputsSetPromiseType=t.OnInputsSetPromiseType[e.type])})),this.isDisposed())return this._releaseResources(),Q.reject(new pe);if(n){if(!this.isDisabled){this._bindAssetNameFromAdapter(),this.resourceLTM().registerForDispose(this.widget.element.setEvents(["fxportalcontrolloadfailed",(e,t)=>{this._createErrorPart(Re.ErrorLoadingControl,t)}]));const t=o?o.size():this.initialSize,s=t!==x,a=!1;Je(this._vm,e,o,t,s,this.partDefinition),i.isV2(n.content())||this._setupLoadingReactor(o,n.container.operations),o.userResizable(this.getCompositionType()===oe.StartboardPart&&2===r.resizeMode),o.actionBarViewModel.partTitle(this.getTitle()||"Untitled"),s?this.extension.processMessages().finally((()=>{this.isDisposed()||this._setupPartWidget(e,d,c,l,a,p)})):this._setupPartWidget(e,d,c,l,a,p)}}else this._createErrorPart(Re.ViewModelMissing,a.UiCompositionPart.viewModelRequired)})).catch((e=>{if(this.isDisposed()||MsPortalFx.Errors.isInstanceOfErrorType(e,MsPortalFx.Errors.CanceledError))return Q.reject(new pe);this._createErrorPart(Re.ErrorAcquiringViewModel,e)}))}else l!==ie.Provisioning&&(u="Incorrect part type '{0}'.".format(l),this._createErrorPart(Re.IncorrectPartType,u))}_setupPartWidget(e,t,i,o,n,r){const a=this.widget,l=this.getViewModel();this._perfData.prepareViewModel=r();const d=(0,s.startTimer)();u.setSelectableContext(this,l,e),MsPortalFx.tryImmediateResolve(this._createPartWidget(t,l,n),(()=>{if(this.isDisposed())return Q.reject(new pe);Je(l,e,a.options,a.options.size(),!1,this.partDefinition),this.register(t.viewStateProperties,i,o),function(e){const t=e.adapter,s=t?t.allInputsSet:e.allInputsSet;ko.computed(e,(()=>{if(s()){const t=Ze(e);t&&t.exists&&e.assetId(ko.unwrap(t.value))}}))}(this),this._ensureAssetAffinity(),this._perfData.finalizePartCompose=d();if(1===this.partDefinition.resizeMode){const e=this.extension&&this.extension.name;if("AppInsightsExtension"!==e&&"SamplesExtension"!==e)return;X(this._vm.container).resize.subscribe(this,(e=>{if(!e||!e.width||!e.height)return;const t=N.getGridPixelSize(e.width,e.height);this.widget.element.trigger("fxsizechange",[a.options.id,t.width,t.height])}))}}),(e=>{this._createErrorPart(Re.ErrorCreatingWidget,e)}))}register(t,i,o){const n=this.parent&&this.getPartsContainer();this._removeOutputArgumentValuesFromContainerModel(),(this.bindings||[]).forEach((e=>{const t=e.source.modelType;this._hasRebindableInputs||e.source.scope!==re.CurrentContainer||1!==t&&7!==t&&9!==t||(this._hasRebindableInputs=!0)})),this._listenForPartMutation(),this.adapter&&!o&&Ye(this),i||(this._registerInputPropertyBindings(),this._setupInvocationProperties(t,this._vm)),this._partSettingsManager.configureInstanceProperties(this._viewStateProperties),this._partSettingsManager.initialize(),nt(this.partDefinition)||le(this,"./UI.Composition.SelectableRegistration",(e=>{e.listenForRegistrationChanges(this,this._vm,this)}),e),le(this,"./UI.Composition.Selectable2Registrar",(e=>{e.registerSelectables(this,this._vm,this,!nt(this.partDefinition))}),e);const r=this.getInputPropertyBindings();this._setupBladeRebindingHandlers(n);const a=(0,s.startTimer)();this.save(),i||(i=Fe(this._getAllInputsSetWatcherConfig())),i.bindableTarget.viewModel=this._vm,this._setContainerInputsChanging=(e,t)=>{if(!e)return t?ne.turnOnInputsSetSuppressionOff(i,t):ne.turnOnInputsSetSuppressionOff(i);ne.turnOnInputsSetSuppressionOn(i)},ne.setupAllInputsSetWatcherFromExtendedConfig(i),this.adapter&&(o||(o=Fe(this._getAdapterAllInputsSetWatcherConfig())),o.bindableTarget.viewModel=this.adapter.viewModel,ne.setupAllInputsSetWatcherFromExtendedConfig(o)),st().then((e=>{e.listenForConfigurationChanges(this,o,i)}));const l=()=>{this._finishCompose(n,r,a)};He(this)||(0,H.isShellPart)(this.locator)?l():this.extension.processMessages().finally(l)}_finishCompose(e,t,s){if(!this.isDisabled&&!this.isDisposed()){e&&e.notifyPartComposed(this),this._registrationDeferred.resolve();const i=[t.awaitAllBound];this.adapter&&i.push(this.adapter.inputPropertyBindings.awaitAllBound);const o=s(),n=this._allInputPropertyBindingsBound;Q.all(i).then((()=>{const e=this._perfData;n.resolve(),e.allInputBindingsBoundPreprocess=o,e.allInputBindingsBound=s(),this._loadedMarker&&(this.adapter&&$.extend(e,{innerPart:{extension:this.extension.name,name:this.partDefinition.name}}),this.compositionTime=fx.getTimestamp()-this._loadedMarker,this._loadedMarker=null)})).catch((()=>{n.reject()})),this.save()}}_registerInputPropertyBindings(){const e=[],t=[],s=[];this._journey=this.diContainer.get(w.JourneyManager).activeJourney(),(this.bindings||[]).forEach((i=>{i.source.scope===re.DetailsContainer?s.push(i):t.push(i),i.isIdentityInput&&e.push(i.targetProperty)})),this._partSettingsManager.configure(this._getPartSettingsManagerConfig(e,this._viewStateProperties));const i=this.getInputPropertyBindings();Pe(this.diContainer,this,i,s),Pe(this.diContainer,this,i,t,(e=>this.adapter?this.adapter?this.bindAdaptedInput(e):void 0:this.bindAgainstOverridesOrContainerModel(e))),this._setEditScope(),this._setupJourneyEditScopeReactor()}bindAdaptedInput(e){const t=e.source;switch(t&&t.modelType){case 7:return{sourceModel:this.adapter.viewModel,sourceModelName:this+"-[Adapter]"};case 9:return{sourceModel:this.adapter.inputPropertyBindings.targetModel,sourceModelName:this+"-[AdapterInputs]"}}}getNonDetailsContainerPropertyBindings(e=!0){const t=this.adapter;return(e&&t?t.inputPropertyBindings:this.getInputPropertyBindings()).properties.filter((e=>{const t=e.compositionBindingDefinition;return(t&&t.source&&t.source.scope)!==re.DetailsContainer}))}bindAgainstOverridesOrContainerModel(e){if(e.source.id!==this.id){if(O.isDynamicBindingWithNonLocalSource(e))return null;const t=e.source.property,s=this.overridesModel;if(_e(s,t).exists)return{overridesConstantBindings:!0,sourceModelName:this+"-[OverridesModel]",sourceModel:s};const i=this.containerModel;if(i&&_e(i,t).exists)return{sourceModelName:this+"-[ContainerModel]",sourceModel:i};if(O.isOverridesOrContainerModelSourceReference(e.source)){const e={};return O.setModelValue(e,t,void 0),{sourceModelName:this+"-[Inferred]",sourceModel:e}}}}_setupInvocationProperties(e,t){const s=this.partDefinition;if(this._vm=t,!this._vm||this.isDisposed()||this.isDisabled)return;this._setViewStateProperties(s.viewStateProperties,e);const i=Be[Ee],o=this.diContainer.createChildContainer("composition");o.set(k.OpenerConfiguration,this._getBladeOpenerConfig()),this.setBladeOpener(o.get(i.BladeOpener)),this.registerForDispose((()=>o.disposeAsync())),function(e,t,s){let i=!!t;t&&(t.assetType&&!t.assetIdInputProperty?(fe.error(`'assetIdProperty' is required if 'assetType' is defined on part definition. Locator:'${e.locator}'.`),i=!1):!s&&t.editScopeType&&e.bindings&&e.bindings.some((e=>e.targetProperty===Ce))&&(i=!1,fe.error(`Declaring an 'editScopeType' and an input binding with '${Ce}' as a target property is not supported. A part cannot be the owner of an edit scope and also receive an edit scope id from an external source. Part: '${e}'. Bindings: ${JSON.stringify(e.bindings)}.`)));return i}(this,this.partDefinition,this._restoredFromJson)&&s.details&&s.details.length&&(s.details.forEach((e=>{(function(e,t){const s=[];let i=!0;t&&t.invocationInputArguments&&t.invocationInputArguments.length&&(i=k.validateDetailsDefinition(t,s));s.length&&be(s[0],e.toString(),t);return i})(this,e)&&this._registerInvocationProperty(e)})),this.resourceLTM().registerForDispose(this.widget.element.setEvents(["fxopeninnewtab",(e,t)=>{const s=t.selectable,i=k.getAssociatedDetailDefinition(s||t.selectableSet,this.getViewModel(),this.partDefinition);if(i){const e=s?s.selectedValue():(0,D.createSelection)(t.selectableSet,t.item),o=Q(e).then((e=>{const t=this._bladeOpener.createBladeModelForSelectedItem(i,e),s=t&&t.locator;return s?(0,p.getBladeDeepLink)(s.getExtensionName(),s.name,t.model,{baseUri:me.location.href}):null}));this.diContainer.get(_.WindowManager).openWindow(o)}}])))}getSelectableAsync(e){return Q(this.getViewModelAsync().then((t=>{const s="string"==typeof e?e:k.getSelectablePath(e),i=_e(t,s);if(i.exists)return ko.unwrap(i.value)})))}_getBladeOpenerConfig(){return{diContainer:this.diContainer,masterModelId:Xe(this),masterModel:this.getViewModel(),referenceComposition:this,referenceExtension:this.extension,invocationThrottleDuration:this.invocationThrottleDuration,isBladeOpenedByMaster:e=>Ve(this,e),onBladeOpened:MsPortalFx.noop,addOutputBindings:(e,t)=>{!function(e,t,s){const i=e.getInputPropertyBindings();(s||[]).forEach((s=>{MsPortalFx.find(i.properties,(e=>{const i=e.compositionBindingDefinition;return e.sourceProperty===s.source.property&&i&&i.source&&i.source.id===t.id}))||(Pe(e.diContainer,e,i,[s]),s.source.id=t.id,e.bindings.push(s),e.save())}))}(this,e,t)},removeOutputBindings:e=>{!function(e,t){const s=e.getInputPropertyBindings(),i=e.bindings||[],o=i.filter((e=>e.source.scope!==re.DetailsContainer));o.length!==i.length&&(s.properties.filter((e=>{const s=e.compositionBindingDefinition;return s&&s.source&&s.source.id===t.id})).forEach((e=>{s.removeProperty(e)})),e.bindings=o,e.save())}(this,e)},configureBladeDescriptor:e=>{e.masterPartId=this.id,e.bindings&&e.bindings.forEach((t=>{t.source&&t.source.id===this.id&&(e.model[t.targetProperty]=ko.toJS(_e(this._vm,t.source.property).value))}))}}}loadState(e){this.partDefinition&&e&&this._vm&&this._vm!==t.EmptyViewModel&&this._viewStateProperties.forEach((t=>{const s=_e(e,t);s.exists&&!t.startsWith("internal.")&&O.setModelValue(this._vm,t,s.value)}))}_setupLoadingReactor(e,t){if(this.partDefinition.partKind!==ie.Provisioning){this._frameBlockingUi(ot(this.partDefinition)),this._loadingReactorLifetime=this.createChildLifetime(),ko.reactor(this._loadingReactorLifetime,(()=>{const s=t.inProgress();e.hasOngoingOperation(s&&!e.locked()),this.triggeringLockedBladeSpinner(s&&e.locked())}));const s=ko.computed(this._loadingReactorLifetime,(()=>t.blockingUi()||this._frameBlockingUi()||this._contentInitializing()));if(He(this)){const e=Ue(this);2!==S.getBladeType(e.bladeDefinition)&&(ko.reactor(this._loadingReactorLifetime,(()=>{e.shieldType&&e.shieldType(t.shieldType())})),e.uiBlockers.push(s))}s.subscribe(this._loadingReactorLifetime,(s=>{const i=1===t.shieldType()||e.locked();if(e.isInBlockingLoadingState(s&&!i),!s){const t=e.hasOngoingOperation.value;this._contentRevealed.resolve(t)}})),s()||(this._contentRevealed.resolve(t.inProgress()),e.isInBlockingLoadingState(!1))}}_removeOutputArgumentValuesFromContainerModel(){const e=this.partDefinition,t=this.containerModel;t&&e&&e.details&&e.details.forEach((e=>{const s=e.outputArguments;s&&s.forEach((e=>{const s=e.valuesFrom;s&&s.forEach((e=>{const s=e.property;_e(t,s).exists&&O.setModelValue(t,s,void 0)}))}))}))}_getPartSettingsManagerConfig(e,t){return{part:this,instanceProperties:t,partViewModelId:Xe(this),partStateDefinition:this.partDefinition&&this.partDefinition.partState,identityInputs:e}}_listenForPartMutation(){const e=this.partDefinition;let t;const s=this._vm.container;if(!s.mutate||He(this))return;const i=this.createChildLifetime();s.mutate.subscribe(i,(s=>{const o=this.locator.getExtensionLocator();if(s.partName)t=s.extensionName?we(s.extensionName).withPartType(s.partName):o.withPartType(s.partName);else{const s=e.assetTypeDefinition;if(!s)return void fe.error("Mutate function on part {0} was called with an object but the mutating part doesn't have an asset type definition.".format(this.locator.toString()));t=we(o.name).withPartType(s.partName)}const n={newPartContainerModel:s.containerModel,invoker:"mutation"};this.diContainer.get(L.ReplacePartPortalFunc).invoke({part:this,newLocator:t,options:n},Ie).catch((e=>{const s=`Unable to replace provisioning part '${this.locator.toString()}' with the part for the created asset defined by the locator '${t.toString()}'\r\n${e}.`;fe.error(s)})).finally((()=>{this._disposeEditScope(),i.dispose()}))}))}_updateForHasPermissions(e){return Q(this._vmPromise.then((()=>{const s=this._vm;if(s===t.EmptyViewModel||this.isDisposed())fe.warning("Part '{0}' has not retrieved view model when checking permissions.".format(this.locator.toString()));else{const t=s.container,i=this.widget;e?!MsPortalFx.isNullOrUndefined(t.unauthorizedMessage.peek())&&t.unauthorizedMessage(null):(i&&i.options.isInBlockingLoadingState(!1),t.unauthorized(),s.updatePartForUnauthorized())}})))}_getAllInputsSetWatcherConfig(){const t=this.widget,i={bindableTarget:{viewModelName:Xe(this)},propertyBindings:this.getInputPropertyBindings(),allInputsSet:this.allInputsSet,calledOnInputsSet:this.calledOnInputsSet,failedOnInputsSet:this.failedOnInputsSet,referenceComposition:this,notifyWhenInputsChangeWithSameValues:!0,inputsSetCalled:(e,s)=>{let i;s.then((e=>{i=e})).finally((()=>{this._onInputsSet.resolve(i),this._contentRevealed.resolve(!1),this._lastRebindOnInputsSetProperties&&($.isEmptyObject(this._lastRebindOnInputsSetProperties)||S.deepSubset(e,this._lastRebindOnInputsSetProperties))&&t&&t.options.isInBlockingLoadingState(!1)}))},beforeViewModelPropertyUpdate:t=>{if(this.partDefinition.permissions){const i=(0,s.startTimer)(),o=this.locator.toString();return R.checkPermissions(this.partDefinition.permissions,te.All,t,this.partDefinition.assetType,this.extension.name,this.diContainer,o).then((t=>(this._updateForHasPermissions(t).catch((t=>{this.isDisposed()||MsPortalFx.Errors.isInstanceOfErrorType(t,MsPortalFx.Errors.CanceledError)||(0,r.logToExtension)(e,this.widget.element,2,`Part permission check failed. Error: ${MsPortalFx.getLogFriendlyMessage(t)}`)})),t))).finally((()=>{this._perfData.checkPermissions=i()}))}return Q(!0)},getInputsMetadata:1===qe(this)&&(()=>Q(MsPortalFx.tryImmediateResolve(st(),(e=>{const t=e.getConfigurableInputsMetadata(this);return Object.keys(t).forEach((e=>{const s=t[e];(s&&s.bindingSources||[]).forEach((e=>{delete e.sourceReference}))})),t})))),getDashboardFilters:()=>{const e=this.parent&&this.getPartsContainer();return e&&e.getFilters?e.getFilters():{}},getPartFilters:()=>this.filters||{}};return this.partDefinition&&this.partDefinition.partState&&this._partSettingsManager&&(i.getStateAsync=()=>Q(this._partSettingsManager.getPartSettingsAsync()).then((e=>(this._part&&this._part.partSettingFailed(!1),e)),(e=>(this._part&&this._part.partSettingFailed(!0),(0,j.QReject)(`Failed to retrieve part settings for part '${this}'.`,{innerErrors:e}))))),i}_getAdapterAllInputsSetWatcherConfig(){const e=this.adapter;return{bindableTarget:{viewModelName:e.viewModelId},propertyBindings:e.inputPropertyBindings,allInputsSet:e.allInputsSet,calledOnInputsSet:e.calledOnInputsSet,failedOnInputsSet:e.failedOnInputsSet,referenceComposition:this,notifyWhenInputsChangeWithSameValues:!0}}notifyDetailBladeClosed(e){const t=()=>{const t=e.masterCommandName,s=this._vm.container,i=s&&s.selectable;i&&!he(t)&&i.isCommandSelected(!1)};this.isComposed?t():this.await(7).then(t)}beforeActivateCommandMenuItems(e){e.isControlContextMenu||this._contextMenuViewModels&&(this._contextMenuViewModels.dispose(),this._contextMenuViewModels=null)}_handleRightClick(t,s){const i=s&&s.listData&&s.listData.selectableSet;if(!this.isDisabled&&!this.isDisposed()){const o=i;s.supplyCommands||o&&o._msPortalFxSupplyCommands?le(this,"./UI.Composition.ContextMenuV2",(e=>{const i={partComposition:this,diContainer:this.diContainer};e.OpenContextMenuPipeline.createPipeline(this.diContainer,this,i,this).startTask({dataItem:s.viewModel,extension:this.extension,contextMenuArgs:s,evt:t})}),e):this._determineExtensionAndTriggerContextMenu(t,s)}}_determineExtensionAndTriggerContextMenu(t,s){const i=this.diContainer,o=this.extension,n=e=>{const t=this._finder.locateAsync(we(e.commandGroupOwner));return t.catch((()=>{fe.error("Could not find extension '{0}' for commandGroup {1} from part in extension {2}.".format(e.commandGroupOwner,e.commandGroup,o.name))})),t},r=(e,o)=>{e.fireContextMenuEvent(this,i,this,o,t,s,this._showShellCommands,this._bladeOpener).then((e=>{this._contextMenuViewModels=e}))};le(this,"./UI.Composition.ContextMenuContainer.DemandLoad",(e=>{s.commandGroupOwner&&s.commandGroupOwner!==o.name?n(s).then((t=>{r(e,t)})):r(e,o)}),e)}isSelected(){const e=ko.unwrap(this._vm.container).selectable,t=ko.unwrap(e);return t&&ko.unwrap(t.isSelected)}await(e){switch(e){case 0:return this._allContentRevealed;case 1:return this._partDefinitionDeferred.promise;case 2:return this._earlyVmDeferred.promise;case 3:return this._allOnInputsSet;case 5:return this._getPartViewModelCalledDeferred.promise;case 6:return this.await(1).then((()=>{const e=Ue(this),t=(null==e?void 0:e.bladeDefinition)?S.getBladeType(e.bladeDefinition):0;return 5===t||6===t?this.await(0):this.await(7)}));case 7:return this._registrationDeferred.promise}return super.await(e)}_createErrorPart(t,s){if(this.isDisposed())return Q.reject(new pe);const i=MsPortalFx.getLogFriendlyMessage(s);this._traceErrorTelemetry(t,"string"==typeof s?s:s&&s.message,s);const o=He(this)&&Ue(this),n=`Error composing ${o?"blade":"part"} '${o||this}'. Details: ${i}`;let l;l=new q("string"==typeof s?{message:n}:{message:n,innerErrors:s}),t===Re.ErrorAcquiringViewModel||t===Re.ViewModelMissing?(0,r.logToExtension)(e,rt(this),2,n):fe.error(n,t,l);const d=b.getPartFactory(this._finder,this.locator,{partKind:ie._Internal_Error}),c=(0,W.composePartViewModel)((()=>({message:a.PartError.titleContent,summaryItems:[{label:a.PartError.errorReason,value:Re[t]}],details:i}))),p=this._savedContainerState,u=c.container;return p&&(u.partTitle(p.partTitle),u.assetName(p.assetName)),this._registrationDeferred.reject(s),o&&o.widget.options.loaded(!0),this._createPartWidget(d,c,!0)}_createPartWidget(t,s,i){var o;if(this.isDisposed())return Q.reject(new pe);const n=Ue(this),a=n&&n.bladeDefinition,l={size:this.widget.options.size,locator:this.locator,getDebugId:()=>Xe(this),traceErrorTelemetry:(e,t)=>{this._traceErrorTelemetry(Re.TransitionedToErrorState,e,t)},noFxContentPadding:this.partDefinition&&(this.partDefinition.noFxContentPadding||this.partDefinition.isV2),isVirtualPartForTemplateBlade:a&&1===S.getBladeType(n.bladeDefinition),getTelemetryContextState:a&&S.bladeImplementedWithVirtualPart(a)?()=>n.getTelemetryContextState():()=>this._creationState,partLocation:qe(this),pinnedBladeDeeplink:this.partDefinition&&this.partDefinition.ignorePinnedDeepLink?void 0:this._pinnedBladeDeeplink};if(i&&this.widget.options.isInBlockingLoadingState(!1),a){let e;if(a.menuBlade){let t;if(a.menuBlade.isV2){const e=s.content().viewModel;t=e&&e._msPortalFxMenu}else{t=s.content().menu}e=t&&t._msPortalFxData}else if(null===(o=a.tabMenuBlade)||void 0===o?void 0:o.isV2){const t=s.content().viewModel,i=t&&t._msPortalFxTabMenu;e=i&&i._msPortalFxData}e&&MsPortalFx.extend(e,{menuDeepLink:n.menuDeepLink})}return Q(MsPortalFx.tryImmediateResolve(t.createPart(this._partContainer[0],s,l,this.diContainer,this),(t=>{var i;if(this.isDisposed())return Q.reject(new pe);this._part=t;const o=(e=!1)=>{this._frameRevealed.resolve(e),this._frameBlockingUi(!1),!e&&this._frameInitialized.resolve()};if(ot(this.partDefinition)&&t.awaitReady){const s=t;s.awaitReady().catch((t=>{const s=n.bladeDefinition?S.getBladeType(n.bladeDefinition):0;2===s||5===s||6===s?n.logFrameBladeLoadError(t):K.usingState((()=>{Me.trace({extension:rt(this),source:Ie,action:"IFramePartReadyTimeout",name:Ne(this.locator),data:{details:t},journeyId:this._getTelemetryJourneyId()})}),this._creationState),(0,r.logToExtension)(e,this.widget.element,2,`A 'ready' message is expected but not received by '${this}'. IFrame should post the 'ready' message to indicate that the IFrame HTML page has loaded and an 'onMessage' handler has been installed to receive subsequent messages. Details: ${MsPortalFx.getLogFriendlyMessage(t)}`)})),s.awaitContentRevealed().then((()=>{o(!0)})),s.awaitInitializationComplete().then((()=>{o()}))}else o();He(this)||(ko.reactor(this,(()=>{const e=s.container.notFoundMessage();this._part.notFoundMessage(e)})),ko.reactor(this,(()=>{const e=s.container._msPortalFxHandledError();this._part.handledErrorMessage(e)}))),t.setupContent({extensionWindowId:this.extension&&this.extension.name,styleSheets:null===(i=this.partDefinition)||void 0===i?void 0:i.styleSheets}).finally((()=>{this._contentInitializing(!1)})),ko.computed(this,(()=>{const e=this.parent,t=e&&e.widget,s=t&&t.options.locked();this.widget&&this.widget.options.locked(s),this._part&&this._part.lockedUiContext(s)}))})))}loadPropertiesFromJson(e,t,s=!1,i){const o=ne.bindingsFromJSON,n=t.partState;this.assetInstanceDefinition=t.assetInstanceDefinition,this.bindings=i?Se(i,this):o(e,t.bindings)||[],this.initialSize=t.initialSize,this._bindingsInitialized=t.bindingsInitialized,this._restoredFromJson=!0,this.loadFromJson(t),this._savedContainerState=t.savedContainerState,this.containerModel=F.createContainerModel(t.containerModel),this.overridesModel=F.createContainerModel(t.overridesModel)||{},this.partState=FxImpl.isSerializedObject(n)?FxImpl.fromSerializableObject(n):n,s&&et(this.partState),t.originalPartLocator&&(this.previousLocator=G.fromJSON(e,t.originalPartLocator)),this.flags=t.flags||0,this._adapterBindings=o(e,t.adapterBindings)}calculateInitialSize(){let e,t,s,i,o={};const n=this._finder,r=this.locator,a=r.type;if(5===a||7===a){if(n.tryLocate(r,o)){const a=o.value;if(a){const l=a.inline,d=a.reference;if(t=l?l.initialSize:d.initialSize,s=l?l.initialWidth:d.initialWidth,i=l?l.initialHeight:d.initialHeight,l)e=l;else{const t=we(d.extension||r.getExtensionName()).withPartType(d.partTypeName);o={},n.tryLocate(t,o)&&(e=o.value)}}}}else 6===a?(o={},n.tryLocate(r,o)&&(e=o.value)):fe.error("Unable to create Part composition. Invalid locator type: '{0}'".format(a));this._bindingsInitialized=!1;const l=b.getPartSizeOrDefault(e);let d=l;if(se.InternalPartSize[t])d=t;else if(e&&se.InternalPartSize[e.initialSize])d=e.initialSize;else if(e){const t=b.getPartFactory(this._finder,this.locator,e);d=t&&void 0!==t.defaultSize?t.defaultSize:l}this.initialSize=d,99===this.initialSize&&(this.initialWidth=s||e&&e.initialWidth,this.initialHeight=i||e&&e.initialHeight)}getDiagnosticsData(){return $.extend(super.getDiagnosticsData(),{bindings:ne.mapBindingsToFriendlyObjects(this.bindings)})}_getSummaryPartViewModelState(){const e={collapsed:!1};return this.widget.trigger("fxsummarycollapsed",e),e.collapsed}_getEditScopeIdFromSettings(){const e=this._journey,t=e&&e.ambientSettings.getItem(this.journeyPath),s=t&&t.value,i=s&&s.editScope;return i&&i.editScopeId}_setupJourneyEditScopeReactor(){const e=this.partDefinition,t=this._journey;e&&e.editScopeType&&t&&t.observeEditScopeChanges(this,{editScopeId:this.editScopeId,ownerType:this.locator.type,ownerLocatable:this})}_setEditScope(){const e=this.partDefinition;if(!e||!e.editScopeType)return;const t=this._getEditScopeIdFromSettings(),i=this.editScopeId;t?i(t):(i((0,s.getUniqueId)()),this.diContainer.get(y.EditScopeManager).onEditScopeCreated(i()));const o=this.getInputPropertyBindings();if(!o.properties.some((e=>e.targetProperty===Ce))){const e={};e[Ce]=i,o.mapProperty(Ce,Ce).bind(this+"-[EditScopeId]",e,!0)}}_getCommands(){if(!this.isComposed||!this.widget)throw new ue(`Part '${this}' needs to be composed before retrieving its commands.`);return this.widget.options.commands}_setupPromises(){this._onInputsSet=Q.defer(),this._contentRevealed=Q.defer(),this._allOnInputsSet=Q.all([this._onInputsSet.promise,this._frameInitialized.promise]),this._allContentRevealed=Q.all([this._contentRevealed.promise,this._frameRevealed.promise]).spread((e=>e)),this._allContentRevealed.then((e=>this.contentRevealed=e))}_setupBladeRebindingHandlers(e){if(e&&e.onRebind){const t=e=>{this._setContainerInputsChanging(!0),this._updateRebindSequenceNumber(),K.provideContext((()=>{this._creationState=K.getState()}),J.Part,this._getPartContext());const t=this.editScopeId()&&this.diContainer.get(y.EditScopeManager).getStateObservable(this.editScopeId()),s=this.widget;if(this._onInputsSet.reject(new ce(`Part binding canceled due to rebinding for part '${this}'`)),this._contentRevealed.reject(new ce(`Part reveal canceled due to rebinding for part '${this}'`)),this._setupPromises(),this._hasRebindableInputs){const t=(this.parent.parent||this.parent).widget;!s||t&&t.options.locked()||s.options.isInBlockingLoadingState(!0),this._lastRebindOnInputsSetProperties=ke(e,this.bindings,1,""+this),this._setupAdaptedInputsReboundReactor()}if(t&&0===t()&&this.diContainer.get(y.EditScopeManager).onEditScopeDisposed(this.editScopeId()),this.editScopeId(void 0),this._ensureAdapterAtomicityForBindings(),this.bindings.forEach((e=>{if(e.source.scope===re.DetailsContainer){_e(this._vm,e.targetProperty).exists&&O.setModelValue(this._vm,e.targetProperty,void 0)}})),this._vm.container.unauthorizedMessage.peek()&&this._vm.container.unauthorizedMessage(null),He(this)){Ue(this).setInputsSetPromise(Q(this._onInputsSet.promise))}else this._vm.container.notFoundMessage.peek()&&this._vm.container.notFoundMessage(null)},s=e=>{this.isComposed&&this._setEditScope()},i=()=>{this._setContainerInputsChanging(!1)};e.onRebind(t,s,i),this.registerForDispose((()=>{e.offRebind(t,s,i)}))}}_ensureAssetAffinity(){const e=this.parent&&this.getPartsContainer(),t=this.assetType,s=e&&e.assetType,i=this._part.inContainerOfSameAsset;if(!(e&&s&&t&&s===t&&ko.isObservable(e.assetId)))return i(!1);ko.computed(this,(()=>{const t=e.assetId(),s=this.assetId(),o=t&&s&&v.compareAssetId(t,s);i(o),this._part.assetId(s)}))}_ensureAdapterAtomicityForBindings(){const e=this.adapter;if(!e)return;const t=[];this.bindings.forEach((e=>{const s=e.source;7===s.modelType&&t.push(s.property)})),t.forEach((t=>{O.setModelValue(e.viewModel,t,void 0)}))}_setupAdaptedInputsReboundReactor(){const e=this.adapter;e&&!e.allOutputsReboundComputed&&(e.allOutputsReboundComputed=ko.computed(this,(()=>{if(this.bindings.filter((e=>{const t=e.source.modelType;return 7===t||9===t})).every((e=>{const t=this.bindAdaptedInput(e).sourceModel,s=_e(t,e.source.property).value;return void 0!==ko.unwrap(s)}))){const t=""+this,s=ke(e.viewModel,this.bindings,7,t),i=ke(e.inputPropertyBindings.targetModel,this.bindings,9,t);this._lastRebindOnInputsSetProperties=$.extend(s,i)}})))}_disposeEditScope(){const e=this.editScopeId();if(e){this.diContainer.get(y.EditScopeManager).onEditScopeDisposed(e);const t=this._journey;t&&t.ambientSettings.removeItem(this.journeyPath)}}_setViewStateProperties(e,t){const s=e||[];let i=t||[];i=i.filter((e=>{const t=e.split(".");return!(t.length>1)||(t.pop(),"object"==typeof _e(this._vm,t.join(".")).value)})),this._viewStateProperties=MsPortalFx.union(s,i);const o=this._vm,n=o&&o.container;n&&n.selectable&&(this._viewStateProperties=MsPortalFx.union(this._viewStateProperties,ye))}_registerInvocationProperty(e){const t=this._bladeOpener;let s;k.detailsIsPartContainer(e)&&(s=ko.pureComputed((()=>!this._vm.container.isSelectable()))),t.registerInvocationProperty(e,s)}_traceErrorTelemetry(e,t,s){const i=Object.assign(Object.assign({details:t,resourceId:this.assetId()},s&&s.data||{}),{stack:s&&s.stack});He(this)?MsPortalFx.tryImmediateResolve(this.diContainer.getAsync(o.get("MsPortalImpl/UI/Compositions/UI.Composition.BladeTelemetry","BladeTelemetry")),(t=>{t.traceBladeLoadErrored(Re[e],i)})):K.usingState((()=>{Me.trace({extension:rt(this),source:Ie,action:"PartErrored",actionModifier:Re[e],name:Ne(this.locator),data:i,journeyId:this._getTelemetryJourneyId()})}),this._creationState)}_getTelemetryJourneyId(){const e=this._journey;return e&&e.id}recordUserInteraction(){}_tracePartTelemetry(e,t){const s=rt(this),i=Ne(this.locator);Me.trace({source:Ie,action:e,extension:s,name:i,journeyId:this._getTelemetryJourneyId(),data:t})}}function He(e){return e.partDefinition&&e.partDefinition.shareVmWithParentBlade}function Ue(e){const t=e.getPartsContainer();return t&&t.getCompositionType()===S.CompositionType.Blade&&t}function We(e){const t=Ue(e);return!!(t&&t.bladeDefinition&&t.bladeDefinition.locked)}function Ve(e,t){return t.masterPartId===e.id&&he(t.masterCommandName)}function je(e,t){const s=t&&t.children||[],i=s.indexOf(e,1);if(i>0){const e=s[i-1];if(e.bladeDefinition&&(e.bladeDefinition.menuBlade||e.bladeDefinition.tabMenuBlade))return e}}function qe(e){const t=e.parent&&e.getPartsContainer(),s=t?t.getCompositionType():oe.Unknown;return t?s===oe.Startboard?1:2:0}function $e(e,t=!0){let i;return e&&(t&&!e.hasOwnProperty(S.PartContainerModelIdProperty)&&((e=ko.toJS(e))[S.PartContainerModelIdProperty]=(0,s.getUniqueId)()),i=ne.createObservableModel(e)),i}function Qe(e,t){let i;return e&&t?(i={},(0,s.forEachKey)(e,(e=>{i[e]=null}))):i=e,FxImpl.toSerializableObject(i)}function Ge(e,t,s,i,o,n){const r=e.createChildContainer("composition"),a=new ze(r,t,null,s,null,null,null,n);return a.registerForDispose((()=>r.disposeAsync())),a.calculateInitialSize(),a.containerModel=$e(i),a.overridesModel=$e(o||{},!1),a}function Ke(e){const t=N.getGridPixelSize(e.gridWidth(),e.gridHeight());let s=t.height,i=t.width;return e.locked()||(s-=30,i-=30),{height:s,width:i}}function Je(e,t,s,i,o,n){if(!nt(n)){if(o){const t="content.size",s=_e(e,t);s.exists&&ko.isObservable(s.value)&&O.setModelValue(e,t,i)}m.requestAnimationFrame((()=>{const o=function(e,t){return N.isFixedSize(t.size())?Ke(t):{height:e.height(),width:e.width()}}(t,s),n=e.container;n.width(o.width),n.height(o.height);const r=n.size();!he(r)&&r.partSize===i&&MsPortalFx.deepEquals(r.dimensions,o)||n.size({partSize:i,dimensions:o})}))}}function Xe(e){const t=e.partDefinition,s=e.adapter,i=t&&t.viewModel?t.viewModel:"N/A";return`${e} (${s?`AdapterPart. Extension: ${s.extension.name}, ViewModel: ${s.viewModelName}, Wrapped ViewModel: ${i}`:`ViewModel: ${i}`})`}function Ye(e){const t=e.adapter,s=t.inputPropertyBindings.targetModel;Pe(e.diContainer,e,t.inputPropertyBindings,t.bindings,(t=>(s[t.targetProperty]=ko.observable(),e.bindAgainstOverridesOrContainerModel(t))))}function Ze(e){const t=e.adapter,s=t?t.inputPropertyBindings:e.getInputPropertyBindings(),i=MsPortalFx.find(s.properties,(t=>t.targetProperty===e.assetInstanceDefinition.assetIdInputProperty));return i?_e(i.sourceModel,i.sourceProperty):null}function et(e){"object"==typeof e&&(0,s.forEachKey)(e,((t,s)=>{Te[t]?delete e[t]:"object"==typeof s&&et(s)}))}function tt(t){return le(void 0,t,(e=>Be[t]=e),e)}function st(){return tt(De)}function it(){return Be[De]}function ot(e){return e&&(e.partKind===ie.Frame||e.partKind===ie._Internal_Az||e.partKind===ie._Internal_React)}function nt(e){return e&&(e.partKind===ie._Internal_Az||e.partKind===ie._Internal_React)}function rt(e){const t=e.getPartsContainer();if(t){if(t.getCompositionType()===oe.Blade)return t.locator.getExtensionName()}const s=e.locator;return s&&s.getExtensionName()}t.Instance=ze,t.tryGetParentMenuBlade=je,t.prepareContainerModel=$e,t.getSerializableContainerModel=Qe,t.create=Ge,t.setBladeOpenerModule=function(e){Be[Ee]=e},t.setDynamicPartBinderModule=function(e){Be[De]=e},t.inferredReferenceType=-999,t.createOverridesOrContainerModelSourceReference=function(e){return{property:e,modelType:t.inferredReferenceType,scope:re.CurrentContainer,cardinality:O.ReferenceCardinality.OneToOne}}})),
define("MsPortalImpl/UI/Compositions/UI.Composition.CompositionAwaiter",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompositionAwaiter=void 0;class s{constructor(e,t){this.deferred=Q.defer(),this.targetId=e,this.isSource=t}}t.CompositionAwaiter=class{constructor(e){this._awaitableCompositions=[],this.resolvedCompositions=[],this._trackResolvedCompositions=e}await(e,t){const i=new s(e&&e.toString(),t),o=MsPortalFx.findIndex(this.resolvedCompositions,(e=>t(e)));return o>=0?i.deferred.resolve(this.resolvedCompositions[o]):(this._awaitableCompositions.push(i),e&&e.onDispose((()=>{if(Q.isPending(i.deferred.promise)){i.deferred.reject(new MsPortalFx.Errors.DisposedCanceledError);const e=this._awaitableCompositions.indexOf(i);e>=0&&this._awaitableCompositions.splice(e,1)}}))),i.deferred.promise}resolve(e){let t,s;for(this._trackResolvedCompositions&&(this.resolvedCompositions.push(e),e.onDispose((()=>{const t=this.resolvedCompositions.indexOf(e);t>=0&&this.resolvedCompositions.splice(t,1)}))),t=this._awaitableCompositions.length-1;t>=0;t--)s=this._awaitableCompositions[t],s.isSource(e)&&(s.deferred.resolve(e),this._awaitableCompositions.splice(t,1))}get waitingCompositions(){return this._awaitableCompositions.map((e=>e.targetId))}}})),
define("MsPortalImpl/UI/Dashboard/FiltersSerialization",["require","exports","Fx/Composition/DashboardFilters","FxInternal/Composition/DashboardFilters"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSubstringFilterModel=t.isEqualityFilterModel=t.deserializeFilters=t.serializeFilters=t.getFilterProcessor=void 0;const o={0:"equals",1:"notEquals",2:"contains",3:"notContains",4:"startsWith",5:"notStartsWith",6:"endsWith",7:"notEndsWith"};function n(e){return g["number"==typeof e?e:(0,i.getFilterKindFromId)(e)]}t.getFilterProcessor=n,t.serializeFilters=function(e){const t=e&&Object.keys(e);if(t&&0!==t.length)return t.reduce(((t,s)=>{const i=n(s);return t[s]={model:i.toJSON(i.fromExtensionModel(e[s]))},t}),{})},t.deserializeFilters=function(e){const t=e&&Object.keys(e);if(t&&0!==t.length)return t.reduce(((t,s)=>{const i=n(s),o=i.fromJSON(e[s].model);return t[s]=i.toExtensionModel(MsPortalFx.extend2(o,{selectAllState:void 0})),t}),{})};const r=(()=>{const e=[];return e[0]="auto",e[1]="1m",e[2]="5m",e[3]="15m",e[4]="30m",e[5]="1h",e[6]="6h",e[7]="12h",e[8]="1d",e[9]="7d",e[10]="1mo",e})(),a=(()=>{const e=[];return e[0]="m",e[1]="h",e[2]="d",e[3]="w",e})();function l(e){const t=o[e.operator];if(p(e))return{operator:t,substring:e.substring};const s=e.values;let i=e.selectAllState;switch(MsPortalFx.isNumeric(i)||(i=0),i){case 1:return{operator:t,selectAllState:"intermediate",excludedValues:s};case 0:return{operator:t,values:s};case 2:return{operator:t,selectAllState:"all",values:s}}}function d(e){const t=+MsPortalFx.find(Object.keys(o),(t=>o[+t]===e.operator));if(0!==t&&1!==t)return{operator:t,substring:e.substring,selectAllState:0};const s=e.values||e.excludedValues;let i;switch(e.selectAllState){case"all":i=2;break;case"intermediate":i=1;break;default:i=0}return{operator:t,values:s,selectAllState:i}}function c(e){const{operator:t}=e;return"number"==typeof t&&(0===t||1===t)}function p(e){return!c(e)}function u(e){if(e&&p(e)){const{operator:t,substring:s}=e;return{operator:t,substring:s}}return null}function m(e){if(e&&s.EqualityFilter.isSubstringFilterModel(e)){const{operator:t,substring:s}=e;return{operator:t,substring:s,selectAllState:0}}return null}t.isEqualityFilterModel=c,t.isSubstringFilterModel=p;const g={0:{fromExtensionModel:e=>e,toExtensionModel:e=>e,toJSON:function(e){const t={format:e.format?"local":"utc",granularity:r[e.granularity]};return e.relative?t.relative=`${e.relative.duration}${a[e.relative.timeUnit]}`:t.absolute=e.absolute,t},fromJSON:function(e){const t={format:"local"===e.format?1:0,granularity:function(e){const t=MsPortalFx.findIndex(r,(t=>t===e));return-1!==t?t:0}(e.granularity)},s=e.relative;if(s)t.relative=function(e){if((e=e&&e.trim())&&e.length>1){const t=e.slice(-1),s=MsPortalFx.findIndex(a,(e=>e===t));if(-1!==s){const t=parseInt(e.slice(0,e.length-1));if(MsPortalFx.isNumeric(t))return{duration:t,timeUnit:s}}}}(s);else{const s=e.absolute;s&&(t.absolute={fromDate:new Date(s.fromDate),toDate:new Date(s.toDate)})}return t}},1:{fromExtensionModel:e=>m(e)||Object.assign(Object.assign({},e),{selectAllState:0}),toExtensionModel:e=>u(e)||{operator:e.operator,values:e.values},toJSON:l,fromJSON:d},2:{fromExtensionModel:e=>m(e)||{operator:e.operator,values:e.subscriptionIds,selectAllState:0},toExtensionModel:e=>u(e)||{operator:e.operator,subscriptionIds:e.values},toJSON:l,fromJSON:d},3:{fromExtensionModel:e=>m(e)||{operator:e.operator,values:e.locations,selectAllState:0},toExtensionModel:e=>u(e)||{operator:e.operator,locations:e.values},toJSON:l,fromJSON:d},5:{fromExtensionModel:e=>m(e)||{operator:e.operator,values:e.resourceGroupIds,selectAllState:0},toExtensionModel:e=>u(e)||{operator:e.operator,resourceGroupIds:e.values},toJSON:l,fromJSON:d},4:{fromExtensionModel:e=>m(e)||{operator:e.operator,values:e.resourceTypes,selectAllState:0},toExtensionModel:e=>u(e)||{operator:e.operator,resourceTypes:e.values},toJSON:l,fromJSON:d}}})),
define("MsPortalImpl/UI/Compositions/UI.Composition.StartboardPart",["require","exports","Fx/Composition/DashboardFilters","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Finder","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuContainer","MsPortalImpl/UI/Compositions/UI.Composition.Part","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/UI/Dashboard/FiltersSerialization","MsPortalImpl/Services/Services.EditScopeManagement","Fx/Composition/Selectable","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/Widgets/Widgets.Portal.init","FxInternal/Composition/Part"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g,h,f,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.create=t.Instance=t.fxpartfilterschanged=void 0;var b=MsPortalFx.Base.Diagnostics,v=MsPortalFx.Parts.PartKind,y=l.CompositionBinder;const M=window.fx.getTimestamp;t.fxpartfilterschanged="fxpartfilterschanged";const I=b.createLog(e);class C extends c.Instance{constructor(e,t,s,i){super(e,t,s,i&&i.id,null,"StartboardPart",i&&i.pinnedBladeDeeplink),this.partFilterState=ko.observable(0),this._lastUserInteraction=-2e3,this.containerModel={},this._store=4,this._deepLink=i&&i.pinnedBladeDeeplink,i&&i.duringPortalStartup&&(this._dontLoadFilterUpdatingModule=!0),i&&i.savedContainerState&&(this._savedContainerState=i.savedContainerState),i&&i.partHeader&&(this._partHeader=i.partHeader),this.await(7).then((()=>{this._updatePartFilterState(!this._dontLoadFilterUpdatingModule),this._dontLoadFilterUpdatingModule=!1})),this.await(2).then((e=>{P(e)&&e.content.subscribeAndRun(this,(t=>{const s=P(e).updateFilters;s&&s((e=>this.updateFilters(e)))}))})),this._updatableHeaderPromise=this.await(3).then((()=>{if(MsPortalFx.isFeatureEnabled(x.partHeaderEnabledFeatureName)){const{container:e}=this.getViewModel();if(e){const t=e.updatableHeader,s=!!t.options();if(s||e.partTitle())return this._updatableHeader=t,this.getPerfData().updatableHeaderEnabledBy=s?"API":"title",this.getPerfData().updatableHeaderUsed=!!this._partHeader,!s&&t.options({disableSubtitleUpdate:!e.assetName()}),this._partHeader&&this._updateHeader(this._partHeader),t}}}))}clone(){return this.cloneAs(((e,t)=>{const s={overridesModel:t,filters:this.filters,pinnedBladeDeeplink:this._deepLink,savedContainerState:this._savedContainerState},i=w(this.diContainer,this.locator,e,s);return i.defaultMenuItemId=this.defaultMenuItemId,i}))}static fromJSON(e,t,s,n){const r=e.get(i.ExtensionManagerOptions);return c.createCompositionFromJSON(r,t,(()=>{const i=e.createChildContainer("composition"),a=new C(i,o.Locator.fromJSON(r,t.locator),t.widgetState,{id:t.id,duringPortalStartup:n,pinnedBladeDeeplink:t.deepLink});return a.registerForDispose((()=>i.disposeAsync())),a.loadPropertiesFromJson(r,t,!0,s),a._storedEditScopeId=t.editScopeId,a.defaultMenuItemId=t.defaultMenuItemId,a.containerModel=a.containerModel||{},a.filters=u.deserializeFilters(t.filters),a._partHeader=t.partHeader,a}),((s,i)=>{const o=e.createChildContainer("composition"),n=new C(o,s,null,{id:t.id});return n.registerForDispose((()=>o.disposeAsync())),n.unrecoverableErrorMessage=i,n}))}getCompositionType(){return n.CompositionType.StartboardPart}register(e,t,s){super.register(e,t,s);const i=this._part,o=this.editScopeId();o&&this.partDefinition.partKind===v.Provisioning&&this.diContainer.get(m.EditScopeManager).getStateObservable(o).subscribe(this,(e=>{(1===e||2===e)&&this.addWidgetToUI({parentElement:this.getPartsContainer().widget})})),i.openPartSettingsBlade=(e,t)=>{t&&t.stopPropagation(),this.openPartSettingsBlade()},this.partFilterState.subscribe(this,(e=>{i.partFilterState(e)}))}toJSON(){const e=super.toJSON();return e.editScopeId=this.editScopeId(),e.defaultMenuItemId=this.defaultMenuItemId,e.deepLink=this._deepLink,e.filters=u.serializeFilters(this.filters),this._partHeader&&(this._partHeader.title||this._partHeader.subtitle)&&(e.partHeader=this._partHeader),e}validateBindings(e){if(this.bindings&&this.bindings.length>0){const t=this.bindings.filter((e=>e.source.id!==this.id)).map((e=>e.source.property));return y.modelHasProperties(""+this,t,e)}return!0}addWidgetToUI(e){const t=this.widget;Promise.all([this.getDashboardFiltering(),this._updatableHeaderPromise]).then((([e])=>{this._supportsFiltering=e.supportsFiltering,(this._supportsFiltering||this._updatableHeader)&&t.options.commands.push(new p.CustomizeTileData(this,this.diContainer)),d.composeShellCommands(this,this,t.options.commands,!0,this.diContainer)})),super.addWidgetToUI(e),e.doNotSaveSettings||this.save();const s=t.element,i=this._ltm;s&&i&&this.await(1).then((e=>{if(!(this._isFramePart=e&&e.partKind===v.Frame)){const e=function(e,t,s){return e.addEventListener(t,s,!0),{dispose:function(){e&&(e.removeEventListener(t,s,!0),e=null)}}},t=()=>{const e=(0,f.getPortalViewModel)(this.diContainer),t=(e,t)=>{t.masterPartId===this.id&&this.recordUserInteraction()};return e.customEvents.addHandler(i,"fxbladeclosed",t),{dispose:()=>{e.customEvents.removeHandler("fxbladeclosed",t)}}};i.registerForDispose(t()),i.registerForDispose([...["click","mousedown","keydown"].map((t=>e(s[0],t,(()=>this.recordUserInteraction()))))])}}))}hasUserInteractedRecently(){if(this._isFramePart||this._lastUserInteraction+2e3>M())return!0;const e=this.diContainer.get(h.JourneyManager).activeJourney(),t=e&&e.children&&e.children[0];return(t&&t.masterPartId)===this.id}save(e){}_forceSave(e){super.save(e)}_getEditScopeIdFromSettings(){return this._storedEditScopeId}_setupJourneyEditScopeReactor(){}getDashboardFiltering(){return Q(this.await(1)).then((e=>({supportsFiltering:e.supportsFiltering,staticFilters:e.filters||[],partApi:Q(this.await(2)).then((e=>P(e)))})))}overridesFilter(e){return Object.keys(this.filters||{}).includes(e)}notifyFiltersChanged(e){return Q(this.await(7).then((()=>{this._setContainerInputsChanging(!0);const t=2|(e?4:0),s=this._setContainerInputsChanging(!1,t),i=this._updatePartFilterState(!this._dontLoadFilterUpdatingModule);return Q.all([s,i])})))}_disposeEditScope(){const e=this.editScopeId();e&&this.diContainer.get(m.EditScopeManager).onEditScopeDisposed(e)}_getBladeOpenerConfig(){const e=super._getBladeOpenerConfig(),t=()=>{const e=this.diContainer.get(r.Finder).findBlades(this.getPartsContainer());return e&&e.length>0&&e[0]},s=this.diContainer.get(h.JourneyManager),i=e.configureBladeDescriptor;return e.configureBladeDescriptor=e=>{i(e),MsPortalFx.startsWith(e.masterInvocationProperty,"container.")&&(e.defaultMenuItemId=this.defaultMenuItemId)},e.onBladesOpening=()=>{this.isDisposed()&&I.error(`Cannot open new blades for part '${this}', it has already been disposed and removed from the starboard. If this part was created from a Hub action, make sure it doesn't change the target blade after it has been opened.`)},e.getCloseOwnedDetailBladesHandler=e=>{let i;const o=e&&e.source&&e.source.property,n=t();return n&&n.masterPartId===this.id&&n.masterInvocationProperty===o&&!n.masterCommandName&&(i=()=>{const e=s.activeJourney();return e?s.tryDiscardJourney(e.id):s.tryDeactivateJourney()}),i},e.getCloseOtherDetailBladesHandler=e=>{let i;const o=e&&e.source&&e.source.property,n=t();return!n||n.masterPartId===this.id&&n.masterInvocationProperty===o||(i=()=>{const e=s.activeJourney();if(e)return e.isStartedWithContextBlade()?s.tryDiscardJourney(e.id):s.tryDeactivateJourney()}),i},e}_updatePartFilterState(e){const t=this.parent&&this.getPartsContainer();return t&&t.getDashboardFiltersForPart(this.id,e).then((e=>{const t=this.filters||{};e=e||{};let i=0;const o=Object.keys(t),n=Object.keys(e);if(o.length>0||n.length>0)if(0===o.length)i=1===n.length&&n.includes(s.TimeRangeFilter.filterId)?1:2;else{const o=[];for(const s in t)e[s]&&!this._deepEquals(t[s],e[s])&&o.push(s);i=0===o.length?n.length>1||!n.includes(s.TimeRangeFilter.filterId)?2:1:o.includes(s.TimeRangeFilter.filterId)&&1===o.length?3:4}this.partFilterState(i)}))}updateFilters(e){const t=this.parent&&this.getPartsContainer();if(!t)return Q.reject(new Error("Only Parts located on Dashboards can call 'updateFilters'"));let s,i;Array.isArray(e)?s=e.reduce(((e,t)=>(e[t.filterId]=t.filterModel,e)),{}):e.dashboard||e.part?(s=e.dashboard,i=e.part):s=e;let o=!1;return i&&(o=this._updatePartFilters(i)),s?t.updateFilters(this,s):(o&&this.notifyFiltersChanged(!0),Q())}_updatePartFilters(e){const s=MsPortalFx.clone(this.filters||{},!0,!0),i=Object.keys(e);for(let t=0;t<i.length;t++){const o=i[t],n=e[o];n?s[o]=n:delete s[o]}return!MsPortalFx.deepEquals(this.filters,s)&&(this.filters=s,this.widget.element.trigger(t.fxpartfilterschanged,{part:this,isUserInteraction:this.hasUserInteractedRecently()}),!0)}_getTelemetryJourneyId(){}recordUserInteraction(){this._lastUserInteraction=M()}openPartSettingsBlade(){const e=!!this._updatableHeader,t=e?this._getPartHeader():void 0;this.getViewModel().container.openContextPane(new g.PdlBladeReference("PartSettingsBlade","HubsExtension",{onClosed:(s,i)=>{if(i){if(this._supportsFiltering){const e={};Object.keys(i.filters).forEach((t=>{e[t]=i.filters[t]&&u.getFilterProcessor(t).toExtensionModel(i.filters[t])})),this._updatePartFilters(e),this.notifyFiltersChanged(!1)}if(e&&i.partHeader){const e=i.partHeader;e.title===t.title&&e.subtitle===t.subtitle||(this._tracePartTelemetry("PartUpdatableHeaderChanged"),this._updateHeader(e,!0),this.widget.element.trigger("fxpartsettingchanged",{part:this,isUserInteraction:!0}))}}},parameters:{partId:this.id,partHeader:t}}))}_getPartHeader(){var e,t;const{title:s,subtitle:i}=this._partHeader||{},o={title:s},n=null===(e=this._updatableHeader)||void 0===e?void 0:e.options;return(!n||!(null===(t=n())||void 0===t?void 0:t.disableSubtitleUpdate))&&(o.subtitle=i||""),o}_updateHeader({title:e,subtitle:t},s){var i;const o=this._getPartHeader();o.title=e;!(null===(i=(0,this._updatableHeader.options)())||void 0===i?void 0:i.disableSubtitleUpdate)&&(o.subtitle=t),this._partHeader=o,this._updatableHeader.updatedHeader(o),s&&this.widget.element.trigger(c.fxpartsettingchanged,{part:this,isUserInteraction:!0})}getConfigureOnAddToDashboardSelectorAsync(){return this.getViewModelAsync().then((e=>{const t=a.getModelValue(e,"content.configureOnAddToDashboardSelector");if(t.exists)return ko.unwrap(t.value)}))}_deepEquals(e,t){if(e=ko.unwrap(e),t=ko.unwrap(t),e===t)return!0;if(!e||!t)return!1;const s=MsPortalFx.getTypeOf(e);if(s!==MsPortalFx.getTypeOf(t))return!1;switch(s){case"array":{const s=e;return e.length===t.length&&s.every((e=>{let s=!1,i=0;for(;i<t.length;){if(this._deepEquals(t[i],e)){s=!0;break}i++}return s}))}case"date":return e.getTime()===t.getTime();case"object":{const s=Object.keys(e);return s.length===MsPortalFx.keysLength(t)&&s.every((s=>this._deepEquals(e[s],t[s])))}default:return!1}}}function P(e){return e.chrome&&e.chrome._msPortalFxV2ShellApi()}function w(e,t,s,i){i=i||{};const o=e.createChildContainer("composition"),n=new C(o,t,null,i);return n.registerForDispose((()=>o.disposeAsync())),n.calculateInitialSize(),n.modelContainsSensitiveData=i.modelContainsSensitiveData,n.containerModel=c.prepareContainerModel(s||{}),n.filters=i.filters,n.overridesModel=c.prepareContainerModel(i.overridesModel||{}),n.validateBindings(s)||(I.error("Unable to create instance of startboard part '{0}', check log for errors.".format(t.toString())),n.locator.name="##INVALID##"),i.doNotSaveSettings||n.save(),n}t.Instance=C,t.create=w})),
define("MsPortalImpl/UI/UI.DashboardFiltersManager",["require","exports","Fx/Composition/DashboardFilters","Fx/ResourceManagement","FxInternal/Composition/DashboardFilters","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Languages","MsPortalImpl/UI/Dashboard/FiltersSerialization","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Services/Services.Subscriptions"],(function(e,t,s,i,o,n,r,a,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseResourceGroupId=t.normalizeResourceGroupId=t.ResourceTypeFilterRuntime=t.ResourceGroupFilterRuntime=t.LocationFilterRuntime=t.SubscriptionFilterRuntime=t.EqualityFilterRuntime=t.EqualityFilterRuntimeBase=t.DashboardFiltersManager=t.getStaticFilterId=t.getCultureSpecificLanguage=t.isCompleteFilterModel=t.intrinsicFilterDescriptors=void 0;var c=MsPortalFx.Base,p=c.Diagnostics,u=c.Diagnostics.Telemetry;const m=p.createLog(e);function g(e){return e.get(d.SubscriptionsUserContext).inSessionSelectedSubscriptions}function h(e,t){if(!t)return!1;let s=!1;switch(e){case 0:{const e=t;s=e.absolute&&!!e.absolute.fromDate&&!!e.absolute.toDate||e.relative&&MsPortalFx.isNumeric(e.relative.duration)&&MsPortalFx.isNumeric(e.relative.timeUnit),e.absolute&&(s=e.absolute.toDate&&e.absolute.fromDate<e.absolute.toDate);break}case 1:case 2:case 3:case 5:case 4:{const e=t;s=MsPortalFx.isNumeric(e.operator);break}}return s}function f(e){const t=e&&e.selectedDisplayLanguage||"",s=e&&e.selectableDisplayLanguages||[],i=MsPortalFx.find(s,(e=>!MsPortalFx.localeCompareIgnoreCase(e.locale,t)));return i&&i.specificCulture||"en-us"}function x(e){const{filterKind:s}=e;return t.intrinsicFilterDescriptors[s]?t.intrinsicFilterDescriptors[s].filterId:e.filterId}t.intrinsicFilterDescriptors=[{kind:0,filterId:s.TimeRangeFilter.filterId,displayText:n.Filtering.Intrinsics.timeRange},{kind:2,filterId:s.SubscriptionFilter.filterId,displayText:n.Filtering.Intrinsics.subscription},{kind:3,filterId:s.LocationFilter.filterId,displayText:n.Filtering.Intrinsics.location},{kind:5,filterId:s.ResourceGroupFilter.filterId,displayText:n.Filtering.Intrinsics.resourceGroup},{kind:4,filterId:s.ResourceTypeFilter.filterId,displayText:n.Filtering.Intrinsics.resourceType}].reduce(((e,t)=>(e[t.kind]=t,e)),[]),t.isCompleteFilterModel=h,t.getCultureSpecificLanguage=f,t.getStaticFilterId=x;t.DashboardFiltersManager=class{constructor(e,t){this._diContainer=e,this._filtersLocale=ko.observable(),this._appliedFilters=ko.observableArray(),this._currentSessionLocale=f(r.currentLocaleContext),this._equalityFilterRuntimes=[],this._parent=t,this._filtersLifetime=t.createChildLifetime();const s=this._diContainer,i=this._subscriptions={getSelectedSubscriptions:()=>s.get(d.SubscriptionsUserContext).getInSessionSelectedSubscriptions().then((e=>e())),selectedSubsUpdateTriggered:g(s)};this._equalityFilterRuntimes[1]=new v,this._equalityFilterRuntimes[2]=new y(i),this._equalityFilterRuntimes[3]=new M,this._equalityFilterRuntimes[5]=new I(i),this._equalityFilterRuntimes[4]=new C;const o=ko.observableArray([]),n=o.mapInto(t,((e,t)=>{const s=ko.observable();return c.Promises.cancelOnDispose(this._filtersLifetime,t.getDashboardFiltering&&t.getDashboardFiltering()).then((e=>{e.partApi.then((t=>{s({supportsFiltering:e.supportsFiltering,supportsAddFilter:e.staticFilters.some((e=>0!==e.filterKind))||t&&!!t.getDynamicFilterDefinitions})}))})),s}));t.subscribeChildren((e=>{o(e.map((e=>e)))})),this.filtersWidgetViewModel={showDashboardFilteringUi:MsPortalFx.isFeatureEnabled("dashboardautorefresh")?ko.observable(!0):ko.pureComputed((()=>!!this._appliedFilters().length||n().some((e=>e()&&e().supportsFiltering)))),showAddFilterUi:ko.pureComputed((()=>n().some((e=>e()&&e().supportsAddFilter)))),appliedFilters:this._appliedFilters,createDashboardFilterViewmodel:()=>this._createDashboardFilterViewModel({}),getFilterUpdatingApi:()=>this._getFilterUpdatingApi().then((e=>e.filtersWidgetViewModel))},o.subscribeArrayBulkChanges(this._parent,((e,t)=>{t&&t.length&&t.forEach((e=>{this._appliedFilters.peek().forEach((t=>MsPortalFx.remove(t.filteredPartIds,e.id)))}))}));const a=ko.pureComputed(o).extend({throttle:100}),l=ko.pureComputed(this._appliedFilters).extend({throttle:100});ko.reactor(this._parent,[a,l],((e,t)=>(this._isFilterUpdatingModuleLoadingOrLoaded()?Q(this._getFilterUpdatingApi()).then((e=>e.getAllFilterDescriptors(!0).then((e=>e.map((e=>e.filterId)))))):(()=>{const t=[];return Q.allSettled(e.map((e=>this._getPartStaticFilters(e).then((e=>{MsPortalFx.pushUnique(t,e)}))))).then((()=>t))})()).then((e=>{this._ensureTimeRangeFilter(e),t.forEach((t=>{const s=e.includes(t.id())||t.filteredPartIds&&t.filteredPartIds.length>0;t.isApplicable(s)}))}))))}updateFilters(e,t){return this._getFilterUpdatingApi().then((s=>s.updateFilters(e,t)))}getFilters(){return this._appliedFilters.peek().filter((e=>{const t=e.model();return 2!==t.selectAllState||t.values&&0===t.values.length})).reduce(((e,t)=>{const s=t.id(),i=t.model(),o=t.kind();return"string"==typeof s&&h(o,i)&&(e[s]=this.toExtensionModel(o,i)),e}),{})}loadDashboard(e){this.resetFilters(),this._filtersLocale(e&&e.filterLocale||this._currentSessionLocale);const t=e&&e.filters||{},s=Object.keys(t),i=s.map((e=>{const s=((e,t)=>({kind:(0,o.getFilterKindFromId)(e),model:(0,a.getFilterProcessor)(e).fromJSON(t.model),displayCache:t.displayCache,filteredPartIds:t.filteredPartIds}))(e,t[e]),i=s.kind;if(!h(i,s.model))return;const n=this._createDashboardFilterViewModel({id:e,model:s.model,kind:i,filterIdDisplayText:s.displayCache.name,filterValueDisplayText:s.displayCache.value,filteredPartIds:s.filteredPartIds});return this._activateFilter(n),n})).filter((e=>!!e));this._appliedFilters.push(...i),u.trace({source:"DashboardFilters",action:"DashboardFiltersLoaded",data:{filterIds:s.toString()}})}setFilters(e){this._filtersLifetime||(this._filtersLifetime=this._parent.createChildLifetime());const t=Object.keys(e).map((t=>{const s=e[t];return this._createDashboardFilterViewModel({id:t,model:this.fromExtensionModel(s.filterKind,s.filterModel),kind:s.filterKind})}));this._appliedFilters(t)}toJSON(){return this._appliedFilters().length?this._getFilterUpdatingApi().then((e=>e.toJSON())):Q({})}getDashboardFiltersForPart(e,t){if(t||this._isFilterUpdatingModuleLoadingOrLoaded())return this._getFilterUpdatingApi().then((t=>t.getDashboardFiltersForPart(e)));{const t=MsPortalFx.find(this._parent.children,(t=>t.id===e));if(!t){const t=new Error("Error retrieving dashboard filters for part '{0}'. Part could not be found.".format(e));return m.error(t),Q({})}return this._getPartStaticFilters(t).then((t=>this._appliedFilters.peek().filter((s=>s.filteredPartIds.includes(e)||t.includes(s.id()))).reduce(((e,t)=>(e[t.id()]=this.toExtensionModel(t.kind(),t.model()),e)),{})))}}getFilterValues(e,t,s){return this._getFilterUpdatingApi().then((i=>i.getFilterValues(e,t,s)))}getFilterIdTextAndOperators(e,t){return this._getFilterUpdatingApi().then((s=>s.getFilterIdTextAndOperators(e,t)))}getFilterValueDisplayText(e,t,s){return this._getFilterUpdatingApi().then((i=>i.getFilterValueDisplayText(e,t,s)))}getFiltersSupportedByPart(e){return this._getFilterUpdatingApi().then((t=>t.getFiltersSupportedByPart(e)))}getFilterWarning(e,t){return this._equalityFilterRuntimes[(0,o.getFilterKindFromId)(e)].getFilterWarning(t)}_createDashboardFilterViewModel(e){const t=this._filtersLifetime.createChildLifetime();return{id:ko.observable(e.id),kind:ko.observable(e.kind),kindLifetime:t,model:ko.observable(e.model),isApplicable:ko.observable(!0),filterIdDisplayText:e.filterIdDisplayText,filterValueDisplayText:e.filterValueDisplayText,warningMessage:ko.observable(""),filteredPartIds:e.filteredPartIds||[]}}_ensureTimeRangeFilter(e){const t=this._appliedFilters.peek(),i=MsPortalFx.find(t,(e=>e&&0===e.kind())),o=e.includes(s.TimeRangeFilter.filterId);!i&&o&&c.Promises.cancelOnDispose(this._filtersLifetime,this._getFilterUpdatingApi()).then((e=>e.addTimeRangeFilter()))}resetFilters(){this._filtersLifetime&&this._filtersLifetime.dispose(),this._filtersLifetime=this._parent.createChildLifetime(),this._appliedFilters([])}dispose(){this._filtersLifetime&&this._filtersLifetime.dispose()}toExtensionModel(e,t){return(0,a.getFilterProcessor)(e).toExtensionModel(MsPortalFx.extend2(t,{selectAllState:void 0}))}fromExtensionModel(e,t){return(0,a.getFilterProcessor)(e).fromExtensionModel(t)}_activateFilter(e){const{kind:t,kindLifetime:s}=e,i=t();0!==i&&this._equalityFilterRuntimes[i].activateFilter(s,e)}_normalizeEqualityFilterValue(e,t){return this._equalityFilterRuntimes[e].normalizeFilterValue(t)}_getFilterUpdatingApi(){return this._filterUpdatingModulePromise||(this._filterUpdatingModulePromise=Q(c.Promises.cancelOnDispose(this._parent,MsPortalFx.require("MsPortalImpl/UI/UI.DashboardFiltersManager.Updating").then((e=>(this._parent.widget&&this._parent.widget.element.attr("data-filterupdatingloaded",!0),new e.DashboardFiltersUpdatingImpl(this._diContainer,this._parent,{appliedFilters:this._appliedFilters,getDashboardLifetime:()=>this._filtersLifetime,activateFilter:e=>this._activateFilter(e),createDashboardFilterViewModel:e=>this._createDashboardFilterViewModel(e),ensureTimeRangeFilter:e=>this._ensureTimeRangeFilter(e),normalizeEqualityFilterValue:(e,t)=>this._normalizeEqualityFilterValue(e,t),subscriptions:this._subscriptions}))))))),this._filterUpdatingModulePromise}_isFilterUpdatingModuleLoadingOrLoaded(){return!!this._filterUpdatingModulePromise}_getPartStaticFilters(e){return Q(c.Promises.cancelOnDispose(this._filtersLifetime,e.getDashboardFiltering()).then((e=>e.staticFilters.map(x))))}};class b{activateFilter(e,t){}getFilterWarning(e){return Q("")}}t.EqualityFilterRuntimeBase=b;class v extends b{normalizeFilterValue(e){return e}}t.EqualityFilterRuntime=v;class y extends b{constructor(e){super(),this._subscriptions=e}activateFilter(e,t){ko.reactor(e,[t.model,this._subscriptions.selectedSubsUpdateTriggered],(()=>this.getFilterWarning(t.model()).then((e=>{t.warningMessage(e)}))))}normalizeFilterValue(e){return e.toLowerCase()}getFilterWarning(e){return 0!==e.selectAllState||(0,a.isSubstringFilterModel)(e)?Q(""):Q(this._subscriptions.getSelectedSubscriptions().then((t=>!e.values.some((e=>!t.some((t=>t.subscriptionId.toLowerCase()===e.toLowerCase()))))?"":n.Filtering.Subscription.subscriptionFilterUsingExcludedSubscriptions)))}}t.SubscriptionFilterRuntime=y;class M extends b{constructor(){super()}normalizeFilterValue(e){return e}}t.LocationFilterRuntime=M;class I extends b{constructor(e){super(),this._subscriptions=e}activateFilter(e,t){ko.reactor(e,[t.model,this._subscriptions.selectedSubsUpdateTriggered],(()=>{this.getFilterWarning(t.model()).then((e=>{t.warningMessage(e)}))}))}getFilterWarning(e){return 0!==e.selectAllState||(0,a.isSubstringFilterModel)(e)?Q(""):Q(this._subscriptions.getSelectedSubscriptions().then((t=>!e.values.some((e=>{const s=w(e),{subscription:i}=s;return!t.some((e=>e.subscriptionId.toLowerCase()===i.toLowerCase()))}))?"":n.Filtering.ResourceGroup.resourceGroupFilterUsingExcludedSubscriptions)))}normalizeFilterValue(e,t){return P(e,t)||e}}t.ResourceGroupFilterRuntime=I;class C extends b{constructor(){super()}normalizeFilterValue(e){const{resourceType:t,resourceKind:s}=e,i={resourceType:t.toLowerCase()};return s&&(i.resourceKind=s.toLowerCase()),i}}function P(e,t){const s=w(e,t);return s&&i.ArmId.stringify(s,4)}function w(t,s,o){const n=i.ArmId.parse(t,!0);if(4===n.kind)return n;if(!o){const i=new Error(`Invalid resource group id '${JSON.stringify(t)}'`);s?(0,l.logToExtension)(e,s.widget.element,2,i):m.error(i)}}t.ResourceTypeFilterRuntime=C,t.normalizeResourceGroupId=P,t.parseResourceGroupId=w})),
define("MsPortalImpl/Weave/LazyControls",["require","exports","MsPortalImpl/Weave/Util"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LazyNotice=t.LazyInfoBox=t.LazyCustomHtml=t.LazyPillCollection=t.LazyCheckBox=t.LazyTextBox=t.LazySection=void 0,t.LazySection=(0,s.createControlLazyComponentForKO)((()=>Q(MsPortalFx.require("MsPortalImpl.Controls/Fields/Section")))),t.LazyTextBox=(0,s.createControlLazyComponent)((()=>Q(MsPortalFx.require("MsPortalImpl.Controls/Fields/TextField")))),t.LazyCheckBox=(0,s.createControlLazyComponent)((()=>Q(MsPortalFx.require("MsPortalImpl.Controls/Fields/CheckBoxField")))),t.LazyPillCollection=(0,s.createControlLazyComponent)((()=>Q(MsPortalFx.require("MsPortalImpl/Controls/Controls.PillCollection")))),t.LazyCustomHtml=(0,s.createControlLazyComponentForKO)((()=>Q(MsPortalFx.require("MsPortalImpl.Controls/Fields/CustomHtmlField")))),t.LazyInfoBox=(0,s.createControlLazyComponentForKO)((()=>Q(MsPortalFx.require("MsPortalImpl/Controls/Controls.InfoBox")))),t.LazyNotice=(0,s.createControlLazyComponentForKO)((()=>Q(MsPortalFx.require("MsPortalImpl/Controls/Controls.Notice"))))})),
define("_generated/MsPortalImpl/Svg/Library/Copy.svg",["require","exports"],(function(e,t){"use strict";return{type:338,data:"<svg viewBox='0 0 14 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M14 6.3V16H4v-3H0V0h6.7l3 3h1zM4 3h4.3l-2-2H1v11h3zm9 4h-3V4H5v11h8zm-2-1h1.3L11 4.7z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/CaretDown.svg",["require","exports"],(function(e,t){"use strict";return{type:286,data:"<svg viewBox='0 0 14.7 8.1' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='m.7 0 6.7 6.6L14 0l.7.7-7.3 7.4L0 .7.7 0z'/></g></svg>"}})),
define("_generated/MsPortalImpl/Svg/Startup/Share.svg",["require","exports"],(function(e,t){"use strict";return{type:324,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='m14.9 10.4.4.4.4.5a1.4 1.4 0 0 1 .2.6 1.3 1.3 0 0 1 .1.6 3.6 3.6 0 0 1-.2 1 3.5 3.5 0 0 1-.5.8l-.8.5-1 .2a2 2 0 0 1-1.3-.4 5.4 5.4 0 0 1-2 1A5.4 5.4 0 0 1 8 16a5.7 5.7 0 0 1-2.2-.4 5.4 5.4 0 0 1-2-1 2 2 0 0 1-1.3.4l-1-.2-.8-.5a3.5 3.5 0 0 1-.5-.8 3.6 3.6 0 0 1-.2-1 1.3 1.3 0 0 1 .1-.6 1.4 1.4 0 0 1 .2-.6l.4-.5c.1-.2.3-.3.4-.4a1.7 1.7 0 0 0-.1-.7V9a7.6 7.6 0 0 1 .3-2.1A6.6 6.6 0 0 1 2.2 5l1.5-1.5a5.2 5.2 0 0 1 1.8-1 3 3 0 0 1 .2-1 2.2 2.2 0 0 1 .5-.8L7 .2 8 0l1 .2.8.5a2.2 2.2 0 0 1 .5.8 3 3 0 0 1 .2 1 5.2 5.2 0 0 1 1.8 1L13.8 5a6.6 6.6 0 0 1 .9 1.9A7.6 7.6 0 0 1 15 9v.7a1.7 1.7 0 0 0-.1.7zM1 12.5a1.3 1.3 0 0 0 .1.6l.3.5.5.3h1.2l.5-.3.3-.5a1.3 1.3 0 0 0 .1-.6 1.3 1.3 0 0 0-.1-.6l-.3-.5-.5-.3H1.9l-.5.3-.3.5a1.3 1.3 0 0 0-.1.6zM8 15a5.7 5.7 0 0 0 1.8-.3 4.8 4.8 0 0 0 1.6-.8l-.3-.7a1.5 1.5 0 0 1-.1-.7 3.6 3.6 0 0 1 .2-1 3.5 3.5 0 0 1 .5-.8l.8-.5 1-.2h.4a3.4 3.4 0 0 0 .1-1 5.7 5.7 0 0 0-.3-1.8 4.1 4.1 0 0 0-.7-1.5 4.9 4.9 0 0 0-1.2-1.3 3.8 3.8 0 0 0-1.5-.9l-.4.6c-.1.2-.3.3-.5.5l-.7.3H7.3l-.7-.3-.5-.5-.4-.6a3.8 3.8 0 0 0-1.5.9A4.9 4.9 0 0 0 3 5.7a5.1 5.1 0 0 0-.7 1.5A5.7 5.7 0 0 0 2 9a3.4 3.4 0 0 0 .1 1h1.1l.9.5a2.7 2.7 0 0 1 .7.8 4.3 4.3 0 0 1 .2 1.2 1.5 1.5 0 0 1-.1.7l-.3.7a4.8 4.8 0 0 0 1.6.8A5.7 5.7 0 0 0 8 15zM8 1h-.6l-.5.3-.3.5a1.3 1.3 0 0 0-.1.6 1.3 1.3 0 0 0 .1.6l.3.5.5.3h1.2l.5-.3.3-.5a1.3 1.3 0 0 0 .1-.6 1.3 1.3 0 0 0-.1-.6l-.3-.5-.5-.3zm5.5 13h.6l.5-.3.3-.5a1.3 1.3 0 0 0 .1-.6 1.3 1.3 0 0 0-.1-.6l-.3-.5-.5-.3h-1.2l-.5.3-.3.5a1.3 1.3 0 0 0-.1.6 1.3 1.3 0 0 0 .1.6l.3.5.5.3z'/></g></svg>"}})),
define("MsPortalImpl/Widgets/Widgets.StartBoard.Component",["require","exports","Weave/DirectMode","Weave","WeaveDOM/DirectRender/DataAttribute","FxInternal/Weave","FxInternal/Weave/Components/Button","FxInternal/AsyncLoader","FxInternal/Weave/Util","_generated/MsPortalImpl/Svg/Startup/CaretDown.svg","_generated/MsPortalImpl/Svg/Library/Copy.svg","_generated/MsPortalImpl/Svg/Startup/Share.svg","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Interactions/Interactions.FullScreenMode","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/Weave/LazyControls","MsPortalImpl/Widgets/Widgets.DropMenu.Component","MsPortalImpl/Widgets/Widgets.DropMenu","MsPortalImpl/Widgets/Widgets.Portal"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g,h,f,x,b,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StartBoardInner=void 0;var y=MsPortalFx.Base.Images,M=MsPortalFx.Base.Diagnostics.Telemetry;async function I(e,t,o,n){const[r,a]=await Promise.all([MsPortalFx.require("MsPortalImpl/UI/Dashboard/UI.DashboardCommands"),MsPortalFx.require("MsPortalImpl/Widgets/Widgets.CommandBar")]);return s(i.GetContext,{fn:l=>s(i.LifetimeManagerScoped,{fn:i=>{const d=l.diContainer,c=a.CommandBar;if(o){const o=r.initializeFullScreenCommandBar(i,d,e,t);return s(c,{className:["fxs-startboard-commandBar-fullScreen az-noprint",{"az-display-none":e.headerMode.compose((e=>2===e))}],vm:o})}if(n){const t=r.initializeOrganizeModeCommandBar(i,e);return s(c,{className:"fxs-startboard-commandBar-organize az-noprint",vm:t})}const p=r.initializeCommandBar(i,d,e,t);return s(c,{className:["fxs-startboard-commandBar az-noprint",{"az-display-none":e.headerMode.compose((e=>2===e))}],vm:p})}})})}async function C(e,t){const o=await MsPortalFx.require("MsPortalImpl/UI/Dashboard/UI.DashboardCommands");return s(i.GetContext,{fn:i=>{const n=i.diContainer.get(o.OpenBrowseDashboardsPane);return s("li",{className:["fxs-startboard-dropdown-item","fxs-startboard-dropdown-browseall","fxs-portal-hover"],role:"menuitem"},s("div",{className:"fxs-startboard-dropdown-subscriptions"},e.subscriptionsInfo),s("a",{tabindex:"-1",href:"#",className:"fxs-startboard-button-browse fxs-portal-text-primary",afterMount:e=>{t(n,e)},onClick:({event:e})=>{e.preventDefault(),n.execute(!1)}},g.Dashboard.browseAll))}})}function P(e,t){M.trace({source:"StartBoard",action:e,data:t})}t.StartBoardInner=function(e){const{vm:t,commandContextBinder:M}=e,w=t.headerMode.compose((e=>{const t=["fxs-startboard-header"];return 1===e?t.push("fxs-startboard-header-normal"):2===e&&t.push("fxs-startboard-header-migration"),t.join(" ")}));let _;return{focusOnDropMenu:()=>{_&&_.setFocus()},tsxNode:s(i.GetContext,{fn:e=>{const S=e.diContainer,F=S.get(v.ViewModel),k=F.displayMode.compose((e=>"Dashboard"===e)),T=t.title,D=t.isShared,E=`${g.Dashboard.sharedDashboard} | ${g.Dashboard.readOnlydDashboard}`,B=(0,i.composeComputation)([D,t.userPermissions],((e,{canModify:t})=>e?t?g.Dashboard.sharedDashboard:E:g.Dashboard.privateDashboard)),A=S.get(m.FullScreenMode),N=S.get(h.DesktopManagerMode).value,O=(0,n.toComputation)(N).compose((e=>1===e));return s(i.Fragment,null,s(i.Once,{"data-odebug":"17",condition:k,trueFn:()=>{return s(i.Fragment,null,s("div",{className:"fxs-startboard-loadanimation"},s("div",{className:"fxs-splashscreen-loader-container fxs-loading5dots-container"},s("div",null),s("div",null),s("div",null),s("div",null),s("div",null))),s("div",{className:w},s("div",{className:"fxs-startboard-title-next"},s("div",{className:"fxs-startboard-title-content"},s(i.If,{condition:D,concealmentBehavior:"remove",trueFn:()=>s("div",{className:"fxs-startboard-button-icon az-noprint",image:p})}),s("div",{className:"fxs-startboard-title",title:T},T)),s("div",{className:["fxs-startboard-subtitle",{"fxs-startboard-subtitle-shared":D}]},B)),s("div",{className:"fxs-startboard-header-item fxs-startboard-dropdown",afterMount:(e,s)=>{_=new b.Widget($(e),t.dashboardDropMenuViewModel,!0,!0),s.registerForDispose((()=>{_.dispose(),_=null}))}},s(x.DropMenuInner,{button:s("div",{className:"fxs-startboard-dropdown-button fxs-portal-hover"},s("div",{className:"fxs-startboard-title-container"},s(i.If,{condition:D,concealmentBehavior:"remove",trueFn:()=>s("div",{className:"fxs-startboard-button-icon az-noprint",image:p})}),s("div",{className:"fxs-startboard-title",title:T},T),s("div",{className:"fxs-startboard-button-icon az-noprint",image:y.CustomImageWithOptions(d,{palette:99})})),s("div",{className:["fxs-startboard-subtitle",{"fxs-startboard-subtitle-shared":D}]},B)),content:s("div",{className:"fx-dropmenu-dropdown"},s("ul",{className:"fxs-dropmenu-list-system",role:"menu","aria-label":g.Dashboard.recentMenuLabel},s(i.If,{condition:t.dashboardList,concealmentBehavior:"remove",trueFn:()=>s(i.Fragment,null,s(i.If,{condition:t.dashboardList.compose(l.isEmptyArray),concealmentBehavior:"remove",trueFn:()=>s("li",{className:"fxs-startboard-dropdown-item",role:"menuitem",tabindex:"-1"},s("div",{className:"fxs-dropmenu-list-content"},g.Dashboard.emptynext))}),s(i.ForEach,{collection:t.dashboardList,fn:({item:t})=>{const i=-1===t.id.indexOf("private");return s("li",{className:["fxs-startboard-dropdown-item","fxs-startboard-dropdown-dashboard","fxs-portal-hover","msportalfx-tooltip-overflow"],role:"menuitem",tabindex:"-1","aria-label":t.title+(i?" "+g.Dashboard.sharedStatusLabel:""),data:t,onClick:e,onKeyDown:e},s("div",{className:"fxs-dropmenu-list-content fxs-startboard-item-container"},s("div",{className:"fxs-startboard-item-icon fxs-portal-svg",image:i?p:null}),s("div",{className:"fxs-startboard-item-title"},t.title)))}})),falseFn:()=>s("li",{className:"fxs-startboard-dropdown-item",role:"menuitem",tabindex:"-1"},s("div",{className:"fxs-tile-progress-transparent fxs-loading5dots-container"},s("div",null),s("div",null),s("div",null),s("div",null),s("div",null)))}),s(i.PromiseFragment,{"data-odebug":"p12",promise:C(t,M)}))),vm:t.dashboardDropMenuViewModel})),s("input",{type:"text",className:"fxs-startboard-header-item fxs-startboard-title-edit fxs-hide-in-normal",maxlength:200,value:T,"aria-label":g.Dashboard.titleLabel,onValueChange:({value:e})=>t.title(e),onBlur:({event:e})=>{$(e.target).trigger("fxstartboardtitlechanged")}}),s(i.Once,{"data-odebug":"18",condition:(0,n.toComputation)(A.isActive),trueFn:()=>s(i.PromiseFragment,{"data-odebug":"p13",promise:I(t,M,!0)})}),s("div",{className:"fxs-startboard-header-item fxs-startboard-migration",role:"menubar"},s("button",{type:"button",role:"menuitem",className:"fxs-startboard-button fxs-startboard-button-migrate fxs-portal-hover",title:g.Dashboard.migrate,tabindex:"0",onClick:({event:e})=>{$(e.currentTarget).trigger("fxmigratestartboard")}},s("div",{className:"fxs-startboard-button-icon","aria-hidden":"true",image:y.CustomImageWithOptions(c,{palette:99})}),s("div",{className:"fxs-startboard-button-text"},g.Dashboard.migrate))),s(i.Once,{"data-odebug":"19",condition:F.topBar.newDashboardSaveEnabled,trueFn:()=>function(e,t){const o=g.Dashboard.Actions,n=(0,i.composeComputation)([t,e.dashboardChanged],((e,t)=>e||t)),a=(0,i.composeComputation)([t,e.userPermissions,e.dashboardChanged],((e,{canModify:t},s)=>s||e&&!t)),l=(0,i.composeComputation)([t,e.dashboardChanged],((e,t)=>e&&t)),d=e.userPermissions.compose((({canModify:e})=>e?o.save:o.saveCopy));return s("div",{className:"fxs-startboard-actions"},s(r.Button,{className:"fxs-startboard-actions-save",text:d,style:0,visible:a,loading:e.dashboardSaveInProgress,onClick:()=>{const t=e.userPermissions.value.canModify,s=t?1:2;P(t?"DashboardPublish":"DashboardSaveACopy"),e.finishDashboardEdit(s,"StartBoard")}}),s(r.Button,{className:"fxs-startboard-actions-preview",text:o.preview,style:1,visible:l,onClick:()=>{P("CustomizeModeExited",{dashboardChanged:!!e.dashboardChanged.value}),e.exitOrganizeMode()}}),s(r.Button,{className:"fxs-startboard-actions-cancel",text:o.cancel,style:1,visible:n,onClick:()=>{P("DashboardDiscard"),e.finishDashboardEdit(3)}}))}(t,O)})),s(i.PromiseFragment,{"data-odebug":"p14",promise:I(t,M)}),s("div",{className:"fxs-startboard-filter",afterMount:(e,s)=>{if(t.filtersWidgetViewModel){const i=s.createChildLifetime();t.filtersWidgetViewModel.showDashboardFilteringUi.subscribeAndRun(i,(o=>{o&&(i.dispose(),a.get("MsPortalImpl/Widgets/Widgets.DashboardFilters","Widget").then((i=>{s.registerForDispose(new i($(e.parentElement),t.filtersWidgetViewModel,S))})))}))}}}),s("div",{className:"fxs-startboard-customize-header fxs-hide-in-normal"},s(i.If,{condition:O,trueFn:()=>s(i.PromiseFragment,{"data-odebug":"p15",promise:I(t,M,!1,!0)})}),s("div",{className:"fxs-startboard-customize-description"},g.Dashboard.editDescription)),s(i.If,{condition:(0,i.composeComputation)([t.userPermissions,O],(({canModify:e},t)=>t&&!e)),trueFn:()=>s(i.LifetimeManagerScoped,{fn:e=>s(f.LazyInfoBox,{className:"fxs-startboard-warning",vm:t=>t.createVm(e,{style:4,text:g.Dashboard.readOnlyWarningMsg,ariaLabel:g.Dashboard.readOnlyWarningMsg})})})}),s(i.If,{condition:t.dashboardErrorMessage.compose(l.isNonEmptyString),trueFn:()=>s(i.LifetimeManagerScoped,{fn:e=>s(f.LazyInfoBox,{className:"fxs-startboard-error",vm:s=>s.createVm(e,{style:5,text:(0,n.toObservable)(e,t.dashboardErrorMessage),ariaLabel:(0,n.toObservable)(e,t.dashboardErrorMessage)})})})}));function e(e){const s=e.event;if("keydown"===s.type&&(13!==s.keyCode&&32!==s.keyCode||0!==(0,u.getModifierKeys)(s)))return;const i=(0,o.getElementData)(s.currentTarget);s.preventDefault(),s.stopPropagation(),t.switchDashboard&&t.switchDashboard(i).then((()=>{if(_){const e=_.element,t=Math.min(Math.max(e.outerWidth()+50,400),560);e.find(".fxs-dropmenu-content").css({minWidth:t})}})),t.dashboardDropMenuViewModel.close()}}}),s("div",{className:"fxs-startboard-layout fxs-flowlayout"},s(i.Once,{"data-odebug":"20",condition:(0,n.toComputation)(F.inOrganizeMode),trueFn:()=>{const e=t.flowLayoutOptions.resolutionGuidesOffset,o=e.y+"px",n=e.x+"px";return s(i.Fragment,null,[{x:3840,y:2160},{x:1920,y:1080},{x:1440,y:900},{x:1366,y:768},{x:1024,y:768}].map((e=>s("div",{className:`fxs-flowlayout-resolutionguide fxs-flowlayout-resolutionguide-${e.x}x${e.y} fxs-hide-in-normal`,style:{top:o,left:n}}))))}}),s("div",{className:"fxs-flowlayout-childcontainer",style:{height:t.flowLayoutOptions.childContainerHeight,width:t.flowLayoutOptions.childContainerWidth}})),s("div",{className:"fxs-startboard-message-container"},s("div",{className:"fxs-startboard-message-title"},g.Dashboard.NotFound.title),s("div",{className:"fxs-startboard-message-body"},t.notFoundMessage)))}})}}})),
define("MsPortalImpl/UI/Compositions/UI.Composition.StartBoard",["require","exports","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/Services/Services.EditScopeManagement","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/UI/Compositions/UI.Composition.CompositionAwaiter","MsPortalImpl/UI/Compositions/UI.Composition.Finder","MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition.StartboardPart","MsPortalImpl/UI/UI.DashboardFiltersManager","MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/Widgets/Widgets.Portal","MsPortalImpl/Widgets/Widgets.StartBoard","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/UI/Commands/Base.PortalFunctions","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/Parts/Parts","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/Weave/DirectRender","MsPortalImpl/Widgets/Widgets.StartBoard.Component"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g,h,f,x,b,v,y,M,I,C,P,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Instance=t.isStartboardPartKey=t.fxstartboardsettingchanged=void 0;var _=MsPortalFx.Base.Diagnostics,S=_.Telemetry,F=p.ReferenceScope,k=MsPortalFx.Parts;const T=_.createLog(e);t.fxstartboardsettingchanged="fxstartboardsettingchanged",t.isStartboardPartKey=function(e){return e!==o.desktopSettingsKey&&e!==o.startBoardSettingsKey&&!MsPortalFx.startsWith(e,c.partIdentityStatePrefix)};const D=o.startBoardSettingsKey;class E extends a.Instance{constructor(e){super(D,e,null,[],null,D),this._diContainer=e,this._partAwaiter=new l.CompositionAwaiter(!0),this._containerAwaiter=new l.CompositionAwaiter,this.masterContainer=null,this.notFound=ko.observable(!1),this.containerType=0,this._browser=e.get(M.Browser),this._store=4,this.registerForDispose(this.dashboardFiltersManager=new m.DashboardFiltersManager(e,this))}static create(e){return new E(e)}getCompositionType(){return r.CompositionType.Startboard}setGetDashboard(e){if(this._getDashboard)throw new Error("GetDashboard can only be set once by DashboardManager");this._getDashboard=e}removeGetDashboard(){this._getDashboard=null}getDashboard(){const e=this._getDashboard;return e?e():null}onDetailContainersChanged(){}getDeepLink(){return Q("")}toJSON(){const e=super.toJSON(),t=this._getDashboard?this._getDashboard():null;if(t){e.dashboardId=t.id,e.dashboardTitle=t.title;const s=t.model;e.dashboardModel=s?{model:ko.toJS(s.model),metadata:MsPortalFx.clone(s.metadata,!0)}:void 0}return delete e.children,e}get eligibleForBinding(){return!1}getInputPropertyBindings(){throw new Error("Unreachable code")}getViewModel(e){let t;if(8===(e=MsPortalFx.isNullOrUndefined(e)?8:e)){const e=this._getDashboard&&this._getDashboard().model;if(!e)throw new Error("There is no current Dashboard.");t=e.model}return t||{}}getViewModelAsync(e){return Promise.resolve(this.getViewModel(e))}getCompatibleSourceReferences(e){const t=this._getDashboard&&this._getDashboard().model,s=t&&t.metadata;if(s){const t=e.type;if(t){return Object.keys(s).filter((e=>s[e]===t)).map((e=>({property:e,modelType:8,scope:F.CurrentContainer,cardinality:p.ReferenceCardinality.OneToOne})))}}return null}getFilters(){return this.dashboardFiltersManager&&this.dashboardFiltersManager.getFilters()}updateFilters(e,t){return this.dashboardFiltersManager&&this.dashboardFiltersManager.updateFilters(e,t)||Q()}getDashboardFiltersForPart(e,t){return this.dashboardFiltersManager&&this.dashboardFiltersManager.getDashboardFiltersForPart(e,t)||Q({})}getFilterIdsForPart(e){return this.dashboardFiltersManager&&this.dashboardFiltersManager.getFiltersSupportedByPart(e)}setFilters(e){return this.dashboardFiltersManager&&this.dashboardFiltersManager.setFilters(e)}getPartInstance(e){return MsPortalFx.find(this.children,(t=>t.id===e))}_compose(e,s){const o=this.diContainer,n=this.createChildLifetime(),a=e.options,l=a.getStartBoardArea(),d=new x.ViewModel(this.id,this.widgetState(),this.dashboardFiltersManager&&this.dashboardFiltersManager.filtersWidgetViewModel,function(e,t){const s=[],o=new h.EnterOrganizeMode(e,t,!0);return o.text(i.Dashboard.edit),s.push(new h.ResetStartBoardCommand(e,t),o,new h.ExitOrganizeMode(e,t)),s}(n,o),a.startboardLoading,a.startboardNotFound,this.diContainer),c=this._getDashboard?this._getDashboard().title:null;c&&d.title(c);const{focusOnDropMenu:p,tsxNode:u}=(0,w.StartBoardInner)({vm:d,commandContextBinder:(e,t)=>{e.bind(new g.CompositionInstanceCommandContext(t,null,this))}});(0,P.applyToElement)({element:l[0],ltm:this,weaveNode:u,weaveContext:{diContainer:o},opName:"Startboard"}),this.widget=new x.Widget(l,d,p),l.data(r.CompositionInstanceDataName,this),this.widget.ltm.registerForDispose([n,l.setEvents([b.Widget.viewSettingsChanged,(e,s)=>{e.stopPropagation(),this.widgetState(s),l.trigger(t.fxstartboardsettingchanged)}],["fxunpin",(e,t)=>{const s=MsPortalFx.find(this.children,(0,r.getIdMatchFunc)(t.tileId));if(s){const e=this.widget;T.warning("Part '{0}' is about to be removed due to user unpin operation.".format(s)),this.removeTile(s),setTimeout((()=>{const t=this.diContainer.get(f.ViewModel),s=t.topBar.newDashboardSaveEnabled.value?e.element.find(".fxs-startboard-actions-save .fxs-button"):t.topBar.getWidget().element.find(".fxs-topbar-dashboard-save .fxs-button");s?s.focus():e.setFocus()}),50)}}])]),s.resolve()}removeTile(e,t){if(e){let s;const o=this._diContainer.get(v.JourneyManager),r=o.activeJourney();r&&r.originTile===e&&(s=r.id);const a=e.editScopeId()&&this._diContainer.get(n.EditScopeManager).getStateObservable(e.editScopeId()),l=!a||0===a()||2===a(),d=!s||o.canDiscardJourney(s),c=t&&t.force||l&&d;(c||this._browser.confirm(i.Desktop.confirmEditScopeDiscard))&&(s&&o.forceDiscardJourney(s),e.clearIdentitySettings(),this.removeChild(e,!1,t&&t.skipSave),c||T.warning("Part '{0}' is removed from the start board.".format(e)))}}resetLayout(e){return Q(this.diContainer.get(y.ResetDashboardPortalFunc).invoke({duringPortalStartup:!1,force:e},"Dashboard"))}clearStartboard(e){this.dashboardFiltersManager&&this.dashboardFiltersManager.resetFilters(),this.children.slice().forEach((e=>this.removeTile(e,{force:!0,skipSave:!0}))),!e&&this.save()}dispose(){super.dispose(!0)}get journeyPath(){return[]}getComposedParts(){return this._partAwaiter.resolvedCompositions}awaitComposedPart(e,t){return this._partAwaiter.await(e,t)}notifyPartComposed(e){this._partAwaiter.resolve(e)}awaitContainer(e,t){return this._containerAwaiter.await(e,t)}notifyContainer(e){this._containerAwaiter.resolve(e)}onInvocationStarted(){}getDiagnosticsData(){const e=this.diContainer.get(d.Finder).findBlades(this);return $.extend(super.getDiagnosticsData(),{detailBlades:e.map((e=>e+""))})}createStartBoardPart(e,t,i){if(!e)return void T.error("options should be specified for adding a part to the startboard.");if(!e.locator)return void T.error("options.originPartLocator should be specified for adding a part to the startboard.");let o={locator:e.locator,newBindings:void 0};e.ignoreRedirects||(o=N(this._diContainer.get(s.DefinitionFinder),e.locator,e.telemetryAction));const n=e.model,r=u.create(this._diContainer,o.locator,n,{modelContainsSensitiveData:e.modelContainsSensitiveData,filters:e.filters,pinnedBladeDeeplink:e.deepLink,duringPortalStartup:t});o.newBindings&&(r.getInstanceBindings=()=>o.newBindings);const a=e.defaultMenuItemId;return a&&(r.defaultMenuItemId=a),k.InternalPartSize[e.initialSize]&&(r.initialSize=e.initialSize,99===e.initialSize&&(r.initialHeight=e.initialHeight,r.initialWidth=e.initialWidth)),r}pinPartReferences(e,t){const i=e.map((e=>B(this._diContainer.get(s.DefinitionFinder),e,t,"PinPartReferences").then((e=>this.createStartBoardPart(e)))));return Q.allSettled(i).then((e=>e.map((e=>e.value))))}pinBladeToStartboard(e){const t=e.locator.getExtensionLocator(),i=this.diContainer.get(s.DefinitionFinder);let o;if(e.onPin)o=Q(e.onPin()).then((e=>B(i,e,t.name,"Blade.onPin")));else{const n=e.locator;o=Q(i.locateAsync(n)).then((i=>{const o=i.pinnedPartExtension||t.name;return{locator:s.Locator.forExtension(o).withPartType(i.pinnedPart),model:(i.inputs||[]).concat(i.optionalInputs||[]).reduce(((t,s)=>(t[s]=p.getModelValue(e.model,s).value,t)),{}),telemetryAction:"PinPdlBlade"}}))}return o.then((t=>{const{locator:s,newBindings:o}=N(i,t.locator,t.telemetryAction);return i.locateAsync(s).then((()=>{const i=u.create(this._diContainer,s,t.model,{filters:t.filters,pinnedBladeDeeplink:e.deepLink});o&&(i.getInstanceBindings=()=>o);const{initialSize:n,initialHeight:r,initialWidth:a}=t;return k.InternalPartSize[n]&&(i.initialSize=n,99===n&&(i.initialHeight=r,i.initialWidth=a)),i.defaultMenuItemId=t.defaultMenuItemId,i}))}))}clonePartToStartboard(e){return e.cloneAs(((t,s)=>u.create(this.diContainer,e.locator,t,{overridesModel:s,filters:e.filters})),!0).then((t=>{const i=A(this.diContainer.get(s.DefinitionFinder),e.locator,e.partDefinition);if(C.isVariableSize(t.initialSize)&&i&&i.length>0){const e=MsPortalFx.find(i,(function(e){return C.isFixedSize(e)}));if(!(null!==e&&e>=0))throw FxImpl.createError("Requested tile size for pinning not supported");t.initialSize=e,t.widgetState().NormalState.size=e}return t})).catch((t=>{const s=FxImpl.createError("Pin Part to Startboard Failed: The target part could not pinned. Part: {0}".format(e.toString()),{innerErrors:t});throw T.error(s),s}))}}function B(e,t,i,o){const{partName:n,parameters:r}=t,a=t.options,{extensionName:l,filters:d}=a;let{initialSize:c,initialHeight:p,initialWidth:u}=a;const m=l||i;let g,h=s.Locator.forExtension(m).withPartType(n);"UnboundPart"===n?g=Q():(h=N(e,h,o).locator,g=Q(e.locateAsync(h)).then((t=>{if(k.InternalPartSize[c]){const s=k.InternalPartSize[t.initialSize]?t.initialSize:2,o=A(e,h,t)||[];s!==c&&-1===o.indexOf(c)&&(T.error("Extension {0} attempted to pin using an unsupported size of part with locator '{1}'. Requested size was '{2}'. Pinned with size '{3}'.".format(i,h.toString(),k.InternalPartSize[c],k.InternalPartSize[s])),c=s,99===c?(p=p||t.initialHeight,u=u||t.initialWidth):p=u=void 0)}})));const f=n&&n.endsWith(".ReactTile")?{parameters:r}:r;return g.then((()=>({model:f,locator:h,initialSize:c,initialHeight:p,initialWidth:u,filters:d,ignoreRedirects:!0,telemetryAction:o,deepLink:a.deepLink})))}function A(e,t,s){if("number"==typeof s.partKind){return I.getPartFactory(e,t,s).supportedSizes}}function N(e,t,i){let o;if(6===t.type){const n=t.getExtensionLocator(),r=s.Locator.forPartTypeRedirect(n.name,t.name),a={};if(e.tryLocate(r,a)){const e=t,r=a.value;t=(r.toExtension?s.Locator.forExtension(r.toExtension):n).withPartType(r.toPart),o=r.bindings,S.trace({source:"StartBoard",action:"Redirect",name:e.toFriendlyString(),data:{reason:i,to:t.toFriendlyString()}})}}return{locator:t,newBindings:o}}t.Instance=E})),
define("MsPortalImpl/UI/UI.StartboardManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Hubs/UI.NotificationManager","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.Graph","MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/UI/Compositions/UI.Composition.StartBoard","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/UI/UI.DesktopManagerView","MsPortalImpl/UI/Compositions/UI.Composition.Part","MsPortalImpl/Widgets/Widgets.Portal.init"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StartboardManager=void 0;var f=MsPortalFx.Base,x=MsPortalFx.Hubs.Notifications.NotificationStatus;const b=f.Diagnostics.createLog(e),v=r.CompositionBinder.createObservableModel,y=i.Dashboard.Notification,M=i.Dashboard.NotFound;let I=class{constructor(e,t,s,i){this._diContainer=e,this._notificationManager=t,this._view=s,this._lifetime=new FxImpl.TriggerableLifetimeManager,this._portal=(0,h.getPortalViewModel)(e),this._lifetime.registerForDispose(this.startboard=p.Instance.create(this._diContainer)),i.setStartBoard(this.startboard),MsPortalFx.tryImmediateResolve(this._portal.onWidgetCreate(),(()=>{this._view.composeStartBoard(this.startboard)}))}dispose(){this._lifetime&&this._lifetime.dispose()}setWidgetLoading(e){this.startboard.widget.options.loading(e)}collectDashboardSettings(e){const t={},s=e.toJSON(),i=e.children.filter((e=>!e.isDisposed())),o=e.widget.getDomOrderedChildren();i.length!==o.length&&b.error(`There should be the same number of composed parts to save (${i.length}) as the number of positioned elements in the layout (${o.length}). The settings will be incorrect.`);const n=[];return o.forEach((e=>{const t=MsPortalFx.remove(i,(t=>t.id===e));1===t.length?n.push(this.getPartSettings(t[0])):b.error(`There should be a composed part with ID '${e}' yet none was found. The saved content will be incorrect. The settings will be incorrect.`)})),i.length>0&&i.forEach((e=>{b.error(`Part '${e.id}' should have a position defined in the layout, yet none was found. The settings will be incorrect.`),n.push(this.getPartSettings(e))})),Q.allSettled(n).then((i=>(i.forEach((e=>{$.extend(t,e.value)})),e.dashboardFiltersManager&&e.dashboardFiltersManager.toJSON().catch((e=>(b.error("Failed to get part filters information."),s.dashboardModel.model)))))).then((e=>(e&&(s.dashboardModel.model.filterLocale=e.filterLocale,s.dashboardModel.model.filters=e.filters),t[c.startBoardSettingsKey]=s,JSON.parse(JSON.stringify(t)))))}getPartSettings(e,t){return(t||void 0===t?Q(e.await(7)):Q()).catch(MsPortalFx.noop).then((()=>{if(e.isDisposed())return{};const t={},{partJson:s,containerModel:i}=this.partCompositionToJSON(e);return t[s.id]=s,this.getPartIdentitySettings(e,i).then((e=>$.extend(t,e)))})).catch((t=>(b.error(t,8,`part: '${e.id}'.`),{})))}getPartIdentitySettings(e,t){const s=e.partDefinition;if(!s||!s.partState)return Q({});const i=(0,l.buildIdentitySettingKey)(e.locator,t);return Q(e.getPartSettingsManager().getStartboardPartIdentitySettings()).then((e=>{if(!e)return{};const t={};return t[i]=e,t})).catch((t=>(b.error(t,9,`Failed to get part '${e.id}' identify settings for key '${i}'.`),{})))}enterOrganizeMode(e){this.startboard.widget.element.trigger("fxenterorganizemode",{openTileGallery:e})}pinMultipleParts(e,t,s,o){if(e.length<1)return Q();let n;return n=o&&this.startboard.notFound()?Q.reject("Can pin on not found dashboard"):this.startboard.pinPartReferences(e,t).then((e=>{if(void 0===s||s){const e=i.Shell.pinnedToStartBoard;this.popNotification(e,e,x.Information)}return e})),n.catch((t=>{throw b.debug("Pin multiple parts failed: The parts could not be pinned. Part references: {0}".format(e.toString())),this.popNotification(y.errorTitle,M.failToPinPart,x.Error),t}))}pinBladeToStartboard(e,t,s){let o;return o=s&&this.startboard.notFound()?Q.reject("Can pin on not found dashboard"):this.startboard.pinBladeToStartboard(e).then((s=>{if(!t){const t=e.bladeTitle,s=t?i.Shell.pinnedToStartBoardWithTitle.format(t):i.Shell.pinnedToStartBoard;this.popNotification(s,s,x.Information)}return s})),o.catch((e=>{throw this.popNotification(y.errorTitle,M.failToPinBlade,x.Error),e}))}pinPartToStartboard(e){let t;return t=this.startboard.notFound()?Q.reject("Can pin on not found dashboard"):this.startboard.clonePartToStartboard(e).then((t=>(this.popNotification(e.getTitle(),i.Shell.pinnedToStartBoard,x.Information),t))),t.catch((t=>{throw b.error("Pin Part to Startboard Failed: The target part could not pinned. Part: {0}".format(e.toString())),this.popNotification(y.errorTitle,M.failToPinPart,x.Error),t}))}popNotification(e,t,s,i){this._notificationManager.addClientNotification({title:e,description:t,status:s,timestamp:new Date,uri:i||"#dashboard"})}updateUriAndPageTitle(e,t=!1){e&&e.id&&(0,u.updateDashboardUri)(this._diContainer,e.id,t),this.startboard.widget.options.title(e.title)}partCompositionToJSON(e){const t=e.toJSON();let s=e.containerModel;if(!s||!s[o.PartContainerModelIdProperty]){const e=ko.toJS((0,d.createContainerModel)(t.containerModel))||{};e[o.PartContainerModelIdProperty]=MsPortalFx.getUniqueId(),s=v(e),t.containerModel=(0,g.getSerializableContainerModel)(s,!1)}return{partJson:t,containerModel:s}}};I=__decorate([__metadata("fx:diagnostics",[e,"StartboardManager"]),s.Class(),__metadata("design:paramtypes",[s.Container,n.NotificationManager,m.DesktopManagerView,a.CompositionGraph])],I),t.StartboardManager=I})),
define("MsPortalImpl/UI/UI.DesktopManagerImpl",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Services/Services.AssetManagement","MsPortalImpl/Services/Services.Settings","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/Base/Base.DeepLink","FxHubs/RpcEndPoints","Fx/Composition/DashboardFilters","FxInternal/Composition/DashboardFilters","MsPortalImpl/Services/Services.Settings.Schema","FxInternal/AsyncLoader","MsPortalImpl/UI/UI.StartboardManager"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFilterWarningHandler=t.getFilterValueDisplayTextHandler=t.getFilterValuesHandler=t.getDashboardFiltersHandler=t.getDashboardDeepLinkHandler=t.DesktopManagerImpl=void 0;const f=MsPortalFx.require;function x(){return Q(f("MsPortalImpl/UI/UI.Desktop.Actions"))}let b=class{constructor(e){this._diContainer=e,this._lifetime=new FxImpl.TriggerableLifetimeManager,this._manifestCache=e.get(o.ManifestCache),this._mode=e.get(a.DesktopManagerMode).value,this._settingsManager=e.get(r.SettingsManager),this._journeyManager=this._diContainer.get(l.JourneyManager),this.startBoard=e.get(h.StartboardManager).startboard,this._setupOrganizeModeComponents()}initialize(){return this._journeyManager.configure(this.startBoard),this._diContainer.get(n.AssetManager).onAssetDeleted(((e,t,s,i)=>{x().then((o=>o.handleAssetDeleted(this,this._journeyManager,e,t,s,i)))})),this.getSettingCollections().forEach((e=>{this._diContainer.get(r.SettingsManager).setSettings(e)})),Q()}_getExtensionEmailAddress(e){const t=this._manifestCache.getManifest(e,"assetTypes");return t&&t.feedbackEmail}getCurrentBladeInfo(){const e=this._getBreadCrumb(),t=this._getExtensionEmailAddress("HubsExtension"),s=e[e.length-1],i=s&&s.extensionName||"";return{extensionName:i,feedbackTo:i&&this._getExtensionEmailAddress(i)||t,feedbackCC:t,breadcrumb:e.map((e=>e.title)).join(" > "),bladeLocators:e.map((e=>e.name)),bladeName:s&&s.name||""}}_getBreadCrumb(){const e=this._journeyManager.activeJourney();if(!e)return[];const t=e.children;return t&&t.length?t.map((e=>({title:e.isDefaultTitle()?e.id:e.title(),extensionName:e.locator.getExtensionName(),name:e.locator.toFriendlyString()}))):[]}getSettingCollections(){const e={},t=[];return e[m.desktopSettingsKey]=JSON.parse(JSON.stringify(this)),t.push({store:4,settings:e}),t}dispose(){this._lifetime.dispose()}toJSON(){return{startBoardId:this.startBoard?this.startBoard.id:null}}getDiagnosticsData(){const e=this.startBoard;return{startboard:e&&e.getDiagnosticsData()}}getAssetDiagnosticsData(){const e=this._journeyManager.activeJourney();return e?x().then((t=>t.dumpCompositionAssets(e))):Q.resolve("No journey")}_setupOrganizeModeComponents(){const e=this._lifetime.createChildLifetime();this._mode.subscribe(e,(t=>{1===t&&(e.dispose(),i.get("MsPortalImpl/UI/UI.DragDropCompositionManager","create").then((e=>e(this._diContainer))))}))}};b=__decorate([__metadata("fx:diagnostics",[e,"DesktopManagerImpl"]),s.Class(),__metadata("design:paramtypes",[s.Container])],b),t.DesktopManagerImpl=b,t.getDashboardDeepLinkHandler=(0,g.defineHandler)(c.DashboardEndpoints.getDashboardDeepLink,(e=>(0,d.rpcGetDashboardDeepLink)(e.diContainer,e.messageArg))),t.getDashboardFiltersHandler=(0,g.defineHandler)(c.PartFilterEndpoints.getFilters,(e=>{const t=e.diContainer.get(b),s=e.messageArg,i=t.startBoard,o=i.dashboardFiltersManager,n=i.getFilterIdsForPart(s).then((e=>{const t=[];return e.forEach((e=>{t.push(i.dashboardFiltersManager.getFilterIdTextAndOperators(s,e).then((t=>({id:e,displayString:t.displayString,operators:t.operators}))))})),Q.all(t)})),r=i.getDashboardFiltersForPart(s,!0);return Q.all([n,r]).then((e=>{const t={},n=e[1],r=[];Object.keys(n).forEach((i=>{const a=o.fromExtensionModel((0,u.getFilterKindFromId)(i),n[i]);if(i!==p.TimeRangeFilter.filterId){const l=o.getFilterValueDisplayText(i,n[i],s).then((e=>({displayString:e,value:a.values})));r.push(l.then((s=>{const o=MsPortalFx.find(e[0],(e=>e.id===i)).displayString;t[i]={filterIdDisplayText:o,operator:a.operator,valueString:s.displayString,values:s.value,substring:a.substring}})))}}));const a=MsPortalFx.forEachKey(MsPortalFx.clone(i.getPartInstance(s).filters,!0)||{},((e,t,i)=>{const n=o.getFilterValueDisplayText(e,t,s).then((s=>{i[e]=MsPortalFx.extend(o.fromExtensionModel((0,u.getFilterKindFromId)(e),t),{valueString:s})}));r.push(n)}),{});return Q.all(r).then((()=>({dashboardFilterDisplays:t,dashboardTimeRangeFilter:n[p.TimeRangeFilter.filterId],partFilters:a||{},allPossibleFilters:e[0]})))}))})),t.getFilterValuesHandler=(0,g.defineHandler)(c.PartFilterEndpoints.getFilterValues,(e=>{const t=e.diContainer.get(b),s=e.messageArg;return t.startBoard.dashboardFiltersManager.getFilterValues(s.filterId,s.filterText,s.partId)})),t.getFilterValueDisplayTextHandler=(0,g.defineHandler)(c.PartFilterEndpoints.getFilterValueDisplayText,(e=>{const t=e.diContainer.get(b),s=e.messageArg,i=t.startBoard.dashboardFiltersManager.toExtensionModel((0,u.getFilterKindFromId)(s.filterId),s);return t.startBoard.dashboardFiltersManager.getFilterValueDisplayText(s.filterId,i,s.partId)})),t.getFilterWarningHandler=(0,g.defineHandler)(c.PartFilterEndpoints.getFilterWarning,(e=>{const t=e.diContainer.get(b),s=e.messageArg;return t.startBoard.dashboardFiltersManager.getFilterWarning(s.filterId,MsPortalFx.extend2(s.filterModel,{selectAllState:void 0}))}))})),
define("MsPortalImpl/Interactions/Interactions.FlowLayoutDragDrop",["require","exports","MsPortalImpl/Base/Base.Events","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.FlowLayout"],(function(e,t,s,i,o,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlowLayoutDragDrop=void 0;const a=window,l=$(a.document.body),d=n.Widget.getWidget,c="draggable",p="ui-draggable fxs-drag-disableTouchAction",u=".fxs-tile:not(.fxs-tilesize-herowidefitheight):not(.fxs-tilesize-fullwidthfitheight):not(.fxs-tilesize-fittocontainer)",m=".fxs-flowlayout",g={dismissFn:I,logName:"flowlayoutdragdrop"};let h,f,x,b,v;const y={left:0,top:0};function M(e){if(!h)return;l.off(m);const t=h.elementObject,s="true"===t.attr("dragdrop.revert"),o={left:e.pageX,top:e.pageY};i.unregister(g),s&&t.attr("dragdrop.revert","false"),C(),s&&f&&(C(),f.refreshLayout()),t.css("opacity",1),b=s?x:P(o),f.moveChild(h.elementObject,Math.max(b.col,0),Math.max(b.row,0),!0),w()}function I(){h.elementObject.attr("dragdrop.revert","true").trigger("mouseup")}function C(){v&&(clearTimeout(v),v=null)}function P(e){const t=f.element,s=t.offset(),i=e.left+y.left,n=e.top+y.top,r=i-s.left+t.scrollLeft(),a=n-s.top+t.scrollTop();return{col:Math.floor((r+.33*o.GridSpacingWidth)/o.GridSpacingWidth),row:Math.floor((a+.33*o.GridSpacingHeight)/o.GridSpacingHeight)}}function w(){f=null,x=null,b=null,h=null}function _(){const e=$.querySelectorAll(m),t=[];return e.each((function(e,s){const i=d($(s),r.Widget),o=i.options;o.allowReorder&&!o.locked()&&t.push(i.element.findByClassName("fxs-flowlayout-childcontainer"))})),t}function S(e){I(),M(e)}class F{constructor(){if(F._singleton)throw new Error("FlowLayoutDragDrop operates as a singleton.");F._singleton=this}dispose(){this.disableDragDropTargets(),w(),F._singleton=null}static get Instance(){return F._singleton||(F._singleton=new F),F._singleton}enableDragDropOnSingleTarget(e){if("true"===e.attr(c))return;e.attr(c,"true");e.filter(u).addClass(p).on("dragstart",(e=>{if(h&&S(e),s.isFullscreen()||e.target!==e.currentTarget)return void e.preventDefault();let t={left:e.pageX,top:e.pageY};l.on("dragover.fxs-flowlayout",(e=>{e.preventDefault();const s={left:e.pageX,top:e.pageY};s.left===t.left&&s.top===t.top||function(e,t){if(f){const e=P(t);e.col===b.col&&e.row===b.row||(b=e)}C(),v=setTimeout((()=>{v=null,f&&f.moveChild(h.elementObject,Math.max(b.col,0),Math.max(b.row,0),!1)}),50)}(0,t=s)})),l.on("drop.fxs-flowlayout",(e=>{e.preventDefault(),M(e)})),l.on("dragend.fxs-flowlayout",(e=>{M(e)})),l.on("dragleave.fxs-flowlayout",(e=>{0<e.clientX&&e.clientX<a.innerWidth&&0<e.clientY&&e.clientY<a.innerHeight||S(e)}));const o=e.originalEvent.dataTransfer;o.setData("text","fxs-draganddrop"),o.effectAllowed="move",function(e){const t=e.target,s=$(t);if(!h||h.htmlTarget===t){if(h={htmlTarget:t,elementObject:s,width:s.outerWidth(!1),height:s.outerHeight(!1)},y.top=-e.offsetY,y.left=-e.offsetX,f=d(s.closest(m),r.Widget),!f)return e.preventDefault(),void S(e);s.css("opacity",.75),x=b=P({left:e.pageX,top:e.pageY}),i.register(g)}}(e)}))}enableDragDropTargets(){_().forEach((e=>{e.on("mouseenter",u,(e=>{const t=$(e.currentTarget);"true"!==t.attr(c)&&this.enableDragDropOnSingleTarget(t)}))}))}disableDragDropTargets(){_().forEach((e=>e.off("mouseenter",u))),$.querySelectorAll(".ui-draggable").removeClass(p).off("dragstart").removeAttr(c)}}t.FlowLayoutDragDrop=F})),
define("_generated/Less/MsPortalImpl/Widgets/OrganizeMode.css",["module"],(function(e){"use strict";return{css:".fxs-desktop-organize .fxs-tile .fxs-tile-content{z-index:0}.fxs-desktop-organize .fxs-tile .fxs-tile-overlay{display:block;touch-action:none}.fxs-desktop-organize .fxs-tile:hover .fxs-tile-overlay{background-color:transparent}.fxs-desktop-organize .fxs-tile.fxs-tilesize-custom .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-mini .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-small .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-tall .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-wide .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-normal .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-large .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-herotall .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-herowide .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-hero .fxs-tile-overlay{cursor:move}.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-help .fxs-tile div.fxs-tile-overlay,.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-context .fxs-tile div.fxs-tile-overlay,.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-contextaction .fxs-tile div.fxs-tile-overlay{background-color:transparent}.fxs-desktop-organize .fxs-sidebar{display:none !important}.fxs-desktop-organize .fxs-startboard-header .fxs-startboard-migration,.fxs-desktop-organize .fxs-startboard-header .fxs-startboard-dropdown,.fxs-desktop-organize .fxs-startboard-filter,.fxs-desktop-organize .fxs-startboard-commandBar{display:none}.fxs-desktop-organize .fxs-hide-in-customize{visibility:hidden}.fxs-desktop-organize .fxs-startboard-layout>.fxs-flowlayout-childcontainer{min-height:2155px;min-width:3865px}.fxs-desktop-organize .msportalfx-clickable-in-customize,.fxs-desktop-organize .fxc-hotspot-customclick{z-index:1}.fxs-desktop-organize .fxs-startboard-customize-header .fxs-startboard-button{padding:15px 5px}.fxs-desktop-organize .fxs-contextpane .fxs-tile .fxs-tile-overlay{display:none}.fxs-desktop-normal .fxs-hide-in-normal{display:none}@media(max-width:700px){.fxs-startboard-customize-header{min-height:initial}.fxs-startboard-customize-description{display:none}}",moduleId:e.id}})),
define("MsPortalImpl/UI/UI.DesktopModeManager",["require","exports","MsPortalImpl/Base/Base.Events","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.FlowLayoutDragDrop","MsPortalImpl/Services/Services.Settings","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/UI.DesktopManagerImpl","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/Resources/Resources.Images","MsPortalImpl/Resources/ImplScriptResources","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/OrganizeMode.css"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DesktopModeManagerImpl=t.createDesktopModeManager=void 0,(0,h.injectCss)(f,{moduleId:"flowlayoutGridShadowUri",css:`.fxs-desktop-organize .fxs-flowlayout-childcontainer {background: url(${m.getFlowLayout().gridShadow});}`});const x=p.Widget.widgetRemoveEvent,b=`.${u.overlayClassName}`,v=`.${u.widgetClassName}`,y=`.${u.actionBarContainerClassName}`;t.createDesktopModeManager=function(e,t,i){const o=e.get(l.DesktopManagerImpl),n=e.get(a.DesktopManagerMode).value,r=new M(t,e,i),d=e=>{const t=$(e.target).closest(v);return p.Widget.getWidget(t,u.Widget)},c=t.getStartBoardArea();return t.topBar.exitOrganizeMode=()=>{e.get(a.DesktopManagerMode).value(0);const t=o.startBoard.widget.element.find(".fxs-startboard-button-edit>.azc-toolbarButton-container");t.length&&t.focus()},c.on("fxenterorganizemode",((e,t)=>{e.stopPropagation();const s=d(e);t=$.extend({},t),MsPortalFx.isNullOrUndefined(t.trigger)&&(t.trigger=s?0:1),s&&(s.options.selected(!0),r.updateTileSelection(s)),r.startPartManagement(t).then((()=>{s&&s.showTileManagementContextMenu()}))})),c.on("fxopentilegallery",(e=>{1===n()&&(e.stopPropagation(),r.startPartManagement({openTileGallery:!0}))})),c.on("click",b,(e=>{const t=d(e),s=t&&t.options;s&&!s.locked()&&(s.selected(!s.selected()),r.updateTileSelection(t))})),c.on("click",y,(e=>{if(1!==n())return;const t=d(e),s=t&&t.options;!s||s.locked()||s.selected()||(s.selected(!0),r.updateTileSelection(t))})),c.on("dragstart",".ui-draggable",(e=>{if(s.isFullscreen())return void e.preventDefault();1!==n()&&n(1);const t=d(e),i=t&&t.options;i&&!i.selected()&&(i.selected(!0),r.updateTileSelection(t))})),c.on("fxpartcreated",((e,t)=>{e.stopPropagation();const s=t.widget;s.options.selected(!0),r.updateTileSelection(s)})),r};class M{constructor(e,t,s){this._diContainer=t,this._dismissHandle={dismissFn:()=>{this._mode(0)},logName:"desktopmodemanager"},this._mode=t.get(a.DesktopManagerMode).value,this._portal=e,this._lifetime=s,this._userSettingsManager=t.get(n.SettingsManager),this._contextPane=t.get(r.RightContextPane),this._partMgmtStarted=!1,this._selectedTile=null,this._handleModeChange(s)}get selectedTile(){return this._selectedTile}updateTileSelection(e){this._deselectCurrentTile(),e.options.selected()&&(this._selectedTile=e),this._selectedTile&&this._selectedTile.element.on(x,this._tileRemoveHandler=e=>{e.target===this._selectedTile.element[0]&&this._deselectCurrentTile()})}startPartManagement(e){if(this._partMgmtStarted)return Q();if(this._mode(1),e.openTileGallery){const e=this._contextPane;return this._partMgmtStarted=!0,e.tryOpen(this).then((()=>{const e=this._partGalleryVm;return MsPortalFx.require("MsPortalImpl/UI/UI.PartGalleryManager").then((t=>{this._partGalleryManager||(this._partGalleryManager=t.create(this._lifetime.createChildLifetime(),this._diContainer,e))}))}))}return Q()}onAddingContent(e){return Q(MsPortalFx.require("MsPortalImpl/Widgets/Widgets.PartGallery")).then((t=>{this._partGalleryVm||(this._partGalleryVm=new t.ViewModel(this._lifetime,this._diContainer));const s=this._partGalleryVm;if(!this._partGalleryWidget){const i=$(FxImpl.createElement("div",{class:"fxs-partgallery-container"}));return e.getWidget().getBladeHost(i,{title:g.PartGallery.title,bladeWidth:0}).then((o=>{e.getWidget().addChild(o);(this._partGalleryWidget=t.create(i,s)).ltm.registerForDispose(o)}))}}))}onRemovingContent(e){this._partMgmtStarted=!1,this._partGalleryWidget.dispose(),this._partGalleryWidget=null,e.getWidget().clear()}_enterOrganizeMode(){return this._portal.inOrganizeMode(!0),i.register(this._dismissHandle),o.FlowLayoutDragDrop.Instance.enableDragDropTargets(),this._partMgmtStarted?Q():this.startPartManagement({})}_exitOrganizeMode(){const e=this._portal;o.FlowLayoutDragDrop.Instance.disableDragDropTargets(),e.inOrganizeMode(!1);this._contextPane.close(!0),this._deselectCurrentTile(),this._userSettingsManager.flushSettings(),i.unregister(this._dismissHandle)}_handleModeChange(e){this._mode.subscribe(e,(e=>{switch(e){case 1:{this._diContainer.getAsync(c.DialogManager).then((e=>{e.dismissOpenDialog()}));const e=this._diContainer.get(d.JourneyManager),t=e.activeJourney();t&&e.forceDiscardJourney(t.id),this._enterOrganizeMode(),s.isFullscreen()&&s.exitFullscreen();break}default:this._exitOrganizeMode()}}))}_deselectCurrentTile(){this._selectedTile&&(this._selectedTile.element.off(x,this._tileRemoveHandler),this._tileRemoveHandler=null,this._selectedTile.options.selected(!1),this._selectedTile=null)}}t.DesktopModeManagerImpl=M})),
define("MsPortalImpl/UI/Compositions/UI.Composition.Services",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Base.Router","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/UI/Commands/UI.CommandManager","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/UI.DesktopManagerImpl","MsPortalImpl/UI/UI.DesktopModeManager","MsPortalImpl/UI/Hubs/UI.NotificationManager","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Portal"],(function(e,t,s,i,o,n,r,a,l,d,c,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initialize=t.FeedbackPaneInfo=t.WhatsNewModal=t.HatsModal=t.ContactabilityModal=void 0;const u=MsPortalFx.require;class m{constructor(e){this.callBack=e}static create(e,t){return new m((s=>{u("MsPortalImpl/Widgets/Dialogs/Widgets.UpdateContact").then((i=>{new i.Widget($(FxImpl.createElement("div")),new i.ViewModel,s,t.getRootElement(),e)}))}))}}__decorate([__metadata("fx:diagnostics",[e,"ContactabilityModal"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s.Container,p.ViewModel]),__metadata("design:returntype",m)],m,"create",null),t.ContactabilityModal=m;class g{constructor(e){this.callBack=e}static create(e,t){return new g((s=>{u("MsPortalImpl/Widgets/Dialogs/Widgets.HatsModal").then((i=>{new i.Widget($(FxImpl.createElement("div")),new i.ViewModel,s.tasks,t.getRootElement(),e)}))}))}}__decorate([__metadata("fx:diagnostics",[e,"HatsModal"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s.Container,p.ViewModel]),__metadata("design:returntype",g)],g,"create",null),t.HatsModal=g;class h{constructor(e){this.callBack=e}static create(e,t){return new h((s=>{MsPortalFx.isFeatureEnabled("whatsnew")&&e.whatsNewEnabledKey()&&u("MsPortalImpl/Widgets/Widgets.WhatsNew").then((e=>{const i=s.items.map((e=>{const t=e.published?new Date(e.published).toLocaleString():"";return e.description+="\r\n"+t,e}));new e.Widget($(FxImpl.createElement("div")),new c.ViewModel,i,t.getRootElement())}))}))}}__decorate([__metadata("fx:diagnostics",[e,"WhatsNewModal"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[o.GeneralSettings,p.ViewModel]),__metadata("design:returntype",h)],h,"create",null),t.WhatsNewModal=h;class f{static create(t,s,i){return u("../../Widgets/Widgets.FeedbackPane",e).then((e=>({amdModule:e,widget:new e.FeedbackPane(t,s,(()=>i.getCurrentBladeInfo()))})))}}__decorate([__metadata("fx:diagnostics",[e,"FeedbackPaneInfo"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s.Container,r.RightContextPane,a.DesktopManagerImpl]),__metadata("design:returntype",void 0)],f,"create",null),t.FeedbackPaneInfo=f,t.initialize=function(e,t,s){return t.get(n.PortalCommandManager),t.get(i.Router),d.createNotificationManager(t),MsPortalFx.tryImmediateResolve(s.onWidgetCreate(),(()=>{l.createDesktopModeManager(t,s,e)})),t}})),
define("MsPortalImpl/Notifications/WhatsNewCheck",["require","exports","FxHubs/HubsSettingsSchema","MsPortalImpl/Notifications/NotificationsClientStrings","MsPortalImpl/Services/Services.BrowserSettings","MsPortalImpl/Services/Services.Settings","MsPortalImpl/UI/Compositions/UI.Composition.Services","MsPortalImpl/UI/Hubs/UI.NotificationManager"],(function(e,t,s,i,o,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkForPortalUpdates=t.showWhatsNewNotification=void 0;var l=MsPortalFx.ViewModels,d=MsPortalFx.Hubs.Notifications,c=d.NotificationStatus;let p=!1;function u(e,t){const s=1===t.length?i.WhatsNewNotification.oneTitle:i.WhatsNewNotification.twoOrMoreTitle.format(t.length);return Q(e.getAsync(a.NotificationHandler)).then((o=>o.notificationCallback({diContainer:e,messageContext:{callStack:null,destWindowId:null,srcWindowId:null},messageArg:new d.ClientNotification({status:c.Information,title:s,description:i.WhatsNewNotification.description.format(`<ul>${t.map((e=>"<li>"+MsPortalFx.encodeHtml(e.title)+"</li>")).join("")}</ul>`),descriptionAsHtml:!0,linkedBlade:l.getBladeSelection("HubsExtension","WhatsNewBlade",{})}).package()})))}t.showWhatsNewNotification=u,t.checkForPortalUpdates=function(e){const t=s.Keys.whatsNewLastNotificationTime,i=e.get(n.SettingsManager);return(0,n.readUserSettings)(i,[t]).then((s=>{const a=s[t];if(a)Q(MsPortalEarly.preload).then((e=>e&&e.whatsNew)).then((s=>{if(s&&s.length){const l=s.filter((e=>e.published&&new Date(e.published)>new Date(a)));if(l&&l.length){const a={};if(a[t]=(new Date).toISOString(),(0,n.writeUserSettings)(i,a,null),!MsPortalFx.isFeatureEnabled("whatsnew")||(0,o.hideSmallModals)()||p)return u(e,l);p=!0,e.get(r.WhatsNewModal).callBack({items:s.map((e=>({title:e.title,description:e.content,published:e.published,uri:e.uri})))})}}}));else{({})[t]=(new Date).toISOString(),(0,n.writeUserSettings)(i,s,null)}}))}})),
define("MsPortalImpl/Services/Services.PortalPollingManager",["require","exports","Fx/DependencyInjection","Fx/Ajax","MsPortalImpl/Services/Services.Subscriptions","Weave","MsPortalImpl/Services/Services.BrowserSettings","MsPortalImpl/Services/Services.SecurityTokens"],(function(e,t,s,i,o,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEV=t.PollingManager=void 0;var l=MsPortalFx.Base.Diagnostics.Telemetry;const d=FxImpl.features.isEnabled("selftoken");let c=MsPortalFx.isFeatureEnabled("pollservicehealthalerts"),p=MsPortalFx.isFeatureEnabled("outagebanner"),u=!0;let m=class{constructor(e){this._diContainer=e,this._polledData=(0,n.makeWritableComputation)(),this._lifetime=new FxImpl.TriggerableLifetimeManager}startPolling(){this._pollingHandle||Q.delay(12e4).then((()=>{const t=()=>{(async function(t){const s=["whatsNew"],n=t.get(r.PrivateLinkState).isPrivateLinked.value,u=t.get(r.ServiceDependencyState).azureResourceGraphUnavailable.value;p&&s.push("outages"),!c||n||u||s.push("serviceHealthAlerts");const m=l.startTrace({action:"PollPortalOnDemandData",source:"PortalPollingManager"});let g,h;try{const r=await t.get(a.SecurityTokensManager).getToken({extensionName:"fx",resourceName:"",skipCache:!1,isBackground:!1})||{token:{}},l=(await t.get(o.SubscriptionsUserContext).getInSessionSelectedSubscriptions())().map((e=>e.subscriptionId));if(h=await(0,i.postJSON)({isBackgroundTask:!0,uri:"/api/Portal/GetOnDemandData",setAuthorizationHeader:!d||{resourceName:"self"},headers:{"x-ms-feature-flags":JSON.stringify(MsPortalEarly.earlyBaseFeatureFlags)}},{armAuthorizationHeader:r.token.header,subscriptionIds:l,queries:s}),l.length){const s=await MsPortalFx.require(e.normalize("MsPortalImpl/Notifications/NotificationsFetchedFromClientHelper"));n&&c&&!u&&(h.serviceHealthAlerts=await s.getServiceHealthAlerts(l,t))}}catch(e){g=e}return l.endTrace(m,"complete",{counts:{irisNotifications:Object.keys(((null==h?void 0:h.irisNotifications)||{}).Notifications||{}).length,outages:((null==h?void 0:h.outages)||[]).length,whatsNew:((null==h?void 0:h.whatsNew)||[]).length,serviceHealthAlerts:((null==h?void 0:h.serviceHealthAlerts)||[]).length},error:g,queries:s}),h})(this._diContainer).then((e=>{e&&this._polledData(e),this._pollingHandle=setTimeout((()=>{t()}),6e5)}))};(u?Q():Q.delay(6e5)).then((()=>t()))}))}getPolledDataObservable(){return this._polledData}dispose(){this._pollingHandle&&clearTimeout(this._pollingHandle),this._lifetime.dispose(),u=!0}};m=__decorate([__metadata("fx:diagnostics",[e,"PollingManager"]),s.Class(),__metadata("design:paramtypes",[s.Container])],m),t.PollingManager=m})),
define("MsPortalImpl/Notifications/NotificationsArea",["require","exports","Fx/DependencyInjection","MsPortalImpl/Notifications/WhatsNewCheck","MsPortalImpl/Services/Services.Subscriptions","MsPortalImpl/Services/Services.PortalPollingManager","MsPortalImpl/Services/LazyUserData/LazyUserDataHelpers","MsPortalImpl/Services/Services.BrowserSettings","Weave"],(function(e,t,s,i,o,n,r,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEV=t.DataContext=t.delayTimeout=void 0,t.delayTimeout=MsPortalFx.isDevelopmentMode&&MsPortalFx.isFeatureEnabled("fasteventservice")?1e4:3e4;var d=MsPortalFx.Base.Diagnostics.Telemetry;const c=MsPortalFx.getFeatureValue("irismessagelimit");let p=function(t,s){const i=null==s?void 0:s.Notifications;let o=0;o=Number(c||1)>1&&Array.isArray(i)?i.length:i?1:0,o&&MsPortalFx.require(e.normalize("./PortalNotifications")).then((e=>{e.init(t,s)})),d.trace({source:"NotificationsArea",action:o?"IrisNotificationPresent":"IrisNotificationNotPresent",data:{count:o,requestedCount:c}})};function u(t,s){s&&s.length?MsPortalFx.require(e.normalize("./PortalNotifications")).then((e=>{e.initServiceHealthAlerts(t,s)})):d.trace({source:"NotificationsArea",action:"NoServiceHealthAlertsShown"})}let m=class{constructor(s,o){this._diContainer=s,this._lifetime=new FxImpl.TriggerableLifetimeManager;const d=FxImpl.features.isNativePerf,c=MsPortalFx.getFeatureValue("skipeventpoll"),m=MsPortalFx.isFeatureEnabled("portalpolling"),g=MsPortalFx.isFeatureEnabled("pollservicehealthalerts"),h=MsPortalFx.isFeatureEnabled("showservicehealthalerts"),f="true"===c||d&&"false"!==c;if(f)return void(h&&(0,r.lazyUserDataMemo)(this._diContainer).then((e=>{const t=e.serviceHealthAlerts||[];u(this._diContainer,t)})));const x=ko.observable([]);o.getInSessionSelectedSubscriptions().then((e=>{e.subscribeAndRun(this._lifetime,(e=>x(e)))})),x.subscribeAndRun(this._lifetime,(s=>{if(s&&s.length&&!this._initialized&&(this._initialized=!0,f||Q.delay(t.delayTimeout).then((()=>{MsPortalFx.require(e.normalize("./NotificationsFetchedFromClientHelper")).then((e=>{e.startPollingForDigestEvents(this._diContainer,s)}))})),!m&&g)){const i=()=>{this._diContainer.get(a.ServiceDependencyState).azureResourceGraphUnavailable.value||MsPortalFx.require(e.normalize("./NotificationsFetchedFromClientHelper")).then((e=>{Q.delay(e.defaultPollingInterval).then((()=>{e.getServiceHealthAlerts(s.map((e=>e.subscriptionId)),this._diContainer).then((e=>{u(this._diContainer,e),i()}))}))}))};Q.delay(t.delayTimeout).finally(i)}})),d||Q.delay(t.delayTimeout).then((()=>{(0,i.checkForPortalUpdates)(this._diContainer)})),m&&(0,l.subscribeAndRun)(this._lifetime,[this._diContainer.get(n.PollingManager).getPolledDataObservable()],(e=>{e&&(e.irisNotifications&&p(this._diContainer,e.irisNotifications),e.whatsNew&&(0,i.showWhatsNewNotification)(this._diContainer,e.whatsNew),e.serviceHealthAlerts&&u(this._diContainer,e.serviceHealthAlerts))})),d||Q(MsPortalEarly.preload).then((e=>{(e=e||{}).irisNotifications&&p(this._diContainer,e.irisNotifications),e.whatsNew&&(0,i.showWhatsNewNotification)(this._diContainer,e.whatsNew)}))}dispose(){!this._lifetime.isDisposed()&&this._lifetime.dispose()}};m=__decorate([__metadata("fx:diagnostics",[e,"DataContext"]),s.Class(),__metadata("design:paramtypes",[s.Container,o.SubscriptionsUserContext])],m),t.DataContext=m})),
define("_generated/Less/MsPortalImpl/Parts/Parts.ButtonPart.css",["module"],(function(e){"use strict";return{css:".fxs-part-buttonpart{display:flex;width:100%;height:100%;box-sizing:border-box;text-align:center;align-items:center;flex-direction:column}.fxs-part-buttonpart-iconcontainer{flex:0 0 auto;box-sizing:border-box;display:flex;align-items:center}.fxs-part-buttonpart-iconcontainer>img,.fxs-part-buttonpart-iconcontainer>svg{flex:0 0 auto;height:50px;width:50px}.fxs-part-buttonpart-textcontainer{width:100%;font-size:13px;line-height:normal}.fxs-part-buttonpart-assetname{margin:0;font-size:10px;line-height:10px;padding-bottom:1px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-part-buttonpart-desc{display:none;position:relative;margin-top:10px}.fxs-part-buttonpart-desc:empty{margin-top:0}.fxs-part-buttonpart-titlecontainer{display:flex;flex-flow:row nowrap;align-items:flex-start;justify-content:center}.fxs-part-buttonpart-title{position:relative;margin:0;font-size:14px;font-weight:600;display:block;display:-webkit-box;line-height:18px;max-height:36px;overflow:hidden;text-overflow:ellipsis;-webkit-line-clamp:2;-webkit-box-orient:vertical}.fxs-part-buttonpart-title.fxs-should-use-single-line{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-tilesize-mini .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-mini .fxs-part-buttonpart-iconcontainer>svg,.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>svg{height:30px;width:30px}.fxs-tilesize-small .fxs-part-buttonpart,.fxs-tilesize-wide .fxs-part-buttonpart{text-align:left;flex-direction:row}.fxs-tilesize-small .fxs-part-buttonpart-titlecontainer,.fxs-tilesize-wide .fxs-part-buttonpart-titlecontainer{justify-content:flex-start}.fxs-tilesize-small .fxs-part-buttonpart-textcontainer,.fxs-tilesize-wide .fxs-part-buttonpart-textcontainer{flex:0 1 auto;display:flex;flex-direction:column;justify-content:center}.fxs-tilesize-mini .fxs-part-buttonpart-iconcontainer{padding-top:3px}.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer{width:51px;padding-left:6px}.fxs-tilesize-normal .fxs-part-buttonpart-titlecontainer{margin:13px 0 5px}.fxs-tilesize-normal .fxs-part-buttonpart-iconcontainer{padding-top:28px}.fxs-tilesize-normal .fxs-part-part-title-visible .fxs-part-buttonpart-iconcontainer{padding-top:0}.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer{width:85px;padding-left:15px}.fxs-tilesize-wide .fxs-part-buttonpart-title{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-tilesize-wide .fxs-part-buttonpart-assetname{padding-top:2px}.fxs-tilesize-wide .fxs-part-buttonpart-desc{display:block;display:-webkit-box;line-height:18px;max-height:90px;overflow:hidden;text-overflow:ellipsis;-webkit-line-clamp:5;-webkit-box-orient:vertical}.fxs-part-buttonpart-externallink{height:12px;width:12px;margin-left:3px;margin-top:2px}.fxs-part-buttonpart-externallink>img,.fxs-part-buttonpart-externallink>svg{height:12px;width:12px}",moduleId:e.id}})),
define("MsPortalImpl/Parts/Parts.ButtonPart",["require","exports","MsPortalImpl/Parts/Parts","FxInternal/Composition/ViewModel","FxInternal/Css","_generated/Less/MsPortalImpl/Parts/Parts.ButtonPart.css"],(function(e,t,s,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ButtonPart=t.template=void 0,(0,o.injectCss)(n),t.template="<div class='fxs-part-buttonpart'><div class='fxs-part-buttonpart-iconcontainer' data-bind='image: icon, attr: { title: _displayTitle }'></div><div class='fxs-part-buttonpart-textcontainer'><div class='fxs-part-buttonpart-titlecontainer'><h3 class='fxs-part-buttonpart-title msportalfx-tooltip-overflow' data-bind='text: _displayTitle, css: { \"fxs-should-use-single-line\": _assetNameVisible }, attr: { \"aria-describedby\": _assetName() && _id }'></h3>\x3c!-- ko if: _isExternalLink --\x3e<div class='fxs-part-buttonpart-externallink azc-fill-heavy' data-bind='image: _linkSvg, attr: { \"aria-label\": _linkUri }'></div>\x3c!-- /ko --\x3e</div><div data-bind='text: _assetName, visible: _assetNameVisible, attr: { id: _id }' class='fxs-part-buttonpart-assetname msportalfx-tooltip-overflow'></div><div data-bind='text: description' class='fxs-part-buttonpart-desc msportalfx-tooltip-overflow'></div></div></div>";class r extends s.PartImpl{constructor(){super(...arguments),this.template=t.template}_getContentForBinding(e){const t=this._viewModel,s=t.content,o=t.container,n=o.clickableLink,r=e=>"_self"===e.target()||e.uri&&MsPortalFx.startsWith(e.uri(),"#")&&"auto"===e.target(),a=ko.observable(!!n&&!r(n));ko.computed(e,(()=>{this.ariaLabel(s().title())}));const l=n&&n.target;l&&l.subscribe(e,(e=>{a(!r(n))}));const d=n&&n.uri;d&&d.subscribe(e,(e=>{a(!r(n))}));const c=i.isV2(s())?()=>this._options.size():()=>s().size&&s().size();return ko.computed(e,(()=>MsPortalFx.extend2(super._getContentForBinding(e)(),{_displayTitle:ko.computed(e,(()=>{const e=c(),t=s(),i=t.title();return(0===e||1===e)&&t.shortTitle()||i})),_assetName:o.assetName,_isExternalLink:a,_linkUri:d,_linkSvg:MsPortalFx.Base.Images.Hyperlink(),_assetNameVisible:ko.computed(e,(()=>!this.inContainerOfSameAsset()&&o.assetName())),_id:MsPortalFx.getUniqueId()})))}}t.ButtonPart=r})),
define("_generated/Less/MsPortalImpl/Parts/Parts.Collection.css",["module"],(function(e){"use strict";return{css:'.fxs-part-collectionpart .azc-grid table thead tr th{height:28px;line-height:28px;border-top-width:1px;border-top-style:solid}.fxs-part-collectionpart .azc-grid table thead tr th>a{line-height:normal}.fxs-part-collectionpart .azc-grid table thead tr th:first-child a{padding-left:15px}.fxs-part-collectionpart .azc-grid table tbody tr td{height:27px}.fxs-part-collectionpart .azc-grid table td.azc-grid-cell:first-of-type{padding-left:15px}.fxs-part-collectionpart .azc-grid table td:last-of-type,.fxs-part-collectionpart .azc-grid table td:last-child{padding-right:15px}.fxs-part-collectionpart .azc-grid table .azc-grid-resizableColumn-handle{height:28px}.fxs-part-collectionpart .fxs-part-collectionpart-rollup-container{display:none}.fxs-part-collectionpart.fxs-part-collectionpart-rollup-forceshow .fxs-part-collectionpart-rollup-container{display:block}.fxs-part-collectionpart-more-data{font-weight:600;font-size:12px;line-height:24px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;position:absolute;right:0}.fxs-part-collectionpart-more-data:hover{text-decoration:underline}.fxs-part-collectionpart-rollup-container{margin:-6px 0 6px}.fxs-part-collectionpart-rollup-count{font-weight:600;font-size:30px;line-height:30px;letter-spacing:-.025em}.fxs-part-collectionpart-rollup-label{font-weight:700;font-size:15px;line-height:15px;letter-spacing:-.02em;margin-left:4px}.fxs-part-collectionpart-part-title{font-size:10px;line-height:10px;padding-bottom:1px;margin:5px 0 0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:none}.fxs-part-collectionpart-rollup-icon{width:21px;height:21px;margin-left:4px;display:inline-block}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-container,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-container{display:block;margin:0}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-label,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-label{display:none}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-count,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-count{line-height:25px}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-no-rollup-count,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-no-rollup-count{width:30px;height:30px;margin-left:0}.fxs-tilesize-mini .fxs-part-collectionpart{text-align:center;padding:5px 6px 0}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-part-title{display:block}.fxs-tilesize-small .fxs-part-collectionpart{float:right;margin-top:-15px}html[lang^="ja"] .fxs-part-collectionpart .fxs-part-collectionpart-part-title,html[lang^="ko"] .fxs-part-collectionpart .fxs-part-collectionpart-part-title,html[lang^="zh"] .fxs-part-collectionpart .fxs-part-collectionpart-part-title{font-size:11px;line-height:11px}',moduleId:e.id}})),
define("MsPortalImpl/Parts/Parts.Collection",["require","exports","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Parts/Parts","MsPortalImpl/Resources/ImplScriptResources","FxInternal/Css","_generated/Less/MsPortalImpl/Parts/Parts.Collection.css"],(function(e,t,s,i,o,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CollectionPart=void 0,(0,n.injectCss)(r);const a=o.Parts,l=`<div class="fxs-part-collectionpart" data-bind="css: {'fxs-part-collectionpart-rollup-forceshow': alwaysShowRollupCount()}"><div class="fxs-part-collectionpart-rollup-container"><span class="fxs-part-collectionpart-rollup-count" data-bind="text: rollupCount, visible: !noRollupCount()"></span><span class="fxs-part-collectionpart-rollup-label" data-bind="text: rollupCountLabel"></span><img class="fxs-part-collectionpart-rollup-icon" data-bind="attr: { src: rollupCountIconUri }, visible: rollupCountIconUri, css: {'fxs-part-collectionpart-no-rollup-count': noRollupCount }" alt=""/><div class="fxs-part-collectionpart-rollup-icon" data-bind="image: rollupCountIcon, visible: rollupCountIcon, css: {'fxs-part-collectionpart-no-rollup-count': noRollupCount }"></div><h4 class="fxs-part-collectionpart-part-title fxs-display-none" data-bind="text: _partTitle"></h4></div>\x3c!-- ko if: emptyGrid() && noRowsHtml() --\x3e<div class="fxs-part-collectionpart-norowshtml fxs-display-none" data-bind="pcControl: noRowsHtml"></div>\x3c!-- /ko --\x3e\x3c!-- ko if: !emptyGrid() || !noRowsHtml() --\x3e\x3c!-- ko if: !!gridMode() --\x3e<div data-bind="pcGrid: grid" class="msportalfx-removepartpaddingside"></div><a href="#" class="fxs-part-collectionpart-more-data fxs-portal-text-primary" tabindex="0" data-bind="visible: hasMoreData">${MsPortalFx.encodeHtml(a.more)}</a>\x3c!-- /ko --\x3e\x3c!-- /ko --\x3e</div>`;class d extends i.PartImpl{constructor(e,t,s,i){super(e,t,s,i),this.template=l;(this._container=$(e)).on("click keydown","a.fxs-part-collectionpart-more-data",(e=>{13!==e.which&&"click"!==e.type||e.preventDefault(),e.stopPropagation();const t=$.Event(e.type);t.keyCode=e.keyCode,$(e.delegateTarget).trigger(t)}))}_getContentForBinding(e){const t=this._viewModel,i=this._container.findByClassName("fxs-part-collectionpart-part-title"),o=this._container.findByClassName("fxs-part-collectionpart-norowshtml");return ko.computed(e,(()=>{const e=t.content().size();s.toggle(i,0!==e||!!t.container.partTitle()),s.toggle(o,0!==e&&1!==e)})),ko.observable(MsPortalFx.extend2(t.content(),{_partTitle:t.container.partTitle}))}}t.CollectionPart=d})),
define("_generated/Less/MsPortalImpl/Parts/Parts.PricingTier.css",["module"],(function(e){"use strict";return{css:".msportalfx-pricingTier .msportalfx-tooltip-overflow{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.msportalfx-pricingTier .msportalfx-pricingTier-normal-iconContainer,.msportalfx-pricingTier .msportalfx-pricingTier-wide-iconContainer{height:55px;border-bottom:1px solid #dcdfe2}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer{margin-top:10px}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer .msportalfx-pricingTier-specCode{float:left;margin-right:8px;max-width:100px}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer .msportalfx-pricingTier-promotedFeatures{line-height:12px;padding-top:4px}.msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-float .msportalfx-pricingTier-icon{width:30px;height:30px;margin-top:1.7em}.msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-float .msportalfx-pricingTier-icon.msportalfx-pricingTier-icon-small{margin-top:-.15em}.fxs-tilesize-wide .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock{padding-top:10px}.fxs-tilesize-wide .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock .msportalfx-pricingTier-icon{width:30px;height:30px;margin-right:15px}.fxs-tilesize-normal .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock{padding-top:18px}.fxs-tilesize-normal .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock .msportalfx-pricingTier-icon{width:20px;height:20px;margin-right:5px}.fxs-tilesize-small .msportalfx-pricingTier .msportalfx-pricingTier-textContainer{margin-top:-12px}.fxs-tilesize-mini .msportalfx-pricingTier .msportalfx-pricingTier-specTitle,.fxs-tilesize-mini .msportalfx-pricingTier .msportalfx-pricingTier-specCode{text-align:center;float:initial}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Parts/Parts.SpecPicker.css",["module"],(function(e){"use strict";return{css:'.msportalfx-specpicker{width:175px;height:320px;position:relative;border-color:inherit}.msportalfx-specpicker::after{right:10px;left:auto;transform:skew(8deg) rotate(3deg)}.msportalfx-specpicker .msportalfx-specpicker-table{table-layout:auto}.msportalfx-specpicker ul{list-style-type:none;padding:0}.msportalfx-specpicker .msportalfx-tooltip-overflow{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.fxs-mode-dark .msportalfx-specpicker{box-shadow:0 1px 4px rgba(255,255,255,.3),0 0 40px rgba(255,255,255,.1) inset}.fxs-mode-dark .msportalfx-specpicker::before,.fxs-mode-dark .msportalfx-specpicker::after{box-shadow:0 0 20px rgba(255,255,255,.8)}.fxs-mode-light .msportalfx-specpicker{box-shadow:0 1px 4px rgba(0,0,0,.3),0 0 40px rgba(0,0,0,.1) inset}.fxs-mode-light .msportalfx-specpicker::before,.fxs-mode-light .msportalfx-specpicker::after{box-shadow:0 0 20px rgba(0,0,0,.8)}.msportalfx-specpicker-star{width:14px;height:14px;fill:#ffb900;stroke:#000;stroke-width:1px;float:right;margin-right:4px;margin-top:1px}.msportalfx-specpicker-header{color:#fff;font-size:14px;height:26px;line-height:26px}.msportalfx-specpicker-header .msportalfx-specpicker-header-specCode{font-weight:600;text-transform:uppercase;padding-left:11px}.msportalfx-specpicker-header .msportalfx-specpicker-header-title{padding-left:6px}.msportalfx-specpicker-header-text{fill:#ffb900;stroke:#000;stroke-width:1px;width:161px;position:absolute}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade1{background-color:#4668c5}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade2{background-color:rgba(70,104,197,.2)}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade3{background-color:rgba(70,104,197,.1)}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade1{background-color:#8a2da5}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade2{background-color:rgba(138,45,165,.2)}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade3{background-color:rgba(138,45,165,.1)}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade1{background-color:#578000}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade2{background-color:rgba(87,128,0,.2)}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade3{background-color:rgba(87,128,0,.1)}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade1{background-color:#c40}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade2{background-color:rgba(204,68,0,.2)}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade3{background-color:rgba(204,68,0,.1)}.msportalfx-specpicker-table{table-layout:auto;width:100%;border-collapse:collapse}.msportalfx-specpicker-table .msportalfx-specpicker-feature-name{font-weight:600;font-size:13px;line-height:1.385;margin-left:6px}.msportalfx-specpicker-table .msportalfx-specpicker-feature-value{font-weight:600;font-size:17px}.msportalfx-specpicker-row td{white-space:nowrap;padding:0}.msportalfx-specpicker-row td .msportalfx-specpicker-cell{height:30px;line-height:30px}.msportalfx-specpicker-row td.msportalfx-specpicker-right{overflow:hidden;text-overflow:ellipsis;max-width:1px;width:100%}.msportalfx-specpicker-row.msportalfx-specpicker-promotedFeatures td{padding-bottom:1px}.msportalfx-specpicker-row.msportalfx-specpicker-borderBottom td{border-bottom:1px solid #e9e9f3}.msportalfx-specpicker-row .msportalfx-specpicker-left{text-align:center;min-width:39px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-feature-value{font-size:13px;line-height:1.385;padding-top:6px;margin-left:6px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-feature-name{font-size:10px;line-height:normal;margin-top:-3px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-mutipleline .msportalfx-specpicker-feature-value{padding-top:1px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell{min-width:29px;text-align:center}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell img{width:22px;height:22px;margin-top:8px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell div{width:20px;height:20px;padding-top:5px;padding-left:0;display:inline-block}.msportalfx-specpicker-footer-container{position:absolute;bottom:0;left:0;right:0;height:46px;text-align:right}.msportalfx-specpicker-footer{margin-right:10px;margin-bottom:8px;background-color:inherit}.msportalfx-specpicker-footer-value{margin-top:6px;text-transform:uppercase;line-height:22px !important;font-weight:600;font-size:22px;line-height:22px;letter-spacing:-.025em}.msportalfx-specpicker-footer-details{font-size:10px;line-height:14px;text-transform:uppercase}.msportalfx-specpicker-footer-statusMessage,.msportalfx-specpicker-footer-channelMessage{margin-left:5px;margin-right:5px;font-size:11px;text-align:left}.msportalfx-specpicker-footer-statusMessage{margin-top:25px}.msportalfx-specpicker-footer-channelMessage{margin-top:10px;position:absolute;background-color:inherit;white-space:normal;display:block;display:-webkit-box;line-height:16px;max-height:32px;overflow:hidden;text-overflow:ellipsis;-webkit-line-clamp:2;-webkit-box-orient:vertical}.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker{background-color:rgba(189,189,189,.05)}.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-header{background-color:#bdbdbd}.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-promotedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell{background-color:rgba(189,189,189,.2)}.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-promotedFeatures .msportalfx-specpicker-right .msportalfx-specpicker-cell{background-color:rgba(189,189,189,.1)}.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-footer-container{background-color:#dedede}.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-feature-value,.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-feature-name,.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-footer-value{color:#bdbdbd}.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-disable-blockui-shield{position:absolute;top:0;left:0;bottom:0;right:0}.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-disable-message-anchor{position:absolute;text-align:center;left:15px;right:15px;top:40%}.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-disable-message-anchor .msportalfx-specpicker-disable-message-container{display:inline-block;background-color:rgba(50,56,63,.8);margin-top:20px;padding:15px 10px;width:100%;box-sizing:border-box}.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-disable-message-anchor .msportalfx-specpicker-disable-message-container .msportalfx-specpicker-disable-message{display:inline;color:#fff}.ext-hubs-specPickerGrid-container{height:100%;overflow:hidden;display:flex;flex-direction:column}.ext-hubs-specPicker-container{width:100%;min-height:100%}.ext-hubs-specPicker-container .ext-hubs-specPicker-filtersContainer.ext-hubs-specPicker-filtersContainer{margin-top:0;padding-top:5px}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptionsContainer{height:25px;padding-top:5px;padding-right:15px}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions{font-size:14px;float:right}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .msportalfx-specpicker-recommendationsIcon{width:14px;height:14px;display:inline-block}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .fxc-hotspot.fxc-hotspot-selected{cursor:default;background-color:inherit}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .fxc-hotspot.fxc-hotspot-clickable{color:#0058ad;fill:#0058ad}.ext-hubs-specPicker-container .ext-hubs-specPicker-content{height:100%}.ext-hubs-specPicker-container .ext-hubs-specPicker-message{margin-top:0;border-left:6px solid #ffb900;padding:15px;white-space:pre-wrap}.ext-hubs-specPicker-container .ext-hubs-specPicker-listView{margin-left:19px}.ext-hubs-specPicker-container .fxc-hotspot{outline:none;padding:5px}.ext-hubs-specPicker-container .fxc-hotspot:focus{outline-style:dotted;outline-width:1px}',moduleId:e.id}})),
define("MsPortalImpl/Parts/Parts.Intrinsics",["require","exports","MsPortalImpl/Parts/Parts","FxInternal/Css","_generated/Less/MsPortalImpl/Parts/Parts.SpecPicker.css","_generated/Less/MsPortalImpl/Parts/Parts.PricingTier.css"],(function(e,t,s,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parts=void 0,(0,i.injectCss)(o,n);var r=MsPortalFx.Parts.PartKind;const a="<div data-bind='{0}: $root'></div>",l={defaultSize:8,supportedSizes:[8],viewStateProperties:["content.selection.selectedItems","content.selection.activatedItems"]},d=15,c=18,p=27,u=28,m=29,g=30;t.parts=[{kind:r.Asset,factory:s.createAmdPartFactory("MsPortalImpl/Parts/Parts.Asset",((e,t,s,i,o)=>new e.AssetPart(t,s,i,o)),{defaultSize:1,supportedSizes:[0,1,2]})},{kind:r.Button,factory:s.createAmdPartFactory("MsPortalImpl/Parts/Parts.ButtonPart",((e,t,s,i,o)=>new e.ButtonPart(t,s,i,o)),{supportedSizes:[0,1,2,3]})},{kind:r.Chart,factory:s.createAmdPartFactory("MsPortalImpl/Parts/Parts.Chart",((e,t,s,i,o)=>new e.Chart(t,s,i,o)),{supportedSizes:[1,2,4,3,10,5,6,7,8,9]})},{kind:r.Collection,factory:s.createAmdPartFactory("MsPortalImpl/Parts/Parts.Collection",((e,t,s,i,o)=>new e.CollectionPart(t,s,i,o)),{supportedSizes:[0,1,2,3,4,10,5,6,7,9,8]})},{kind:r.CollectionSummary,factory:s.createAmdPartFactory("MsPortalImpl/Parts/Parts.CollectionSummary",((e,t,s,i,o)=>new e.Part(t,s,i,o)),{supportedSizes:[0,1,2,3]})},{kind:u,factory:s.createAmdPartFactory("MsPortalImpl/Parts/Parts.Donut",((e,t,s,i,o)=>new e.Donut(t,s,i,o)),{supportedSizes:[2,5,3,10,4,6]})},{kind:d,factory:s.createPartFactory(a.format("pcEditor"))},{kind:r.Grid,factory:s.createPartFactory(a.format("pcGrid"),{viewStateProperties:["content.selectableData.selectedItems","content.selectableData.activatedItems","content.selectableData.itemsWithChildEdits"]})},{kind:r.InfoList,factory:s.createAmdPartFactory("MsPortalImpl/Parts/Parts.InfoList",((e,t,s,i,o)=>new e.InfoListPart(t,s,i,o)),l)},{kind:r.Properties,factory:s.createAmdPartFactory("MsPortalImpl/Parts/Parts.Properties",((e,t,s,i,o)=>new e.PropertiesPart(t,s,i,o)),l)},{kind:r.QuickStart,factory:s.createAmdPartFactory("MsPortalImpl/Parts/Parts.QuickStart",((e,t,s,i,o)=>new e.QuickStartPart(t,s,i,o)),{defaultSize:1,supportedSizes:[0,1,2,3]})},{kind:m,factory:s.createAmdPartFactory("MsPortalImpl/Parts/Parts.QuotaGauge",((e,t,s,i,o)=>new e.QuotaGauge(t,s,i,o)),{supportedSizes:[2,10,3,4,6,5]})},{kind:g,factory:s.createAmdPartFactory("MsPortalImpl/Parts/Parts.ResourceSummary",((e,t,s,i,o)=>new e.ResourceSummaryPart(t,s,i,o)),l)},{kind:p,factory:s.createAmdPartFactory("MsPortalImpl/Parts/Parts.SingleValueGauge",((e,t,s,i,o)=>new e.SingleValueGauge(t,s,i,o)),{supportedSizes:[2,10,3,4]})},{kind:c,factory:s.createPartFactory("<div></div>")}],t.parts.forEach((e=>{s.registerFactory(r[e.kind],e.factory)}))})),
define("MsPortalImpl/Services/Services.BrowserTelemetry",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBrowserInfo=void 0;var s=MsPortalFx.Base;const i=window,o=i.screen||{};let n,r,a,l;function d(){const e=o.height,t=o.width,d=i.innerHeight,c=i.innerWidth;if(n!==e||r!==t||a!==d||l!==c){const i={PreviousWindowHeight:a,PreviousWindowWidth:l,PreviousWindowResolution:l+"x"+a};n=e,r=t,a=d,l=c,function(e,t){const i=Date.now();s.Diagnostics.Telemetry.trace({timestamp:i,source:"BrowserTelemetry",action:t,data:e})}(MsPortalFx.extend(i,{ScreenHeight:e,ScreenWidth:t,ScreenResolution:t+"x"+e,WindowHeight:d,WindowWidth:c,WindowResolution:c+"x"+d}),"WindowSizeChanged")}}t.getBrowserInfo=function(){const e=i.navigator||{},t=o.availHeight,s=o.availWidth,d=n=o.height,c=r=o.width,f=a=i.innerHeight,x=l=i.innerWidth;return{AppName:e.appName,AppVersion:e.appVersion,UserAgent:e.userAgent,Language:e.language,SystemLanguage:e.systemLanguage,UserLanguage:e.userLanguage,Location:i.location.href,Platform:e.platform,CpuClass:e.cpuClass,Orientation:p,PrefersMsHighContrast:h,PrefersColorScheme:u,PrefersContrast:m,PrefersReducedMotion:g,ScreenAvailableHeight:t,ScreenAvailableWidth:s,ScreenAvailableResolution:s+"x"+t,ScreenHeight:d,ScreenWidth:c,ScreenResolution:c+"x"+d,WindowHeight:f,WindowWidth:x,WindowResolution:x+"x"+f,ScreenColorDepth:o.colorDepth}};let c=0;$(i).on("resize",((e,t)=>{clearTimeout(c),c=setTimeout(d,5e3)}));const p=i.matchMedia("(orientation: landscape)").matches?"landscape":i.matchMedia("(orientation: portrait)").matches?"portrait":"undetermined",u=i.matchMedia("(prefers-color-scheme: light)").matches?"light":i.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"nopreference",m=i.matchMedia("(prefers-contrast: high)").matches?"high":i.matchMedia("(prefers-contrast: low)").matches?"low":"nopreference",g=i.matchMedia("(prefers-reduced-motion: reduce)").matches?"reduce":"nopreference",h=i.matchMedia("(forced-colors: active) and (prefers-color-scheme: light)").matches?"light":i.matchMedia("(forced-colors: active) and (prefers-color-scheme: dark)").matches?"dark":"off"})),
define("MsPortalImpl/Services/Services.FileUploadEndpointRegistration",["require","exports","Fx"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerFileUploadEndpoints=void 0;var i=FxImpl.Rpc,o=FxImpl.FileUpload;const n=(0,s.memoizePromise)((()=>Q(MsPortalFx.require("MsPortalImpl/Services/Services.FileUploadManager")).then((e=>e.fileUploadManagerInstance()))));let r=!1;t.registerFileUploadEndpoints=function(){r||(r=!0,o.uploadActionEndPoint.register(i.client,null,(e=>n().then((t=>t.invokeUploadAction(e.uploadKey,e.action,e.context))))),o.getUploadInfosEndPoint.registerObjectFactory(i.client,{allowedOrigin:null,allowRemoteChanges:!0,handler:e=>n().then((t=>t.getUploadInfos(e.uploadKeys,e.category,e.resumable)))}))}})),
define("MsPortalImpl/Services/Services.FileUploadInitialization",["require","exports","Fx"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=t.uploadSettingsManager=t.hasFileUploads=void 0;const i=(0,s.memoizePromise)((()=>Q(MsPortalFx.require("MsPortalImpl/Services/Services.FileUploadSettings")).then((e=>e.fileUploadResumableTrackerInstance()))));let o=!1;t.init=function(e){o||(o=!0,t.uploadSettingsManager=e,Q(e.querySettings({store:10})).then((t=>{!MsPortalFx.isEmpty(t)&&i().then((t=>t.init(e)))})))}})),
define("MsPortalImpl/Services/Services.GitHub",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchGitHubAccountInfo=void 0;var s=MsPortalFx.Base.Diagnostics.Telemetry;let i;t.fetchGitHubAccountInfo=async function(e){if(i)return i;const t=s.start({source:"Services.GitHub",action:"FetchGitHubAccountInfo"});try{i=await fetch(`https://api.github.com/user/${e}`).then((e=>e.json())),s.completeTrace(t)}catch(e){s.cancelTrace(t,{error:e})}return i}})),
define("MsPortalImpl/Services/Services.HatsSettings",["require","exports","Fx/DependencyInjection","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.SettingsProcessor"],(function(e,t,s,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HatsSettings=t.HatsSettingsManager=void 0;class n extends o.SettingsProcessor{static create(e){return o.create(n,e,new r,18,!0)}}__decorate([__metadata("fx:diagnostics",[e,"HatsSettingsManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[i.SettingsManager]),__metadata("design:returntype",Promise)],n,"create",null),t.HatsSettingsManager=n;class r{constructor(){this.hatsExtensions=ko.observable("")}static create(e){return e.value}addExtensionCounts(e){if(!e.length)return;const t=JSON.parse(this.hatsExtensions()||"{}");e.forEach((e=>{var s;const i=(null!==(s=t[e.extension])&&void 0!==s?s:0)+e.count;t[e.extension]=i})),this.hatsExtensions(JSON.stringify(t))}getHatsExtensionsList(){const e=JSON.parse(this.hatsExtensions()||"{}"),t=function(e){return Object.keys(e).map((t=>{var s;return null!==(s=e[t])&&void 0!==s?s:0})).reduce(((e,t)=>e+t),0)}(e);return Object.keys(e).map((s=>{const i=e[s];return{bladeLoadCount:i,extension:s,extensionWeight:(o=t,n=i,Number((n/o).toFixed(5))),totalBladeLoadCount:t};var o,n}))}}__decorate([__metadata("fx:diagnostics",[e,"HatsSettings"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[n]),__metadata("design:returntype",r)],r,"create",null),t.HatsSettings=r})),
define("MsPortalImpl/Services/Services.ProjectedDirectories",["require","exports","Fx/DependencyInjection","MsPortalImpl/UI/UI.AuthStateManager","Fx/ResourceManagement","Fx/Ajax","FxHubs/ArmHelpers/ArmApisStartup","MsPortalImpl/Services/Services.Tenants","FxHubs/RpcEndPoints","FxHubs/HubsSettingsSchema","MsPortalImpl/Services/Services.Settings","FxInternal/AsyncLoader","Fx"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resetState=t.getDirectoriesMapHandler=t.getSubscriptionsForSelectedDirectoriesHandler=t.ServicesProjectedDirectories=void 0;var m=MsPortalFx.Base.Diagnostics.Telemetry;const g=d.Keys.directoriesSelected,h="Services.ProjectedDirectories",f=(0,u.memoizePromise)((e=>e.getTenants().then((e=>{const t=e.tenants||[],s=FxImpl.lowerCaseStringMap(),i=[];t.forEach((e=>{const{id:t,displayName:o,tenantCategory:n}=e;s.set(t,e),!o&&n.toLowerCase().includes("projectedby")&&i.push(t)}));const o=i.length;if(o){const e=m.start({source:h,action:"_getDirectoriesMapMemo"}),t=[],a=(0,r.listTenantsApi)();for(let e=0;e<o;e=Math.min(o,e+10)){const s=i.slice(e,e+10),o=(0,n.batch)({uri:`${a}&$filter=tenantId in ('${s.join("','")}')`,setTelemetryHeader:h+".getDirectoryNames"}).then((e=>{if(-1===[200,202,201,204].indexOf(e.httpStatusCode))throw FxImpl.Azure.buildSimplifiedError(e.content);return e.content}));t.push(Q(o))}return Q.allSettled(t).then((t=>{let o=!1,n=0;return t.forEach((e=>{e&&"fulfilled"===e.state&&e.value?(e.value.value||[]).forEach((({tenantId:e,displayName:t})=>{t&&(n++,s.get(e).displayName=t)})):o=!0})),m.completeTrace(e,{directoriesToResolve:i.length,directoriesResolved:n,hasErrors:o}),s})).catch((t=>{throw m.cancelTrace(e,{directoriesToResolve:i.length}),t}))}return s}))));let x=class{constructor(e,t,s){this._tenantsService=e,this._settingsManager=t;const i=this._selectedDirectoriesInSession=ko.observable([]),o=s.getCurrentUser().tenantId;!o&&m.trace({source:h,action:"constructor",name:"CurrentUserDirectoryIdIsUndefined"});const n=(o||"").toLowerCase(),r=this._defaultSelectedDirectories=[n];this._initPromise=Q(t.querySetting(6,g).then((e=>{const t=e&&e.toLowerCase().split(";"),s=t&&t.length?t:r;i(s)}))),this._hasProjectedDirectories=Q.spread([e.getTenants(),this._initPromise],(e=>{const t={};let s=!1;e.tenants.forEach((e=>{const i=e.id.toLowerCase(),o=i!==n,r=e.tenantCategory.toLowerCase().includes("projectedby");s=s||o&&r,o&&!r||(t[i]=!0)}));const o=i(),r=o.filter((e=>t[e]));return r.length!==o.length&&this.setSelectedDirectoriesInSession(r),s})),f(e)}hasProjectedDirectories(){return this._initPromise.then((()=>this._hasProjectedDirectories))}setSelectedDirectoriesInSession(e){return this._initPromise.then((()=>{const t=e&&e.length?e.map((e=>(!e&&m.trace({source:h,action:"setSelectedDirectoriesInSession",name:"DirectoryIdIsUndefined"}),(e||"").toLowerCase()))):this._defaultSelectedDirectories;return this._selectedDirectoriesInSession(t),this._settingsManager.setSetting(6,g,t.join(";"))}))}getSelectedDirectoriesInSession(){return this._initPromise.then((()=>this._selectedDirectoriesInSession))}getSubscriptionsForSelectedDirectories(e){return this._initPromise.then((()=>{e=e||[];const t=this._selectedDirectoriesInSession();return e.filter((({tenantId:e,subscriptionId:s})=>(!e&&m.trace({source:h,action:"getSubscriptionsForSelectedDirectories",name:"SubHasNoTenant",data:s}),t.includes((e||"").toLowerCase()))))}))}getDirectoriesMap(){return Q.spread([f(this._tenantsService),this._initPromise],(e=>e))}getDirectoryByResourceId(e){const t=o.ArmId.parse(e,!0);return t.subscription?Q.spread([MsPortalFx.Azure.getSubscriptionInfo(t.subscription),f(this._tenantsService),this._initPromise],((e,t)=>{const s=e&&e.tenantId;return s?t.get((s||"").toLowerCase())||{id:s,displayName:"",domainName:"",tenantCategory:""}:null})):Q(null)}};x=__decorate([__metadata("fx:diagnostics",[e,"ServicesProjectedDirectories"]),s.Class(),__metadata("design:paramtypes",[a.TenantsService,c.SettingsManager,i.AuthStateManager])],x),t.ServicesProjectedDirectories=x,t.getSubscriptionsForSelectedDirectoriesHandler=(0,p.defineHandler)(l.Directories.getSubscriptionsForSelectedDirectoriesEndPoint,(e=>e.diContainer.get(x).getSubscriptionsForSelectedDirectories(e.messageArg))),t.getDirectoriesMapHandler=(0,p.defineHandler)(l.Directories.getDirectoriesMapEndPoint,(e=>e.diContainer.get(x).getDirectoriesMap().then((e=>{const t={};return e.forEach(((e,s)=>{t[s]=e})),t}))))})),
define("MsPortalImpl/Services/Services.SharedSettings",["require","exports","FxInternal/AsyncLoader"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSharedSettings=void 0;const i=window.fx.environment.links;t.getSharedSettings=s.defineHandler(FxImpl.Extension.getSharedSettingsEndPoint,(e=>({links:{accountPortal:i.accountPortal,classicPortal:i.classicPortal,createSupportRequest:i.createSupportRequest,helpAndSupport:i.helpAndSupport,manageSupportRequests:i.manageSupportRequests,submitAnIdea:i.submitAnIdea,privacyAndTerms:i.privacyAndTerms,privacyStatement:i.privacyStatement,promotionalCommunicationsManager:i.promotionalCommunicationsManager,learnRelatedResources:i.learnRelatedResources,resourceGroupOverview:i.resourceGroupOverview,roadmap:i.roadmap,filteringGranularity:i.filteringGranularity}})))})),
define("MsPortalImpl/Services/Services.ShellProvisioner",["require","exports","Fx/Composition/Selectable","MsPortalImpl/UI/UI.BladeOpener","MsPortalImpl/UI/UI.JourneyManager"],(function(e,t,s,i,o){"use strict";var n;return function(t){var n=FxImpl.ViewModels.ParameterCollectionV3,r=MsPortalFx.Base.Diagnostics;t.promiseCleanupDelay=3e4;const a=r.createLog(e);let l;t.create=function(e){return l||(l=new d(e,e.get(o.JourneyManager),e.get(FxImpl.Rpc.Client)))};class d{constructor(e,t,s){this._diContainer=e,this._journeyManager=t,this.provisioningPromisesLookup={},this._registerRpcCallbacks(s)}processProvisioningRequest(e){let t=!0;const o="Provisioning request is ";if(!e)throw new Error(`${o}undefined.`);if(!e.provisioningRefKey)throw new Error(`${o}missing the provisioningReferenceKey.`);if(!e.provisioningPromise)throw new Error(`${o}missing the provisioningPromise.`);e.provisioningPromise.catch((e=>{const t=(e||{}).error||e;this._logWarning("Provisioning promise rejected. "+(t.message||JSON.stringify(t)))}));const n=e.provisioningConfig;n&&n.dontDiscardJourney&&(t=!1);const r=n&&n.launchPostCreate&&n.postProvisioningBladeInputs;if(r&&r.then((e=>{var t;const o=new s.PdlBladeReference("DeploymentDetailsBlade","HubsExtension",{parameters:{id:e.deploymentId,packageId:e.galleryItemId,packageIconUri:e.galleryItemIconUri,assetTypeId:e.assetTypeId,primaryResourceId:e.primaryResourceId,provisioningHash:e.provisioningHash,createBlade:e.createBlade}}),n=(null===(t=e.createBlade)||void 0===t?void 0:t.telemetryId)||"";this._diContainer.get(i.BladeOpener).openBlade(o,{flags:8,telemetryName:"ShellProvisioner"+(n?`_${n}`:"")})})),t&&!r){const e=this._journeyManager.activeJourney();e&&this._journeyManager.forceDiscardJourney(e.id)}return e.provisioningPromise}_registerRpcCallbacks(e){n.initiateProvisioningRequestEndPoint.registerObjectFactory(e,{allowedOrigin:null,allowRemoteChanges:!0,handler:(t,s)=>{const i=s.srcWindowId,o="Can't initiate the provisioning request. ";return t.provisionerId?t.provisioningRefKey?(n.getProvisioningRequestEndPoint.acquireObject(e,i,t).then((e=>{this.processProvisioningRequest(e.value).finally((()=>{e.dispose()}))}),(e=>{throw new Error(e)})),Q(t)):Q.reject(o+"provisioningRefKey unspecified."):Q.reject(o+"provisionerId unspecified.")}}),n.getProvisioningOperationEndPoint.registerObjectFactory(e,{allowedOrigin:null,allowRemoteChanges:!0,handler:e=>{if(!e)return Q.reject("Can't return provisioning operation. provisioningRefKey unspecified.");const t=this.provisioningPromisesLookup[e],s=t&&t.promise;return s&&(this.provisioningPromisesLookup[e].wasAcquired=!0),Q({provisioningPromise:s,data:t&&t.data})}})}_logWarning(e){a.warning(e)}}t.ShellProvisionerImpl=d}(n||(n={})),n})),
define("MsPortalImpl/Services/Services.TelemetrySharing",["require","exports","Fx/DependencyInjection","MsPortalImpl/Extension/ExtensionManager"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingTelemetryProcessor=void 0;var o=MsPortalFx.Base.Constants,n=FxImpl.Rpc;let r=class{constructor(e,t){this._extensionManager=e,this._extensions={},t.registerRpcEndPoint(o.TelemetrySharing.RegisterExtension,{allowedOrigin:null,handler:()=>{this._extensions[n.getMessageContext().srcWindowId]=!0}})}registerExtensionUnloadCallback(){this._extensionManager.onUnload((e=>{const t=e;return this._extensions[t]&&delete this._extensions[t],!0}))}trace(e){const t=e.extension,s=e.data&&e.data.srcExtension,i=o.TelemetrySharing.TraceTelemetry;"Ajax"!==e.action&&(this._extensions[t]&&n.client.invokeRpc(i,t,e),t!==s&&this._extensions[s]&&n.client.invokeRpc(i,s,e))}flush(){return Q()}};r=__decorate([__metadata("fx:diagnostics",[e,"SharingTelemetryProcessor"]),s.Class(),__metadata("design:paramtypes",[i.ExtensionManager,n.Client])],r),t.SharingTelemetryProcessor=r})),
define("MsPortalImpl/Services/Services.Util",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.redactSensitiveData=t.registerEndpoints=void 0;var s=FxImpl.Constants.RpcMethods,i=MsPortalFx.Base.Constants.ExtensionNames;function o(t,s,i,o,n,r){return o.registerRpcEndPoint(t,{allowedOrigin:r,handler:(t,o)=>Q(MsPortalFx.require(e.normalize(s))).then((e=>(0,e[i])(t,o,o.ltm,n)))})}t.registerEndpoints=function(e,t){const n="./Services.UtilHandlers";o(s.pinParts,n,"pinPartsRpcHandler",e,t),o(s.getClientIp,n,"getClientIpHandler",e),o(s.getHmacSha256,n,"hmacShaRpcHandler",e),o("MsPortalFx.Internal.Constants.RpcMethods.X509Certificate.getX509Certificates",n,"x509CertificateRpcHandler",e),o("MsPortalFx.Internal.Constants.RpcMethods.PublishingProfile.getPublishingProfile",n,"getPublishingProfileRpcHandler",e,null,[`${i.ClassicResources}`,"fx"])},t.redactSensitiveData=function(e){const t=(e=e||"").toLowerCase();return["password","pwd","azure_storage_access_key","sharedkey"].some((e=>t.includes(e)))?"_REDACTED_SENSITIVE_DATA_":MsPortalFx.sanitizeMessage(e)}})),
define("MsPortalImpl/UI/Compositions/UI.Composition.DynamicPartBinder",["require","exports","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.Finder","MsPortalImpl/UI/Compositions/UI.Composition.Part","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding"],(function(e,t,s,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.listenForConfigurationChanges=t.getConfigurableInputsMetadata=t.inferInitialBindingsForInputDefinitions=void 0;var r=MsPortalFx.Base.Constants.BladeParameterNames,a=MsPortalFx.Base.Diagnostics,l=MsPortalFx.ViewModels.Internal,d=MsPortalFx.remove,c=MsPortalFx.deepEquals;const p=a.createLog(e);function u(e){if(e.adapter){const t=g(e),s={};return h(e,!1).forEach((e=>{let i;const o=e.compositionBindingDefinition,n=o&&o.source;if(n&&9===n.modelType){const e=n.property;i=t[e]}i||(i={bindingSources:[],activeBindingSourceName:null}),s[e.targetProperty]=i})),s}return g(e)}function m(e,t){const s=e,i=e,n=i.targetProperty||s.name,r=!!e.optional;if(!t){const e=i.source&&i.source.property||s.name;t=(0,o.createOverridesOrContainerModelSourceReference)(e)}return{targetProperty:n,optional:r,source:t,isDynamicBinding:!0}}function g(e){const t=e.diContainer.get(i.Finder),s=e.parent&&t.findPartsContainer(e),o=e.adapter?e.adapter.inputDefinitions:e.partDefinition.inputDefinitions,r=e.overridesModel,a={};return h(e).forEach((e=>{const t=e.targetProperty,i=(e=>{let t;if(o&&s&&s.getCompatibleSourceReferences){const i=MsPortalFx.find(o,(t=>t.name===e));i&&(t=s.getCompatibleSourceReferences(i))}return(t||[]).map((e=>({sourceReference:e,name:e.property,acceptsValueUpdates:!1})))})(t),l=e.compositionBindingDefinition,d=l&&l.source,c=!(e=>{if(!e||(0,n.isDynamicBindingWithNonLocalSource)(e))return!1;{const t=e.source&&e.source.property;return r&&t&&(0,n.getModelValue)(r,t).exists}})(l)&&d&&MsPortalFx.find(i,(e=>{const t=e.sourceReference;return t.modelType===d.modelType&&t.property===d.property}));a[t]={bindingSources:i,activeBindingSourceName:c&&c.name}})),a}function h(e,t=!0){return e.getNonDetailsContainerPropertyBindings(t).filter((e=>{const t=e.targetProperty;return!l.isBladeCallerInput(t)&&t!==r.EditScopeId}))}t.inferInitialBindingsForInputDefinitions=function(e,t){const s=e.diContainer.get(i.Finder),o=e.parent&&s.findPartsContainer(e);t=t||[];const r=e.overridesModel,a=[];return t.forEach((e=>{const t=e.name;let s;s=(0,n.getModelValue)(r,t).exists?null:(e=>{if(o&&o.getCompatibleSourceReferences){const t=o.getCompatibleSourceReferences(e);return t&&t[0]}})(e),a.push(m(e,s))})),a},t.getConfigurableInputsMetadata=u,t.listenForConfigurationChanges=function(e,t,i){e.getViewModel().internal.updateConfigFn((function(r,a){let l;t&&s.CompositionBinder.turnOnInputsSetSuppressionOn(t),s.CompositionBinder.turnOnInputsSetSuppressionOn(i);try{const{inputs:g,settings:h,inputsMetadata:f}=r,x=e.getSettingsModel(),b=e.partDefinition&&e.partDefinition.partState,v=b?(b.inputIdentityProperties||[]).concat((b.sharedProperties||[]).map((e=>e.property))):[],y=Object.keys(h);let M;v.forEach((e=>{const t=ko.unwrap((0,n.getModelValue)(x,e).value),s=e.startsWith("content.")?e.slice(8):e,i=ko.toJS((0,n.getModelValue)(h,s).value);c(i,t)||((0,n.setModelValue)(x,e,i),l=!0),MsPortalFx.remove(y,s)}));const I=u(e);Object.keys(I).forEach((t=>{const i=I[t],o=f[t],r=g[t];(function(e,t,i,o,r){const a=o&&MsPortalFx.find(i.bindingSources,(e=>e.name===o));if(o&&!a)return void p.error("Source with name '{0}' for configurable Part input named '{1}' does not exist at the Dashboard/Blade-level.".format(o,t));const l=e.getInputPropertyBindings(),u=MsPortalFx.find(l.properties,(e=>e.targetProperty===t));let g,h,f;if(a){const e=i.activeBindingSourceName;a.name!==e&&(g=!0)}else{const e=ko.unwrap((0,n.getModelValue)(u.targetModel,u.targetProperty).value);c(ko.toJS(r),e)||(h=!0)}if(!g&&!h)return!1;if(e.adapter){const s=MsPortalFx.find(e.bindings,(e=>e.targetProperty===t)),i=s&&s.source,o=i&&9===i.modelType&&i.property;if(!o)return p.error("For Adapted Part '{0}', input named '{1}' to the inner Part is not configurable.  Presently, only those inner Part inputs using the 'AdapterInput' binding are configurable.".format(e.toString(),t)),!1;f=o}else f=t;const x=e.adapter?e.adapter.inputPropertyBindings:e.getInputPropertyBindings(),b=MsPortalFx.find(x.properties,(e=>e.targetProperty===f)),v=b.compositionBindingDefinition,y=e.overridesModel;let M;if(g){const t=e.adapter?e.adapter.inputDefinitions:e.partDefinition.inputDefinitions;M=m(MsPortalFx.find(t,(e=>e.name===f)),a.sourceReference)}h&&((0,n.setModelValue)(y,b.sourceProperty,ko.toJS(r)),M=m(v));if(M){x.removeProperty(b);const t=e.adapter?e.adapter.bindings:e.bindings;d(t,v),s.CompositionBinder.setupPropertyBindings(e.diContainer,e,x,[M],(t=>e.bindAgainstOverridesOrContainerModel(t))),t.push(M),e.adapter&&(l.removeProperty(u),s.CompositionBinder.setupPropertyBindings(e.diContainer,e,l,u&&[u.compositionBindingDefinition],(t=>e.bindAdaptedInput(t))))}return!0})(e,t,i,o.activeBindingSourceName,r)&&(M=!0)})),M&&(e.widgetState.valueHasMutated(),function(e,t){const s=e.widget;s&&s.element.trigger(o.fxpartinputchanged,{part:e,isUserInteraction:t})}(e,e.hasUserInteractedRecently()),e.save())}finally{const e=(l?2:1)|(a?0:4);return Q.all([t&&s.CompositionBinder.turnOnInputsSetSuppressionOff(t,e,!0)||Q(),s.CompositionBinder.turnOnInputsSetSuppressionOff(i,e,!0)])}}))}})),
define("MsPortalImpl/UI/Compositions/UI.Composition.SelectableRegistration",["require","exports","MsPortalImpl/ViewModels/ViewModels.BladeCaller"],(function(e,t,s){"use strict";var i;return function(e){const t="internal.registeredSelectables",i="internal.registeredSelectableOptions";e.listenForRegistrationChanges=function(e,o,n){const r=o.internal,a=ko.observableArray([]);a.map(e,((e,o)=>{ko.ignoreDependencies((()=>{!function(e,o,n,r){const a=r.getBladeOpener(),l={invocationInputArguments:[{valuesFrom:[{referenceType:0,property:t+"."+o}]}]},d=ko.unwrap(n.registeredSelectableOptions);if(d){const e=d[o];e&&(e.parameterCollector&&s.addCallerBindings(`${i}.${o}.parameterCollector.bladeCaller`,l,0),l.openInContextPane=e.openInContextPane,l.persistentContextPane=e.persistentContextPane)}a.registerInvocationProperty(l,null,e)}(e,o,r,n)}))})),ko.computed(e,r.registeredSelectables,((e={})=>{a.splice.apply(a,[0,a.peek().length].concat(Object.keys(e)))})).extend({deferred:!0})}}(i||(i={})),i})),
define("MsPortalImpl/UI/Hubs/UI.NotificationsPane",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ViewModel=void 0;t.ViewModel=class{constructor(e){this.diContainer=e,this.lastPaneOpenedTime=ko.observable(Date.now()),this.isPaneOpen=ko.observable(!1)}}})),
define("MsPortalImpl/UI/Hubs/ViewModels/UI.Browse.ViewModelRegistration",["require","exports","MsPortalImpl/Extension/ViewModelManager"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerViewModels=void 0;t.registerViewModels=function(e){(0,s.registerWithDi)("BrowseAllBlade$ServicesListPartViewModel","ServicesListPartViewModel","MsPortalImpl/UI/Hubs/ViewModels/UI.BrowseAll.Part")}})),
define("MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.ViewModelRegistration",["require","exports","MsPortalImpl/Extension/ViewModelManager","FxInternal/Composition/Part"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerViewModels=void 0;t.registerViewModels=function(e){const t=s.registerWithState,o="./MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.DiagnosticsPart";t("HelpAndSupportBlade$DiagnosticsPartViewModel",o,(t=>(0,i.composePartViewModel)((s=>new t.DiagnosticsPartViewModel(s,e)),{logArea:o})))}})),
define("MsPortalImpl/UI/UI.AdvisorNotificationHelper",["require","exports","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.BrowserSettings","MsPortalImpl/Base/Languages","MsPortalImpl/Resources/PortalNotificationsTelemetry"],(function(e,t,s,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEV=t.showAdvisorNotification=t.shouldShowAdvisorNotification=t.percentageOfUsersShownAdvisorNotification=void 0;var r=n.Source,a=n.Action,l=n.ActionModifier;const d=window,c=s.AdvisorNotification,p=24*(parseInt(MsPortalFx.getFeatureValue("advisornotificationdays"))||30)*3600*1e3;t.percentageOfUsersShownAdvisorNotification=parseFloat(MsPortalFx.getFeatureValue("advisornotificationpercent"))/100;let u=(0,i.hideSmallModals)(),m=MsPortalFx.isFeatureEnabled("hideadvisormodals"),g=MsPortalFx.isFeatureEnabled("ci"),h=FxImpl.features.isNativePerf,f=MsPortalFx.isFeatureEnabled("testadvisor");function x(){return f||!u&&!m&&t.percentageOfUsersShownAdvisorNotification>0&&!g&&!h}t.shouldShowAdvisorNotification=x,t.showAdvisorNotification=function(e){if(!x())return Q(!1);const i=Date.now()-p,n=MsPortalFx.Base.Resources.getVersionlessContentUri("Content/static/MsPortalImpl/AdvisorNotifications/AdvisorDashboard_"+o.getCultureSpecificLanguage().split("-").join("")+".svg");return Q(e.querySetting(13,"AdvisorNotification").then((o=>{if(f||(o||0)<i&&Math.random()<t.percentageOfUsersShownAdvisorNotification){FxImpl.Hubs.Notifications.InternalClientNotification.internalPublish({notificationId:"AdvisorModal",timestamp:new Date,modalNotificationData:{image:{imageUrl:MsPortalFx.encodeAttribute(n)}},title:c.title,description:`<h1>${MsPortalFx.encodeHtml(c.description)}&nbsp;<a aria-label='${s.AdvisorNotification.helpTextAriaLabel}' class='msportalfx-ext-link' href='${MsPortalFx.encodeAttribute(d.fx.environment.links.learnAdvisor)}' target="_blank">${MsPortalFx.encodeHtml(s.AdvisorNotification.helpText)}</a></h1>`,status:MsPortalFx.Hubs.Notifications.NotificationStatus.Information,descriptionAsHtml:!0,toastDuration:4,inlineForm:{buttons:[{label:c.buttonText,id:"LaunchAdvisorBladeButton",deepLink:{uri:"#blade/Microsoft_Azure_Expert/AdvisorMenuBlade"}}]}});const u=Date.now();return e.setSetting(13,"AdvisorNotification",u),MsPortalFx.Base.Diagnostics.Telemetry.trace({source:r.ToastTray,action:a.AdvisorNotificationShown,actionModifier:l.NotificationShown,data:{advisorNotificationOccurence:p,percentageOfUsersShownAdvisorNotification:t.percentageOfUsersShownAdvisorNotification,testAdvisorFlag:f,timeElapsedInMs:i,advisorLastShown:o,advisorShownTime:u}}),!0}return!1})))}})),
define("MsPortalImpl/UI/UI.DirectoryHelper",["require","exports","Fx/DependencyInjection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.FavoritesSettings","MsPortalImpl/Services/Services.Tenants","MsPortalImpl/UI/UI.AuthStateManager"],(function(e,t,s,i,o,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SaveDirectorySettingsHandler=void 0;var a=MsPortalFx.Hubs.Notifications;let l=class{constructor(e,t){this._diContainer=e,this._authStateManager=t}async saveDirectorySettings(){const e=await this._diContainer.getAsync(o.UserDirectorySettings),t=e.userDefaultDirectory,s=t()||{},r=(("string"==typeof s?s:s.id)||"").toLowerCase();let l="";const[d,c]=await Promise.all([this._authStateManager.getUserInfo(),this._diContainer.get(n.TenantsService).getHomeTenants()]);l=(d.directoryId||"").toLowerCase();const p=MsPortalFx.find(c,(e=>e.id.toLowerCase()===r)),u=e.signInToLastVisitedDirectory;let m;!1===u()?p||(l&&a.ClientNotification.publish({title:i.defaultDirectoryNotFoundTitle,description:i.defaultDirectoryNotFoundDescription.format(d.domainName),status:a.NotificationStatus.Warning,uri:"#menu/directory"}),u(!0)):u(!0),m=u()?{id:d.directoryId,displayName:d.directoryName,domainName:d.domainName}:{id:p.id,displayName:p.displayName,domainName:p.domainName};const g=MsPortalImpl.sessionStorage.getItem("usedTenantHint");if(g&&(MsPortalImpl.sessionStorage.removeItem("usedTenantHint"),MsPortalFx.Base.Diagnostics.Telemetry.trace({source:"UI.DirectoryHelper",action:"TenantHintUsage",actionModifier:"complete",data:{tenantHint:g,loggedInTenantId:d.directoryId,loggedInTenant:d.domainName}})),m.id){t(m);const e=!this._authStateManager.bootstrapState.user.isOrgId;MsPortalFx.isFeatureEnabled("usetenanthint")&&e?MsPortalImpl.localStorage.setItem("tenantHint",m.domainName):MsPortalImpl.localStorage.removeItem("tenantHint")}}};l=__decorate([__metadata("fx:diagnostics",[e,"SaveDirectorySettingsHandler"]),s.Class(),__metadata("design:paramtypes",[s.Container,r.AuthStateManager])],l),t.SaveDirectorySettingsHandler=l})),
define("MsPortalImpl/UI/UI.NpsHelper",["require","exports","FxInternal/Experimentation","MsPortalImpl/Resources/PortalNotificationsTelemetry"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setTestValues=t.shouldShowPortalNps=t.showPortalNps=t.showNps=t.npsShownInSession=void 0;var o=MsPortalFx.Base.Diagnostics.Telemetry.trace,n=i.Source,r=i.Action,a=i.ActionModifier;let l=MsPortalFx.isFeatureEnabled("testnps"),d=MsPortalFx.isFeatureEnabled("nps");const c=MsPortalFx.isFeatureEnabled("ci");let p=(parseFloat(MsPortalFx.getFeatureValue("npspercent"))||1)/100;const u=24*(parseInt(MsPortalFx.getFeatureValue("npsintervaldays"))||90)*3600*1e3;let m=!1;function g(e){return m=e,m}async function h(e,i,p,u,m,g,h,f){if(l||!c&&d&&!t.npsShownInSession){let l;f&&(l=await f.get(s.ExperimentationManager).getAssignments()),await MsPortalFx.require("MsPortalImpl/Widgets/Widgets.Nps").then((s=>{o({source:n.ToastTray,action:r.NPSShown,actionModifier:a.NotificationShown,data:MsPortalFx.extend({productId:m},g)}),s.showSurvey(e,i,p,u,m,h,f,null==l?void 0:l.getNumberValue("npshatsexp")),t.npsShownInSession=!0}))}}t.npsShownInSession=!1,t.showNps=h,t.showPortalNps=async function(e,t,s,i,o){if(m)return m=!1,h(e,t,s,null,null,{surveyLastCompleted:i()},(()=>{i(Date.now())}),o)},t.shouldShowPortalNps=function(e){return g(!!l||!(!d||c)&&(e()<Date.now()-u&&Math.random()<p))}})),
define("MsPortalImpl/UI/UI.SessionHandlerDeferred",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateSessionLifetime=void 0;var s=MsPortalFx.Base,i=s.Diagnostics.Telemetry;const o=window,n=o.document,r=FxImpl.trustedParentOrigin.toLowerCase();let a=0,l=!0;t.validateSessionLifetime=function(e,t,d,c){if(!l)return Q(!1);const p=Date.now();if(p-a<3e5)return Q(!0);a=p;const u=i.startTrace({source:"Shell",action:c});let m=FxImpl.createElement("iframe");m.classList.add("fxs-extension-frame"),m.setAttribute("tab-index","-1"),m.setAttribute("aria-hidden","true"),m.src=s.Resources.getAppRelativeUri(`/signin/validateSession/@${t}/?sid=${e.aadSessionId||""}`);const g=n.body;g.appendChild(m);const h=Q.defer();let f=e=>{if(e.origin.toLowerCase()===r){const t=e.data||{};"ValidateSession"===t.signature&&(l=!1!==t.valid,x(l,l?"SessionValid":"SessionExpired"),l||d.onStatus({code:7},"fx"))}};const x=(e,t)=>{h.promise.isPending()&&(h.resolve(e),i.endTrace(u,t)),m&&(g.removeChild(m),m=null),f&&(o.removeEventListener("message",f,!1),f=null)};return Q.delay(3e5).then((()=>{x(!0,"ErrorValidatingSession")})),o.addEventListener("message",f,!1),h.promise}})),
define("MsPortalImpl/UI/UI.SessionHandler",["require","exports","MsPortalImpl/UI/UI.SessionHandlerDeferred","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/Resources/SessionHandlerResources","Fx"],(function(e,t,s,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setTestValues=t.initialize=void 0;const r="SessionHandlerTimedSignout",a=window,l=MsPortalFx.Base.Diagnostics.createLog(e),d=parseInt((0,n.getFeatureValue)("sessionpollinterval"))||36e5;let c;const p=(0,n.memoizePromise)((()=>{const e=a.fx.environment.links.graphPoliciesEndpoint;return e?Q(MsPortalFx.Base.Net2.ajax({uri:e,setAuthorizationHeader:{resourceName:"graph"}})).then((e=>(e.value||[]).some((e=>"tokenlifetimepolicy"===(e.type||"").toLowerCase()&&(e.definition||[]).some((e=>(e||"").toLowerCase().includes("maxagesession"))))))).catch((e=>{const t=(e.jqXHR||{}).status;return 401===t||403===t||(0===t?(p.clear(),!1):(p.clear(),l.verbose("Error calling graph for policy details",0,e),!0))})):Q(!0)}));function u(e,t,s,a,l){let d,c=!1;return a.addCallbacks({onBusy:()=>{d=void 0},onIdle:p=>{const u=ko.unwrap(s),m=t&&u?Math.min(t,u):Math.max(t,u);m&&p>=m?(MsPortalFx.Base.Diagnostics.Telemetry.trace({source:r,action:"TimedSignout",data:{signedOutTime:Date.now(),idleTime:p,userSetting:u,tokenTimeout:t}}),d&&MsPortalFx.Base.Diagnostics.Telemetry.endTrace(d,"InactiveUserSignout",{signedOutTime:Date.now(),idleTime:p,userSetting:u,tokenTimeout:t}),l()):(0,n.isFeatureEnabled)("logouttimerpopup")&&m&&p+1===m&&!c&&e.getAsync(i.DialogManager).then((e=>{d=MsPortalFx.Base.Diagnostics.Telemetry.startTrace({source:r,action:"SessionInactivtyTimeoutPrompt",data:{idleTime:p,userSetting:u,tokenTimeout:t}}),c=!0;const{DialogResult:s}=MsPortalFx.ViewModels.Dialogs;e.showModalDialog({description:o.TimeoutDialog.description,title:o.TimeoutDialog.title,buttons:2,cancelButtonText:o.TimeoutDialog.cancelButton,defaultButtonText:o.TimeoutDialog.acceptButton}).then((e=>{switch(c=!1,e){case 1:MsPortalFx.Base.Diagnostics.Telemetry.cancelTrace(d,{signedOutTime:Date.now(),idleTime:p,userSetting:u,tokenTimeout:t}),l();break;case 4:MsPortalFx.Base.Diagnostics.Telemetry.completeTrace(d,{idleTime:p,userSetting:u,tokenTimeout:t}),a.signalBusy()}}))}))}})}t.initialize=function(e,t,i,o,r,a,l,m){const g=i.bootstrapState.idleTimeoutSeconds/60;if(g?c=u(e,g,o,r,a):o.subscribeAndRun(t,(t=>{t&&!c?c=u(e,0,o,r,a):t||g||!c||(r.removeCallbacks(c),c=null)})),(0,n.isFeatureEnabled)("sessionvalidity")){const e=()=>Q.delay(d).then((()=>{p().then((t=>{t&&s.validateSessionLifetime(i.bootstrapState,l,m,"SessionValidityPoll").then((t=>{t&&e()}))}))}));e()}}})),
define("_generated/Less/MsPortalImpl/UI/UI.Portal.Actions.css",["module"],(function(e){"use strict";return{css:".fxt-copy{display:flex;margin-top:5px}.fxt-copy-control{padding-left:10px}",moduleId:e.id}})),
define("MsPortalImpl/UI/UI.StatusHandler",["require","exports","Fx/DependencyInjection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/Services/Services.SecurityTokens","Fx/Composition","FxInternal/Css","_generated/Less/MsPortalImpl/UI/UI.Portal.Actions.css"],(function(e,t,s,i,o,n,r,a,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StatusHandler=t.errorUri=void 0,(0,d.injectCss)(c);var p=MsPortalFx.Base,u=p.Constants,m=p.Diagnostics,g=m.Telemetry,h=MsPortalFx.Hubs.Notifications,f=h.NotificationStatus;const x=window,b=x.document,v=m.createLog(e),y=u.Shell,M=i.Shell,I=M.Notifications,C=M.Dialogs,P=I.SessionEnding,w=I.TokenFailure,_=I.VersionChanged,S={sessionId:MsPortalFx.sessionId};t.errorUri=x.fx.internalEnv.portalApplicationUri+"/Error";const F=[12e5,6e5],k=x.fx.environment.links.aadErrorCodes;function T(e,t,s,i,o){g.trace({source:"Shell",action:"StatusHandlerShowNotification",name:y,data:{title:e,description:t,correlationId:s}}),h.ClientNotification.publish({title:e,description:t,status:i||f.Information,descriptionAsHtml:o,correlationIds:[s]})}let D=class{constructor(e,t,s,i,o){this._diContainer=e,this._dialogManager=t,this._rootElements=s,this._windowManager=i,this.isShellInitialized=Q.defer(),this._pageBlockingPrompt=!1,this._isDialogVisible=!1,this.isOfflineDialogVisible=!1,this._unknownNetworkErrorCount=0,this._unknownNetworkErrorCanceled=!1,o.sessionEndedHandler=(e,t)=>this.onLastTokenRefresh(e,t),o.tokenFailedHandler=(e,t,s)=>{this.onStatus({code:2,message:s,data:{resourceName:t}},e)},o.tokenMfaErrorHandler=(e,t,s)=>{this.onStatus({code:8,message:s,data:{resourceName:t}},e)},o.tokenClaimsErrorHandler=(e,t,s,i)=>{const o=Object.create(null);k&&(o.learnMoreText=C.learnMore,o.onClickLearnMore=new l.ClickableLink(k,"_blank",null,MsPortalFx.noop,"AadErrorCodes")),this.onStatus({code:9,data:{missingClaims:s,resourceName:t},message:i},e,o)},o.unauthorizedTokenHandler=(e,t,s)=>{this.onStatus({code:7},e)},window.onoffline=e=>{this.onOfflineEvent(e)},window.ononline=e=>{this.onOnlineEvent(e)}}onOfflineEvent(e){this._isDialogVisible||this.isOfflineDialogVisible||(this._showDialog({extensionName:y,telemetryAction:"OfflineEvent",messageTitle:C.connectionErrorMessageTitle,messageDescription:C.offlineEventMessageDescription,defaultButtonText:C.newVersionDefaultButtonText,cancelButtonText:C.connectionErrorCancelButtonText,delayMilliSeconds:0,buttons:2,actions:0,additionalDetails:{type:e.type}}),this.isOfflineDialogVisible=!0)}onOnlineEvent(e){this.isOfflineDialogVisible&&(this._dismissDialog(),this.isOfflineDialogVisible=!1,g.trace({source:"Shell",action:"OnlineEvent",name:y}))}onLastTokenRefresh(e,t){const s=Date.now();g.trace({source:"Shell",action:"OnLastTokenRefresh",name:y,data:{tokenExpiresAt:t}}),t<=s&&this.onStatus({code:2},e),g.trace({source:"Shell",action:"SessionEndWarning",name:y,data:{tokenExpiresAt:t}}),F.forEach((e=>{setTimeout((()=>{const t=Math.floor(e/6e4),s=t>10?P.messageFmt.format(t):P.message;T(P.title,s,"lastTokenRefresh")}),t-e-s)}))}async onStatus(e,s,i){var o,n,r;if(!e||this._pageBlockingPrompt)return;const a=s===y||"HubsExtension"===s,l=null!==(o=e.data)&&void 0!==o?o:{},d=null!==(n=l.uri)&&void 0!==n?n:"",c=null!==(r=e.message)&&void 0!==r?r:"";switch(e.code){case 0:return;case 1:return a?void await this._showDialog({extensionName:s,telemetryAction:"ShellVersionChanged",messageTitle:C.newVersionMessageTitle,messageDescription:C.newVersionMessageDescription,defaultButtonText:C.newVersionDefaultButtonText,delayMilliSeconds:3e4,buttons:2,actions:5,additionalDetails:l}):(g.trace({source:"Shell",action:"ExtensionVersionChanged",data:s}),v.warning(`Extension reporting incompatible server version. ${s}:${l.version}`),void T(_.title,_.messageFmt.format(s),`VersionChanged-${s}`));case 2:{const e=l.resourceName;if(e){let t=w.description.format(s);e&&(t+="\n"+w.resourceName.format(e)),c&&(t+="\n"+w.errorDetails.format(c)),T(w.title,t,`AuthTokenError-${s}`,f.Information)}else this._windowManager.redirect({uri:t.errorUri+"/UE_SessionExpired"+window.location.hash,redirectAction:3,reason:`authorizationExpired_Arm_${s}`});return}case 7:return void await this._showDialog({extensionName:y,telemetryAction:"SessionExpired",messageTitle:C.sessionExpired,messageDescription:C.sessionExpiredMessage,defaultButtonText:C.refresh,buttons:1,actions:2,additionalDetails:l});case 4:{if(v.verbose(`Received a status code zero from extension ${s} for URL '${d}'.`),!a)return;if(this._unknownNetworkErrorCount>3||this._isDialogVisible||this._unknownNetworkErrorCanceled)return;this._unknownNetworkErrorCount++;const e=await this._showDialog({extensionName:y,telemetryAction:"UnknownNetworkError",messageTitle:C.connectionErrorMessageTitle,messageDescription:C.connectionErrorMessageDescription,defaultButtonText:C.newVersionDefaultButtonText,cancelButtonText:C.connectionErrorCancelButtonText,buttons:2,actions:0,additionalDetails:l});return void(this._unknownNetworkErrorCanceled=1===e)}case 6:{let e=C.tooManyRequestsDescription;const t=l.retryAfter;return t&&(e=`${e} ${C.tooManyRequestsRetry.format(t)}`),void T(C.tooManyRequestsTitle,e,`TooManyRequests-${s}`,f.Warning,!0)}case 8:return void await this._showDialog({extensionName:s,telemetryAction:"MfaError",messageTitle:C.mfaError,messageDescription:e.message,defaultButtonText:C.signOutText,buttons:2,actions:2,additionalDetails:l});case 9:{const t=(l.missingClaims||"").toLowerCase().includes("capolids"),o=t?C.claimsErrorTitle:C.claimsErrorGenericTitle,n=(t?C.claimsErrorDescription:C.claimsErrorGenericDescription).format(`${s},${l.resourceName||"default"}`,k?'<a class="msportalfx-ext-link" href="" data-bind="text: learnMoreText, fxclick: onClickLearnMore"></a>':"");return void await this._showDialog({extensionName:s,telemetryAction:t?"ClaimsErrorCA":"ClaimsErrorGeneric",messageTitle:o,messageDescription:n,defaultButtonText:C.claimsErrorButtonText,cancelButtonText:C.connectionErrorCancelButtonText,buttons:2,actions:0,missingClaims:l.missingClaims,additionalDetails:MsPortalFx.extend2(l,{errorMessage:e.message}),templateViewModel:i})}default:{const t=`Received unknown extension event '${e.code}' for extension '${s}'.`;return v.error(t),Promise.reject(t)}}}async _showDialog(t){let s;const i=r.hasFlag(t.actions,2);let o;this._pageBlockingPrompt=r.hasFlag(t.actions,1),t.telemetryAction&&g.trace({source:"Shell",action:t.telemetryAction,name:t.extensionName,data:t.additionalDetails}),i&&(o=3);const n=(e,s)=>{this._windowManager.redirect({skipFlushBuffers:i,delayPromise:e&&t.delayMilliSeconds?Q.delay(t.delayMilliSeconds):null,redirectAction:o,reason:s})};if(r.hasFlag(t.actions,4)&&Q.isPending(this.isShellInitialized.promise))return s=Q.defer().promise,n(!1,"shouldSkipPrompt"),s;const a=Q.defer();this._isDialogVisible=!0;const l=await this._dialogManager.showModalDialog({title:t.messageTitle,description:t.messageDescription+'<div class="fxt-copy"><a href="#" data-bind="text: copyText, click: copyClick"></a></div>',templateViewModel:MsPortalFx.extend2(t.templateViewModel,{copyText:C.copyText,copyClick:()=>{const e=JSON.stringify(MsPortalFx.extend2(S,t.additionalDetails),null,2),s=FxImpl.createElement("pre");s.textContent=e,b.body.appendChild(s);const i=x.getSelection();i.removeAllRanges();const o=b.createRange();o.selectNodeContents(s),i.addRange(o),x.document.execCommand("copy"),s.remove()}}),defaultButtonText:t.defaultButtonText,cancelButtonText:t.cancelButtonText,buttons:t.buttons,uiShield:{hidePromise:a.promise}});if(!t.missingClaims)return this._pageBlockingPrompt?(this._rootElements.showSplash(!0),a.resolve(),n(!0,"isPageBlockingPrompt")):4===l?n(!1,"isNotPageBlockingPrompt_Ok"):a.resolve(),this._isDialogVisible=!1,s;{const s=await MsPortalFx.require(e.normalize("./UI.NavigationManager.ForceSignIn"));try{await s.forceSignIn(this._diContainer,{bladeDeepLink:window.location.hash,signInParameters:JSON.parse(t.missingClaims),reason:"MissingClaims"},y)}catch(e){g.trace({source:"UIStatusHandler",action:"ErrorForcingMfaSignIn",data:{error:MsPortalFx.sanitizeMessage(JSON.stringify(e))}})}}}_dismissDialog(){this._dialogManager.hasOpenDialog&&this._dialogManager.dismissOpenDialog(0),this._isDialogVisible=!1}};D=__decorate([__metadata("fx:diagnostics",[e,"StatusHandler"]),s.Class(),__metadata("design:paramtypes",[s.Container,o.DialogManager,n.RootElements,n.WindowManager,a.SecurityTokensManager])],D),t.StatusHandler=D})),
define("MsPortalImpl/UI/UI.Initialize",["require","exports","Fx","Fx/Diagnostics","Fx/DependencyInjection","Fx/Feedback","Fx/Telemetry","Fx/UriBuilder","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Services/Services.BrowserTelemetry","Fx/Composition/Selectable","FxInternal/Experimentation","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl.Controls/Controls/ResourceFilterHelper","FxInternal/AsyncLoader","MsPortalImpl/RpcEndPoints","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.Router","MsPortalImpl/Base/ClaimsIdentity","MsPortalImpl/Base/Languages","MsPortalImpl/Base/Themes","MsPortalImpl/Controls/ControlBindings.Async","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler","MsPortalImpl/Interactions/Interactions.PortalReader","MsPortalImpl/Interactions/Interactions.PrintHandler","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.BrowseCuration","MsPortalImpl/Services/Clarity","MsPortalImpl/Services/Services.HatsSettings","MsPortalImpl/Services/Services.FavoritesSettings","MsPortalImpl/Services/Services.FileUploadEndpointRegistration","MsPortalImpl/Services/Services.FileUploadInitialization","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/Services/Services.PortalIdleState","MsPortalImpl/Services/Services.PortalPollingManager","MsPortalImpl/Services/Services.SecurityTokens","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.Recents","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/Services/Services.ShellProvisioner","MsPortalImpl/Services/Services.Storage","MsPortalImpl/Services/Services.Subscriptions","MsPortalImpl/Services/Services.TelemetrySharing","MsPortalImpl/Services/Services.Tenants","MsPortalImpl/Services/Services.Util","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/Widgets/Widgets.Portal","MsPortalImpl/Widgets/Widgets.ToastViewModel","MsPortalImpl/UI/UI.BladeOpener","MsPortalImpl/UI/Compositions/UI.Composition.Services","MsPortalImpl/UI/UI.DirectoryHelper","MsPortalImpl/UI/Hubs/UI.FavoritesManager","MsPortalImpl/UI/Hubs/UI.NotificationHelper","MsPortalImpl/UI/Hubs/UI.NotificationManager","MsPortalImpl/Notifications/NotificationsArea","MsPortalImpl/UI/Hubs/UI.NotificationsPane","MsPortalImpl/UI/Hubs/ViewModels/UI.Browse.ViewModelRegistration","MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.ViewModelRegistration","MsPortalImpl/UI/UI.AdvisorNotificationHelper","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/UI.DesktopManagerImpl","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/UI/UI.NpsHelper","MsPortalImpl/UI/UI.SessionHandler","MsPortalImpl/UI/UI.StatusHandler","MsPortalImpl/Services/Services.ProjectedDirectories","MsPortalImpl/UI/Commands/Base.PortalFunctions","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/Notifications/PortalNotifications","MsPortalImpl/Widgets/Widgets.Portal.init","MsPortalImpl/Services/Services.BrowserSettings","MsPortalImpl/UI/UI.PassthroughUser","MsPortalImpl/Services/Services.GitHub","FxInternal/Notifications","FxInternal/Diagnostics","FxInternal/Events","MsPortalImpl/Base/Base.KnockoutExtensions","MsPortalImpl/Base/Base.KnockoutExtensions.FxClick","MsPortalImpl/Base/Base.KnockoutExtensions.Image","MsPortalImpl/Controls/ControlBindings","MsPortalImpl/Base/Base.KnockoutExtensions.Copy","MsPortalImpl/Base/Base.KnockoutExtensions.HtmlTemplateBinding","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedAttrBinding","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedCssBinding","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedHtmlBinding","MsPortalImpl/Base/JQueryExtensions","MsPortalImpl/Parts/Parts.Intrinsics","MsPortalImpl/Parts/Parts.ButtonPart","MsPortalImpl/Parts/Parts.Collection","MsPortalImpl/Services/Services.ExtensionTokensManager","MsPortalImpl/Services/Services.SharedSettings","MsPortalImpl/UI/Compositions/UI.Composition.DynamicPartBinder","MsPortalImpl/UI/Compositions/UI.Composition.SelectableRegistration"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g,h,f,x,b,v,y,M,I,C,P,w,_,S,F,k,T,D,E,B,A,N,O,R,L,z,H,U,W,V,j,q,G,K,J,X,Y,Z,ee,te,se,ie,oe,ne,re,ae,le,de,ce,pe,ue,me,ge,he,fe,xe,be,ve,ye,Me,Ie,Ce,Pe,we,_e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEV=t.Portal=t.registerAsyncHandlers=t.subscribeNotifications=t.routeIfHash=void 0;var Se=FxImpl,Fe=Se.Extension,ke=Se.TriggerableLifetimeManager,Te=MsPortalFx.Base,De=Te.Constants.Shell,Ee=Te.Diagnostics,Be=Ee.Telemetry,Ae=FxImpl.NetDiagnostics,Ne=Te.Resources,Oe=FxImpl.Rpc,Re=MsPortalFx.Hubs.Notifications.NotificationStatus,Le=Se.Hubs.Notifications,ze=Te.Net2;const He=window,Ue=He.performance,We=He.fx,Ve=We.getTimestamp;let je=Be.flush;const qe=Oe.client,$e="Shell",Qe=We.environment,Ge=Qe.links,Ke=null==Qe?void 0:Qe.customNotificationsProvider,Je="TopBar",Xe=MsPortalFx.ensureSuffix,Ye=MsPortalFx.getLogFriendlyMessage,Ze=MsPortalFx.noop,et=MsPortalFx.tryImmediateResolve,tt=Xe(Ne.getAppRelativeUri("/"),"/"),st=He.location,it=(0,i.createLog)(e),ot=tt+"SignOut",nt=tt+(MsPortalFx.isFeatureEnabled("msaljslogin")?"auth/login":"signin/index"),rt="loadedPageVersion",at=j.ComponentName.Telemetry,lt="FirstVisitedTimestamp",dt=Object.create(null);let ct,pt,ut="";function mt(e,t,s){t&&t.startsWith("#")&&e.route(t,s)}function gt(e,t,s){r.trace({source:e,action:t,data:s})}ze.setAjaxLogFunc((function(){it.warning.apply(it,arguments)})),t.routeIfHash=mt;let ht=async function(e){return(await e.get(p.ExperimentationManager).getAssignments()).hasFlight("hatspercentage")};function ft(e,t,s,i,o){gt($e,"PortalInitializeNpsModal"),ge.showPortalNps(e,t,s,i,o).catch((e=>{gt($e,"PortalInitializeNpsModalFailure",{error:Ye(e)})}))}function xt(e){e=e||{};const t=new a(ot);t.query.setParameters(e);const s="feature.msaljs",i=new a(He.location.href).query.getParameter(s);return i&&t.query.setParameter(s,i),t.toString()}function bt(e){const t=Ie.temporaryExtensionCount.getExtensionCountsAsList();e.addExtensionCounts(t),Ie.temporaryExtensionCount.flush()}let vt=function(e,t,s,i){Date.now()>t&&yt(e,s,i)};let yt=function(e,t,s){clearInterval(s()),e.addCallbacks({onIdle:e=>{5<e&&(MsPortalImpl.sessionStorage.setItem("wasForceReloaded","true"),Be.trace({source:$e,action:"ForceRefresh",actionModifier:"Idle",data:{idleTimeInMins:e,reloadAfterMilliseconds:t}}),je().then((()=>{st.reload(!0)})))}})};async function Mt(e,t){var i;const o=null!==(i=t.userInfo.isTenantParityDependent)&&void 0!==i&&i,n=t.portalNotifications.shouldShowContactability(),r=ge.shouldShowPortalNps(t.generalSettings.npsTimeMs),a=t.portalNotifications.shouldShowIrisAdvisor();let l=!1;if((0,s.isFeatureEnabled)("showhatsmodal")&&await ht(e)){const e=24*(parseInt((0,s.getFeatureValue)("hatsintervaldays"))||90)*3600*1e3,i=Date.now()-e,o=t.hatsLastSeen<i,n=(0,s.isFeatureEnabled)("testnps");l=!n&&r&&o,gt($e,"HatsEligibleCheck",{hatsIntervalMs:e,hatsLastSeen:t.hatsLastSeen,shouldShowHats:l,shouldShowNps:r,testNps:n,timeLimitInMs:i,waitedLongEnough:o}),Ie.temporaryExtensionCount.addIntervalId(setInterval((()=>bt(t.hatsSettings)),6e5))}let d="";return o?d="SkippedModalsWhenParityDependent":(0,s.isFeatureEnabled)("hidemodalswhendeeplinked")&&t.deeplinkLoadedPortal&&(d="SkippedModalsWhenDeeplinked"),d?(gt($e,d,{deeplink:t.deeplinkLoadedPortal,isTenantParityDependent:o,showWelcomeSequence:t.showWelcomeSequence,shouldShowContactability:n,shouldShowHats:l,shouldShowNps:r,shouldShowAdvisorNotification:ce.shouldShowAdvisorNotification(),shouldShowIrisAdvisor:a}),((0,s.getFeatureValue)("testhats")||l)&&"create"!==t.deeplinkLoadedPortal?t.portalNotifications.showHatsModal(e,t.generalSettings.npsTimeMs).then((s=>{if(s)return t.generalSettings.npsTimeMs(Date.now()),gt($e,"PortalInitializeHatsModal");ft(t.generalSettings,t.userSettingsManager,t.toastVM,t.generalSettings.npsTimeMs,e)})):void(r&&ft(t.generalSettings,t.userSettingsManager,t.toastVM,t.generalSettings.npsTimeMs,e))):t.showWelcomeSequence?t.welcomeSequenceCallback().then((()=>{gt($e,"PortalInitializeWelcomeModal")})):n?(gt($e,"PortalInitializeUpdateContactModal"),void await t.portalNotifications.showContactabilityModal(e)):a?(gt($e,"PortalInitializeIrisAdvisor"),void await t.portalNotifications.showIrisAdvisor(e)):((0,s.isFeatureEnabled)("showirisadvisor")?Q(!1):Q(ce.showAdvisorNotification(t.userSettingsManager))).then((i=>{if(!i)return(0,s.getFeatureValue)("testhats")||l?t.portalNotifications.showHatsModal(e,t.generalSettings.npsTimeMs).then((s=>{if(s)return t.generalSettings.npsTimeMs(Date.now()),gt($e,"PortalInitializeHatsModal");ft(t.generalSettings,t.userSettingsManager,t.toastVM,t.generalSettings.npsTimeMs,e)})):void(r?ft(t.generalSettings,t.userSettingsManager,t.toastVM,t.generalSettings.npsTimeMs,e):function(e,t){if((0,s.isFeatureEnabled)("canmodifyextensions")||(0,s.isFeatureEnabled)("testdevsat"))Q((0,s.require)("MsPortalImpl/UI/UI.DevSATSurvey")).then((s=>{s.showDevSAT(e,t)}))}(t.toastVM,t.generalSettings.devSatTimeMs));gt($e,"PortalInitializeAdvisorModal")}))}function It(e){return(0,s.isFeatureEnabled)("mspfilter")?Q(e.getAsync(xe.ServicesProjectedDirectories)):Q()}function Ct(e,t,s,i,o){e.notifications.subscribeArrayChanges(t,(e=>{var t;oe.showToastAndUpdateCount(s,e,s.get(FxImpl.Features).isEnabled("enablecustomnotificationsprovider")&&(null===(t=dt.customNotificationsProviderViewModel)||void 0===t?void 0:t.isPaneOpen)?dt.customNotificationsProviderViewModel:i,o)}),(e=>{oe.updateNotificationCount(e,i)}))}t.subscribeNotifications=Ct;const Pt={initializeDirectoryButton:function(e,t){e.topBar.directoryButtonClick=async()=>{if(t.get(pe.RightContextPane).close()){gt(Je,"SettingsFlyoutOpen",{launchedBy:"DirectoryPaneTopbarButton"});const e=t.get(v.Router);await e.route("#settings/directory",{openedBy:10})}}},initializeFeedbackPane:function(e,t){e.feedbackButtonClick=async()=>{if((await t.get(p.ExperimentationManager).getAssignments()).getBooleanValue("globalInProductFeedback")){const e=t.get(ue.DesktopManagerImpl).getCurrentBladeInfo(),s={extensionName:null==e?void 0:e.extensionName,bladeName:null==e?void 0:e.bladeName,cesQuestion:u.Global.feedbackCESQuestion,cvaQuestion:u.Global.feedbackCVAQuestion,featureName:"Global_InProductFeedback",surveyId:"Global_InProductFeedback_Experimentation"},i=new c.PdlBladeReference("InProductFeedbackBlade","HubsExtension",{parameters:s,onClosed:e=>{gt(Je,"GlobalInProductFeedback",2===e?{isFeedbackProvided:!0}:{isFeedbackProvided:!1})}});t.get(ee.BladeOpener).openBlade(i,{flags:1,telemetryName:"InProductFeedbackBlade"}).then((e=>{e&&gt(Je,"GlobalInProductFeedback",{isFeedbackBladeOpen:!0})})).catch((e=>{gt(Je,"GlobalInProductFeedback",{error:e})}))}else t.getAsync(te.FeedbackPaneInfo).then((e=>{const t=e.widget;gt(Je,"FeedbackSmileyClicked",{isPaneOpen:t.isVisible()}),t.toggle()}))}},initializeNotificationsPane:function(e,t,i,o,n){const r=new ae.ViewModel(t),a=null==Ke?void 0:Ke.blade,l=t.get(FxImpl.Features).isEnabled("enablecustomnotificationsprovider"),d=(0,s.memoizePromise)((()=>{if(!l||!a)return Q((0,s.require)("MsPortalImpl/Widgets/Widgets.NotificationsPane")).then((e=>new e.Widget(n,r)))}));Ct(o,n,t,r,i),e.topBar.notificationButtonClick=()=>{if(l&&a){const e=new c.PdlBladeReference(a,null==Ke?void 0:Ke.extensionName);t.get(ee.BladeOpener).openBlade(e,{flags:1,telemetryName:`OpenCustomNotificationsPane_${a}`}).then((e=>{var t;e&&(i.removeAllToasts(),null===(t=dt.customNotificationsProviderViewModel)||void 0===t||t.isPaneOpen(!0))})).catch((e=>{gt(Je,"OpenCustomNotificationsPaneFailed",{error:e})}))}else d().then((e=>{e.toggleNotificationsContextPane().then((e=>{e?(i.removeAllToasts(),oe.updateUnreadCountOnButton(0)):r.isPaneOpen(!1)}))}))};const p={events:"fxtoastclick",handler:(e,t)=>{o.handleNotificationClick(t.data.value,!0)}};i.eventHandlers.push(p)},initializeSearch:function(e,t,i){e.initOptions((()=>(0,s.require)("MsPortalImpl/Widgets/Widgets.SharedOptionsInit").then((s=>{s.initSearchWidgetOptions(i,e,t)}))))},initializeSettings:function(e,t,s){const i=e.topBar;let o=1;s.isEnabled("hidesettingsoverview")&&(o=s.isEnabled("hidedirectorypanebutton")?4:2),i.settingsButtonClick=()=>{const s=e.settingsFlyoutState.value;let i=!0;if(0===s&&(i=t.get(pe.RightContextPane).close()),i){gt(Je,s?"SettingsFlyoutClose":"SettingsFlyoutOpen");const t=0!==s?0:o;e.settingsFlyoutState(t)}}},initializeTopBar:function(e,t,s,i,o){const n=t.get(Z.ViewModel),r=e.topBar;this.initializeSettings(e,t,o),this.initializeFeedbackPane(r,t),et(e.onWidgetCreate(),(()=>{!o.isEnabled("asyncSearch")&&this.initializeSearch(r.searchViewModel,t,s)})),this.initializeNotificationsPane(e,t,n,i,s),this.initializeDirectoryButton(e,t)},markFromNavigation:function(e){Ue.mark(e);try{Ue.measure(e,"Navigation",e)}catch(t){const s=[t];try{s.push(...Ue.getEntriesByName("Navigation")||[]),s.push(...Ue.getEntriesByName(e)||[])}catch(e){s.push(e)}it.error("Error calling Performance.measure",0,...s)}}};function wt(e){return e.getAsync(H.SettingsManager).then((e=>H.queryStores(e,[4]))).then((e=>{const t=e&&e.get(4),s=t&&t[W.startBoardSettingsKey];return s&&s.dashboardId||""}))}function _t(e){e.get(H.PortalStartupMarkers).preloadDashboardStart=Ve(),Pt.markFromNavigation("preloadDashboardBundle"),(0,s.require)("MsPortalImpl/UI/Dashboard/DashboardManager"),et(function(e){const t=(0,ve.getCurrentUri)().getHashParts();return"dashboard"===t.category.toLowerCase()&&t.rest?Q(t.rest):wt(e)}(e),(t=>{t=(t||"").toLowerCase();const i=e.get(H.PortalStartupMarkers);0===t.indexOf("private")?(Pt.markFromNavigation("preloadDashboardPrivateRepoBundle"),(0,s.require)("MsPortalImpl/UI/Dashboard/PrivateDashboardRepository"),i.preloadDashboardRepoStart=Ve(),i.preloadDashboardRepoType="private"):0===t.indexOf("arm")&&(Pt.markFromNavigation("preloadDashboardArmRepoBundle"),(0,s.require)("MsPortalImpl/UI/Dashboard/ArmDashboardRepository"),i.preloadDashboardRepoStart=Ve(),i.preloadDashboardRepoType="arm")}))}function St(e,t,s){e.get(t).setRegistration(s)}function Ft(e,t,s){St(e,t,((t,i)=>function(e){const t=e.get(H.PortalStartupMarkers);return t.hasOwnProperty("requireDashboardStart")||(t.requireDashboardStart=Ve()),Q(e.getAsync(f.get("MsPortalImpl/UI/Dashboard/DashboardManager","DashboardManagerImpl")))}(e).then((e=>s(e,t,i)))))}function kt(e){Ft(e,be.StartNewDashboardPortalFunc,((e,t,s)=>e.startNewDashboard(s))),Ft(e,be.ExportDashboardPortalFunc,(e=>e.getArmDashboardJson())),Ft(e,be.ImportDashboardPortalFunc,((e,t)=>e.importDashboard(t.dashboard,t.title))),Ft(e,be.ReadDashboardPortalFunc,((e,t)=>e.readDashboardsForType(t.repositoryType,t.subscriptions,t.useArg,t.includeRecents))),Ft(e,be.SwitchDashboardPortalFunc,((e,t,s)=>e.switchDashboard(t,s))),Ft(e,be.ResetDashboardPortalFunc,((e,t)=>e.resetLayout(t.duringPortalStartup,t.force))),Ft(e,be.CloneDashboardPortalFunc,(e=>e.cloneCurrentDashboard())),Ft(e,be.UpdateDashboardPortalFunc,((e,t)=>e.updateDashboard(t.dashboard))),Ft(e,be.ClonePartPortalFunc,((e,t,s)=>e.clonePartToDashboardJson(t.partComposition,s,t.dashboard,t.isCopyExperience))),Ft(e,be.AssignTagsToDashboardPortalFunc,((e,t,s)=>e.assignTagsToDashboard(s))),Ft(e,be.ShareCurrentDashboardPortalFunc,((e,t)=>e.shareCurrentDashboard(t.title,t.armExtras))),Ft(e,be.ShareDashboardToSessionPortalFunc,((e,t)=>{e.shareCurrentDashboardToSession(t)})),Ft(e,be.UnshareDashboardToSessionPortalFunc,(e=>e.unshareCurrentDashboard())),Ft(e,be.GetUserPermissionsForDashboardPortalFunc,((e,t)=>e.getPermissions(t))),Ft(e,be.IsCurrentDashboarSharedPortalFunc,(e=>e.isCurrentDashboardShared())),Ft(e,be.GetCurrentDashboardPropertiesPortalFunc,(e=>e.getCurrentDashboardProperties())),Ft(e,be.PinTilesPortalFunc,((e,t,s)=>e.pinMultipleParts(t.partReferences,t.originExtension,t.notify,s,t.dashboard?t.dashboard:null,t.dashboardCreationOption?t.dashboardCreationOption:null))),Ft(e,be.PinTileWithOptionsPortalFunc,((e,t,s)=>e.addPartToStartBoard(t.options,t.duringPortalStartup,t.shouldSave,s))),Ft(e,be.PinBladePortalFunc,((e,t,s)=>e.pinBladeToDashboard(t,s))),Ft(e,be.PinTilePortalFunc,((e,t,s)=>e.pinPartToStartboard(t,s))),Ft(e,be.DeleteDashboardWithConfimationPortalFunc,((e,t)=>e.deleteDashboardWithConfirmation(t.currentContext,t.reasonDeleted))),Ft(e,be.RefreshDashboardPortalFunc,((e,t,s)=>e.refreshDashboard(s))),St(e,be.RoutePortalFunc,(t=>e.getAsync(f.get("MsPortalImpl/Base/Base.Router","Router")).then((e=>e.route(t.uri,t.openedByContext))))),St(e,be.ReplacePartPortalFunc,(t=>f.get("MsPortalImpl/UI/UI.ReplacePart","replacePart").then((s=>s(e,t.part,t.newLocator,t.options))))),St(e,be.ReloadPartPortalFunc,(t=>f.get("MsPortalImpl/UI/UI.ReloadPart","reloadPart").then((s=>s(e,t))))),St(e,be.CreateJourneyForBladeFunc,(t=>f.get("MsPortalImpl/UI/UI.CreateJourney","createJourney").then((s=>s(e,t,!1))))),St(e,be.CreateJourneyForAssetFunc,(t=>f.get("MsPortalImpl/UI/UI.CreateJourney","createJourney").then((s=>s(e,t,!0))))),St(e,be.ToggleCloudShell,(()=>e.getAsync(f.get("MsPortalImpl/UI/UI.AzureConsole","AzureConsole")).then((e=>{e.toggle()}))))}function Tt(e,t){const s=(t=t||{}).duration||Ve(),i=t.data||{};return Be.trace({timestamp:t.endTime,source:$e,action:e,actionModifier:Be.ActionModifier.Complete,duration:s,data:i}),Pt.markFromNavigation(e),s}t.registerAsyncHandlers=kt;let Dt=class{constructor(e){this._diContainer=e,this._lifetime=new ke}async initialize(){const t=this._lifetime,i=this._diContainer,o=i.get(me.RootElements),r=i.get(FxImpl.Features),c=i.get(j.StorageService),ee=new a(st.href),ae=Ve();Pt.markFromNavigation("enterUIInitialize"),Be.Internal.initialize({extensionName:$e,userQuery:MsPortalEarly.userQuery}),MsPortalEarly.initializedTelemetry(Be.trace);i.get(D.ClarityManager).initialize();const ce=setInterval(je,14e3);C.initialize(),kt(i),await async function(){var e,t;const s=null===(t=null===(e=await MsPortalEarly.preload)||void 0===e?void 0:e.variants)||void 0===t?void 0:t.hubsextension;i.get(p.ExperimentationManager).setExtensionFlights(s)}();const pe=function(e){return Q(e.getAsync(H.SettingsManager)).then((t=>Q.spread([t.querySetting(12,lt),e.getAsync(O.GeneralSettings),e.get(FxImpl.Features)],((t,s,i)=>{const o=!t;return i.isEnabled("landalltohome")&&o&&s.landingPage(1),(0,O.isLandingPageDashboard)(e)}))))}(i);!function(e,t){const i=(0,ve.getCurrentUri)().getHashParts().category.toLowerCase();switch(i){case"blade":case"create":case"asset":case"resource":["MsPortalImpl/UI/UI.CreateJourney","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener"].forEach((e=>{(0,s.require)(e),gt($e,"PortalInitializeDeeplinkPreload",{routeType:i,moduleId:e})})),ut=i;break;case"dashboard":_t(e);break;case"":(0,s.isFeatureEnabled)("azureHome")?t.then((t=>{t&&_t(e)})):_t(e)}}(i,pe),await Q.spread([i.getAsync(m.AuthStateManager),i.getAsync(P.ExtensionManager),i.getAsync(z.SecurityTokensManager),i.getAsync(H.SettingsManager),i.getAsync(U.MruTokensSettingsManager),It(i)],((a,p,m,C)=>{var D;const z=Qe.pageVersion,U=function(e,t){const s=e.getValue(at,rt,0);return t!==s&&e.setValue(at,rt,t,0),s}(c,z),me=i.get(H.PortalStartupMarkers);me.defaultRoute=!1,me.splashScreen=MsPortalEarly.splashScreenLoadTime,me.initializeStart=Ve(),me.enterUIInitialize=ae,me.loadedSameVersion=z===U,me.previousVersion=U||"",me.performanceTelemetry=FxImpl.NetDiagnostics.getPerformanceTelemetry(),me.requireConfigPerf=MsPortalImpl.requireConfigPerf,Pt.markFromNavigation("initializeStart");const xe=a.bootstrapState,Ie=a.getCurrentUser();FxImpl.Base.Diagnostics.setObjectIdToScrub(Ie.objectId);const ke=new URLSearchParams(window.location.search),Te=ke.has("msaljslogin");if(!xe)return gt($e,"SignInRedirect","AuthBootstrapState not found. Redirecting the user to sign-in."),void b.redirectWithCdn(i,{uri:nt,parameters:Te?{"feature.msaljslogin":"true",msaljsscript:"true"}:null,hash:st.hash});r.isEnabled("enableanimations",!0)||$.enableAnimations(!1);const Ne=i.get(R.PortalIdleStateService);x.registerRpc(i);const We=/^.*[/|.]entra\..*$/i.test(null!==(D=FxImpl.trustedParentOrigin)&&void 0!==D?D:""),Xe=new S.PortalReader(t,{idPrefix:"portal"});Xe.read(We?u.Shell.Reader.entraLoading:u.Shell.Reader.portalLoading);const et=i.get(fe.StatusHandler),ot=Q.spread([i.getAsync(O.GeneralSettings),i.getAsync(ye.PortalNotifications),i.getAsync(E.HatsSettings),i.getAsync(B.FavoritesSettings),i.getAsync(B.UserDirectorySettings),i.getAsync(I.ThemeManager),i.getAsync(P.ExtensionManagerOptions)],((x,P,S,D,E)=>{me.initializeGeneralSettings=Ve(),Pt.markFromNavigation("initializeGeneralSettings");const B=M.initialize(t,i,r.shellFeatures.fromQuery.l,void 0!==ee.query.getParameter("l"));B.requireRedirect&&this._redirect({uri:null,skipFlushBuffers:!0,reason:"Locale",logData:B}),MsPortalFx.isObject(Qe)&&console.log("Version: "+Qe.version+"\nSession: "+MsPortalFx.sessionId);const A=MsPortalImpl.sessionStorage.getItem("forceSignIn_previousSessionId");A&&(gt($e,"ReloadedFromFxForceSignIn",{previousSessionId:A}),MsPortalImpl.sessionStorage.removeItem("forceSignIn_previousSessionId")),w.initialize(),t.registerForDispose((()=>{w.dispose()}));i.get(ie.FavoritesManager).initializeFavorites(D);const R=(0,Me.getPortalViewModel)(i);me.portalWidgetStart=Ve(),i.get(Y.Widget),me.portalWidgetEnd=Ve(),te.initialize(t,i,R),me.uiCompositionInitEnd=Ve(),h.initialize(i.get(k.AssetTypeService));const z=i.get(q.SubscriptionsUserContext).getGlobalSelectedSubscriptions().then((e=>e())),H=z.then((e=>{ft(e),gt($e,"getGlobalSelectedSubscriptions",{first100SubscriptionIds:e.slice(0,100).map((e=>e.subscriptionId)),globalSelectedSubscriptionCount:e.length})}));(0,s.require)("MsPortalImpl/Services/Services.Recents").then((e=>e.loadRecentsFromLazyData(i)));const U=i.get(ne.NotificationManager);r.isEnabled("enablecustomnotificationsprovider")&&(null==Ke?void 0:Ke.provider)&&(0,s.require)("MsPortalImpl/UI/UI.CustomNotificationsHelper").then((e=>{e.activateCustomNotificationProvider(i,U,oe.updateUnreadCountOnButton,dt)})).catch((e=>{gt($e,"GetCustomNotificationsHelperFailed",{error:e})})),i.get(re.DataContext),p.lastExtensionError.subscribeAndRun(t,(e=>{e&&U.addClientNotification({title:u.Shell.extensionError,description:u.Shell.loadingError.format(e.name,`${fx.environment.trustedParentOrigin}/SelfHelp`),status:Re.Error,timestamp:new Date,descriptionAsHtml:!0})})),Fe.extensionStatusEndPoint.register(qe,null,((e,t)=>{e&&ht(e,t.srcWindowId)}));const G=R.topBar;G.exitDevMode=()=>{o.showSplash(!0),MsPortalImpl.Extension.unregisterAll().then((()=>{this._redirect({uri:tt})}))},Fe.getCurrentlDeepLinkEndpoint.register(qe,null,(()=>(0,_e.sanitizeUriComponent)(st.href))),St(i,be.DownloadDiagnosticsJson,(()=>(0,s.require)("../Base/Base.ClientRawFileDownload",e).then((e=>{e.downloadFile({provideText:()=>ye().then((e=>JSON.stringify(e,null,2)))},"PortalDiagnostics.json","charset=utf-8;application/json")}))));const ae=(0,s.memoizePromise)((()=>Q((0,s.require)("../Base/Base.DebugInfo",e)).then((e=>e.initialize(t,i)))));St(i,be.ShowDebugTools,(()=>ae().then((e=>e.toggleStickys(ct))))),(0,s.isFeatureEnabled)("telemetryinsights")&&St(i,be.ShowTelemetryInsights,(async()=>{const{TelemetryInsights:o}=await(0,s.require)("../Services/Services.TelemetryInsights",e);i.get(o).toggleOverlay(t)})),i.get(_.KeyboardShortcutHandler),St(i,be.ShowWelcomeSequence,(()=>f.get("MsPortalImpl/Widgets/Widgets.WelcomeSequence","Widget").then((e=>{const s=e.create(i,R,C);return t.registerForDispose(s),s}))));const he=()=>i.get(K.TenantsService).getTenants(),ye=()=>Q.all([(0,s.require)("MsPortalImpl/Base/Base.DiagnosticsPopup"),H,he()]).spread(((e,t,s)=>e.getDiagnosticsData(i,ft,ko.observableArray(s.tenants),m)));G.reportBug=()=>{(0,s.require)("./UI.Portal.Actions",e).then((e=>{e.reportBug(i,ee)}))},(0,s.isFeatureEnabled)("subscreditcheck")&&(0,s.isFeatureEnabled)("upgradefromtrialbutton")&&(0,s.require)("MsPortalImpl/Services/SubsCreditCheck").then((e=>{e.subscriptionsRequiringUpgrade.subscribeAndRun(t,(e=>{1===e.length?(Be.trace({action:"FreeTrialUpgradeShown",source:"TopBar",data:{subscriptionId:e[0].subscriptionId,creditsRemaining:e[0].remaining}}),G.canUpgradeSubscription(!0),G.upgradeableSubscription({subscriptionId:e[0].subscriptionId,remaining:e[0].remaining})):G.canUpgradeSubscription(!1)}))}));const Se=i.get(v.Router),De=MsPortalFx.getIdGenerator("SideBarOpeningBlade");R.sideBar.launchBlade=(e,t)=>{const s=Se.route(e,{openedBy:t?1:void 0}),i=R.getJourneyWidget();if(i){const e=De();i.loadingHint(e,!0),s.finally((()=>{i.loadingHint(e,!1),i.trigger("fxbladerepos",{noScroll:!0})}))}},T.initializeRpc(),J.registerEndpoints(Oe.client,i),Pt.markFromNavigation("beforeInitDesktopMgr"),me.beforeInitDesktopMgr=Ve();const Ae=i.get(ue.DesktopManagerImpl).initialize().then((()=>R.onWidgetCreate())).then((async()=>{Pt.markFromNavigation("desktopMgrInitialized"),me.desktopMgrInitialized=Ve();let e=await C.querySetting(12,lt);e||(e=Date.now(),C.setSetting(12,lt,e)),gt($e,"FirstVisited",{[lt]:e});const t=await C.querySetting(6,"gallery_createLauncher_lastUsed_subscriptionId");return gt($e,"LastUsedSubscriptions",t),pe})).then((e=>{me.defaultLandingView=e?"Dashboard":"Home",me.defaultSideBarLayout=(0,O.isSideBarDocked)(i)?"Docked":"Flyout",me.desktopAndExtensionManagerInitialize=Ve(),Pt.markFromNavigation("desktopAndExtensionManagerInitialize");const t=r.isEnabled("nodirectory");return Se.initialRoute((()=>(me.defaultRoute=!0,Se.goToLandingPage({interactionSource:"UIInitialize",replaceHistory:!0,skipFocus:t,invokedByInitRoute:!0}))),{skipFocus:t})})).then((()=>{Pt.markFromNavigation("setupInitialRoute"),me.setupInitialRoute=Ve(),G.getWidget().initReactiveLayout(),o.showSplash(!1),me.locationHash=ee.fragment.split("?")[0],me.hiddenTime=MsPortalEarly.stopPageLoadTimeout(),me.earlyLoad=MsPortalEarly.earlyLoadPerfData,me.windowSize=window.innerWidth;const e=Ue.timing;if(e){const t=e.navigationStart;me.fetchStart=e.fetchStart-t,me.requestStart=e.requestStart-t,me.responseStart=e.responseStart-t,me.responseEnd=e.responseEnd-t,me.domComplete=e.domComplete-t}const t={data:$.extend(me,MsPortalFx.convertArrayToMap(["EntryPoint","SignInIndex"],(e=>`PageTelemetry_${e}`),((e,t,s)=>{const i=MsPortalImpl.sessionStorage.getItem(s);if(i)return MsPortalImpl.sessionStorage.removeItem(s),JSON.parse(i)})))};MsPortalEarly.blockedHosts.length>0&&it.warning(`Fallbacks are being used for extension hosting service. The current blocked hosts are ${JSON.stringify(MsPortalEarly.blockedHosts)}`),clearInterval(ce),ct=Tt("TotalTimeToPortalReady",t),je();const i=Ne.addCallbacks({onIdle:e=>{const t=He.navigator;t&&!1!==t.onLine&&e%15==0&&at(!0),Ne.removeCallbacks(i)}});!function(e){const t=Number((0,s.getFeatureValue)("reloadafterdays"));if(MsPortalImpl.sessionStorage.getItem("wasForceReloaded")&&(MsPortalImpl.sessionStorage.removeItem("wasForceReloaded"),(0,we.publishNotification)({title:u.Shell.Dialogs.reloadPortalMessageTitle,description:u.Shell.Dialogs.reloadPortalMessageDescription.format(t),status:0,toastDuration:1})),t>0){const s=864e5*t,i=Date.now()+s,o=setInterval((()=>{vt(e,i,s,(()=>o))}),36e5)}}(Ne),E.addRecentDirectory(Ie.tenantId)})).catch((e=>{pt=pt||"/LoadFailed?stack="+encodeURIComponent(e&&e.stack).slice(0,1e3),this._redirect({uri:fe.errorUri+pt})}));i.get(se.SaveDirectorySettingsHandler).saveDirectorySettings(),Ae.then((()=>(0,Ce.checkPassthroughUserWithNoSubs)(i))).then((e=>{if(e)return(0,Ce.launchPassthroughModalDialog)(i,(()=>this._logoutHandler({securityTokensManager:m,telemetryEvent:{source:"UIInitialize",action:"PassthroughUserSignOut"},buildSignOutUriParams:{sid:xe.aadSessionId,tid:Ie.tenantId}})))})).then((()=>{C.querySettings({store:7,keys:["WelcomeSequence","LastHatsShownTimestamp"]}).then((e=>{var t;Mt(i,{deeplinkLoadedPortal:!me.defaultRoute&&ut,welcomeSequenceCallback:()=>Q(i.get(be.ShowWelcomeSequence).invoke()),showWelcomeSequence:r.isEnabled("guidedtour")&&(!e||!e.WelcomeSequence)&&!r.isEnabled("ci"),portalNotifications:P,generalSettings:x,toastVM:We,userSettingsManager:C,hatsLastSeen:null!==(t=e.LastHatsShownTimestamp)&&void 0!==t?t:0,hatsSettings:S,userInfo:Ie}).catch((e=>{gt($e,"StartupModalsFailure",{error:Ye(e)})})),r.isEnabled("nodirectory")&&G.directoryButtonClick()})).catch((e=>{gt($e,"QuerySettingsFailure",{error:Ye(e)})})),N.init(C);const e=u.Portal;if(r.isEnabled("internalonly")&&!r.isEnabled("canmodifyextensions")&&!a.isMicrosoftOrAmeTenant){const t=FxImpl.trustedParentOrigin,s=t.replace(/^([^/]+\/\/).+\.([^.]+\.[^.]+\.[^.]+)$/,"$1$2");t!==s&&U.addClientNotification({status:Re.Information,title:e.preview,description:e.unsupportedEnvironment.format(t),uri:s,timestamp:new Date,uriAction:Le.ClientNotificationUriAction.OpenInCurrentTab})}l.isSafari&&l.webKitVersion<602&&i.getAsync(g.DialogManager).then((t=>t.showModalDialog({title:e.unsupportedBrowser,description:e.unsupportedBrowserDesc.format(Ge.unsupportedBrowser),buttons:1,showErrorIcon:!0})))})),k.setupAssetTypeServiceRpc(i),V.create(i),r.isEnabled("portalpolling")&&i.get(L.PollingManager).startPolling();let ze=null;Ee.ErrorReporter.initialize((()=>{ze=ze||i.get(ue.DesktopManagerImpl),it.debug(ze.getDiagnosticsData())}),!1,(()=>(ze=ze||i.get(ue.DesktopManagerImpl),ze.getCurrentBladeInfo())));const We=i.get(Z.ViewModel);Pt.initializeTopBar(R,i,t,U,r);const Xe=i.get(FxImpl.Rpc.Client);n.Internal.showNpsEndpoint.register(Xe,null,((e,t)=>{ge.showNps(x,C,We,e.productDisplayName,`${t.srcWindowId||""}_${e.productId}`)})),n.Internal.canShowNpsEndpoint.register(Xe,null,(()=>!ge.npsShownInSession));const ot=G.avatarMenuVM;Ie.gitHubUserId&&(0,Pe.fetchGitHubAccountInfo)(Ie.gitHubUserId).then((e=>ot.gitHubUserInfo(e))),ot.userIdentity(Ie),ot.hideTenant(r.isEnabled("hideavatartenant"));const rt=r.isEnabled("tenants2020");a.getUserInfo().then((e=>{let t;if(ot.userInfo(e),rt&&(ot.tenantDisplayName(e.uniqueDirectoryName),ot.listOfTenants.setAll([{id:e.directoryId,domainName:e.domainName,displayName:e.directoryName,tenantCategory:""}])),r.isEnabled("saveDeploymentNotification")){try{t=JSON.parse(MsPortalImpl.sessionStorage.getItem("_msPortalFx-Session-Deployments-{0}".format((e.objectId||e.email)+e.directoryId)))||{}}catch(e){return}Object.keys(t).length&&(0,s.require)("MsPortalImpl/Services/Services.DeploymentSession").then((e=>{i.get(e.DeploymentSession).restoreDeployments(i)}))}})),rt||he().then((e=>{const t=e.tenants;xt(t),ot.listOfTenants.setAll(t)})),ot.showDiagnostics=()=>i.get(be.DownloadDiagnosticsJson).invoke(),ot.showDebugTools=()=>i.get(be.ShowDebugTools).invoke(),ot.signedOut=()=>{this._logoutHandler({securityTokensManager:m,telemetryEvent:{source:Je,action:"AvatarMenuSignOut"},redirectAction:15})},ot.openAccountPortal=()=>{const e=Ge.accountPortal;gt(Je,"AvatarMenuOpenBilling"),mt(Se,e.startsWith("#")?e:e+"subscriptions",{openedBy:7})},ot.switchDirectory=()=>{const e=i.get(v.Router);gt(Je,"SettingsFlyoutOpen",{launchedBy:"AvatarMenu"}),e.route("#settings/directory",{openedBy:7})},ot.openGitHubProfile=Ie.gitHubUserId?()=>{gt(Je,"AvatarMenuOpenGitHubProfile",{launchedBy:"AvatarMenu"}),(0,Pe.fetchGitHubAccountInfo)(Ie.gitHubUserId).then((e=>window.open(e.html_url,"_blank")))}:Ze;const at=e=>{let t;t=Ie.gitHubUserId?Promise.resolve(`${"https://avatars.githubusercontent.com/u/{0}".format(Ie.gitHubUserId)}`):r.isEnabled("serveravatar")?C.queryStore(0).then((e=>(c.clearAllComponentItems(j.ComponentName.Avatar,0),(e||{})[W.avatarKey]||Ie.defaultAvatarUri))):y.getAvatarImage(Ie.emailAddress,Ie.avatarUri,Ie.defaultAvatarUri,c,e),t.then((e=>{ot.avatarImage(e)})).catch((e=>{gt(Je,"AvatarImageFetchFailed",{error:Ye(e)})}))};at(),ot.submitAnIdea=()=>{gt(Je,"AvatarMenuOpenFeedback"),He.open(Ge.submitAnIdea,"_blank")};const bt=()=>{const e=Ge.accessDetails;return!(!e||!e.startsWith("#"))&&(gt(Je,"AvatarMenuOpenAccessDetails"),mt(Se,e,{openedBy:7}),!0)};ot.showMyAccessBlade=()=>{(0,s.isFeatureEnabled)("vlcentralcustommecontrollinks")?bt():bt()||(gt(Je,"AvatarMenuOpenAccessDetailsDefault"),i.get(be.CreateJourneyForBladeFunc).invoke({extension:"HubsExtension",detailBlade:"MyAccess.ReactView",detailBladeInputs:{resourceId:""},defaultMenuItemId:void 0}))},z.then((e=>{const t=(Ft.selectedFormatCulture||"").toLowerCase().split("-").slice(-1)[0];ot.contactInfoEnabled(e.length&&r.isEnabled("contactinfo")&&!["at","ru","de","gr"].includes(t))})),ot.showContactInfoBlade=()=>{gt(Je,"AvatarMenuOpenContactInfo"),R.settingsFlyoutState(6)},ot.switchAccount=e=>{let t=e?{loginHint:e}:{selectAccount:"true"};Te&&(t=Object.assign(Object.assign({},t),{"feature.msaljslogin":"true",msaljsscript:"true"})),b.redirectWithCdn(i,{uri:nt,parameters:t,hash:b.getHashQueryStringSegment(st.href),redirectAction:2})},!r.isEnabled("ci")&&(s.isDevelopmentMode||MsPortalEarly.query.clientoptimizations&&"true"!==MsPortalEarly.query.clientoptimizations||r.isEnabled("canmodifyextensions"))&&ae().then((e=>e.startErrorDetection(t)));const yt="data-click-telemetry";let It;R.customEvents.addHandler(t,"mousedown",(e=>{It=e.target})),R.customEvents.addHandler(t,"mouseup",(e=>{const t=It;if(It=null,e.target===t){const e=R.getRootElement()[0],s=$(t).closest("[data-click-telemetry]",e);if(s.length){const t=s.attr(yt)+"",i=s.closest(".fxs-tile",e).data(X.CompositionInstanceDataName),o=i&&i.locator,n=o&&o.toFriendlyString()||$e;Be.trace({source:n,action:"CustomClick",name:t})}}})),le.registerViewModels(i),de.registerViewModels({diContainer:i,securityTokensManager:m,subscriptions:ft,tenants:xt}),et.isShellInitialized.resolve();i.get(F.PrintHandler).init(this._lifetime);const Ct=i.get(I.ThemeManager),wt=Ct.currentTheme().name,_t=Ct.highContrastMode(),Ft=M.currentLocaleContext,kt=Ft.selectedDisplayLanguage,Dt=Ft.selectedFormatCulture||kt,Et=d.getBrowserInfo(),Bt=R.sideBar.isCollapsed.value?"collapsed":"expanded",At=c.clearValue(j.ComponentName.Redirect,"Referrers",1),Nt=(0,O.isFocusNavigationEnabled)(i)?"enabled":"disabled",Ot="1"===ke.get("pwa");return Q.spread([i.get(K.TenantsService).getHomeTenantsCount(),i.get(q.SubscriptionsUserContext).getAllSubscriptionsCount(),i.get(q.SubscriptionsUserContext).getGlobalDisplayedSubscriptions()],((e,t)=>{var s;const i=(0,ve.getCurrentUri)().getHashParts().category,o="dashboard"===i?`${i}/${(0,ve.getDashboardTypeFromUri)()}`:i;Be.trace({source:"UIInitialize",action:"PortalInitialized",data:{selectedDisplayLanguage:kt,formatCulture:Dt,sidebarState:Bt,focusNavigationState:Nt,defaultLandingView:me.defaultLandingView,defaultSideBarLayout:me.defaultSideBarLayout,currentTheme:wt,highContrastMode:_t,tenantsCount:e,subscriptionsCount:t.value,freeTrial:G.canUpgradeSubscription.value,deepLinkType:o,referrers:At,browserInfo:Et,userAgentData:null!==(s=He.navigator.userAgentData)&&void 0!==s?s:{},isStandalonePwa:Ot}})})),Ae})),ht=(e,t)=>{et.onStatus(e,t)},ft=ko.observable(),xt=ko.observableArray();return Ae.registerTelemetrySubmissionHandler(),Se.ProvisioningTelemetry.registerTelemetrySubmissionHandler(),ze.status.subscribe(t,(e=>{ht(e,De)})),i.getAsync(G.SharingTelemetryProcessor).then(Be.addProcessor),function(e){if(!(e&&Ue&&Ue.getEntriesByType&&Ue.timing))return;const t=Ve(),s=function(e,t,s){Tt(e,{duration:t,endTime:Math.round(s+Ue.timing.navigationStart)})},i=Ue.getEntriesByType("resource").filter((e=>{const t=e.initiatorType;return"link"===t||"script"===t}));let o=i.reduce(((e,t)=>Math.min(t.startTime,e)),1/0),n=i.reduce(((e,t)=>Math.max(t.responseEnd,e)),0);const r=n-o,a=n;o=Math.max(o,e),n=Math.min(n,t);const l=n-o,d=t-l-e;s("TotalTimeToSplashScreen",e,e),s("TotalStartupResourceDownload",r,a),s("StartupResourceDownload",l,n),s("StartupScriptExecution",d,t)}(MsPortalEarly.splashScreenLoadTime),ot.then((()=>{Xe.read(We?u.Shell.Reader.entraReady:u.Shell.Reader.portalReady),he.initialize(i,this._lifetime,a,i.get(O.GeneralSettings).idleTimeoutMins,Ne,(()=>this._logoutHandler({securityTokensManager:m,telemetryEvent:{source:"UIInitialize",action:"IdleTimeoutSignOut"},buildSignOutUriParams:{sid:xe.aadSessionId,tid:Ie.tenantId}})),Ie.tenantDomain,et)})),A.registerFileUploadEndpoints(),N.uploadSettingsManager=C,Qe.oneDsInstrumentationKey&&setTimeout((async()=>{(await(0,s.require)("MsPortalImpl/Services/Services.1ds")).initialize()}),5e3),ot}))}dispose(){(0,s.isFeatureEnabled)("showhatsmodal")&&(Ie.temporaryExtensionCount.flushIntervalIds(),this._diContainer.isDisposed||bt(this._diContainer.get(E.HatsSettings))),this._lifetime.dispose(),Se.resetGlobalState()}_redirect(e){this._diContainer.get(me.WindowManager).redirect(e)}async _logoutHandler(e){const{securityTokensManager:t,telemetryEvent:s,redirectAction:i,buildSignOutUriParams:o}=e,n=await t.portalAuthHandlerPromise,r=!!n,a=Object.assign({},s.data);s.data={telemetryEventData:a,isPortalAuthHandlerInitialized:r},Be.trace(s),r&&await n.localLogout(),this._redirect({uri:xt(o),redirectAction:i})}};Dt=__decorate([__metadata("fx:diagnostics",[e,"Portal"]),o.Class(),__metadata("design:paramtypes",[o.Container])],Dt),t.Portal=Dt})),
define("_generated/Less/MsPortalImpl/Base/Base.Images.css",["module"],(function(e){"use strict";return{css:".msportalfx-svg-c01{fill:#fff}.msportalfx-svg-c02{fill:#e5e5e5}.msportalfx-svg-c03{fill:#a0a1a2}.msportalfx-svg-c04{fill:#7a7a7a}.msportalfx-svg-c05{fill:#3e3e3e}.msportalfx-svg-c06{fill:#1e1e1e}.msportalfx-svg-c07{fill:#0f0f0f}.msportalfx-svg-c08{fill:#ba141a}.msportalfx-svg-c09{fill:#dd5900}.msportalfx-svg-c10{fill:#ff8c00}.msportalfx-svg-c11{fill:#fcd116}.msportalfx-svg-c12{fill:#fee087}.msportalfx-svg-c13{fill:#b8d432}.msportalfx-svg-c14,.msportalfx-svg-c32{fill:#57a300}.msportalfx-svg-c15{fill:#59b4d9}.msportalfx-svg-c16{fill:#3999c6}.msportalfx-svg-c17{fill:#804998}.msportalfx-svg-c18{fill:#ec008c}.msportalfx-svg-c19{fill:#0072c6}.msportalfx-svg-c20{fill:#68217a}.msportalfx-svg-c21{fill:#00188f}.msportalfx-svg-c22{fill:#e81123}.fxs-mode-light .msportalfx-svg-c22{fill:#a4262c}.msportalfx-svg-c23{fill:#cae3f3}.msportalfx-svg-c24{fill:#59aed3}.msportalfx-svg-c25{fill:#4c3b12}.msportalfx-svg-c26{fill:#be9555}.msportalfx-svg-c27{fill:#4f4d52}.msportalfx-svg-c28{fill:#ef6f59}.msportalfx-svg-c29{fill:#f7cb64}.msportalfx-svg-c30{fill:#fdd8db}.msportalfx-svg-c31{fill:#f6ffec}.msportalfx-svg-c33{fill:#8a2da5}.msportalfx-svg-c34{fill:#e00b1c}.msportalfx-svg-c35{fill:#015cda}.msportalfx-svg-c36{fill:#5db300}.msportalfx-svg-c97{fill:#ffb900}.msportalfx-svg-c98{fill:#00a4ef}.msportalfx-svg-c99{fill:#f25022}.msportalfx-inverted-theme .msportalfx-svg-c05,.fxs-theme-dark .msportalfx-svg-c05{fill:#777}.msportalfx-inverted-theme .msportalfx-svg-c07,.fxs-theme-dark .msportalfx-svg-c07{fill:#f2f2f2}.msportalfx-svg-palette-white{fill:#fff}.msportalfx-svg-palette-blue{fill:#015cda}.msportalfx-svg-palette-black{fill:#1e1e1e}.msportalfx-svg-palette-green{fill:#57a300}.msportalfx-svg-palette-gray{fill:#a0a1a2}.msportalfx-svg-palette-inherit{fill:inherit}.msportalfx-svg-badge{position:absolute;left:0;bottom:0;min-height:10px;min-width:10px}.ext-fxc-menu-icon>.msportalfx-svg-badge{left:-2px;bottom:-2px;min-height:8px;min-width:8px}.msportalfx-svg-disabled{filter:grayscale(100%)}@-moz-document url-prefix(){.msportalfx-svg-disabled{filter:none;}}.msportalfx-svg-disabled .msportalfx-svg-c01{fill:grayscale(#fff)}.msportalfx-svg-disabled .msportalfx-svg-c02{fill:grayscale(#e5e5e5)}.msportalfx-svg-disabled .msportalfx-svg-c03{fill:grayscale(#a0a1a2)}.msportalfx-svg-disabled .msportalfx-svg-c04{fill:grayscale(#7a7a7a)}.msportalfx-svg-disabled .msportalfx-svg-c05{fill:grayscale(#3e3e3e)}.msportalfx-svg-disabled .msportalfx-svg-c06{fill:grayscale(#1e1e1e)}.msportalfx-svg-disabled .msportalfx-svg-c07{fill:grayscale(#0f0f0f)}.msportalfx-svg-disabled .msportalfx-svg-c08{fill:grayscale(#ba141a)}.msportalfx-svg-disabled .msportalfx-svg-c09{fill:grayscale(#dd5900)}.msportalfx-svg-disabled .msportalfx-svg-c10{fill:grayscale(#ff8c00)}.msportalfx-svg-disabled .msportalfx-svg-c11{fill:grayscale(#fcd116)}.msportalfx-svg-disabled .msportalfx-svg-c12{fill:grayscale(#fee087)}.msportalfx-svg-disabled .msportalfx-svg-c13{fill:grayscale(#b8d432)}.msportalfx-svg-disabled .msportalfx-svg-c14{fill:grayscale(#7fba00)}.msportalfx-svg-disabled .msportalfx-svg-c15{fill:grayscale(#59b4d9)}.msportalfx-svg-disabled .msportalfx-svg-c16{fill:grayscale(#3999c6)}.msportalfx-svg-disabled .msportalfx-svg-c17{fill:grayscale(#804998)}.msportalfx-svg-disabled .msportalfx-svg-c18{fill:grayscale(#ec008c)}.msportalfx-svg-disabled .msportalfx-svg-c19{fill:grayscale(#0072c6)}.msportalfx-svg-disabled .msportalfx-svg-c20{fill:grayscale(#68217a)}.msportalfx-svg-disabled .msportalfx-svg-c21{fill:grayscale(#00188f)}.msportalfx-svg-disabled .msportalfx-svg-c22{fill:grayscale(#e81123)}.msportalfx-svg-disabled .msportalfx-svg-c23{fill:grayscale(#cae3f3)}.msportalfx-svg-disabled .msportalfx-svg-c24{fill:grayscale(#59aed3)}.msportalfx-svg-disabled .msportalfx-svg-c25{fill:grayscale(#4c3b12)}.msportalfx-svg-disabled .msportalfx-svg-c26{fill:grayscale(#be9555)}.msportalfx-svg-disabled .msportalfx-svg-c27{fill:grayscale(#4f4d52)}.msportalfx-svg-disabled .msportalfx-svg-c28{fill:grayscale(#ef6f59)}.msportalfx-svg-disabled .msportalfx-svg-c29{fill:grayscale(#f7cb64)}.msportalfx-svg-disabled .msportalfx-svg-c30{fill:grayscale(#fdd8db)}.msportalfx-svg-disabled .msportalfx-svg-c31{fill:grayscale(#f6ffec)}.msportalfx-svg-disabled .msportalfx-svg-c97{fill:grayscale(#ffb900)}.msportalfx-svg-disabled .msportalfx-svg-c98{fill:grayscale(#00a4ef)}.msportalfx-svg-disabled .msportalfx-svg-c99{fill:grayscale(#f25022)}.msportalfx-svg-loading-square{animation:ProgressFlagAnimation 1.45s infinite ease-in-out;transform-origin:50%}.msportalfx-svg-loading-square:nth-child(1){animation-delay:0s}.msportalfx-svg-loading-square:nth-child(2){animation-delay:.2s}.msportalfx-svg-loading-square:nth-child(3){animation-delay:.4s}@keyframes ProgressFlagAnimation{0%{transform:scale(1);opacity:.3}36.1%{transform:scale(1.06);opacity:1}50%{transform:scale(1.06);opacity:1}86.1%{transform:scale(1);opacity:.3}}.msportalfx-svg-flip-horizontal>svg,svg.msportalfx-svg-flip-horizontal{transform:scaleX(-1)}.msportalfx-svg-fabric-rotate360{animation:ImageRotation 1.3s cubic-bezier(.53,.21,.29,.67) infinite}@keyframes ImageRotation{0%{transform:rotate(-45deg)}100%{transform:rotate(315deg)}}.fxs-svg-number .msportalfx-font-bold{font-size:10px;fill:#0065ad}.fxs-svg-number .fxs-svg-circle{stroke-width:0%;fill:#0078d4}.fxs-svg-number .fxs-svg-text{fill:#fff;font-size:10px}.fxs-svg-number.msportalfx-svg-disabled{filter:grayscale(0%)}.fxs-svg-number.msportalfx-svg-disabled .fxs-svg-circle{fill:#fff;stroke-width:1px;stroke:#949494}.fxs-svg-number.msportalfx-svg-disabled .fxs-svg-text{fill:#949494}.fxs-theme-dark .fxs-svg-number .fxs-svg-text{fill:#0f0f0f}.fxs-theme-dark .fxs-svg-number .fxs-svg-circle{stroke-width:0%;fill:#0078d4}.fxs-theme-dark .fxs-svg-number.msportalfx-svg-disabled .fxs-svg-circle{fill:#0f0f0f;stroke-width:1px;stroke:#949494}.fxs-theme-dark .fxs-svg-number.msportalfx-svg-disabled .fxs-svg-text{fill:#949494}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Themes/Themes.Universal.css",["module"],(function(e){"use strict";return{css:'a{color:#0078d4}a:hover,a:active{color:#004578}a[aria-disabled="true"]{pointer-events:none}.fxs-topbar{background-color:#1c1c1c;color:#fff}.fxs-topbar-button,.fxs-topbar-avatarmenu .fxs-dropmenu-button{fill:#fff}.fxs-topbar-button:hover,.fxs-topbar-avatarmenu .fxs-dropmenu-button:hover{background-color:#605e5c}.fxs-topbar-button:active,.fxs-topbar-avatarmenu .fxs-dropmenu-button:active{background-color:#605e5c}.fxs-topbar-home{color:#fff}.fxs-topbar-home:hover{color:#fff;background-color:#605e5c}.fxs-notificationspane-button-unreadcount{color:#1c1c1c;background-color:#fff}.fxs-topbar-active .fxs-topbar-button,.fxs-topbar-active.fxs-topbar-button{background-color:#fff;fill:#1c1c1c}.fxs-topbar-active .fxs-notificationspane-button-unreadcount{color:#fff;background-color:#1c1c1c}.fxs-topbar-debug-button{color:#1c1c1c !important;background-color:#db7500 !important}.fxs-topbar-debug-button:hover{background-color:#fff0d1 !important}.fxs-topbar-upgradebutton{color:#1c1c1c !important;background-color:#bdf6e2 !important}.fxs-topbar-upgradebutton:hover{background-color:#f3fdfa !important}.fxs-search-wrapper{background-color:#e1dfdd}.fxs-search-icon-mini{fill:#3b3a39}.fxs-search-box .azc-input{color:#3b3a39}.fxs-search-box .azc-input::placeholder{color:#3b3a39}.fxs-search-box .azc-input::placeholder{color:#3b3a39}.fxs-topbar-devmode{background-color:#db7500}.fxs-topbar-devmode .fxs-topbar-avatarmenu .fxs-dropmenu-button{color:#1c1c1c}.fxs-topbar-devmode .fxs-topbar-button,.fxs-topbar-devmode .fxs-topbar-avatarmenu .fxs-dropmenu-button{fill:#1c1c1c}.fxs-topbar-devmode .fxs-topbar-button:hover,.fxs-topbar-devmode .fxs-topbar-avatarmenu .fxs-dropmenu-button:hover{background-color:#fff0d1}.fxs-search-showmenu .fxs-search-wrapper{background-color:#fff}.fxs-search-showmenu .fxs-search-box .azc-input{color:#252423}.fxs-search-showmenu .fxs-search-box .azc-input::placeholder{color:#252423}.fxs-search-showmenu .fxs-search-box .azc-input::placeholder{color:#252423}.fxs-search-showmenu .fxs-search-icon-mini{fill:#135995}.fxs-topbar-exit-customize,.fxs-topbar-dashboard{background-color:#8a2da5}.fxs-sidebar-menu-container .fxc-menu-search{margin:12px 15px}.fxs-sidebar-menu-container .fxc-menu-grid .ext-fxc-menu-item{color:#fff;padding:0 15px}.fxs-sidebar-menu-container .fxc-menu-grid .ext-fxc-menu-icon{width:18px;height:18px;padding-right:6px;padding-top:7px}.fxs-sidebar-menu-container .fxc-menu-grid .azc-listView-groupheader{margin:0 15px}.fxs-sidebar-menu-container .fxs-portal-activated,.fxs-sidebar-menu-container .fxs-portal-activated.fxs-portal-hover:hover{background-color:rgba(128,128,128,.25)}.fxs-sidebar-menu-container .fxs-portal-hover:hover{background-color:rgba(128,128,128,.15)}.fxs-sidebar-item-link:hover,.fxs-sidebar-collapse-button:hover{background-color:rgba(128,128,128,.15)}.fxs-sidebar .fxs-sidebar-icon.fxs-sidebar-menu-icon,.fxs-sidebar .fxs-sidebar-hamburger .fxs-sidebar-icon{fill:#0078d4}.fxs-sidebar-bar,.fxs-sidebar-menu .fxs-sidebar-bar{background-color:#323130;color:#fff}.fxs-sidebar-divider,.fxs-sidebar-divider2{border-bottom-color:#3b3a39}.fxs-sidebar-hamburger-button,.fxs-sidebar-collapse-button{fill:#fff}.fxs-sidebar-shadow{width:6px;background:linear-gradient(270deg,rgba(0,0,0,.24) 0%,rgba(0,0,0,0) 100%)}.fxs-sidebar .fxs-sidebar-icon{fill:#fff}.fxs-sidebar .fxs-sidebar-icon .msportalfx-svg-c05{fill:#fff}.fxs-sidebar .fxs-sidebar-icon .msportalfx-svg-c07{fill:#fff}.fxs-sidebar-star.fxs-is-favorite svg{fill:#ffb900;stroke:#000;stroke-width:1px}.fxs-bg-white{background-color:#fff}.fxs-overlay{background:rgba(0,0,0,.7)}.fxs-highlight{color:#000;background-color:#fff100}.fxs-tile-actionbar-action:hover,.fxs-tile-actionbar-action.fxs-tile-actionbar-action-pressed{background:rgba(125,125,125,.2)}.fxs-tile-actionbar-action.fxs-tile-actionbar-command-unpinfromstartboard:hover{background:#ba141a;fill:white}.fxs-text-white{color:#fff}.fxs-fill-white{fill:#fff}.fxs-br-primary{border-color:#00bcf2}.fxs-tile-selected .fxs-tile-overlay{background-color:transparent}.fxs-bg-overlay-dark{background:rgba(0,0,0,.7)}.fxs-bg-primary-10{background-color:rgba(0,188,242,.1)}.azc-disabled:hover,.azc-row-disabled:hover{background-color:inherit}input.azc-disabled,.azc-disabled,.azc-disabled:hover,.azc-disabled:focus{cursor:default;outline:none}.azc-dockedballoon-balloon a{color:#4894fe}.fxs-portal .fxs-text-info,.fxs-portal .msportalfx-text-info{color:#0058ad}.fxs-portal .fxs-text-success,.fxs-portal .msportalfx-text-success{color:#7fba00}.fxs-portal .fxs-text-dirty,.fxs-portal .msportalfx-text-dirty{color:#8a2da5}.fxs-portal .fxs-text-warning,.fxs-portal .msportalfx-text-warning{color:#ffba01}.fxs-fill-info,.msportalfx-fill-info{fill:#015cda !important}.fxs-fill-complete,.fxs-fill-success,.msportalfx-fill-success{fill:#57a300 !important}.fxs-fill-upsell,.fxs-fill-dirty,.msportalfx-fill-dirty{fill:#8a2da5 !important}.fxs-fill-warning,.msportalfx-fill-warning{fill:#db7500 !important}.fxs-fill-error,.msportalfx-fill-error{fill:#a4262c !important}.fxs-br-info,.msportalfx-br-info{border-color:#015cda !important}.fxs-br-success,.msportalfx-br-success{border-color:#57a300 !important}.fxs-br-dirty,.msportalfx-br-dirty{border-color:#8a2da5 !important}.fxs-br-warning,.msportalfx-br-warning{border-color:#db7500 !important}.fxs-br-error,.msportalfx-br-error{border-color:#a4262c !important}.fxs-bg-info,.msportalfx-bg-info{background-color:#015cda !important}.fxs-bg-success,.msportalfx-bg-success{background-color:#57a300 !important}.fxs-bg-upsell,.fxs-bg-dirty,.msportalfx-bg-dirty{background-color:#8a2da5 !important}.fxs-bg-warning,.msportalfx-bg-warning{background-color:#db7500 !important}.fxs-bg-error,.msportalfx-bg-error{background-color:#a4262c !important}@keyframes loading-opacity{0%{opacity:0}10%{opacity:0}50%{opacity:1}100%{opacity:1}}@keyframes loading{0%{transform:translateX(-500px)}10%{transform:translateX(-500px)}90%{transform:translateX(500px)}100%{transform:translateX(500px)}}.fxs-loading5dots-container{width:100%;display:flex;align-items:center;justify-content:center}.fxs-loading5dots-container>div{flex:0 0 auto;position:relative;animation:loading 3s cubic-bezier(0,.95,1,.05) infinite,loading-opacity 1.5s ease-in-out infinite alternate;animation-fill-mode:both}.fxs-loading5dots-container>div:nth-child(1){animation-delay:.2s}.fxs-loading5dots-container>div:nth-child(2){animation-delay:.1s}.fxs-loading5dots-container>div:nth-child(4){animation-delay:-.1s}.fxs-loading5dots-container>div:nth-child(5){animation-delay:-.2s}.fxs-loading5dots-container>div::after{content:"";display:block;border-radius:50%}',moduleId:e.id}})),
define("MsPortalImpl/Init",["require","exports","Fx/DependencyInjection","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/UI/UI.Initialize","MsPortalImpl/Services/Services.Storage","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/Base/Base.HistoryManager","FxInternal/Environment","FxInternal/Css","_generated/Less/MsPortalImpl/Base/Base.Images.css","_generated/Less/MsPortalImpl/Themes/Themes.Universal.css","MsPortalImpl/InitShellWorker","FxInternal/Experimentation","Fx/Telemetry"],(function(e,t,s,i,o,n,r,a,l,d,c,p,u,m,g,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!1===MsPortalFx.isFeatureEnabled("theme2")?(0,c.injectCss)(p,u):(0,c.injectCss)(p);var f=MsPortalFx.Base,x=f.Diagnostics,b=f.UriBuilder,v=r.ComponentName;const y=fx.environment,M=x.createLog(e),I=s.container.get(r.StorageService),C=new b(a.originalHref);C.query=new f.QueryStringBuilder(MsPortalEarly.userQuery),(0,l.replaceState)({data:{},url:C.toString()}),I.clearValue(v.Redirect,"IdpRedirectCount",1);let P=0;const w=I.getValue(v.Redirect,"Referrers",1)||"";setInterval((function(e){const t={fx:y.version};(e?Q():Q.spread([s.container.getAsync(i.ExtensionManager),s.container.getAsync(o.ManifestCache)],((e,s)=>{e.initializedExtensions.forEach((e=>{t[e.name]=s.getVersion(e.name)}))}))).then((()=>{M.custom("Session",1,++P,w,t)}))}),36e5),s.container.set(d.Environment,{extensionName:y.extensionName,sdkEnv:{},shellTrustedLinkedDomains:FxImpl.internalEnv.shellTrustedLinkedDomains,trustedLinkedDomains:void 0,linkedDomainMap:FxImpl.internalEnv.linkedDomainMap}).set(g.ExperimentationManager,new g.ExperimentationManager(FxImpl.features,h.trace)).get(n.Portal).initialize(),(0,m.init)(s.container)}));
define("FxHubs/ArtHelpers/ResourceHoverCardHelpers",["require","exports","FxHubs/ArtHelpers/ArtRequestGenerator","FxHubs/ArtHelpers/ArtApis","FxHubs/ArtHelpers/ArgBrowseHelpers","FxHubs/Resources/FxHubsClientStrings","FxInternal/Resources/ReactComponents","FxHubs/ArtHelpers/ArgBrowseHelpers","FxHubs/ArtHelpers/KustoQueryGenerator","Fx/ResourceManagement","FxHubs/ArtHelpers/KustoQueryHelpers"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function v(n,t){var i,r,u;return((r=(i=n.data)===null||i===void 0?void 0:i.rows)===null||r===void 0?void 0:r.length)?(u=MsPortalFx.findIndex(n.data.columns,(function(n){return n.name===t})),u<0)?null:n.data.rows[0][u]:null}function y(n,t,f,e,h,v,y,p,w,b){return __awaiter(this,void 0,void 0,(function(){var g,tt,d,k,nt,it,rt,ut;return __generator(this,(function(ft){switch(ft.label){case 0:return l[h]?[4,l[h]]:[3,2];case 1:return[2,ft.sent()];case 2:for(g=0,tt=n;g<tt.length;g++)d=tt[g],t.push(d.name),(d.format===5||d.format===7)&&t.push("".concat(d.name,"DisplayName")),d.bladeParameterColumn&&t.push(o.getColumnName(d.bladeParameterColumn));return k=new s.KustoQueryGenerator(null,MsPortalFx.unique(t),null,f),nt=f?c.smartQuerySplit(f):[],it=!1,nt.length&&nt[0]&&(rt=nt[0].trim().split(" "),it=!u.knownArgTopLevelOperatorsLowerCased.includes(rt[0].toLowerCase())),it?k.setSuffixPredicates(["where id =~ '".concat(h,"'"),"limit 1"]):(e.kind===1?k.setSources(4):e.kind===4?k.setSources(2):k.setSources(1),k.setPrefixPredicates(["where id =~ '".concat(h,"'")]),k.setSuffixPredicates(["limit 1"])),ut=e.subscription?Q(a.getSubscriptionInfo(e.subscription)):Q(null),l[h]=ut.then((function(t){for(var u,c,l=MsPortalFx.forEachKey(v,(function(n,t,i){var r,u,f,e,o;t&&(e=undefined,o=undefined,t.defaultKind&&((r=t.defaultKind.displayName)===null||r===void 0?void 0:r.singular)&&(e=(u=t.defaultKind.displayName)===null||u===void 0?void 0:u.singular),t.kindMap&&(o=MsPortalFx.forEachKey(t.kindMap,(function(n,t,i){var r;((r=t.displayName)===null||r===void 0?void 0:r.singular)&&(i[n]=t.displayName.singular)}),{})),i[n]={displayName:e||((f=t.displayName)===null||f===void 0?void 0:f.singular)||n,subValueDisplayNames:o})}),{}),a=s.buildDisplayNameMapProvider({columnName:"type",subValueColumnName:"kind",mappedColumnName:"typeDisplayName",displayNameMapFunc:function(){return l}}),o=MsPortalFx.extendStringMapIntoMap(Object.create(null),y,(function(n){return{displayName:n.displayName}})),d=s.buildDisplayNameMapProvider({columnName:"location",mappedColumnName:"locationDisplayName",displayNameMapFunc:function(){return o}}),g=s.buildDisplayNameMapProvider({columnName:"subscriptionId",mappedColumnName:"subscriptionDisplayName",displayNameMapFunc:function(){var n;return t?(n={},n[t===null||t===void 0?void 0:t.subscriptionId]={displayName:t===null||t===void 0?void 0:t.displayName},n):{}}}),f=[],e=0,h=n;e<h.length;e++){u=h[e];switch(u.format){case 5:f.push(s.buildDisplayNameMapProvider({columnName:u.name,mappedColumnName:"".concat(u.name,"DisplayName"),displayNameMapFunc:function(){return o}}));break;case 7:f.push(s.buildDisplayNameMapProvider({columnName:u.name,mappedColumnName:"".concat(u.name,"DisplayName"),displayNameMapFunc:function(){return MsPortalFx.extendStringMapIntoMap(Object.create(null),p,(function(n){return{displayName:n.displayName}}))}}))}}return k.setMappingProviders(__spreadArray([a,d,g],f,!0)),k.updateQuery(),c=i.getRequest(w.createChildLifetime(),{subscriptionsObservable:ko.observable(t?[t===null||t===void 0?void 0:t.subscriptionId]:[]),pageObservable:null,pageSizeObservable:ko.observable(1),queryObservable:k.query,skipTokenObservable:null}),r.getDataFromArt(c.request(),b||"art-resource-hover-card")})).then((function(n){return delete l[h],n})),[4,l[h]];case 3:return[2,ft.sent()]}}))}))}Object.defineProperty(t,"__esModule",{value:!0});t.getResourceFromArg=t.getValueFromArgResponse=t.defaultProperties=void 0;var a=MsPortalFx.Azure,l=Object.create(null);t.defaultProperties=[{columnId:"typeDisplayName",name:f.ResourceHoverCard.type},{columnId:"kind",name:e.ResourceHoverCard.kind},{columnId:"locationDisplayName",name:f.ResourceHoverCard.location},{columnId:"location",name:"locationId",isMetadata:!0},];t.getValueFromArgResponse=v;t.getResourceFromArg=y}))